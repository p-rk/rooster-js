var PiTextEditor=function(D){"use strict";var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},j={},B={},F={},H={},t={},n={},r={},o={},i={};function z(e){e=e&&(e.commonAncestorContainer||e),e=e&&(e.ownerDocument||("[object HTMLDocument]"==Object.prototype.toString.apply(e)?e:null));return e&&(e.defaultView||window)}Object.defineProperty(i,"__esModule",{value:!0}),i.getTargetWindow=void 0,i.getTargetWindow=z,i.default=function(e,t){var n=z(e),n=n&&n[t],r=window,r=r&&r[t];return r&&e instanceof r||n&&e instanceof n},Object.defineProperty(o,"__esModule",{value:!0});var U=i,V=(o.default=function(e,t,n){return!(!e||!t)&&(!(!n||e!=t)||((0,U.default)(t,"Range")&&(t=t&&t.commonAncestorContainer,n=!0),t&&3==t.nodeType&&(t=t.parentNode,n=!0),1!=e.nodeType&&11!=e.nodeType?!!n&&e==t:!(!n&&e==t)&&function(e,t){if(e.contains)return e.contains(t);for(;t;){if(t==e)return!0;t=t.parentNode}return!1}(e,t)))},{}),W={},q=(Object.defineProperty(W,"__esModule",{value:!0}),W.default=function(e,t){return!(!e||!t||4!=(4&t.compareDocumentPosition(e)))},Object.defineProperty(V,"__esModule",{value:!0}),V.splitBalancedNodeRange=void 0,W);function K(e,t){var n;if(!e||!e.parentNode)return null;var r=e.parentNode,o=r.cloneNode(!1);if(o.removeAttribute("id"),t)for(;r.firstChild&&r.firstChild!=e;)o.appendChild(r.firstChild);else for(;e.nextSibling;)o.appendChild(e.nextSibling);return o.firstChild&&""!=o.innerHTML?null!=(n=r.parentNode)&&n.insertBefore(o,t?r:r.nextSibling):o=null,o}V.default=K,V.splitBalancedNodeRange=function(e){var t,n=Array.isArray(e)?e[0]:e,e=Array.isArray(e)?e[e.length-1]:e,r=n&&e&&n.parentNode==e.parentNode?n.parentNode:null;return r&&((0,q.default)(n,e)&&(t=e,e=n,n=t),K(n,!0),K(e,!1)),r};var Z={},G=(Object.defineProperty(Z,"__esModule",{value:!0}),Z.default=function(e){return[].slice.call(e)},Object.defineProperty(r,"__esModule",{value:!0}),r.collapse=void 0,o),$=V,X=Z;function Y(e,t,n,r,o){for(;t.parentNode!=e&&!(0,G.default)(t.parentNode,n);){if(r&&t.previousSibling||!r&&t.nextSibling){if(!o)break;(0,$.default)(t,r)}if(!t.parentNode)break;t=t.parentNode}return t}r.default=function(e,t,n,r){var o;return(0,G.default)(e,t)&&(0,G.default)(e,n)?(t=Y(e,t,n,!0,r),n=Y(e,n,t,!1,r),(0,G.default)(t,n,!0)?[t]:(0,G.default)(n,t)?[n]:t.parentNode==n.parentNode?(e=(r=t.parentNode?(0,X.default)(null==(e=t.parentNode)?void 0:e.childNodes):[]).indexOf(t),o=r.indexOf(n),r.slice(e,o+1)):[t,n]):[]},r.collapse=Y;var a={},Q=(Object.defineProperty(a,"__esModule",{value:!0}),a.default=function(e){return e&&1==e.nodeType?e.tagName.toUpperCase():""},{}),J=(Object.defineProperty(Q,"__esModule",{value:!0}),a),ee="ADDRESS,ARTICLE,ASIDE,BLOCKQUOTE,CANVAS,DD,DIV,DL,DT,FIELDSET,FIGCAPTION,FIGURE,FOOTER,FORM,H1,H2,H3,H4,H5,H6,HEADER,HR,LI,MAIN,NAV,NOSCRIPT,OL,OUTPUT,P,PRE,SECTION,TABLE,TD,TH,TFOOT,UL,VIDEO".split(","),te=["block","list-item","table-cell"],l=(Q.default=function(e){var t=(0,J.default)(e);return!(!t||!(0<=te.indexOf(e.style.display)||0<=ee.indexOf(t)))},{}),ne=(Object.defineProperty(l,"__esModule",{value:!0}),o),re=W;function oe(e){this.element=e}oe.prototype.collapseToSingleElement=function(){return this.element},oe.prototype.getStartNode=function(){return this.element},oe.prototype.getEndNode=function(){return this.element},oe.prototype.equals=function(e){return this.element==e.getStartNode()},oe.prototype.isAfter=function(e){return(0,re.default)(this.element,e.getEndNode())},oe.prototype.contains=function(e){return(0,ne.default)(this.element,e,!0)},oe.prototype.getTextContent=function(){var e;return(null==(e=this.element)?void 0:e.textContent)||""},l.default=oe;var s={},ie={},ae={},le=(Object.defineProperty(ae,"__esModule",{value:!0}),a),se="AREA,BASE,BR,COL,COMMAND,EMBED,HR,IMG,INPUT,KEYGEN,LINK,META,PARAM,SOURCE,TRACK,WBR".split(","),c=(ae.default=function(e){return!!e&&0<=se.indexOf((0,le.default)(e))},{}),d={},ce={},de=(Object.defineProperty(ce,"__esModule",{value:!0}),i),ue=(ce.default=function(e,t){return(0,de.default)(e,"HTMLElement")&&(e.matches||e.msMatchesSelector).call(e,t)},Object.defineProperty(d,"__esModule",{value:!0}),o),fe=ce,pe=(d.default=function(e,t,n){var r=(e=e?1==e.nodeType?e:e.parentNode:null)&&1==e.nodeType?e:null;if(r&&n)if(r.closest)r=r.closest(n);else for(;r&&r!=t&&!(0,fe.default)(r,n);)r=r.parentElement;return!t||(0,ue.default)(t,r)?r:null},Object.defineProperty(c,"__esModule",{value:!0}),d),he=W;function ge(e,t,n){switch(void 0===t&&(t=0),this.isFromEndOfRange=n,e.node?(this.node=e.node,t=e.offset):this.node=e,t){case-2:this.offset=me(this.node),this.node=this.node.parentNode,this.isAtEnd=!1;break;case-3:this.offset=me(this.node)+1,this.isAtEnd=!this.node.nextSibling,this.node=this.node.parentNode;break;case-1:this.offset=ve(this.node),this.isAtEnd=!0;break;default:var r=ve(this.node);this.offset=Math.max(0,Math.min(t,r)),this.isAtEnd=0<t&&r<=t}this.element=(0,pe.default)(this.node)}function me(e){for(var t=0;e=(null==e?void 0:e.previousSibling)||null;)t++;return t}function ve(e){var t;return 3==e.nodeType?(null==(t=e.nodeValue)?void 0:t.length)||0:1==e.nodeType?e.childNodes.length:1}ge.prototype.normalize=function(){if(3==this.node.nodeType||!this.node.firstChild)return this;for(var e=this.node,t=this.isAtEnd?-1:this.offset;1==e.nodeType||11==e.nodeType;){var n=this.isFromEndOfRange?-1==t?e.lastChild:e.childNodes[t-1]:0==t?e.firstChild:-1==t?e.lastChild:e.childNodes[t];if(!n)break;e=n,t=this.isAtEnd||this.isFromEndOfRange?-1:0}return new ge(e,t,this.isFromEndOfRange)},ge.prototype.equalTo=function(e){return e&&(this==e||this.node==e.node&&this.offset==e.offset&&this.isAtEnd==e.isAtEnd)},ge.prototype.isAfter=function(e){return this.node==e.node?this.isAtEnd&&!e.isAtEnd||this.offset>e.offset:(0,he.default)(this.node,e.node)},ge.prototype.move=function(e){return new ge(this.node,Math.max(this.offset+e,0))},ge.getStart=function(e){return new ge(e.startContainer,e.startOffset)},ge.getEnd=function(e){return e.collapsed?ge.getStart(e):new ge(e.endContainer,e.endOffset,!0)},c.default=ge,Object.defineProperty(ie,"__esModule",{value:!0});var ye=ae,be=c,Ee=i;function Ce(e){return 1==e.node.nodeType&&(0,ye.default)(e.node)?new be.default(e.node,e.isAtEnd?-3:-2):e}function we(e){return e&&e.node}function Se(e,t){if(!e||!t)return null;for(var n=0,r=0;r<t.length&&(n=t[r],r<t.length-1&&e&&1==e.nodeType&&e.childNodes.length>n);r++)e=e.childNodes[n];return new be.default(e,n)}ie.default=function(e,t,n,r){var o=null,i=null;return we(e)?(o=e,i=we(t)?t:null):(0,Ee.default)(e,"Node")&&(Array.isArray(t)?(o=Se(e,t),i=Array.isArray(n)?Se(e,n):null):"number"==typeof t?(o=new be.default(e,t),i=(0,Ee.default)(n,"Node")?new be.default(n,r):null):!(0,Ee.default)(t,"Node")&&t||(o=new be.default(e,-2),i=new be.default(t||e,-3))),null!=(n=null==o?void 0:o.node)&&n.ownerDocument?(r=o.node.ownerDocument.createRange(),o=Ce(o),i=Ce(i||o),r.setStart(o.node,o.offset),r.setEnd(i.node,i.offset),r):null};var xe,Te,Oe={},Pe={},_e={},ke=(Object.defineProperty(_e,"__esModule",{value:!0}),_e.Browser=_e.getBrowserInfo=void 0,/android/i);function Le(e,t){var n=-1!=e.indexOf("rv:")&&-1!=e.indexOf("Trident"),r=-1!=e.indexOf("MSIE")||n,o=!1,i=!1,a=!1,l=!1,s=-1!=e.indexOf("WebKit");return r||(o=-1!=e.indexOf("Chrome"),i=-1!=e.indexOf("Firefox"),-1!=e.indexOf("Safari")&&(a=-1==e.indexOf("Chrome")&&-1==e.indexOf("Android")),(l=-1!=e.indexOf("Edge"))&&(s=o=i=!1)),{isMac:-1!=t.indexOf("Mac"),isWin:-1!=t.indexOf("Win")||-1!=t.indexOf("NT"),isWebKit:s,isIE:r,isIE11OrGreater:n,isSafari:a,isChrome:o,isFirefox:i,isEdge:l,isIEOrEdge:r||l,isAndroid:ke.test(e)}}_e.getBrowserInfo=Le,_e.Browser=window?Le(window.navigator.userAgent,window.navigator.appVersion):{},xe=Pe,Object.defineProperty(xe,"__esModule",{value:!0}),xe.KnownCreateElementData=void 0,Te=i,Ne=_e,xe.KnownCreateElementData=((u={})[0]={tag:""},u[1]=Ne.Browser.isEdge?{tag:"div",children:[{tag:"span",children:[{tag:"br"}]}]}:{tag:"div",children:[{tag:"br"}]},u[2]={tag:"blockquote",style:"margin-top:0;margin-bottom:0"},u[3]={tag:"div",style:"width: 1px; height: 1px; overflow: hidden; position: fixed; top: 0; left; 0; -webkit-user-select: text",attributes:{contenteditable:"true"}},u[4]={tag:"li",style:"display:block"},u[5]={tag:"div",style:"position: fixed; width: 0; height: 0"},u[6]={tag:"div",style:"width:100%;height:100%;position:relative;overflow:hidden"},u[7]={tag:"div",style:"position: fixed; cursor: row-resize; user-select: none"},u[8]={tag:"div",style:"position: fixed; cursor: col-resize; user-select: none"},u[9]={tag:"div",style:"position: fixed; cursor: nw-resize; user-select: none; border: 1px solid #808080"},u[10]={tag:"div",style:"position: fixed; cursor: ne-resize; user-select: none; border: 1px solid #808080"},u[11]={tag:"div",style:"position: fixed; cursor: all-scroll; user-select: none; border: 1px solid #808080"},u),xe.default=function t(e,n){if(!(e="number"==typeof e?xe.KnownCreateElementData[e]:e)||!e.tag)return null;var r=e.tag,o=e.namespace,i=e.className,a=e.style,l=e.dataset,s=e.attributes,e=e.children,c=o?n.createElementNS(o,r):n.createElement(r);return a&&c.setAttribute("style",a),i&&(c.className=i),l&&(0,Te.default)(c,"HTMLElement")&&Object.keys(l).forEach(function(e){c.dataset[e]=l[e]}),s&&Object.keys(s).forEach(function(e){c.setAttribute(e,s[e])}),e&&e.forEach(function(e){"string"==typeof e?c.appendChild(n.createTextNode(e)):e&&(e=t(e,n))&&c.appendChild(e)}),c};var Ne={},Re=(Object.defineProperty(Ne,"__esModule",{value:!0}),Z),Ie=(Ne.default=function(e,t){t=t.createElement("DIV");return t.innerHTML=e,(0,Re.default)(t.childNodes)},Object.defineProperty(Oe,"__esModule",{value:!0}),Pe),Ae=Ne,Me=i,De=(Oe.default=function(e,t){if(0==(e=e?(0,Me.default)(e,"Node")?[e]:e:[]).length||!e[0]||!e[0].ownerDocument)return null;(0,Me.default)(t=t||"div","HTMLElement")||(n=e[0].ownerDocument,t="string"==typeof t?/^\w+$/.test(t)?n.createElement(t):(0,Ae.default)(t,n)[0]:(0,Ie.default)(t,n));var n=e[0].parentNode;n&&n.insertBefore(t,e[0]);for(var r=0,o=e;r<o.length;r++){var i=o[r];t.appendChild(i)}return t},Object.defineProperty(s,"__esModule",{value:!0}),r),je=o,Be=ie,Fe=a,He=Q,ze=W,Ue=Oe,Ve=V,We=["TD","TH","LI","BLOCKQUOTE"];function qe(e,t,n){this.rootNode=e,this.startNode=t,this.endNode=n}qe.getBlockContext=function(e){for(var t=e;t&&!(0,He.default)(t);)t=t.parentNode;return t},qe.prototype.collapseToSingleElement=function(){for(var e=qe.getBlockContext(this.startNode),t=e?(0,De.default)(e,this.startNode,this.endNode,!0):[],n=qe.getBlockContext(this.startNode);t[0]&&t[0]!=n&&t[0].parentNode!=this.rootNode&&We.indexOf((0,Fe.default)(t[0].parentNode))<0;)t=[(0,Ve.splitBalancedNodeRange)(t)];return 1==t.length&&(0,He.default)(t[0])?t[0]:(0,Ue.default)(t)},qe.prototype.getStartNode=function(){return this.startNode},qe.prototype.getEndNode=function(){return this.endNode},qe.prototype.equals=function(e){return this.startNode==e.getStartNode()&&this.endNode==e.getEndNode()},qe.prototype.isAfter=function(e){return(0,ze.default)(this.getStartNode(),e.getEndNode())},qe.prototype.contains=function(e){return(0,je.default)(this.startNode,e,!0)||(0,je.default)(this.endNode,e,!0)||(0,ze.default)(e,this.startNode)&&(0,ze.default)(this.endNode,e)},qe.prototype.getTextContent=function(){var e=(0,Be.default)(this.getStartNode(),this.getEndNode());return e?e.toString():""},s.default=qe,Object.defineProperty(n,"__esModule",{value:!0});var Ke=r,Ze=o,Ge=a,$e=Q,Xe=l,Ye=s;function Qe(e,t,n){var r=e;if("BR"==(0,Ge.default)(r)&&n)return r;for(;r;){for(var o=e;e.parentNode&&!(o=n?e.nextSibling:e.previousSibling);)if((e=e.parentNode)==t)return r;for(;o;){if((0,$e.default)(o))return r;if("BR"==(0,Ge.default)(o))return n?o:r;e=o,o=n?e.firstChild:e.lastChild}r=e}return r}n.default=function(e,t){if(!(0,Ze.default)(e,t))return null;var n=Ye.default.getBlockContext(t);if(!n)return null;if(n==t)return new Xe.default(n);var r=Qe(t,n,!1),o=Qe(t,n,!0),t=(0,Ke.default)(e,r,o,!1),r=t[0],o=t[t.length-1];if(r.parentNode!=o.parentNode)return new Ye.default(e,r,o);for(;!r.previousSibling&&!o.nextSibling;){var i=r.parentNode;if(i==n){n!=e&&(r=o=i);break}if(!i||i==e)break;r=o=i}return r==o&&(0,$e.default)(r)?new Xe.default(r):new Ye.default(e,r,o)};var u={},Je=(Object.defineProperty(u,"__esModule",{value:!0}),n),s=(u.default=function(e,t){for(var n=e;(n=n&&(t?n.firstChild:n.lastChild))&&n.firstChild;);return n&&(0,Je.default)(e,n)||null},{}),et={},f={},tt={},nt={},rt={},ot={},p=(Object.defineProperty(ot,"__esModule",{value:!0}),ot.default=function(e,t,n){var r=(null==(r=e.nodeValue)?void 0:r.substring(0,t))||"",o=(null==(o=e.nodeValue)?void 0:o.substring(t))||"",t=e.ownerDocument.createTextNode(n?r:o);return e.nodeValue=n?o:r,null!=(o=e.parentNode)&&o.insertBefore(t,n?e:e.nextSibling),t},{}),h={},it={},at=(Object.defineProperty(it,"__esModule",{value:!0}),it.getComputedStyle=void 0,d);function lt(e,t){void 0===t&&(t=["font-family","font-size","color","background-color"]);var e=(0,at.default)(e),n=[];if(t=Array.isArray(t)?t:[t],e){var r=(e.ownerDocument.defaultView||window).getComputedStyle(e);if(r)for(var o=0,i=t;o<i.length;o++){var a=i[o],l=r.getPropertyValue(a)||"",l="font-family"!=a?l.toLowerCase():l;l="font-size"==a?(a=l)&&a.indexOf("px")==a.length-2?Math.round(75*parseFloat(a)+.05)/100+"pt":a:l,n.push(l)}}return n}it.default=lt,it.getComputedStyle=function(e,t){return lt(e,t)[0]||""},Object.defineProperty(h,"__esModule",{value:!0});var st=a,ct=it,dt=/^[\r\n]+$/gm,ut=/[\t\r\n\u0020\u200B]/gm,ft=(h.default=function e(t,n){if(3==t.nodeType)return!(t.nodeValue&&""!=t.textContent&&!dt.test(t.nodeValue)&&(!n||""!=t.nodeValue.replace(ut,"")));if(1!=t.nodeType)return!0;if("none"==(0,ct.getComputedStyle)(t,"display"))return!0;var r=(0,st.default)(t);if("DIV"!=r&&"SPAN"!=r)return!1;for(var o=t.firstChild;o;o=o.nextSibling)if(!e(o,n))return!1;return!0},Object.defineProperty(p,"__esModule",{value:!0}),p.getPreviousLeafSibling=p.getNextLeafSibling=p.getLeafSibling=void 0,o),pt=a,ht=h;function gt(e,t,n,r,o){var i=null,a=n?function(e){return(null==e?void 0:e.nextSibling)||null}:function(e){return(null==e?void 0:e.previousSibling)||null},l=n?function(e){return e.firstChild}:function(e){return e.lastChild};if((0,ft.default)(e,t))for(var s=t,c=!0;c;){for(var d=(null==s?void 0:s.parentNode)||null,s=a(s);!s&&d!=e;)s=a(d),d=(null==d?void 0:d.parentNode)||null;for(;s&&(!r||r.indexOf((0,pt.default)(s))<0)&&l(s);)s=l(s);if(!(c=!!s&&(0,ht.default)(s,o))){i=s;break}}return i}p.getLeafSibling=gt,p.getNextLeafSibling=function(e,t,n){return gt(e,t,!0,n)},p.getPreviousLeafSibling=function(e,t,n){return gt(e,t,!1,n)},Object.defineProperty(rt,"__esModule",{value:!0});var mt=a,vt=c,yt=ot,bt=Oe,Et=p,Ct=V,wt="SPAN,B,I,U,EM,STRONG,STRIKE,S,SMALL".split(",");function St(e,t){e&&1==e.nodeType&&t(e,!0)}rt.default=function(e,t,n,r){void 0===n&&(n=new vt.default(e,0).normalize()),void 0===r&&(r=new vt.default(e,-1).normalize());for(var o,i=[],a=n,l=r;a&&l&&l.isAfter(a);){var s=a.node,c=(0,mt.default)(s.parentNode),d=(0,Et.getNextLeafSibling)(e,s);3==s.nodeType&&["TR","TABLE"].indexOf(c)<0&&(s!=l.node||l.isAtEnd||(s=(0,yt.default)(s,l.offset,!0)),0<a.offset&&(s=(0,yt.default)(s,a.offset,!1)),i.push(s)),a=d&&new vt.default(d,0)}0<i.length&&(i.every(function(e){return e.parentNode==i[0].parentNode})&&(o=i.shift(),i.forEach(function(e){var t=(o.nodeValue||"")+(e.nodeValue||"");o.nodeValue=t,null!=(t=e.parentNode)&&t.removeChild(e)}),i=[o]),i.forEach(function(e){for(;"SPAN"!=(0,mt.default)(e)&&0<=wt.indexOf((0,mt.default)(e.parentNode));)St(e,t),e=(0,Ct.splitBalancedNodeRange)(e);"SPAN"!=(0,mt.default)(e)&&(St(e,t),e=(0,bt.default)(e,"SPAN")),t(e)}))},Object.defineProperty(nt,"__esModule",{value:!0});var xt=rt,Tt=W,Ot=c;function Pt(e,t){this.containerNode=e,this.parentBlock=t}Pt.prototype.getTextContent=function(){return(3==this.containerNode.nodeType?this.containerNode.nodeValue:this.containerNode.textContent)||""},Pt.prototype.getContainerNode=function(){return this.containerNode},Pt.prototype.getParentBlock=function(){return this.parentBlock},Pt.prototype.getStartPosition=function(){return new Ot.default(this.containerNode,0).normalize()},Pt.prototype.getEndPosition=function(){return new Ot.default(this.containerNode,-1).normalize()},Pt.prototype.isTextualInlineElement=function(){return this.containerNode&&3==this.containerNode.nodeType},Pt.prototype.isAfter=function(e){return e&&(0,Tt.default)(this.containerNode,e.getContainerNode())},Pt.prototype.contains=function(e){var t=this.getStartPosition(),n=this.getEndPosition();return e&&e.isAfter(t)&&n.isAfter(e)},Pt.prototype.applyStyle=function(e){(0,xt.default)(this.containerNode,e)},nt.default=Pt;var _t,kt,Lt=e&&e.__extends||(_t=function(e,t){return(_t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}_t(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),Lt=(Object.defineProperty(tt,"__esModule",{value:!0}),kt=nt.default,Lt(Nt,kt),Nt);function Nt(e,t){return kt.call(this,e,t)||this}tt.default=Lt;var Rt,It,Lt={},g=e&&e.__extends||(Rt=function(e,t){return(Rt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}Rt(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),g=(Object.defineProperty(Lt,"__esModule",{value:!0}),It=nt.default,g(At,It),At);function At(e,t){return It.call(this,e,t)||this}Lt.default=g,Object.defineProperty(f,"__esModule",{value:!0});var Mt=n,Dt=a,jt=tt,Bt=Lt,Ft=nt,Ht=i,g=(f.default=function(e,t){e=(0,Ht.default)(e,"Node")?(0,Mt.default)(e,t):e;return t&&e&&function(e,t){for(var n,r=[e],o=e.parentNode;o&&t.contains(o);o=o.parentNode)r.push(o);for(var i=r.length-1;0<=i&&!n;i--){var a=r[i],l=(0,Dt.default)(a);"A"==l?n=new Bt.default(a,t):"IMG"==l&&(n=new jt.default(a,t))}return n||new Ft.default(e,t)}(t,e)},{}),zt={},Ut=(Object.defineProperty(zt,"__esModule",{value:!0}),zt.getLastLeafNode=zt.getFirstLeafNode=void 0,h),Vt=p;function Wt(e,t){for(var n=function(e){return t?e.firstChild:e.lastChild},r=n(e);r&&n(r);)r=n(r);return r=r&&(0,Ut.default)(r)?(0,Vt.getLeafSibling)(e,r,t):r}zt.getFirstLeafNode=function(e){return Wt(e,!0)},zt.getLastLeafNode=function(e){return Wt(e,!1)},Object.defineProperty(g,"__esModule",{value:!0}),g.getLastInlineElement=g.getFirstInlineElement=void 0;var qt=f,Kt=zt,Zt=(g.getFirstInlineElement=function(e){var t=(0,Kt.getFirstLeafNode)(e);return t?(0,qt.default)(e,t):null},g.getLastInlineElement=function(e){var t=(0,Kt.getLastLeafNode)(e);return t?(0,qt.default)(e,t):null},Object.defineProperty(et,"__esModule",{value:!0}),o),Gt=n,$t=u,Xt=f,Yt=g;function Qt(e,t){this.rootNode=e,this.startNode=(0,Zt.default)(e,t)?t:null}Qt.prototype.getStartBlockElement=function(){return this.startNode?(0,Gt.default)(this.rootNode,this.startNode):(0,$t.default)(this.rootNode,!0)},Qt.prototype.getStartInlineElement=function(){return this.startNode?(0,Xt.default)(this.rootNode,this.startNode):(0,Yt.getFirstInlineElement)(this.rootNode)},Qt.prototype.isBlockInScope=function(e){return(0,Zt.default)(this.rootNode,e.getStartNode())},Qt.prototype.trimInlineElement=function(e){return e},et.default=Qt;var Jt={};function en(e,t){this.position=e,this.parentBlock=t}Object.defineProperty(Jt,"__esModule",{value:!0}),en.prototype.getTextContent=function(){return""},en.prototype.getContainerNode=function(){return this.position.node},en.prototype.getParentBlock=function(){return this.parentBlock},en.prototype.getStartPosition=function(){return this.position},en.prototype.getEndPosition=function(){return this.position},en.prototype.isAfter=function(e){return e&&this.position.isAfter(e.getEndPosition())},en.prototype.isTextualInlineElement=function(){return!1},en.prototype.contains=function(e){return!1},en.prototype.applyStyle=function(e){},Jt.default=en;var tn={},nn=(Object.defineProperty(tn,"__esModule",{value:!0}),rt),rn=ie,on=c,an=p;function ln(e,t,n){void 0===t&&(t=null),void 0===n&&(n=null),this.inlineElement=e,this.start=t,this.end=n}ln.prototype.getDecoratedInline=function(){return this.inlineElement},ln.prototype.getContainerNode=function(){return this.inlineElement.getContainerNode()},ln.prototype.getParentBlock=function(){return this.inlineElement.getParentBlock()},ln.prototype.getTextContent=function(){return(0,rn.default)(this.getStartPosition(),this.getEndPosition()).toString()},ln.prototype.getStartPosition=function(){return this.start||this.inlineElement.getStartPosition()},ln.prototype.getEndPosition=function(){return this.end||this.inlineElement.getEndPosition()},Object.defineProperty(ln.prototype,"nextInlineElement",{get:function(){return this.end?new ln(this.inlineElement,this.end):null},enumerable:!1,configurable:!0}),Object.defineProperty(ln.prototype,"previousInlineElement",{get:function(){return this.start?new ln(this.inlineElement,void 0,this.start):null},enumerable:!1,configurable:!0}),ln.prototype.contains=function(e){return e&&e.isAfter(this.getStartPosition())&&this.getEndPosition().isAfter(e)},ln.prototype.isTextualInlineElement=function(){return this.inlineElement&&this.inlineElement.isTextualInlineElement()},ln.prototype.isAfter=function(e){var t=this.getStartPosition(),e=e&&e.getEndPosition();return e&&(t.isAfter(e)||t.equalTo(e))},ln.prototype.applyStyle=function(e){var t,n=this.getStartPosition().normalize(),r=this.getEndPosition().normalize(),o=this.getContainerNode();n.isAtEnd&&(n=(t=(0,an.getNextLeafSibling)(o,n.node))?new on.default(t,0):null),0==r.offset&&(r=(t=(0,an.getPreviousLeafSibling)(o,r.node))?new on.default(t,-1):null),(0,nn.default)(o,e,n||void 0,r||void 0)},tn.default=ln;var sn={},m={},cn=(Object.defineProperty(m,"__esModule",{value:!0}),m.getInlineElementBeforeAfter=m.getInlineElementAfter=m.getInlineElementBefore=void 0,f),dn=tn,un=h,fn=p;function pn(e,t,n){if(!e||!t||!t.node)return null;var r=(t=t.normalize()).offset,o=t.isAtEnd,i=t.node,a=!1,o=(!n&&0==r&&!o||n&&o?i=(0,fn.getLeafSibling)(e,i,n):3==i.nodeType&&(!n&&!o||n&&0<r)&&(a=!0),i&&(0,un.default)(i)&&(i=(0,fn.getLeafSibling)(e,i,n)),(0,cn.default)(e,i));return o=o&&(a||o.contains(t))?n?new dn.default(o,t,void 0):new dn.default(o,void 0,t):o}m.getInlineElementBefore=function(e,t){return pn(e,t,!1)},m.getInlineElementAfter=function(e,t){return pn(e,t,!0)},m.getInlineElementBeforeAfter=pn,Object.defineProperty(sn,"__esModule",{value:!0});var hn=Jt,gn=n,mn=f,vn=l,yn=c,bn=i,En=m,Cn=g;function wn(e,t,n){this.rootNode=e,this.startFrom=n,t=(0,bn.default)(t,"Range")?yn.default.getStart(t):t,this.position=t.normalize(),this.block=(0,gn.default)(this.rootNode,this.position.node)}wn.prototype.getStartBlockElement=function(){return this.block},wn.prototype.getStartInlineElement=function(){if(this.block)switch(this.startFrom){case 0:case 1:case 2:return e=this.block,t=0==this.startFrom,e instanceof vn.default?(n=e.getStartNode(),(t?(0,Cn.getFirstInlineElement):(0,Cn.getLastInlineElement))(n)):(0,mn.default)(e,t?e.getStartNode():e.getEndNode());case 3:n=(0,En.getInlineElementAfter)(this.rootNode,this.position);return n&&this.block.contains(n.getContainerNode())?n:new hn.default(this.position,this.block)}var e,t,n;return null},wn.prototype.isBlockInScope=function(e){return!(!this.block||!e)&&this.block.equals(e)},wn.prototype.trimInlineElement=function(e){return this.block&&e&&this.block.contains(e.getContainerNode())?e:null},sn.default=wn;var l={},Sn=(Object.defineProperty(l,"__esModule",{value:!0}),n),xn=tn,Tn=c,On=m;function Pn(e,t){this.rootNode=e,this.startBlock=null,this.startInline=null,this.start=Tn.default.getStart(t).normalize(),this.end=Tn.default.getEnd(t).normalize()}Pn.prototype.getStartBlockElement=function(){return this.startBlock||(this.startBlock=(0,Sn.default)(this.rootNode,this.start.node)),this.startBlock},Pn.prototype.getStartInlineElement=function(){return this.startInline||(this.startInline=this.trimInlineElement((0,On.getInlineElementAfter)(this.rootNode,this.start))),this.startInline},Pn.prototype.isBlockInScope=function(e){if(!e)return!1;var t,n=this.getStartBlockElement();return this.start.equalTo(this.end)?!!n&&n.equals(e):(t=(0,Sn.default)(this.rootNode,this.end.node),!!n&&!!t&&(e.equals(n)||e.equals(t)||e.isAfter(n)&&t.isAfter(e)))},Pn.prototype.trimInlineElement=function(e){if(!e||this.start.equalTo(this.end))return null;var t=e.getStartPosition(),n=e.getEndPosition();if(t.isAfter(this.end)||this.start.isAfter(n))return null;var r=!1,o=!1;return this.start.isAfter(t)&&(t=this.start,r=!0),n.isAfter(this.end)&&(n=this.end,o=!0),t.isAfter(n)||t.equalTo(n)?null:r||o?new xn.default(e,r?t:void 0,o?n:void 0):e},l.default=Pn,Object.defineProperty(s,"__esModule",{value:!0});var _n=et,kn=Jt,Ln=n,Nn=f,Rn=tn,In=sn,An=l,Mn=m,Dn=p;function jn(e,t){this.scoper=e,this.skipTags=t,this.currentInline=null,this.currentBlock=null}jn.createBodyTraverser=function(e,t,n){return new jn(new _n.default(e,t))},jn.createSelectionTraverser=function(e,t,n){return new jn(new An.default(e,t),n)},jn.createBlockTraverser=function(e,t,n,r){return new jn(new In.default(e,t,n=void 0===n?3:n))},Object.defineProperty(jn.prototype,"currentBlockElement",{get:function(){return this.currentBlock||(this.currentBlock=this.scoper.getStartBlockElement()),this.currentBlock},enumerable:!1,configurable:!0}),jn.prototype.getNextBlockElement=function(){return this.getPreviousNextBlockElement(!0)},jn.prototype.getPreviousBlockElement=function(){return this.getPreviousNextBlockElement(!1)},jn.prototype.getPreviousNextBlockElement=function(e){var t=this.currentBlockElement;if(!t)return null;var n=(0,Dn.getLeafSibling)(this.scoper.rootNode,e?t.getEndNode():t.getStartNode(),e,this.skipTags),n=n?(0,Ln.default)(this.scoper.rootNode,n):null;return n&&this.scoper.isBlockInScope(n)&&(e&&n.isAfter(t)||!e&&t.isAfter(n))?(this.currentBlock=n,this.currentBlock):null},Object.defineProperty(jn.prototype,"currentInlineElement",{get:function(){return this.currentInline||(this.currentInline=this.scoper.getStartInlineElement()),this.currentInline instanceof kn.default?null:this.currentInline},enumerable:!1,configurable:!0}),jn.prototype.getNextInlineElement=function(){return this.getPreviousNextInlineElement(!0)},jn.prototype.getPreviousInlineElement=function(){return this.getPreviousNextInlineElement(!1)},jn.prototype.getPreviousNextInlineElement=function(e){var t,n=this.currentInlineElement||this.currentInline;return n?(n instanceof kn.default?(t=(0,Mn.getInlineElementBeforeAfter)(this.scoper.rootNode,n.getStartPosition(),e))&&!n.getParentBlock().contains(t.getContainerNode())&&(t=null):t=(t=function(e,t,n){if(!t)return null;if(t instanceof Rn.default){var r=n?t.nextInlineElement:t.previousInlineElement;if(r)return r}r=t.getContainerNode(),r=(0,Dn.getLeafSibling)(e,r,n);return(0,Nn.default)(e,r)}(this.scoper.rootNode,n,e))&&n&&(e&&t.isAfter(n)||!e&&n.isAfter(t))?t:null,(t=t&&this.scoper.trimInlineElement(t))?(this.currentInline=t,this.currentInline):null):null},s.default=jn;var g={},Bn=(Object.defineProperty(g,"__esModule",{value:!0}),s),Fn=ie,Hn=/[\s\u00A0\u200B\u3000]+([^\s\u00A0\u200B\u3000]*)$/i;function zn(e,t){this.rootNode=e,this.position=t,this.text="",this.word="",this.inlineBefore=null,this.inlineAfter=null,this.traverser=null,this.traversingComplete=!1,this.inlineElements=[],this.nearestNonTextInlineElement=null}zn.prototype.getWordBefore=function(){var e=this;return this.word||this.traverse(function(){return e.word}),this.word||""},zn.prototype.getInlineElementBefore=function(){return this.inlineBefore||this.traverse(null),this.inlineBefore},zn.prototype.getInlineElementAfter=function(){return this.inlineAfter||(this.inlineAfter=Bn.default.createBlockTraverser(this.rootNode,this.position).currentInlineElement),this.inlineAfter},zn.prototype.getSubStringBefore=function(e){var t=this;return this.text.length<e&&this.traverse(function(){return t.text.length>=e}),this.text.substr(Math.max(0,this.text.length-e))},zn.prototype.getRangeFromText=function(r,o){if(!r)return null;var i=null,a=null,l=r.length-1;return this.forEachTextInlineElement(function(e){for(var t=e.getTextContent()||"",n=t.length-1;0<=n&&0<=l;n--)if(r.charCodeAt(l)==t.charCodeAt(n))l--,a=a||e.getStartPosition().move(n+1);else if(o||a)return!0;return-1==l&&(i=e.getStartPosition().move(n+1),!0)}),i&&a&&(0,Fn.default)(i,a)},zn.prototype.forEachTextInlineElement=function(e){this.inlineElements.some(e)||this.traverse(e)},zn.prototype.getNearestNonTextInlineElement=function(){var e=this;return this.nearestNonTextInlineElement||this.traverse(function(){return e.nearestNonTextInlineElement}),this.nearestNonTextInlineElement},zn.prototype.traverse=function(e){if(this.traverser=this.traverser||Bn.default.createBlockTraverser(this.rootNode,this.position),this.traverser&&!this.traversingComplete)for(var t=this.traverser.getPreviousInlineElement();!this.traversingComplete;){if(this.inlineBefore=this.inlineBefore||t,!t||!t.isTextualInlineElement()){this.nearestNonTextInlineElement=t,this.traversingComplete=!0,this.word||(this.word=this.text);break}var n,r=t.getTextContent();if(this.word||(n=Hn.exec(r))&&2==n.length&&(this.word=n[1]+this.text),this.text=r+this.text,this.inlineElements.push(t),e&&e(t))break;t=this.traverser.getPreviousInlineElement()}},g.default=zn;et={},Jt={},sn={};Object.defineProperty(sn,"__esModule",{value:!0}),sn.default=function(e,t){var n;e&&((n=new FileReader).onload=function(){t(n.result)},n.onerror=function(){t(null)},n.readAsDataURL(e))};var Un=e&&e.__assign||function(){return(Un=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Vn=(Object.defineProperty(Jt,"__esModule",{value:!0}),sn),Wn=_e,qn=/^Version:[0-9\.]+\s+StartHTML:\s*([0-9]+)\s+EndHTML:\s*([0-9]+)\s+/i,Kn=((l={})["text/html"]=function(e,t){return e.rawHtml=Wn.Browser.isEdge?(e=t,3==(null==(r=qn.exec(e))?void 0:r.length)&&(n=parseInt(r[1]),r=parseInt(r[2]),0<n&&n<r&&(e=e.substring(n,r))),e):t;var n,r},l["text/plain"]=function(e,t){return e.text=t},l["text/*"]=function(e,t,n){return!!n&&(e.customValues[n]=t)},l);function Zn(e,t){try{e.customValues["link-preview"]=t,e.linkPreview=JSON.parse(t)}catch(e){}}Jt.default=function(e,t){var a={types:[],text:"",image:null,files:[],rawHtml:null,customValues:{}},l=Un({},Kn);return null!=t&&t.allowLinkPreview&&(l["text/link-preview"]=Zn),Promise.all((e||[]).map(function(n){var r=n.type;if(0!=r.indexOf("image/")||a.image||"file"!=n.kind){if("file"==n.kind)return new Promise(function(e){var t=n.getAsFile();t&&(a.types.push(r),a.files.push(t)),e()});var o=function(e,t){e=0==e.indexOf("text/")?e.substring("text/".length):null,t=t&&e?t.indexOf(e):-1;return e&&0<=t?e:void 0}(r,null==t?void 0:t.allowedCustomPasteType),i=l[r]||(o?l["text/*"]:null);return new Promise(function(t){return i?n.getAsString(function(e){a.types.push(r),i(a,e,o),t()}):t()})}return a.types.push(r),a.image=n.getAsFile(),new Promise(function(t){a.image?(0,Vn.default)(a.image,function(e){a.imageDataUri=e,t()}):t()})})).then(function(){return a})};var m={},Gn=(Object.defineProperty(m,"__esModule",{value:!0}),sn),$n=Z,Xn=(m.default=function(e,t,n){for(var r,o,i={types:e.types?(0,$n.default)(e.types):[],text:e.getData("text"),image:null,files:[],rawHtml:null,customValues:{}},a=0;a<(e.files?e.files.length:0);a++){var l=e.files.item(a);if(0==(null==(r=null==l?void 0:l.type)?void 0:r.indexOf("image/"))){i.image=l;break}}function s(){i.image?(0,Gn.default)(i.image,function(e){i.imageDataUri=e,t(i)}):t(i)}var c;null!=n&&n.getTempDiv&&null!=n&&n.removeTempDiv?((c=n.getTempDiv()).contentEditable="true",c.innerHTML="",c.focus(),null!=(o=null==(o=c.ownerDocument)?void 0:o.defaultView)&&o.setTimeout(function(){var e;i.rawHtml=c.innerHTML,null!=(e=n.removeTempDiv)&&e.call(n,c),s()},0)):(i.rawHtml=void 0,s())},Object.defineProperty(et,"__esModule",{value:!0}),Jt),Yn=m,Qn=Z,l=(et.default=function(e,t,n){var r=e.clipboardData||(null==(r=e.target.ownerDocument)?void 0:r.defaultView).clipboardData;r.items?(e.preventDefault(),(0,Xn.default)((0,Qn.default)(r.items),n).then(t)):(0,Yn.default)(r,t,n)},{}),Jn=(Object.defineProperty(l,"__esModule",{value:!0}),l.default=function(e,t){Array.prototype.push.apply(e,t)},{}),er={};Object.defineProperty(er,"__esModule",{value:!0});var tr="#ffffff";er.default=function e(t,n,r,o,i){var a="string"==typeof n?n.trim():"",n="string"==typeof n?null:n;if((a||n)&&(t.style.setProperty(r?"background-color":"color",(o?null==n?void 0:n.darkModeColor:null==n?void 0:n.lightModeColor)||a),t.dataset&&(a=r?"ogsb":"ogsc",o?n&&(t.dataset[a]=n.lightModeColor):delete t.dataset[a]),r&&i)){var l=t,s=o;if(null==(n=l.firstElementChild)||!n.hasAttribute("style")){var c,d,u,n=l.style.getPropertyValue("background-color"),n=s&&(l.dataset.ogsb||l.dataset.ogab)||n;if(n&&"transparent"!==n)switch(n="#"==n.substring(0,1)?(u=(c=function(e){return e=(e=4===e.length?e.replace(/(.)/g,"$1$1"):e).replace("#",""),[parseInt(e.substr(0,2),16),parseInt(e.substr(2,2),16),parseInt(e.substr(4,2),16)]}(n))[0],d=c[1],c[2]):(c=n.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/),u=(n=[parseInt(c[1]),parseInt(c[2]),parseInt(c[3])])[0],d=n[1],n[2]),u/=255,d/=255,n/=255,(u=50*(Math.max(u,d,n)+Math.min(u,d,n)))<20?1:80<u?0:2){case 1:e(l,{lightModeColor:tr,darkModeColor:"#333333"},!1,s);break;case 0:e(l,{lightModeColor:"#000000",darkModeColor:tr},!1,s)}}}},Object.defineProperty(Jn,"__esModule",{value:!0});var nr,rr=er,or=(Jn.default=function(e,t,n){var r,o,i,a,l,s,c,d,u;t&&(r=e.style,o=t.fontFamily,i=t.fontSize,a=t.textColor,l=t.textColors,s=t.backgroundColor,c=t.backgroundColors,d=t.bold,u=t.italic,t=t.underline,o&&(r.fontFamily=o),i&&(r.fontSize=i),l?(0,rr.default)(e,l,!1,n):a&&(0,rr.default)(e,a,!1,n),c?(0,rr.default)(e,c,!0,n):s&&(0,rr.default)(e,s,!0,n),d&&(r.fontWeight="bold"),u&&(r.fontStyle="italic"),t&&(r.textDecoration="underline"))},{}),v={},ir=(Object.defineProperty(v,"__esModule",{value:!0}),v.default=function(e,t,n){if(e){for(;!n&&e.firstChild;)e.removeChild(e.firstChild);for(;null!=t&&t.firstChild;)e.appendChild(t.firstChild)}},Object.defineProperty(or,"__esModule",{value:!0}),it),ar=a,lr=v,sr=(or.default=function(e,t){if(!e||!t)return null;var n=(0,ar.default)(e);if(n==t.toUpperCase())return e;for(var r=e.ownerDocument.createElement(t),o=0;o<e.attributes.length;o++){var i=e.attributes[o];r.setAttribute(i.name,i.value)}return(0,lr.default)(r,e),"P"!=n&&"P"!=(0,ar.default)(r)||(t=(0,ir.default)(e,["margin-top","margin-bottom"]),r.style.marginTop=t[0],r.style.marginBottom=t[1]),e.parentNode&&e.parentNode.replaceChild(r,e),r},{}),cr=(nr=sr,Object.defineProperty(nr,"__esModule",{value:!0}),nr.PendableFormatCommandMap=void 0,nr.PendableFormatCommandMap={isBold:"bold",isItalic:"italic",isUnderline:"underline",isStrikeThrough:"strikeThrough",isSubscript:"subscript",isSuperscript:"superscript"},nr.default=function(n){return Object.keys(nr.PendableFormatCommandMap).reduce(function(e,t){return e[t]=n.queryCommandState(nr.PendableFormatCommandMap[t]),e},{})},{}),dr=(Object.defineProperty(cr,"__esModule",{value:!0}),a),ur=["IMG"],fr=["TABLE","IMG","LI"].join(","),pr=/\u200b/g;function hr(e,t){return e=e.replace(pr,""),t?e.trim():e}cr.default=function(e,t){if(!e)return!1;if(3==e.nodeType)return""==hr(e.nodeValue||"",t);if(1==e.nodeType)if(""!=hr(e.textContent||"",t)||0<=ur.indexOf((0,dr.default)(e))||e.querySelectorAll(fr)[0])return!1;return!0};var gr={},mr=(Object.defineProperty(gr,"__esModule",{value:!0}),/^[^?]+%[^0-9a-f]+|^[^?]+%[0-9a-f][^0-9a-f]+|^[^?]+%00|^[^?]+%$|^https?:\/\/[^?\/]+@|^www\.[^?\/]+@/i),y="(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)*[a-z0-9](?:[a-z0-9-]*[a-z0-9])?(?:\\:[0-9]+)?(?:[\\/\\?]\\S*)?",vr={http:{match:new RegExp("^(?:microsoft-edge:)?http:\\/\\/"+y+"|www\\."+y,"i"),except:mr,normalizeUrl:function(e){return new RegExp("^(?:microsoft-edge:)?http:\\/\\/","i").test(e)?e:"http://"+e}},https:{match:new RegExp("^(?:microsoft-edge:)?https:\\/\\/"+y,"i"),except:mr},mailto:{match:new RegExp("^mailto:\\S+@\\S+\\.\\S+","i")},notes:{match:new RegExp("^notes:\\/\\/\\S+","i")},file:{match:new RegExp("^file:\\/\\/\\/?\\S+","i")},unc:{match:new RegExp("^\\\\\\\\\\S+","i")},ftp:{match:new RegExp("^ftp:\\/\\/"+y+"|ftp\\."+y,"i"),normalizeUrl:function(e){return new RegExp("^ftp:\\/\\/","i").test(e)?e:"ftp://"+e}},news:{match:new RegExp("^news:(\\/\\/)?"+y,"i")},telnet:{match:new RegExp("^telnet:(\\/\\/)?"+y,"i")},gopher:{match:new RegExp("^gopher:\\/\\/"+y,"i")},wais:{match:new RegExp("^wais:(\\/\\/)?"+y,"i")}},mr=(gr.default=function(e){if(e)for(var t=0,n=Object.keys(vr);t<n.length;t++){var r=n[t],o=vr[r],i=e.match(o.match);if(i&&i[0]==e&&(!o.except||!o.except.test(e)))return{scheme:r,originalUrl:e,normalizedUrl:o.normalizeUrl?o.normalizeUrl(e):e}}return null},{}),yr=(Object.defineProperty(mr,"__esModule",{value:!0}),Z);function br(t,e){return e.some(function(e){return 0==e?0==t:(t&e)==e})}mr.default=function(e,t,n,o,r){if(void 0===o&&(o=0),!e||!t)return[];var i,a,e=(0,yr.default)(e.querySelectorAll(t));return 0!=o&&r&&(a=r.startContainer,t=r.startOffset,i=r.endContainer,r=r.endOffset,1==a.nodeType&&a.firstChild&&(a=a.childNodes[t]||a.lastChild),i=1==i.nodeType&&i.firstChild&&0<r?i.childNodes[r-1]:i,e=e.filter(function(e){var t=a,n=i,r=2==o;return t=e.compareDocumentPosition(t),e=e.compareDocumentPosition(n),n=[0,8],r||n.push(16),br(t,n)||br(e,n)||br(t,[2])&&br(e,[4])&&!br(e,[16])})),n&&e.forEach(n),e};var y={},Er=(Object.defineProperty(y,"__esModule",{value:!0}),y.default=function(e){var t=e?e.parentNode:null;if(!t)return null;for(;e.firstChild;)t.insertBefore(e.firstChild,e);return t.removeChild(e),t},{}),Cr=(Object.defineProperty(Er,"__esModule",{value:!0}),Er.default=function(e){var e=e||{left:0,right:0,top:0,bottom:0},t=e.left,n=e.right,r=e.top,e=e.bottom;return 0<t+n+r+e?{left:Math.round(t),right:Math.round(n),top:Math.round(r),bottom:Math.round(e)}:null},{}),wr=(Object.defineProperty(Cr,"__esModule",{value:!0}),i),Sr=(Cr.default=function(e){return(0,wr.default)(e,"HTMLElement")?e.innerHTML:e?((t=e.ownerDocument.createElement("span")).appendChild(e.cloneNode(!0)),t.innerHTML):"";var t},{}),xr={},Tr=(Object.defineProperty(xr,"__esModule",{value:!0}),or),Or=er,b="transparent";function Pr(e){return e.td&&e.td.dataset.cellShade}function _r(e){return"solid 1px "+(e||"transparent")}xr.default=function(e,t,n){var r,o,i,a,l,s,c,d,u,f,p;function h(e){return e%2==0?a.bgColorEven:a.bgColorOdd}n&&(e.style.borderCollapse="collapse",p=n,(f=t).forEach(function(s,c){s.forEach(function(e,t){if(e.td){var n=p,r=e.td,o=0===c,i=c===f.length-1,a=0===t,l=t===s.length-1;switch(e=n,(t=r).style.borderTop=_r(e.topBorderColor),t.style.borderLeft=_r(e.verticalBorderColor),t.style.borderRight=_r(e.verticalBorderColor),t.style.borderBottom=_r(e.bottomBorderColor),n.tableBorderFormat){case 0:return;case 1:a||(r.style.borderLeftColor=b),l||(r.style.borderRightColor=b);break;case 4:o||(r.style.borderTopColor=b),i||o||(r.style.borderBottomColor=b),a||(r.style.borderLeftColor=b),l||a||(r.style.borderRightColor=b),a&&o&&(r.style.borderRightColor=b);break;case 2:o&&(r.style.borderTopColor=b,r.style.borderRightColor=b,r.style.borderLeftColor=b),a&&(r.style.borderLeftColor=b),l&&(r.style.borderRightColor=b);break;case 3:a&&(r.style.borderLeftColor=b),l&&(r.style.borderRightColor=b);break;case 5:o&&(r.style.borderRightColor=b,r.style.borderLeftColor=b),a&&(r.style.borderBottomColor=b,r.style.borderTopColor=b),o&&a&&(r.style.borderLeftColor=n.verticalBorderColor||b,r.style.borderBottomColor=n.bottomBorderColor||b,r.style.borderTopColor=n.topBorderColor||b);break;case 6:o&&(r.style.borderRightColor=b,r.style.borderLeftColor=b),a&&(r.style.borderBottomColor=b,r.style.borderTopColor=b),o&&a&&(r.style.borderLeftColor=n.verticalBorderColor||b,r.style.borderBottomColor=n.bottomBorderColor||b,r.style.borderTopColor=n.topBorderColor||b),o||a||(r.style.borderLeftColor=b,r.style.borderBottomColor=b,r.style.borderTopColor=b,r.style.borderRightColor=b);break;case 7:o&&(r.style.borderLeftColor=b,r.style.borderTopColor=b,r.style.borderRightColor=b),a&&(r.style.borderLeftColor=b,r.style.borderTopColor=b,r.style.borderBottomColor=b),o||a||(r.style.borderLeftColor=b,r.style.borderBottomColor=b,r.style.borderTopColor=b,r.style.borderRightColor=b),o&&a&&(r.style.borderBottomColor=n.bottomBorderColor||b)}}})}),e=t,l=(a=n).hasBandedRows,s=a.hasBandedColumns,c=a.bgColorOdd,d=a.bgColorEven,u=!l&&c===d,e.forEach(function(e,n){e.forEach(function(e){var t;e.td&&!Pr(e)&&(l?(t=h(n),(0,Or.default)(e.td,t||b,!0,void 0,!0)):u?(0,Or.default)(e.td,a.bgColorOdd||b,!0,void 0,!0):(0,Or.default)(e.td,b,!0,void 0,!0))})}),s&&e.forEach(function(e){e.forEach(function(e,t){t=h(t);e.td&&t&&!Pr(e)&&(0,Or.default)(e.td,t,!0,void 0,!0)})}),i=t,n.hasFirstColumn?i.forEach(function(e,n){e.forEach(function(e,t){e.td&&0===t&&(0===n||Pr(e)||(e.td.style.borderTopColor=b,(0,Or.default)(e.td,b,!0,void 0,!0)),n!==i.length-1&&0!==n&&(e.td.style.borderBottomColor=b),e.td=(0,Tr.default)(e.td,"TH"),e.td.scope="col")})}):i.forEach(function(e){e.forEach(function(e,t){e.td&&0===t&&(e.td=(0,Tr.default)(e.td,"TD"),e.td.scope="")})}),c=t,(r=n).hasHeaderRow?null!=(o=c[0])&&o.forEach(function(e){e.td&&r.headerRowColor&&(Pr(e)||(0,Or.default)(e.td,r.headerRowColor,!0,void 0,!0),e.td.style.borderRightColor=r.headerRowColor,e.td.style.borderLeftColor=r.headerRowColor,e.td.style.borderTopColor=r.headerRowColor,e.td=(0,Tr.default)(e.td,"TH"),e.td.scope="row")}):null!=(o=c[0])&&o.forEach(function(e){e.td&&(e.td=(0,Tr.default)(e.td,"TD"),e.td.scope="")}))};var E={},kr=(Object.defineProperty(E,"__esModule",{value:!0}),E.saveTableInfo=E.getTableFormatInfo=void 0,E.getTableFormatInfo=function(e){e=function(e){if(!e)return null;try{return JSON.parse(e)}catch(e){return null}}(null==e?void 0:e.dataset.roosterTableInfo);return function(e){var t,n,r,o,i,a,l,s,c;if(e)return t=e.topBorderColor,n=e.verticalBorderColor,r=e.bottomBorderColor,o=e.bgColorOdd,i=e.bgColorEven,c=e.hasBandedColumns,a=e.hasBandedRows,l=e.hasFirstColumn,s=e.hasHeaderRow,e=e.tableBorderFormat,c=[c,a,l,s],![t,n,r,o,i].some(function(e){return!(null==e||"string"==typeof e)})&&!c.some(function(e){return!("boolean"==typeof e)})&&-1<e&&e<8?1:void 0}(e)?e:null},E.saveTableInfo=function(e,t){e&&t&&(e.dataset.roosterTableInfo=JSON.stringify(t))},e&&e.__assign||function(){return(kr=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)}),Lr=(Object.defineProperty(Sr,"__esModule",{value:!0}),xr),Nr=v,Rr=Er,Ir=i,Ar=Z,Mr=E,Dr={topBorderColor:"#ABABAB",bottomBorderColor:"#ABABAB",verticalBorderColor:"#ABABAB",hasHeaderRow:!1,hasFirstColumn:!1,hasBandedRows:!1,hasBandedColumns:!1,bgColorEven:null,bgColorOdd:"#ABABAB20",headerRowColor:"#ABABAB",tableBorderFormat:0,keepCellShade:!1};function C(t,e,n){var d,r,u=this;this.cells=null,this.selection=null,this.formatInfo=null,this.trs=[],this.table=(0,Ir.default)(t,"HTMLTableElement")?t:function(){for(var e=t;e&&"TABLE"!=e.tagName;e=e.parentElement);return e}(),this.table&&(d=(0,Ir.default)(t,"HTMLTableElement")?null:t,r=(0,Ar.default)(this.table.rows),this.cells=r.map(function(e){return[]}),r.forEach(function(e,t){var n;u.trs[t%2]=e;for(var r=0,o=0;r<e.cells.length;r++){for(;u.cells[t][o];o++);var i=e.cells[r];i==d&&(u.col=o,u.row=t);for(var a=0;a<i.colSpan;a++,o++)for(var l=0;l<i.rowSpan;l++){var s=a+l==0,c=i.getBoundingClientRect();null!=(n=u.cells)&&n[t+l]&&(u.cells[t+l][o]={td:s?i:null,spanLeft:0<a,spanAbove:0<l,width:s?c.width:void 0,height:s?c.height:void 0})}}}),this.formatInfo=(0,Mr.getTableFormatInfo)(this.table),e&&this.normalizeSize("number"==typeof n?function(e){return e/n}:n))}function jr(e,t,n){e&&(e.removeAttribute("width"),e.removeAttribute("height"),e.style.boxSizing="border-box",e.style.width=t+"px",e.style.height=n+"px")}function Br(e){return{td:Fr(e.td),spanAbove:e.spanAbove,spanLeft:e.spanLeft}}function Fr(e){var t=e?e.cloneNode(!1):null;return(0,Ir.default)(t,"HTMLTableCellElement")&&(t.removeAttribute("id"),t.firstChild||t.appendChild(e.ownerDocument.createElement("br"))),t}C.prototype.writeBack=function(e){var o=this;this.cells?((0,Nr.default)(this.table),this.cells.forEach(function(e,n){var r=Fr(o.trs[n%2]||o.trs[0]);r&&(o.table.appendChild(r),e.forEach(function(e,t){e.td&&(o.recalculateSpans(n,t),r.appendChild(e.td))}))}),this.formatInfo&&!e&&((0,Mr.saveTableInfo)(this.table,this.formatInfo),(0,Lr.default)(this.table,this.cells,this.formatInfo))):this.table&&null!=(e=this.table.parentNode)&&e.removeChild(this.table)},C.prototype.applyFormat=function(e){this.table&&(this.formatInfo=kr(kr(kr({},Dr),this.formatInfo||{}),e||{}),this.formatInfo.keepCellShade||this.deleteCellShadeDataset(this.cells))},C.prototype.deleteCellShadeDataset=function(e){null!=e&&e.forEach(function(e){e.forEach(function(e){e.td&&e.td.dataset.cellShade&&delete e.td.dataset.cellShade})})},C.prototype.edit=function(e){var a=this;if(this.table&&this.cells&&void 0!==this.row&&null!=this.col){var n=this.cells[this.row],t=n[this.col],r=this.selection?this.selection.firstCell.y:this.row,o=this.selection?this.selection.lastCell.y:this.row,i=this.selection?this.selection.firstCell.x:this.col,l=this.selection?this.selection.lastCell.x:this.col;switch(e){case 0:for(var s=r;s<=o;s++)this.cells.splice(r,0,n.map(Br));break;case 1:for(var c=this,s=r;s<=o;s++)!function(){var r=o+c.countSpanAbove(o,c.col);c.cells.splice(r,0,c.cells[r-1].map(function(e,t){var n=a.getCell(r,t);return n.spanAbove?Br(n):e.spanLeft?((n=Br(e)).spanAbove=!1,n):{td:Fr(a.getTd(a.row,t))}}))}();break;case 2:var d=this;for(s=i;s<=l;s++)!function(n){d.forEachCellOfCurrentColumn(function(e,t){t.splice(n,0,Br(e))})}(s);break;case 3:var u=this;for(s=i;s<=l;s++)!function(){var i=l+u.countSpanLeft(u.row,l);u.forEachCellOfColumn(i-1,function(e,t,n){var r,o=a.getCell(n,i);o.spanLeft?r=Br(o):e.spanAbove?(r=Br(e)).spanLeft=!1:r={td:Fr(a.getTd(n,a.col))},t.splice(i,0,r)})}();break;case 6:for(var f=this,p=r;p<=o;p++)!function(n){f.forEachCellOfRow(n,function(e,t){t=a.getCell(n+1,t);e.td&&1<e.td.rowSpan&&t.spanAbove&&(t.td=e.td)})}(p);var h=this.selection?this.selection.lastCell.y-this.selection.firstCell.y:0;this.cells.splice(r,1+h);break;case 5:for(var g=0,m=this,v=i;v<=l;v++)!function(r){m.forEachCellOfColumn(r,function(e,t,n){n=a.getCell(n,r+1),e.td&&1<e.td.colSpan&&n.spanLeft&&(n.td=e.td),n=a.selection?r-g:a.col;t.splice(n,1)}),g++}(v);break;case 7:case 8:for(var y=7==e?-1:1,p=this.row+y;0<=p&&p<this.cells.length;p+=y)if((x=this.getCell(p,this.col)).td&&!x.spanAbove){var b=p<this.row?x:t,E=p<this.row?t:x;this.mergeCells(b,E);break}break;case 9:case 10:for(var C=9==e?-1:1,v=this.col+C;0<=v&&v<this.cells[this.row].length;v+=C)if((x=this.getCell(this.row,v)).td&&!x.spanLeft){var w=v<this.col?x:t,S=v<this.col?t:x;this.mergeCells(w,S,!0);break}break;case 11:for(v=i;v<=l;v++)for(p=r+1;p<=o;p++){var x=this.getCell(r,v),T=this.getCell(p,v);this.mergeCells(x,T)}for(v=i+1;v<=l;v++){var x=this.getCell(r,i),O=this.getCell(r,v);this.mergeCells(x,O,!0)}break;case 4:this.cells=null;break;case 13:t.td&&1<t.td.rowSpan?this.getCell(this.row+1,this.col).td=Fr(t.td):(h=n.map(function(e){return{td:e==t?Fr(e.td):null,spanAbove:e!=t,spanLeft:e.spanLeft}}),this.cells.splice(this.row+1,0,h));break;case 12:t.td&&1<t.td.colSpan?this.getCell(this.row,this.col+1).td=Fr(t.td):this.forEachCellOfCurrentColumn(function(e,t){t.splice(a.col+1,0,{td:t==n?Fr(e.td):null,spanAbove:e.spanAbove,spanLeft:t!=n})});break;case 14:this.table.style.marginLeft="auto",this.table.style.marginRight="auto";break;case 15:this.table.style.marginLeft="",this.table.style.marginRight="auto";break;case 16:this.table.style.marginLeft="auto",this.table.style.marginRight="";break;case 18:this.setAlignmentToSelectedCells(r,o,i,l,"center");break;case 17:this.setAlignmentToSelectedCells(r,o,i,l,"left");break;case 19:this.setAlignmentToSelectedCells(r,o,i,l,"right");break;case 20:this.setAlignmentToSelectedCells(r,o,i,l,"top",!0);break;case 21:this.setAlignmentToSelectedCells(r,o,i,l,"middle",!0);break;case 22:this.setAlignmentToSelectedCells(r,o,i,l,"bottom",!0)}}},C.prototype.setAlignmentToSelectedCells=function(e,t,n,r,o,i){for(var a,l,s=e;s<=t;s++)for(var c=n;c<=r;c++)this.cells&&(l=this.cells[s][c].td,i&&l?null!=(a=l.style)&&a.setProperty("vertical-align",o):l&&null!=(a=l.style)&&a.setProperty("text-align",o))},C.prototype.mergeCells=function(e,t,n){var r=n?(null==(r=e.td)?void 0:r.rowSpan)===(null==(r=t.td)?void 0:r.rowSpan)&&!e.spanLeft:(null==(r=e.td)?void 0:r.colSpan)===(null==(r=t.td)?void 0:r.colSpan)&&!e.spanAbove;e.td&&t.td&&r&&((0,Nr.default)(e.td,t.td,!0),t.td=null,n?t.spanLeft=!0:t.spanAbove=!0)},C.prototype.forEachCellOfCurrentColumn=function(e){this.forEachCellOfColumn(this.col,e)},C.prototype.getCellsWithBorder=function(e,t){for(var n=[],r=0;this.cells&&r<this.cells.length;r++)for(var o=0;o<this.cells[r].length;o++){var i=this.getCell(r,o);if(i.td){var a=(0,Rr.default)(i.td.getBoundingClientRect());if(a){var l=!1;if(t){if(a.right==e)l=!0,n.push(i.td);else if(l)break}else if(a.left==e)l=!0,n.push(i.td);else if(l)break}}}return n},C.prototype.forEachCellOfCurrentRow=function(e){this.forEachCellOfRow(this.row,e)},C.prototype.getCell=function(e,t){return this.cells&&this.cells[e]&&this.cells[e][t]||{}},C.prototype.getCurrentTd=function(){return this.getTd(this.row,this.col)},C.prototype.getTd=function(e,t){if(this.cells&&void 0!==e&&void 0!==t&&(e=Math.min(this.cells.length-1,e),t=this.cells[e]?Math.min(this.cells[e].length-1,t):t,!isNaN(e)&&!isNaN(t)))for(;0<=e&&0<=t;){var n=this.getCell(e,t);if(n.td)return n.td;if(n.spanLeft)t--;else{if(!n.spanAbove)break;e--}}return null},C.prototype.forEachCellOfColumn=function(e,t){if(void 0!==e)for(var n=0;this.cells&&n<this.cells.length;n++)t(this.getCell(n,e),this.cells[n],n)},C.prototype.forEachCellOfRow=function(e,t){if(void 0!==e)for(var n=0;this.cells&&n<this.cells[e].length;n++)t(this.getCell(e,n),n)},C.prototype.recalculateSpans=function(e,t){var n=this.getCell(e,t).td;n&&(n.colSpan=this.countSpanLeft(e,t),n.rowSpan=this.countSpanAbove(e,t),1==n.colSpan&&n.removeAttribute("colSpan"),1==n.rowSpan&&n.removeAttribute("rowSpan"))},C.prototype.countSpanLeft=function(e,t){for(var n=1,r=t+1;this.cells&&r<this.cells[e].length;r++){var o=this.getCell(e,r);if(o.td||!o.spanLeft)break;n++}return n},C.prototype.countSpanAbove=function(e,t){for(var n=1,r=e+1;this.cells&&r<this.cells.length;r++){var o=this.getCell(r,t);if(o.td||!o.spanAbove)break;n++}return n},C.prototype.normalizeEmptyTableCells=function(){for(var e,t=0;e=this.table.rows[t];t++)for(var n=0,r=void 0;r=e.cells[n];n++)!r||r.innerHTML&&r.innerHTML.trim()||r.appendChild(document.createElement("br"))},C.prototype.normalizeTableCellSize=function(t){for(var e=0,n=void 0;n=this.table.rows[e];e++)n.removeAttribute("width"),n.style.setProperty("width",null),n.removeAttribute("height"),n.style.setProperty("height",null);for(e=0;this.cells&&e<this.cells.length;e++)for(var r=0;r<this.cells[e].length;r++){var o,i,a=this.cells[e][r];a&&(o=a.width||0,i=a.height||0,jr(a.td,(null==(a="number"==typeof t?function(e){return e/t}:t)?void 0:a(o))||o,(null==a?void 0:a(i))||i))}},C.prototype.normalizeSize=function(e){this.normalizeEmptyTableCells(),this.normalizeTableCellSize(e);var t=this.table.getBoundingClientRect();jr(this.table,(null==e?void 0:e(t.width))||t.width,(null==e?void 0:e(t.height))||t.height)},Sr.default=C;var xr={},E=(Object.defineProperty(xr,"__esModule",{value:!0}),xr.default=function(e,t){if(!t||!e.cells)return!1;var n=t.firstCell,t=t.lastCell,r=e.cells.length-1,e=e.cells[r].length-1,o=n.x,n=n.y,i=t.x,t=t.y;return 0==o&&0==n&&i==e&&t==r},{}),w={},Hr=(Object.defineProperty(w,"__esModule",{value:!0}),w.isListElement=void 0,a);function zr(e){switch((0,Hr.default)(e)){case"OL":return 1;case"UL":return 2;default:return 0}}w.default=zr,w.isListElement=function(e){return 0!=zr(e)};var Ur={},Vr={},S={},Wr=(Object.defineProperty(S,"__esModule",{value:!0}),S.default=function(e){var r={};return((null==e?void 0:e.getAttribute("style"))||"").split(";").forEach(function(e){var t=e.indexOf(":"),n=e.slice(0,t),e=e.slice(t+1);n&&e&&(r[n.trim()]=e.trim())}),r},{}),qr=(Object.defineProperty(Wr,"__esModule",{value:!0}),Wr.default=function(e,n){var t;e&&((t=Object.keys(n||{}).map(function(e){var t=n[e],e=e?e.trim():null,t=t?t.trim():null;return e&&t?e+":"+t:null}).filter(function(e){return e}).join(";"))?e.setAttribute("style",t):e.removeAttribute("style"))},Object.defineProperty(Vr,"__esModule",{value:!0}),s),Kr=d,Zr=S,Gr=i,$r=Wr,Xr=(Vr.default=function(o,e){var n=function(){for(var e=[],t=qr.default.createBodyTraverser(o),n=null;t.currentInlineElement!=n;){var r=(r=(null==(n=t.currentInlineElement)?void 0:n.getContainerNode())||null)?(0,Kr.default)(r):null;(0,Gr.default)(r,"HTMLElement")&&(r=(0,Zr.default)(r))&&e.push(r),t.getNextInlineElement()}return e}(),r=(0,Zr.default)(o);e.forEach(function(t){var e=n.map(function(e){return void 0!==e[t]?e[t]:""});e&&(1==e.length||1==new Set(e).size)&&e[0]&&(r[t]=e[0])}),(0,$r.default)(o,r)},e&&e.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||((r=r||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}),Yr=(Object.defineProperty(Ur,"__esModule",{value:!0}),o),Qr=w,Jr=a,eo=Q,to=v,no=i,ro=Vr,oo=Z,io=y,ao=Oe,lo=[null,"lower-alpha","lower-roman"];function so(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(this.newListStart=void 0,!e)throw new Error("node must not be null");this.node=(0,no.default)(e,"HTMLLIElement")?e:(0,ao.default)(e,4);e=this.node.style.display;this.dummy="list-item"!=e&&""!=e,this.listTypes=Xr([0],t,!0)}function co(e,t,n){return e=!(0<e.length)||t&&(0,eo.default)(e[0])||n&&(0,eo.default)(e[e.length])?e:[(0,ao.default)(e)]}so.prototype.getListType=function(){return this.listTypes[this.listTypes.length-1]},so.prototype.getLevel=function(){return this.listTypes.length-1},so.prototype.getNode=function(){return this.node},so.prototype.getNewListStart=function(){return this.newListStart},so.prototype.contains=function(e){return(0,Yr.default)(this.node,e,!0)},so.prototype.isDummy=function(){return this.dummy},so.prototype.isOrphanItem=function(){return!1},so.prototype.canMerge=function(n){return!(null==n||!n.isOrphanItem()||this.listTypes.length!=n.listTypes.length)&&this.listTypes.every(function(e,t){return n.listTypes[t]==e})},so.prototype.mergeItems=function(e){var t=this;co((null==e?void 0:e.map(function(e){return e.node}))||[],!0,!1).forEach(function(e){return t.node.appendChild(e)})},so.prototype.indent=function(){if("-.25in"==this.node.style.marginLeft)return this.node.style.margin="",void(this.node.style.marginLeft="");var e=this.getListType();0!=e&&this.listTypes.push(e)},so.prototype.outdent=function(e){this.listTypes.length>((e=void 0===e?!1:e)?2:1)&&this.listTypes.pop()},so.prototype.addNegativeMargins=function(){this.node.style.margin="0in 0in 0in 0.5in",this.node.style.marginLeft="-.25in"},so.prototype.changeListType=function(e){0==e?this.listTypes=[e]:(this.outdent(),this.listTypes.push(e))},so.prototype.setIsDummy=function(e){this.dummy=e},so.prototype.setNewListStart=function(e){this.newListStart=e},so.prototype.writeBack=function(e,t){for(var n,r,o,i,a,l,s=1;s<e.length;s++)if((0,Qr.default)(e[s])!==this.listTypes[s]){e.splice(s);break}for(;s<this.listTypes.length;s++){var c,d=e.length-1,u=(u=e[0],o=this.listTypes[s],i=s,a=t,c=l=void 0,c=u.ownerDocument,1==i&&a&&o==(0,Qr.default)(a)?(0,Yr.default)(u,a)?(l=a.cloneNode(!1)).removeAttribute("id"):((0,to.default)(a),l=a):l=c.createElement(1==o?"ol":"ul"),1==o&&1<i&&l.style.setProperty("list-style-type",lo[(i-1)%lo.length]),l);e[d].appendChild(u),e.push(u),this.getDeepChildIndex(t)==d&&(c=null==(a=this.node.parentElement)?void 0:a.style.listStyleType)&&(u.style.listStyleType=c)}e[e.length-1].appendChild(this.node),this.node.style.setProperty("display",this.dummy?"block":null),1<this.listTypes.length&&!(this.node.style.fontSize||this.node.style.color||this.node.style.fontFamily)&&(0,ro.default)(this.node,["font-size","font-family","color"]),this.listTypes.length<=1&&co("LI"==(0,Jr.default)(this.node)?(n=this.node,r=(0,oo.default)(n.childNodes),(0,io.default)(n),r):[this.node],!0,!0)},so.prototype.getDeepChildIndex=function(e){var t=this.node.parentElement;if(e&&t){for(var n=0;t&&t!=e;)n++,t=(null==t?void 0:t.parentElement)||null;return n}return-1},Ur.default=so;var uo=e&&e.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||((r=r||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},fo=(Object.defineProperty(E,"__esModule",{value:!0}),or),po=w,ho=a,go=Q,mo=cr,vo=c,yo=mr,bo=i,Eo=V,Co=Z,wo=y,So=Ur,xo=Oe;function To(e){if(this.rootList=e,this.items=[],!e)throw new Error("rootList must not be null");Oo(this.rootList),(0,yo.default)(this.rootList,"ol,ul",Oo),(0,yo.default)(this.rootList,"li",Po),this.populateItems(this.rootList)}function Oo(e){var t=null;(0,Co.default)(e.childNodes).forEach(function(e){"LI"==(0,ho.default)(e)?t=e:(0,po.isListElement)(e)?t=null:t&&!(0,mo.default)(e,!0)&&t.appendChild((0,go.default)(e)?e:(0,xo.default)(e))})}function Po(t){for(;!(0,po.isListElement)(t.parentNode);){(0,Eo.default)(t,!0);var e=(0,Co.default)(t.parentNode.childNodes).slice(1);0<e.length&&(e=(0,go.default)(e[0])?e:[(0,xo.default)(e)]).forEach(function(e){return t.appendChild(e)}),(0,wo.default)(t.parentNode)}}To.prototype.contains=function(t){return this.items.some(function(e){return e.contains(t)})},To.prototype.getLastItemNumber=function(){var e=this.getStart();return void 0===e?e:e-1+this.items.filter(function(e){return 1==e.getListType()&&1==e.getLevel()&&!e.isDummy()}).length},To.prototype.writeBack=function(){var n=this;if(!this.rootList)throw new Error("rootList must not be null");var r,e=this.rootList.ownerDocument,o=[e.createDocumentFragment()],e=e.createTextNode(""),i=this.getStart()||1;this.rootList.parentNode.replaceChild(e,this.rootList),this.items.forEach(function(e){var t=e.getNewListStart(),t=(t&&t!=i&&(o.splice(1,o.length-1),i=t),e.writeBack(o,n.rootList),o[1]);(0,bo.default)(t,"HTMLOListElement")&&(r!=t&&(1==i?t.removeAttribute("start"):t.start=i),1==e.getLevel()&&i++),r=t}),e.parentNode.replaceChild(o[0],e)},To.prototype.split=function(e,t){if(!this.rootList)throw new Error("rootList must not be null");for(var n=0;n<this.items.length;n++)if(this.items[n].getNode()==e)return void this.items[n].setNewListStart(t)},To.prototype.setIndentation=function(e,t,n,r,o){var i=this,a=(void 0===o&&(o=!1),!1);if(this.findListItems(e,t,function(e){a=a||0==i.items.indexOf(e),1==n?r&&!e.isDummy()?e.setIsDummy(!0):e.outdent(o):e.indent()}),a&&o)for(var l=0;l<this.items.length;l++)this.items[l].addNegativeMargins()},To.prototype.setAlignment=function(e,t,n){this.rootList.style.display="flex",this.rootList.style.flexDirection="column",this.findListItems(e,t,function(e){var t="start";1==n?t="center":2==n&&(t="end"),e.getNode().style.alignSelf=t})},To.prototype.changeListType=function(e,t,n){var r=!1;this.findListItems(e,t,function(e){r=r||e.getListType()!=n}),this.findListItems(e,t,function(e){return r?e.changeListType(n):e.outdent()})},To.prototype.appendItem=function(e,t){var n=(0,ho.default)(e);"DIV"==n?e=(0,fo.default)(e,"LI"):"LI"!=n&&(e=(0,xo.default)(e,"LI")),this.items.push(0==t?new So.default(e):new So.default(e,t))},To.prototype.mergeVList=function(e){var t,n=this;e&&e!=this&&(e.items.forEach(function(e){return n.items.push(e)}),e.items.splice(0,e.items.length),null!=(t=e.rootList.parentNode)&&t.removeChild(e.rootList))},To.prototype.getListItemIndex=function(e){if(this.items)for(var t=(this.getStart()||1)-1,n=0;n<this.items.length;n++){var r=this.items[n];if(1!=r.getLevel()||r.isDummy()||t++,r.getNode()==e)return t}return-1},To.prototype.getStart=function(){return(0,bo.default)(this.rootList,"HTMLOListElement")?this.rootList.start:void 0},To.prototype.findListItems=function(n,r,e){if(0==this.items.length)return[];var t=new vo.default(this.items[0].getNode(),0),o=new vo.default(this.items[this.items.length-1].getNode(),-1),i=t.isAfter(n)?0:-1,a=this.items.length-(r.isAfter(o)?1:0),t=(this.items.forEach(function(e,t){i=e.contains(n.node)?t:i,a=e.contains(r.node)?t:a}),i=a<this.items.length?Math.max(0,i):i,a=0<=i?Math.min(this.items.length-1,a):a,i<=a?this.items.slice(i,a+1):[]);return e&&t.forEach(e),t},To.prototype.populateItems=function(e,n){var r=this,o=(void 0===n&&(n=[]),(0,po.default)(e));(0,Co.default)(e.childNodes).forEach(function(e){var t=uo(uo([],n,!0),[o],!1);(0,po.isListElement)(e)?r.populateItems(e,t):3==e.nodeType&&""==(e.nodeValue||"").trim()||r.items.push(new(So.default.bind.apply(So.default,uo([void 0,e],t,!1))))})},E.default=To;var x={},_o={},ko=(Object.defineProperty(_o,"__esModule",{value:!0}),d),Lo=(_o.default=function(e,t,n){var r=e&&(0,ko.default)(n,e.rootNode,t);if(r)for(var o;o=(0,ko.default)(r.parentNode,e.rootNode,t);)r=o;return r},{}),No={},Ro=(Object.defineProperty(No,"__esModule",{value:!0}),ie),Io=c,Ao=p,Mo=(No.default=function(e){if(!e)return null;var t=e.nodeBefore,n=e.nodeAfter,r=e.rootNode,o=e.skipTags,t=t?(0,Ao.getNextLeafSibling)(e.rootNode,t,e.skipTags):r.firstChild,n=n?(0,Ao.getPreviousLeafSibling)(r,n,o):r.lastChild,o=t&&n&&(0,Ro.default)(t,n);if(!e.fullSelectionEnd||!e.fullSelectionStart)return o;if(o){r=Io.default.getStart(o).normalize(),t=Io.default.getEnd(o).normalize(),n=e.fullSelectionEnd,o=e.fullSelectionStart;if(!o.isAfter(t)&&!r.isAfter(n))return e=o.isAfter(r)?o:r,o=n.isAfter(t)?t:n,(0,Ro.default)(e,o)}return null},Object.defineProperty(Lo,"__esModule",{value:!0}),s),Do=Pe,jo=n,Bo=No,Fo=h,Ho=(Lo.default=function(e,t){var n=(0,Bo.default)(e),r=[];if(n){for(var o=e.rootNode,i=e.skipTags,a=Mo.default.createSelectionTraverser(o,n,i),l=null==a?void 0:a.currentBlockElement;l;l=a.getNextBlockElement())r.push(l);r=r.filter(function(e){var t=e.getStartNode();return t!=e.getEndNode()||!(0,Fo.default)(t,!0)||(null!=(e=t.parentNode)&&e.removeChild(t),!1)})}return 0==r.length&&e&&!e.rootNode.firstChild&&t&&(o=(0,Do.default)(1,e.rootNode.ownerDocument),e.rootNode.appendChild(o),(l=(0,jo.default)(e.rootNode,o))&&r.push(l)),r},{}),zo=(Object.defineProperty(Ho,"__esModule",{value:!0}),o),Uo=(Ho.default=function(e,t){return!(!e||!(0,zo.default)(e.rootNode,t)||e.nodeBefore&&4!=e.nodeBefore.compareDocumentPosition(t)||e.nodeAfter&&2!=e.nodeAfter.compareDocumentPosition(t))},Object.defineProperty(x,"__esModule",{value:!0}),Pe),Vo=_o,Wo=Lo,qo=Ho,Ko=c,Zo=i,Go=h,$o=Z,Xo=E,Yo=Oe,Qo=p,Jo=w,ei="ol,ul";function ti(e,t,n){var r=t[n?t.length-1:0],r=(0,Qo.getLeafSibling)(e.rootNode,r,n,e.skipTags,!0);r=(0,Vo.default)(e,ei,r),(0,qo.default)(e,r)&&(0,Jo.isListElement)(r)&&(n?(0,Zo.default)(r,"HTMLOListElement")&&1!=r.start||t.push(r):t.unshift(r))}x.default=function(n,r,e){if(!n)return null;var t,o,i=[],a=(e?(e=(0,Vo.default)(n,ei,e))&&i.push(e):((0,Wo.default)(n).forEach(function(e){var t=(0,Vo.default)(n,ei,e.getStartNode());t?(i[i.length-1]!=t&&i.push(t),1==i.length&&(0,Zo.default)(t,"HTMLOListElement")&&1<t.start&&(r=!1)):i.push(e.collapseToSingleElement())}),0!=i.length||n.rootNode.firstChild||(e=(0,Uo.default)(1,n.rootNode.ownerDocument),n.rootNode.appendChild(e),i.push(e),n.fullSelectionStart=new Ko.default(e,0),n.fullSelectionEnd=new Ko.default(e,-1)),r&&(ti(n,i,!1),ti(n,i,!0)),i=i.filter(function(e){return!(0,Go.default)(e,!0)})),null);return 0<i.length&&(e=i.shift()||null,(a=(0,Jo.isListElement)(e)?new Xo.default(e):e?(e=e,t=1==(t=(0,$o.default)(e.childNodes)).length?t[0]:(0,Yo.default)(t,"SPAN"),o=e.ownerDocument.createElement("ol"),e.appendChild(o),(e=new Xo.default(o)).appendItem(t,0),e):null)&&i.forEach(function(e){(0,Jo.isListElement)(e)?a.mergeVList(new Xo.default(e)):a.appendItem(e,0)})),a};var h={},ni=(Object.defineProperty(h,"__esModule",{value:!0}),l),ri=_o,oi=W,ii=Ho,ai=mr,li=E,si=0;function ci(e,t){this.region=e,this.name=t,this.lastNumber=0,this.lastNumberBeforeCursor=0}ci.createListChains=function(e,l,s){var e=Array.isArray(e)?e:e?[e]:[],t=[];return e.forEach(function(o){var i,a=[];(0,ai.default)(o.rootNode,"ol",function(e){var t,n,r=(0,ri.default)(o,"ol",e);i!=r&&(e=a.filter(function(e){return e.canAppendToTail(r)})[0]||new ci(o,(s||function(){return"__List_Chain_"+si++})()),t=a.indexOf(e),(n=!!l&&(0,oi.default)(r,l))?t<0&&a.push(e):(0<=t&&a.splice(t,1),a.unshift(e)),e.append(r,n),i=r)}),(0,ni.default)(t,a)}),t},ci.prototype.canAppendAtCursor=function(e){return 1<e&&this.lastNumberBeforeCursor+1==e},ci.prototype.createVListAtBlock=function(e,t){var n;return e&&e.parentNode?((n=e.ownerDocument.createElement("ol")).start=t,this.applyChainName(n),e.parentNode.insertBefore(n,e),(t=new li.default(n)).appendItem(e,0),t):null},ci.prototype.commit=function(){for(var e=this.getLists(),t=0,n=0;n<e.length;n++){var r=e[n],o=(r.start=t+1,new li.default(r)),t=o.getLastItemNumber()||0;delete r.dataset.listchain,delete r.dataset.listchainafter,o.writeBack()}},ci.prototype.canAppendToTail=function(e){return this.lastNumber+1==e.start},ci.prototype.append=function(e,t){this.applyChainName(e),this.lastNumber=new li.default(e).getLastItemNumber()||0,t?e.dataset.listchainafter="true":this.lastNumberBeforeCursor=this.lastNumber},ci.prototype.applyChainName=function(e){e.dataset.listchain=this.name},ci.prototype.getLists=function(){var t=this;return(0,ai.default)(this.region.rootNode,"ol[data-listchain="+this.name+"]").filter(function(e){return(0,ii.default)(t.region,e)})},h.default=ci;var w={},di=(Object.defineProperty(w,"__esModule",{value:!0}),w.getRegionCreator=void 0,o),ui=d,fi=c,pi=mr,hi=p,gi=((_o={})[0]={skipTags:["TABLE"],outerSelector:"table",innerSelector:"td,th"},_o);function mi(e,r){var o=fi.default.getStart(e).normalize(),i=fi.default.getEnd(e).normalize();return function(e,t,n){return function(e,t,n,r){var o,i;if(e)return o=t&&(0,hi.getNextLeafSibling)(e,t,r),r=n&&(0,hi.getPreviousLeafSibling)(e,n,r),i=!t||(0,di.default)(e,t)&&(0,di.default)(e,o),e=!n||(0,di.default)(e,n)&&(0,di.default)(e,r),r=!(t&&n&&((0,di.default)(t,n,!0)||(0,di.default)(t,r,!0)||(0,di.default)(n,t,!0)||(0,di.default)(n,o,!0))),i&&e&&r}(e,t,n,r)?{rootNode:e,nodeBefore:t,nodeAfter:n,skipTags:r,fullSelectionStart:o,fullSelectionEnd:i}:null}}w.default=function(e,t,n){var r,o,a,i,l,s,c,d=[];return e&&t&&(o=(r=gi[n]).innerSelector,r=r.skipTags,i=t,l=[{innerNode:a=e,children:[]}],n=gi[n],s=n.outerSelector,n=n.innerSelector,c=(0,pi.default)(a,s,null,2,i),(0,pi.default)(a,n,function(e){var t=(0,ui.default)(e,a,s);if(t&&c.indexOf(t)<0){for(var n={innerNode:e,children:[]},r=l.length-1;0<=r;r--){var o=l[r],i=o.innerNode,o=o.children;if((0,di.default)(i,t)){i=o.filter(function(e){return e.outerNode==t})[0];i||o.push(i={outerNode:t,boundaries:[]}),i.boundaries.push(n);break}}l.push(n)}},1,i),n=l[0],i=(0,ui.default)(t.startContainer,e,o)||e,o=(0,ui.default)(t.endContainer,e,o)||e,d=function n(r,e,o,i,a){a=a||e.innerNode==o;var l=!1,t=e.children,s=e.innerNode,c=[];if(0==t.length)(u=r(s))&&c.push(u);else for(var d=0;d<=t.length&&!l;d++){var u,f=(p=t[d]||{}).outerNode,p=p.boundaries,h=null==(h=t[d-1])?void 0:h.outerNode;a&&(u=r(s,h,f))&&c.push(u),null!=p&&p.forEach(function(e){var t=(e=n(r,e,o,i,a))[0];a=e[1],l=e[2],c=c.concat(t)})}return[c,a,l||s==i]}(mi(t,r),n,i,o)[0]),d.filter(function(e){return!!e})},w.getRegionCreator=mi;var W={},vi=(Object.defineProperty(W,"__esModule",{value:!0}),r),yi=Ho,bi=i,_o=(W.default=function(t,e){if(!e||0==e.length)return[];var e=(0,bi.default)(e[0],"Node")?e:[e[0].getStartNode(),e[e.length-1].getEndNode()],n=(e=e&&e.filter(function(e){return(0,yi.default)(t,e)}))[0],e=e[e.length-1];return(0,yi.default)(t,n)&&(0,yi.default)(t,e)?(0,vi.default)(t.rootNode,n,e,!0):[]},{}),T={},Ei=(Object.defineProperty(T,"__esModule",{value:!0}),a),Ci={B:{"font-weight":"bold"},EM:{"font-style":"italic"},I:{"font-style":"italic"},U:{"text-decoration":"underline"},P:{"margin-top":"1em","margin-bottom":"1em"},PRE:{"white-space":"pre"},S:{"text-decoration":"line-through"},STRIKE:{"text-decoration":"line-through"},SUB:{"vertical-align":"sub","font-size":"smaller"},SUP:{"vertical-align":"super","font-size":"smaller"}},wi=(T.default=function(e,t){e=(0,Ei.default)(e);return Ci[e]||(t||{})[e]},e&&e.__assign||function(){return(wi=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)}),Si=(Object.defineProperty(_o,"__esModule",{value:!0}),or),xi=o,Ti=n,Oi=T,Pi=S,_i=Ho,ki=i,Li=Wr,Ni=r,Ri=(_o.default=function(e,t,n){var r;if((0,_i.default)(e,t)&&(0,_i.default)(e,n)&&(n=(0,Ti.default)(e.rootNode,n))&&!n.contains(t)){for(var o=n.collapseToSingleElement(),i=(0,Ni.collapse)(e.rootNode,o,t,!1,!0),a=o;(0,xi.default)(i,a);){var l,s=a.parentNode;(0,ki.default)(s,"HTMLElement")&&(l=wi(wi(wi({},(0,Oi.default)(s)||{}),(0,Pi.default)(s)),(0,Pi.default)(o)),(0,Li.default)(o,l)),a=s}for(var c=null,n=1==o.childNodes.length&&0==o.attributes.length?o.firstChild:(0,Si.default)(o,"SPAN"),a=n;(0,xi.default)(i,a)&&1==(null==(r=a.parentNode)?void 0:r.childNodes.length);a=a.parentNode)c=a.parentNode;null!=(e=t.parentNode)&&e.insertBefore(n,t.nextSibling),null!=(e=null==c?void 0:c.parentNode)&&e.removeChild(c)}},{}),Ii=(Object.defineProperty(Ri,"__esModule",{value:!0}),Pe),Ai=ie,Mi=Er,Di=(Ri.default=function(e){if(!e)return null;var t=(0,Ai.default)(e),n=t.getBoundingClientRect&&(0,Mi.default)(t.getBoundingClientRect());if(n)return n;e=e.normalize();var r=t.getClientRects&&t.getClientRects();if(n=r&&1==r.length?(0,Mi.default)(r[0]):null)return n;if(3==e.node.nodeType&&e.node.ownerDocument){r=(0,Ii.default)({tag:"span",children:[""]},e.node.ownerDocument);if((t=(0,Ai.default)(e)).insertNode(r),n=r.getBoundingClientRect&&(0,Mi.default)(r.getBoundingClientRect()),null!=(t=r.parentNode)&&t.removeChild(r),n)return n}t=e.element;return t&&t.getBoundingClientRect&&(n=(0,Mi.default)(t.getBoundingClientRect()))?n:null},{}),ji=(Object.defineProperty(Di,"__esModule",{value:!0}),o),Bi=a,Fi=cr;Di.default=function(e,t){if(e){var n=(e=e.normalize()).node;if(0==e.offset){for(;n&&(0,ji.default)(t,n)&&function(e){for(;e.previousSibling;)if(e=e.previousSibling,"BR"==(0,Bi.default)(e)||!(0,Fi.default)(e))return;return 1}(n);)n=(null==n?void 0:n.parentNode)||null;return n==t}}return!1};var Hi={},zi=(Object.defineProperty(Hi,"__esModule",{value:!0}),o),Ui=c;function Vi(e,t){var n,r;if(!e||!t)return[];var o,i=e.node,a=e.offset,l=[];if(!(0,zi.default)(t,i,!0))return[];if(3==i.nodeType){for(o=i.parentNode;i.previousSibling&&3==i.previousSibling.nodeType;)a+=(null==(n=i.previousSibling.nodeValue)?void 0:n.length)||0,i=i.previousSibling;l.unshift(a)}else i=(o=i).childNodes[a];do{for(var a=0,s=!1,c=(null==o?void 0:o.firstChild)||null;c&&c!=i;c=c.nextSibling){if(3==c.nodeType){if(0===(null==(r=c.nodeValue)?void 0:r.length)||s)continue;s=!0}else s=!1;a++}}while(l.unshift(a),o=(null==(i=o)?void 0:o.parentNode)||null,i&&i!=t);return l}Hi.default=function(e,t){return t?{start:Vi(Ui.default.getStart(t),e),end:Vi(Ui.default.getEnd(t),e)}:null};var O={},Wi=(Object.defineProperty(O,"__esModule",{value:!0}),Cr),qi=Hi,Ki=(O.default=function(e,t){if(!e)return"";var n=(0,Wi.default)(e),e=t&&(0,qi.default)(e,t);return e?n+"\x3c!--"+JSON.stringify(e)+"--\x3e":n},{}),Zi=(Object.defineProperty(Ki,"__esModule",{value:!0}),Ki.setHtmlWithMetadata=void 0,ie),Gi=i;function $i(e,t,n){if(e){t=t||"",e.innerHTML=(null==n?void 0:n(t))||t;n=e.lastChild;if((0,Gi.default)(n,"Comment"))try{var r=JSON.parse(n.nodeValue||"");if(function(e){if(e&&"object"==typeof e)switch(e.type||0){case 0:var t=e;if(Xi(t.start)&&Xi(t.end))return e.type=0,e.isDarkMode=!!e.isDarkMode,1;break;case 1:if("string"==typeof e.tableId&&e.tableId&&Yi(e.firstCell)&&Yi(e.lastCell))return e.isDarkMode=!!e.isDarkMode,1}}(r))return e.removeChild(n),r}catch(e){}}}function Xi(e){return e&&Array.isArray(e)&&e.every(function(e){return"number"==typeof e})}function Yi(e){return e&&"object"==typeof e&&"number"==typeof e.x&&"number"==typeof e.y}Ki.default=function(e,t,n){t=$i(e,t,n);return 0==(null==t?void 0:t.type)?(0,Zi.default)(e,t.start,t.end):null},Ki.setHtmlWithMetadata=$i;var Qi={},Ji=(Object.defineProperty(Qi,"__esModule",{value:!0}),_e),ea=(Qi.default=function(e,t){var n=null==(n=null==(n=null==(n=null==e?void 0:e.commonAncestorContainer)?void 0:n.ownerDocument)?void 0:n.defaultView)?void 0:n.getSelection();if(n){var r=!0;if(0<n.rangeCount)try{var o=null;(t||Ji.Browser.isEdge)&&(o=1==n.rangeCount?n.getRangeAt(0):null)&&o.startContainer==e.startContainer&&o.startOffset==e.startOffset&&o.endContainer==e.endContainer&&o.endOffset==e.endOffset?r=!1:n.removeAllRanges()}catch(e){}r&&n.addRange(e)}},{}),ta={},na={},ra=(Object.defineProperty(na,"__esModule",{value:!0}),na.default=function(e,t){t=e.currentIndex+t;return 0<=t&&t<e.snapshots.length},Object.defineProperty(ta,"__esModule",{value:!0}),ta.clearProceedingSnapshotsV2=void 0,na);function oa(e,t){if(t=t||function(e){return(null==(e=e)?void 0:e.length)||0},(0,ra.default)(e,1)){for(var n=0,r=e.currentIndex+1;r<e.snapshots.length;r++)n+=t(e.snapshots[r]);e.snapshots.splice(e.currentIndex+1),e.totalSize-=n,e.autoCompleteIndex=-1}}ta.default=oa,ta.clearProceedingSnapshotsV2=function(e){oa(e,function(e){return(null==(e=e.html)?void 0:e.length)||0})},Object.defineProperty(ea,"__esModule",{value:!0}),ea.addSnapshotV2=void 0;var ia=ta;function aa(e,t,n,r,o){r=r||function(e){return(null==(e=e)?void 0:e.length)||0},o=o||sa;var i=e.snapshots[e.currentIndex];if(e.currentIndex<0||!i||!o(t,i)){(0,ia.default)(e,r),e.snapshots.push(t),e.currentIndex++,e.totalSize+=r(t);for(var a=0;a<e.snapshots.length&&e.totalSize>e.maxSize;)e.totalSize-=r(e.snapshots[a]),a++;0<a&&(e.snapshots.splice(0,a),e.currentIndex-=a,e.autoCompleteIndex-=a),n&&(e.autoCompleteIndex=e.currentIndex)}}function la(e,t){return e.html==t.html}function sa(e,t){return e==t}ea.default=aa,ea.addSnapshotV2=function(e,t,n){aa(e,t,n,function(e){return(null==(e=e.html)?void 0:e.length)||0},la)};var ca={},da=(Object.defineProperty(ca,"__esModule",{value:!0}),ca.moveCurrentSnapsnot=void 0,na);function ua(e,t){return(0,da.default)(e,t)?(e.currentIndex+=t,e.autoCompleteIndex=-1,e.snapshots[e.currentIndex]):null}ca.default=ua,ca.moveCurrentSnapsnot=ua;var fa={},pa=(Object.defineProperty(fa,"__esModule",{value:!0}),fa.default=function(e){return{snapshots:[],totalSize:0,currentIndex:-1,autoCompleteIndex:-1,maxSize:e}},{}),ha=(Object.defineProperty(pa,"__esModule",{value:!0}),pa.default=function(e){return 0<=e.autoCompleteIndex&&e.currentIndex-e.autoCompleteIndex==1},{}),ga={},ma=(Object.defineProperty(ga,"__esModule",{value:!0}),"border-spacing,caption-side,color,cursor,direction,empty-cells,font-family,font-size,font-style,font-variant,font-weight,font,letter-spacing,line-height,list-style-image,list-style-position,list-style-type,list-style,orphans,quotes,text-align,text-indent,text-transform,visibility,white-space,widows,word-spacing".split(",")),va=(ga.default=function(e){var t=e&&e.ownerDocument&&e.ownerDocument.defaultView,n=t&&e&&t.getComputedStyle(e),r={};return ma.forEach(function(e){return r[e]=n&&n.getPropertyValue(e)||""}),r},{}),ya=(Object.defineProperty(va,"__esModule",{value:!0}),va.cloneObject=void 0,Object.assign?function(e,t){return Object.assign(t||{},e)}:function(e,t){var n=t||{};if(e)for(var r=0,o=Object.keys(e);r<o.length;r++){var i=o[r];n[i]=e[i]}return n}),ba=(va.cloneObject=function(e,t){return ya(e,t)},{}),Ea=e&&e.__assign||function(){return(Ea=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Ca=(Object.defineProperty(ba,"__esModule",{value:!0}),ba.getStyleCallbacks=ba.getDefaultStyleValues=ba.getAllowedCssClassesRegex=ba.getAllowedAttributes=ba.getTagReplacement=void 0,va),wa={a:"*",abbr:"*",address:"*",area:"*",article:"*",aside:"*",b:"*",bdi:"*",bdo:"*",blockquote:"*",body:"*",br:"*",button:"*",canvas:"*",caption:"*",center:"*",cite:"*",code:"*",col:"*",colgroup:"*",data:"*",datalist:"*",dd:"*",del:"*",details:"*",dfn:"*",dialog:"*",dir:"*",div:"*",dl:"*",dt:"*",em:"*",fieldset:"*",figcaption:"*",figure:"*",font:"*",footer:"*",h1:"*",h2:"*",h3:"*",h4:"*",h5:"*",h6:"*",head:"*",header:"*",hgroup:"*",hr:"*",html:"*",i:"*",img:"*",input:"*",ins:"*",kbd:"*",label:"*",legend:"*",li:"*",main:"*",map:"*",mark:"*",menu:"*",menuitem:"*",meter:"*",nav:"*",ol:"*",optgroup:"*",option:"*",output:"*",p:"*",picture:"*",pre:"*",progress:"*",q:"*",rp:"*",rt:"*",ruby:"*",s:"*",samp:"*",section:"*",select:"*",small:"*",span:"*",strike:"*",strong:"*",sub:"*",summary:"*",sup:"*",table:"*",tbody:"*",td:"*",textarea:"*",tfoot:"*",th:"*",thead:"*",time:"*",tr:"*",tt:"*",u:"*",ul:"*",var:"*",wbr:"*",xmp:"*",form:"SPAN",applet:null,audio:null,base:null,basefont:null,embed:null,frame:null,frameset:null,iframe:null,link:null,meta:null,noscript:null,object:null,param:null,script:null,slot:null,source:null,style:null,template:null,title:null,track:null,video:null},Sa="accept,align,alt,checked,cite,color,cols,colspan,contextmenu,coords,datetime,default,dir,dirname,disabled,download,face,headers,height,hidden,high,href,hreflang,ismap,kind,label,lang,list,low,max,maxlength,media,min,multiple,open,optimum,pattern,placeholder,readonly,rel,required,reversed,rows,rowspan,scope,selected,shape,size,sizes,span,spellcheck,src,srclang,srcset,start,step,style,tabindex,target,title,translate,type,usemap,valign,value,width,wrap".split(","),xa={"background-color":"transparent","border-bottom-color":"rgb(0, 0, 0)","border-bottom-style":"none","border-bottom-width":"0px","border-image-outset":"0","border-image-repeat":"stretch","border-image-slice":"100%","border-image-source":"none","border-image-width":"1","border-left-color":"rgb(0, 0, 0)","border-left-style":"none","border-left-width":"0px","border-right-color":"rgb(0, 0, 0)","border-right-style":"none","border-right-width":"0px","border-top-color":"rgb(0, 0, 0)","border-top-style":"none","border-top-width":"0px","outline-color":"transparent","outline-style":"none","outline-width":"0px",overflow:"visible","text-decoration":"none","-webkit-text-stroke-width":"0px","word-wrap":"break-word","margin-left":"0px","margin-right":"0px",padding:"0px","padding-top":"0px","padding-left":"0px","padding-right":"0px","padding-bottom":"0px",border:"0px","border-top":"0px","border-left":"0px","border-right":"0px","border-bottom":"0px","vertical-align":"baseline",float:"none"},Ta=[];function Oa(){return null}function Pa(e,t){t=t.tagName;return!("LI"==t||"DIV"==t)}ba.getTagReplacement=function(e){var t=Ea({},wa),n=e||{};return Object.keys(n).forEach(function(e){e&&(t[e.toLowerCase()]=n[e])}),t},ba.getAllowedAttributes=function(e){return Sa.concat(e||[]).filter(function(e,t,n){return n.indexOf(e)==t}).map(function(e){return e.toLocaleLowerCase()})},ba.getAllowedCssClassesRegex=function(e){e=Ta.concat(e||[]);return 0<e.length?new RegExp(e.join("|")):null},ba.getDefaultStyleValues=function(n){var r=(0,Ca.cloneObject)(xa);return n&&Object.keys(n).forEach(function(e){var t=n[e];null!=t?r[e]=t:delete r[e]}),r},ba.getStyleCallbacks=function(e){e=(0,Ca.cloneObject)(e);return e.position=e.position||Oa,e.width=e.width||Pa,e},Object.defineProperty(ha,"__esModule",{value:!0});var _a=or,ka=ga,La=T,Na=S,Ra=a,Ia=i,Aa=Wr,Ma=Z,Da=va,ja=ba;function Ba(e){this.elementCallbacks=(0,Da.cloneObject)((e=e||{}).elementCallbacks),this.styleCallbacks=(0,ja.getStyleCallbacks)(e.cssStyleCallbacks),this.attributeCallbacks=(0,Da.cloneObject)(e.attributeCallbacks),this.tagReplacements=(0,ja.getTagReplacement)(e.additionalTagReplacements),this.allowedAttributes=(0,ja.getAllowedAttributes)(e.additionalAllowedAttributes),this.allowedCssClassesRegex=(0,ja.getAllowedCssClassesRegex)(e.additionalAllowedCssClasses),this.defaultStyleValues=(0,ja.getDefaultStyleValues)(e.additionalDefaultStyleValues),this.additionalPredefinedCssForElement=e.additionalPredefinedCssForElement||null,this.additionalGlobalStyleNodes=e.additionalGlobalStyleNodes||[],this.preserveHtmlComments=e.preserveHtmlComments||!1,this.unknownTagReplacement=e.unknownTagReplacement||null}Ba.convertInlineCss=function(e,t){return new Ba({additionalGlobalStyleNodes:t}).exec(e,!0)},Ba.sanitizeHtml=function(e,t){var n=new Ba(t=t||{}),r=(0,Ia.default)(t.currentElementOrStyle,"HTMLElement")?(0,ka.default)(t.currentElementOrStyle):t.currentElementOrStyle;return n.exec(e,t.convertCssOnly,r)},Ba.prototype.exec=function(e,t,n){e=(new DOMParser).parseFromString(e||"","text/html");return e&&e.body&&e.body.firstChild&&(this.convertGlobalCssToInlineCss(e),t||this.sanitize(e.body,n)),e&&e.body&&e.body.innerHTML||""},Ba.prototype.sanitize=function(e,t){if(!e)return"";t=(0,Da.cloneObject)(t,(0,ka.default)(null)),this.processNode(e,t,{})},Ba.prototype.convertGlobalCssToInlineCss=function(i){for(var e=(0,Ma.default)(i.querySelectorAll("style")),t=0,n=this.additionalGlobalStyleNodes.reverse().map(function(e){return e.sheet}).concat(e.map(function(e){return e.sheet}).reverse()).filter(function(e){return e});t<n.length;t++)for(var a=n[t],r=a.cssRules.length-1;0<=r;r--)!function(e){var e=a.cssRules[e],t=e&&e.style?e.style.cssText:null;if(e.type!=CSSRule.STYLE_RULE||!t||!e.selectorText)return;for(var n=0,r=e.selectorText.split(",");n<r.length;n++){var o=r[n];!o||!o.trim()||0<=o.indexOf(":")||(0,Ma.default)(i.querySelectorAll(o)).forEach(function(e){return e.setAttribute("style",t+(e.getAttribute("style")||""))})}}(r);e.forEach(function(e){e.parentNode&&e.parentNode.removeChild(e)})},Ba.prototype.processNode=function(e,t,n){var r,o,i=e.nodeType,a=1==i,l=3==i,s=11==i,i=8==i,c=!1;if(a?(u=(0,Ra.default)(e),o=this.elementCallbacks[u],void 0===(r=this.tagReplacements[u.toLowerCase()])&&(r=this.unknownTagReplacement),o?c=o(e,n):0<u.indexOf(":")||u==r||"*"==r?c=!0:r&&/^[a-zA-Z][\w\-]*$/.test(r)&&(e=(0,_a.default)(e,r),c=!0)):c=l?"pre"==(o=t["white-space"])||"pre-line"==o||"pre-wrap"==o||!/^[\r\n]*$/g.test(e.nodeValue||""):!!s||!!i&&this.preserveHtmlComments,c)if(!l||"pre"!=t["white-space"]&&"pre-wrap"!=t["white-space"]){if(a||s){var d=(0,Da.cloneObject)(t),u=e;a&&(this.processAttributes(u,n),this.preprocessCss(u,d),this.processCss(u,d,n));for(var f,p=u.firstChild;p;p=f)f=p.nextSibling,this.processNode(p,d,n)}}else e.nodeValue=(e.nodeValue||"").replace(/^ /gm,"").replace(/ {2}/g," ");else null!=(r=e.parentNode)&&r.removeChild(e)},Ba.prototype.preprocessCss=function(e,t){var n=(0,La.default)(e,this.additionalPredefinedCssForElement);n&&Object.keys(n).forEach(function(e){t[e]=n[e]})},Ba.prototype.processCss=function(o,i,a){var l=this,s=(0,Na.default)(o);Object.keys(s).forEach(function(e){var t=s[e],n=l.styleCallbacks[e],r=null!=i[e],n=(!n||n(t,o,i,a))&&"inherit"!=t&&t.indexOf("expression")<0&&"-"!=e.substr(0,1)&&l.defaultStyleValues[e]!=t&&(r&&t!=i[e]||!r&&"initial"!=t&&"normal"!=t);n&&r&&(i[e]=t),n||delete s[e]}),(0,Aa.default)(o,s)},Ba.prototype.processAttributes=function(e,t){for(var n=e.attributes.length-1;0<=n;n--){var r=e.attributes[n],o=r.name.toLowerCase().trim(),i=r.value,a=this.attributeCallbacks[o],a=a?a(i,e,t):0<=this.allowedAttributes.indexOf(o)||0==o.indexOf("data-")?i:null;null==(a="class"==o&&this.allowedCssClassesRegex?this.processCssClass(i,a):a)||a.match(/s\n*c\n*r\n*i\n*p\n*t\n*:/i)?e.removeAttribute(o):r.value=a}},Ba.prototype.processCssClass=function(e,t){var n=this,e=e?e.split(" "):[],r=t?t.split(" "):[];return e.forEach(function(e){var t;null!=(t=n.allowedCssClassesRegex)&&t.test(e)&&r.indexOf(e)<0&&r.push(e)}),0<(null==r?void 0:r.length)?r.join(" "):null},ha.default=Ba;var T={},va=(Object.defineProperty(T,"__esModule",{value:!0}),T.default=function(){return{elementCallbacks:{},attributeCallbacks:{},cssStyleCallbacks:{},additionalTagReplacements:{},additionalAllowedAttributes:[],additionalAllowedCssClasses:[],additionalDefaultStyleValues:{},additionalGlobalStyleNodes:[],additionalPredefinedCssForElement:{},preserveHtmlComments:!1,unknownTagReplacement:null}},{}),ba=(Object.defineProperty(va,"__esModule",{value:!0}),va.default=function(e,t,n){var r;e[t]?(r=e[t],e[t]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.apply(void 0,e),n.apply(void 0,e)}):e[t]=n},{}),Fa=(Object.defineProperty(ba,"__esModule",{value:!0}),"contenteditable"),Ha=(ba.default=function(e,t,n,r){e&&(e.className="_Entity _EType_"+t+" "+(r?"_EId_"+r+" ":"")+"_EReadonly_"+(n?"1":"0"),n?e.contentEditable="false":e.getAttribute(Fa)&&e.removeAttribute(Fa))},{}),za=(Object.defineProperty(Ha,"__esModule",{value:!0}),Ha.default=function(e){var t,n=!1,r="",o="",i=!1;return null!=(t=null==e?void 0:e.className)&&t.split(" ").forEach(function(e){"_Entity"==e?n=!0:0==e.indexOf("_EType_")?r=e.substr("_EType_".length):0==e.indexOf("_EId_")?o=e.substr("_EId_".length):0==e.indexOf("_EReadonly_")&&(i="1"==e.substr("_EReadonly_".length))}),n?{wrapper:e,id:o,type:r,isReadonly:i}:null},{}),Ua=(Object.defineProperty(za,"__esModule",{value:!0}),za.default=function(e,t){return"._Entity"+(e?"._EType_"+e:"")+(t?"._EId_"+t:"")},{}),Va=(Object.defineProperty(Ua,"__esModule",{value:!0}),Ua.default=function(e,t,n){n=e&&e.eventDataCache&&e.eventDataCache.hasOwnProperty(t)?e.eventDataCache[t]:n();return e&&(e.eventDataCache=e.eventDataCache||{},e.eventDataCache[t]=n),n},{}),Wa=(Object.defineProperty(Va,"__esModule",{value:!0}),Va.default=function(e,t){e&&e.eventDataCache&&(t&&e.eventDataCache.hasOwnProperty(t)?delete e.eventDataCache[t]:t||(e.eventDataCache={}))},{}),qa=(Object.defineProperty(Wa,"__esModule",{value:!0}),Wa.default=function(e){var t=e.ctrlKey||"Control"===e.key,n=e.altKey||"Alt"===e.key,e=e.metaKey||"Meta"===e.key;return t||n||e},{}),Ka=(Object.defineProperty(qa,"__esModule",{value:!0}),Wa),Za=(qa.default=function(e){return!(0,Ka.default)(e)&&!!e.key&&1==e.key.length},{}),Ga=(Object.defineProperty(Za,"__esModule",{value:!0}),_e.Browser.isMac?function(e){return e.metaKey}:function(e){return e.ctrlKey}),$a=(Za.default=function(e){return Ga(e)},{}),Xa=(Object.defineProperty($a,"__esModule",{value:!0}),or),Ya=o,Qa=ie,Ja=d,el=n,tl=a,nl=cr,rl=Di,ol=ae,il=Lt,al=c,ll=g,sl=mr,cl=ot,dl=Z,ul=y,fl=Sr,pl=Oe,hl=V,gl=[function(e,t,n,r){var o=(0,el.default)(e,n.node);if(o){var i=(0,sl.default)(e,"a[href]",null,1,(0,Qa.default)(n)).filter(function(e){return o.contains(e)})[0];if(i&&(0,nl.default)(i)&&(n=new al.default(i,-2),ml(i),i=null),i&&null!=(a=t)&&a.querySelector&&null!=(a=t)&&a.querySelector("a[href]")){var t=n.normalize(),a=t.node.parentNode,t=3==t.node.nodeType?(0,cl.default)(t.node,t.offset,!1):t.isAtEnd?t.node.nextSibling:t.node,l=e.ownerDocument.createTextNode("");for(a.insertBefore(l,t);(0,Ya.default)(i,l);)l=(0,hl.splitBalancedNodeRange)(l);n=new al.default(l,-2),ml(l)}}return n},function(e,t,n,r){11==t.nodeType&&(t=1==(l=(0,dl.default)(t.childNodes).filter(function(e){return"BR"!=(0,tl.default)(e)})).length?l[0]:null);var o,i,a,l=(0,tl.default)(t),s=l&&t&&"BR"==(0,tl.default)(t.nextSibling),c=(0,Ja.default)(n.node,e,"LI"),d=c&&(0,Ja.default)(c,e,"OL,UL"),u=(0,Ja.default)(n.node,e,"TD,TH"),e=u&&(0,Ja.default)(u,e,"TR");return"LI"==l&&(l=d?(0,tl.default)(d):"UL",t=(0,pl.default)(t,l)),"OL"!=l&&"UL"!=l||!t||"LI"!=(0,tl.default)(t.firstChild)?"TABLE"==l&&e&&(i=new fl.default(t),0==(a=new fl.default(u)).col&&u==a.getCell(a.row||0,0).td&&null!=(o=i.cells)&&o[0]&&i.cells[0].length==(null==(o=a.cells)?void 0:o[0].length)&&(0,rl.default)(n,u)&&("TBODY"!=(0,tl.default)(t.firstChild)||null!=(i=t.firstChild)&&i.nextSibling||(0,ul.default)(t.firstChild),(0,ul.default)(t),n=new al.default(e,-3))):(a=!t.firstChild.nextSibling&&!s,s&&t.parentNode&&ml(t.nextSibling),a?((0,ul.default)(t.firstChild),(0,ul.default)(t)):(0,tl.default)(d)==l&&((0,ul.default)(t),n=new al.default(c,(0,rl.default)(n,c)?-2:-3))),n},function(e,t,n,r){var o,i;return"P"==(0,tl.default)(n.node)&&(o=n.normalize(),i=(0,Xa.default)(n.node,"div"),o.node!=i&&(n=o)),n},function(e,t,n,r){return n=(0,ol.default)(n.node)?new al.default(n.node,n.isAtEnd?-3:-2):n},function(e,t,n,r){return r&&r.collapsed&&(r=(e=new ll.default(e,al.default.getStart(r))).getInlineElementBefore(),e=e.getInlineElementAfter(),r instanceof il.default?n=new al.default(r.getContainerNode(),-3):e instanceof il.default&&(n=new al.default(e.getContainerNode(),-2))),n}];function ml(e){var t;null!=(t=null==e?void 0:e.parentNode)&&t.removeChild(e)}$a.default=function(t,n,r,o){return gl.forEach(function(e){r=e(t,n,r,o)}),r};var vl={},yl=(Object.defineProperty(vl,"__esModule",{value:!0}),l),bl=W,El=w,Cl=No,wl=_o,Sl=c,xl=mr,Tl=i,Ol=ot;function Pl(e,t,n){if((0,Tl.default)(e,"Text"))return r=(0,Ol.default)(e,t,n),n?[r,e]:[e,r];var r=e.childNodes[t-1],t=e.childNodes[t];return r||t||(n?r=(t=e).previousSibling:t=(r=e).nextSibling),!r&&!t||r&&t||(n=e.ownerDocument.createTextNode(""),null!=(e=null==(e=r||t)?void 0:e.parentNode)&&e.insertBefore(n,t),r?t=n:r=n),[r,t]}vl.default=function(e,t){var i=null,a=(0,xl.default)(e,"table,tr",null,2,t),e=(0,El.default)(e,t,0).map(function(e){var t=(0,Cl.default)(e);if(!t)return null;var n=t.startContainer,r=t.endContainer,o=t.startOffset,r=Pl(r,t.endOffset,!1),t=r[0],r=r[1],n=Pl(n,o,!0),o=n[0],n=n[1],n=(i=i||o,(0,bl.default)(e,[n,t]));return(0,yl.default)(a,n),{region:e,beforeStart:o,afterEnd:r}}).filter(function(e){return!!e});return a.forEach(function(e){var t;return null==(t=e.parentNode)?void 0:t.removeChild(e)}),e.forEach(function(e){e&&(0,wl.default)(e.region,e.beforeStart,e.afterEnd)}),i&&new Sl.default(i,-1)};var _l,kl,Ll,Nl,Rl,Il,Al,Ml,Dl,jl,Bl,Fl,Hl,zl,Ul,Vl,Wl,ql,Kl,Zl,Gl,$l,Xl,Yl,Ql,Jl,es,ts,ns,rs,os,is,as,ls,ss,cs,ds,us,fs,ps,hs,gs,ms,vs,ys,bs,Es,Cs,ws,Ss,xs,Ts,Os,Ps,_s,ks,Ls,Ns,Rs,Is,As,Ms,Ds,js,Bs,Fs,Hs,zs,Us,Vs,Ws,qs,Ks,Zs,Gs,$s,Xs,Ys,Qs,Js,ec,tc,nc,rc,oc,ic,ac,lc,sc={},cc=(Object.defineProperty(sc,"__esModule",{value:!0}),s),dc=(sc.default=function(e){for(var t=cc.default.createBodyTraverser(e),n=t&&t.currentBlockElement,r=[];n;)r.push(n.getTextContent()),n=t.getNextBlockElement();return r.join("\n")},R=t,Object.defineProperty(R,"__esModule",{value:!0}),R.KnownCreateElementData=R.createElement=R.matchesSelector=R.setColor=R.getInnerHTML=R.readFile=R.safeInstanceOf=R.toArray=R.normalizeRect=R.splitTextNode=R.getLastLeafNode=R.getFirstLeafNode=R.getPreviousLeafSibling=R.getNextLeafSibling=R.wrap=R.unwrap=R.splitBalancedNodeRange=R.splitParentNode=R.queryElements=R.matchLink=R.isVoidHtmlElement=R.isNodeEmpty=R.isBlockElement=R.getTagOfNode=R.PendableFormatCommandMap=R.getPendableFormatState=R.getComputedStyle=R.getComputedStyles=R.fromHtml=R.findClosestElementAncestor=R.contains=R.collapseNodes=R.changeElementTag=R.applyFormat=R.getBrowserInfo=R.Browser=R.arrayPush=R.extractClipboardItemsForIE=R.extractClipboardItems=R.extractClipboardEvent=R.applyTextStyle=R.PartialInlineElement=R.NodeInlineElement=R.LinkInlineElement=R.ImageInlineElement=R.getInlineElementAtNode=R.PositionContentSearcher=R.ContentTraverser=R.getFirstLastBlockElement=R.getBlockElementAtNode=void 0,R.getTextContent=R.deleteSelectedContent=R.adjustInsertPosition=R.setStyles=R.getStyles=R.isCtrlOrMetaPressed=R.isCharacterValue=R.isModifierKey=R.clearEventDataCache=R.cacheGetEventData=R.getEntitySelector=R.getEntityFromElement=R.commitEntity=R.chainSanitizerCallback=R.createDefaultHtmlSanitizerOptions=R.getInheritableStyles=R.HtmlSanitizer=R.canUndoAutoComplete=R.createSnapshots=R.moveCurrentSnapsnot=R.moveCurrentSnapshot=R.clearProceedingSnapshotsV2=R.clearProceedingSnapshots=R.canMoveCurrentSnapshot=R.addSnapshotV2=R.addSnapshot=R.addRangeToSelection=R.setHtmlWithMetadata=R.setHtmlWithSelectionPath=R.getHtmlWithSelectionPath=R.getSelectionPath=R.isPositionAtBeginningOf=R.getPositionRect=R.createRange=R.Position=R.mergeBlocksInRegion=R.getSelectionRangeInRegion=R.isNodeInRegion=R.collapseNodesInRegion=R.getSelectedBlockElementsInRegion=R.getRegionsFromRange=R.setListItemStyle=R.VListChain=R.createVListFromRegion=R.VListItem=R.VList=R.isWholeTableSelected=R.VTable=R.moveChildNodes=void 0,_l=n,Object.defineProperty(R,"getBlockElementAtNode",{enumerable:!0,get:function(){return _l.default}}),kl=u,Object.defineProperty(R,"getFirstLastBlockElement",{enumerable:!0,get:function(){return kl.default}}),Ll=s,Object.defineProperty(R,"ContentTraverser",{enumerable:!0,get:function(){return Ll.default}}),Nl=g,Object.defineProperty(R,"PositionContentSearcher",{enumerable:!0,get:function(){return Nl.default}}),Rl=f,Object.defineProperty(R,"getInlineElementAtNode",{enumerable:!0,get:function(){return Rl.default}}),Il=tt,Object.defineProperty(R,"ImageInlineElement",{enumerable:!0,get:function(){return Il.default}}),Al=Lt,Object.defineProperty(R,"LinkInlineElement",{enumerable:!0,get:function(){return Al.default}}),Ml=nt,Object.defineProperty(R,"NodeInlineElement",{enumerable:!0,get:function(){return Ml.default}}),Dl=tn,Object.defineProperty(R,"PartialInlineElement",{enumerable:!0,get:function(){return Dl.default}}),jl=rt,Object.defineProperty(R,"applyTextStyle",{enumerable:!0,get:function(){return jl.default}}),Bl=et,Object.defineProperty(R,"extractClipboardEvent",{enumerable:!0,get:function(){return Bl.default}}),Fl=Jt,Object.defineProperty(R,"extractClipboardItems",{enumerable:!0,get:function(){return Fl.default}}),Hl=m,Object.defineProperty(R,"extractClipboardItemsForIE",{enumerable:!0,get:function(){return Hl.default}}),zl=l,Object.defineProperty(R,"arrayPush",{enumerable:!0,get:function(){return zl.default}}),Ul=_e,Object.defineProperty(R,"Browser",{enumerable:!0,get:function(){return Ul.Browser}}),Object.defineProperty(R,"getBrowserInfo",{enumerable:!0,get:function(){return Ul.getBrowserInfo}}),Vl=Jn,Object.defineProperty(R,"applyFormat",{enumerable:!0,get:function(){return Vl.default}}),Wl=or,Object.defineProperty(R,"changeElementTag",{enumerable:!0,get:function(){return Wl.default}}),ql=r,Object.defineProperty(R,"collapseNodes",{enumerable:!0,get:function(){return ql.default}}),Kl=o,Object.defineProperty(R,"contains",{enumerable:!0,get:function(){return Kl.default}}),Zl=d,Object.defineProperty(R,"findClosestElementAncestor",{enumerable:!0,get:function(){return Zl.default}}),Gl=Ne,Object.defineProperty(R,"fromHtml",{enumerable:!0,get:function(){return Gl.default}}),$l=it,Object.defineProperty(R,"getComputedStyles",{enumerable:!0,get:function(){return $l.default}}),Object.defineProperty(R,"getComputedStyle",{enumerable:!0,get:function(){return $l.getComputedStyle}}),Xl=sr,Object.defineProperty(R,"getPendableFormatState",{enumerable:!0,get:function(){return Xl.default}}),Object.defineProperty(R,"PendableFormatCommandMap",{enumerable:!0,get:function(){return Xl.PendableFormatCommandMap}}),Yl=a,Object.defineProperty(R,"getTagOfNode",{enumerable:!0,get:function(){return Yl.default}}),Ql=Q,Object.defineProperty(R,"isBlockElement",{enumerable:!0,get:function(){return Ql.default}}),Jl=cr,Object.defineProperty(R,"isNodeEmpty",{enumerable:!0,get:function(){return Jl.default}}),es=ae,Object.defineProperty(R,"isVoidHtmlElement",{enumerable:!0,get:function(){return es.default}}),ts=gr,Object.defineProperty(R,"matchLink",{enumerable:!0,get:function(){return ts.default}}),ns=mr,Object.defineProperty(R,"queryElements",{enumerable:!0,get:function(){return ns.default}}),rs=V,Object.defineProperty(R,"splitParentNode",{enumerable:!0,get:function(){return rs.default}}),Object.defineProperty(R,"splitBalancedNodeRange",{enumerable:!0,get:function(){return rs.splitBalancedNodeRange}}),os=y,Object.defineProperty(R,"unwrap",{enumerable:!0,get:function(){return os.default}}),is=Oe,Object.defineProperty(R,"wrap",{enumerable:!0,get:function(){return is.default}}),as=p,Object.defineProperty(R,"getNextLeafSibling",{enumerable:!0,get:function(){return as.getNextLeafSibling}}),Object.defineProperty(R,"getPreviousLeafSibling",{enumerable:!0,get:function(){return as.getPreviousLeafSibling}}),ls=zt,Object.defineProperty(R,"getFirstLeafNode",{enumerable:!0,get:function(){return ls.getFirstLeafNode}}),Object.defineProperty(R,"getLastLeafNode",{enumerable:!0,get:function(){return ls.getLastLeafNode}}),ss=ot,Object.defineProperty(R,"splitTextNode",{enumerable:!0,get:function(){return ss.default}}),cs=Er,Object.defineProperty(R,"normalizeRect",{enumerable:!0,get:function(){return cs.default}}),ds=Z,Object.defineProperty(R,"toArray",{enumerable:!0,get:function(){return ds.default}}),us=i,Object.defineProperty(R,"safeInstanceOf",{enumerable:!0,get:function(){return us.default}}),fs=sn,Object.defineProperty(R,"readFile",{enumerable:!0,get:function(){return fs.default}}),ps=Cr,Object.defineProperty(R,"getInnerHTML",{enumerable:!0,get:function(){return ps.default}}),hs=er,Object.defineProperty(R,"setColor",{enumerable:!0,get:function(){return hs.default}}),gs=ce,Object.defineProperty(R,"matchesSelector",{enumerable:!0,get:function(){return gs.default}}),ms=Pe,Object.defineProperty(R,"createElement",{enumerable:!0,get:function(){return ms.default}}),Object.defineProperty(R,"KnownCreateElementData",{enumerable:!0,get:function(){return ms.KnownCreateElementData}}),vs=v,Object.defineProperty(R,"moveChildNodes",{enumerable:!0,get:function(){return vs.default}}),ys=Sr,Object.defineProperty(R,"VTable",{enumerable:!0,get:function(){return ys.default}}),bs=xr,Object.defineProperty(R,"isWholeTableSelected",{enumerable:!0,get:function(){return bs.default}}),Es=E,Object.defineProperty(R,"VList",{enumerable:!0,get:function(){return Es.default}}),Cs=Ur,Object.defineProperty(R,"VListItem",{enumerable:!0,get:function(){return Cs.default}}),ws=x,Object.defineProperty(R,"createVListFromRegion",{enumerable:!0,get:function(){return ws.default}}),Ss=h,Object.defineProperty(R,"VListChain",{enumerable:!0,get:function(){return Ss.default}}),xs=Vr,Object.defineProperty(R,"setListItemStyle",{enumerable:!0,get:function(){return xs.default}}),Ts=w,Object.defineProperty(R,"getRegionsFromRange",{enumerable:!0,get:function(){return Ts.default}}),Os=Lo,Object.defineProperty(R,"getSelectedBlockElementsInRegion",{enumerable:!0,get:function(){return Os.default}}),Ps=W,Object.defineProperty(R,"collapseNodesInRegion",{enumerable:!0,get:function(){return Ps.default}}),_s=Ho,Object.defineProperty(R,"isNodeInRegion",{enumerable:!0,get:function(){return _s.default}}),ks=No,Object.defineProperty(R,"getSelectionRangeInRegion",{enumerable:!0,get:function(){return ks.default}}),Ls=_o,Object.defineProperty(R,"mergeBlocksInRegion",{enumerable:!0,get:function(){return Ls.default}}),Ns=c,Object.defineProperty(R,"Position",{enumerable:!0,get:function(){return Ns.default}}),Rs=ie,Object.defineProperty(R,"createRange",{enumerable:!0,get:function(){return Rs.default}}),Is=Ri,Object.defineProperty(R,"getPositionRect",{enumerable:!0,get:function(){return Is.default}}),As=Di,Object.defineProperty(R,"isPositionAtBeginningOf",{enumerable:!0,get:function(){return As.default}}),Ms=Hi,Object.defineProperty(R,"getSelectionPath",{enumerable:!0,get:function(){return Ms.default}}),Ds=O,Object.defineProperty(R,"getHtmlWithSelectionPath",{enumerable:!0,get:function(){return Ds.default}}),js=Ki,Object.defineProperty(R,"setHtmlWithSelectionPath",{enumerable:!0,get:function(){return js.default}}),Object.defineProperty(R,"setHtmlWithMetadata",{enumerable:!0,get:function(){return js.setHtmlWithMetadata}}),Bs=Qi,Object.defineProperty(R,"addRangeToSelection",{enumerable:!0,get:function(){return Bs.default}}),Fs=ea,Object.defineProperty(R,"addSnapshot",{enumerable:!0,get:function(){return Fs.default}}),Object.defineProperty(R,"addSnapshotV2",{enumerable:!0,get:function(){return Fs.addSnapshotV2}}),Hs=na,Object.defineProperty(R,"canMoveCurrentSnapshot",{enumerable:!0,get:function(){return Hs.default}}),zs=ta,Object.defineProperty(R,"clearProceedingSnapshots",{enumerable:!0,get:function(){return zs.default}}),Object.defineProperty(R,"clearProceedingSnapshotsV2",{enumerable:!0,get:function(){return zs.clearProceedingSnapshotsV2}}),Us=ca,Object.defineProperty(R,"moveCurrentSnapshot",{enumerable:!0,get:function(){return Us.default}}),Object.defineProperty(R,"moveCurrentSnapsnot",{enumerable:!0,get:function(){return Us.moveCurrentSnapsnot}}),Vs=fa,Object.defineProperty(R,"createSnapshots",{enumerable:!0,get:function(){return Vs.default}}),Ws=pa,Object.defineProperty(R,"canUndoAutoComplete",{enumerable:!0,get:function(){return Ws.default}}),qs=ha,Object.defineProperty(R,"HtmlSanitizer",{enumerable:!0,get:function(){return qs.default}}),Ks=ga,Object.defineProperty(R,"getInheritableStyles",{enumerable:!0,get:function(){return Ks.default}}),Zs=T,Object.defineProperty(R,"createDefaultHtmlSanitizerOptions",{enumerable:!0,get:function(){return Zs.default}}),Gs=va,Object.defineProperty(R,"chainSanitizerCallback",{enumerable:!0,get:function(){return Gs.default}}),$s=ba,Object.defineProperty(R,"commitEntity",{enumerable:!0,get:function(){return $s.default}}),Xs=Ha,Object.defineProperty(R,"getEntityFromElement",{enumerable:!0,get:function(){return Xs.default}}),Ys=za,Object.defineProperty(R,"getEntitySelector",{enumerable:!0,get:function(){return Ys.default}}),Qs=Ua,Object.defineProperty(R,"cacheGetEventData",{enumerable:!0,get:function(){return Qs.default}}),Js=Va,Object.defineProperty(R,"clearEventDataCache",{enumerable:!0,get:function(){return Js.default}}),ec=Wa,Object.defineProperty(R,"isModifierKey",{enumerable:!0,get:function(){return ec.default}}),tc=qa,Object.defineProperty(R,"isCharacterValue",{enumerable:!0,get:function(){return tc.default}}),nc=Za,Object.defineProperty(R,"isCtrlOrMetaPressed",{enumerable:!0,get:function(){return nc.default}}),rc=S,Object.defineProperty(R,"getStyles",{enumerable:!0,get:function(){return rc.default}}),oc=Wr,Object.defineProperty(R,"setStyles",{enumerable:!0,get:function(){return oc.default}}),ic=$a,Object.defineProperty(R,"adjustInsertPosition",{enumerable:!0,get:function(){return ic.default}}),ac=vl,Object.defineProperty(R,"deleteSelectedContent",{enumerable:!0,get:function(){return ac.default}}),lc=sc,Object.defineProperty(R,"getTextContent",{enumerable:!0,get:function(){return lc.default}}),e&&e.__assign||function(){return(dc=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)}),uc=(Object.defineProperty(H,"__esModule",{value:!0}),H.addUndoSnapshot=void 0,t);function fc(e,t){var n,r;e.lifecycle.shadowEditFragment||(n=e.api.getSelectionRangeEx(e),r=e.lifecycle.isDarkMode,r=1==(null==n?void 0:n.type)?dc({type:1,tableId:n.table.id,isDarkMode:r},n.coordinates):dc({type:0,isDarkMode:r,start:[],end:[]},(0,uc.getSelectionPath)(e.contentDiv,n.ranges[0])||{}),e.undo.snapshotsService.addSnapshot({html:e.contentDiv.innerHTML,metadata:r},t),e.undo.hasNewContent=!1)}H.addUndoSnapshot=function(e,t,n,r){var o,i,a=e.undo,l=a.isNested;l||(a.isNested=!0,fc(e,r));try{t&&(o=t((i=e.api.getSelectionRange(e,!0))&&uc.Position.getStart(i).normalize(),i&&uc.Position.getEnd(i).normalize()),l||fc(e,!1))}finally{l||(a.isNested=!1)}t&&n&&e.api.triggerEvent(e,{eventType:7,source:n,data:o},!0),r&&(i=e.api.getSelectionRange(e,!1))&&(e.undo.hasNewContent=!1,e.undo.autoCompletePosition=uc.Position.getStart(i))};var n={},u=(Object.defineProperty(n,"__esModule",{value:!0}),n.attachDomEvent=void 0,n.attachDomEvent=function(a,l){var e=Object.keys(l||{}).map(function(e){n=l[e],r={pluginEventType:null,beforeDispatch:null},"number"==typeof n?r.pluginEventType=n:"function"==typeof n?r.beforeDispatch=n:"object"==typeof n&&(r=n);function t(e){i&&i(e),null!=o&&a.api.triggerEvent(a,{eventType:o,rawEvent:e},!1)}var n,r,o=r.pluginEventType,i=r.beforeDispatch;return a.contentDiv.addEventListener(e,t),function(){a.contentDiv.removeEventListener(e,t)}});return function(){return e.forEach(function(e){return e()})}},{}),pc=(Object.defineProperty(u,"__esModule",{value:!0}),u.createPasteFragment=void 0,t),hc="\x3c!--StartFragment--\x3e",gc="\x3c!--EndFragment--\x3e";function mc(e,t){(0,pc.toArray)(e.querySelectorAll("style")).forEach(t)}u.createPasteFragment=function(e,t,n,r,o){if(!t)return null;var i,a,l={eventType:10,clipboardData:t,fragment:e.contentDiv.ownerDocument.createDocumentFragment(),sanitizingOption:(0,pc.createDefaultHtmlSanitizerOptions)(),htmlBefore:"",htmlAfter:"",htmlAttributes:{}},s=l.fragment,c=l.sanitizingOption,d=t.rawHtml,u=t.text,f=t.imageDataUri,p=e.contentDiv.ownerDocument;if(d&&null!=(h=i=(new DOMParser).parseFromString(e.trustedHTMLHandler(d),"text/html"))&&h.body){var h=null==(h=i.querySelector("html"))?void 0:h.attributes;(h?(0,pc.toArray)(h):[]).reduce(function(e,t){return e[t.name]=t.value,e},l.htmlAttributes),(0,pc.toArray)(i.querySelectorAll("meta")).reduce(function(e,t){return e[t.name]=t.content,e},l.htmlAttributes),t.htmlFirstLevelChildTags=[],null!=i&&i.body.normalize();for(var g=0;g<(null==i?void 0:i.body.childNodes.length);g++){var m,v=null==i?void 0:i.body.childNodes.item(g);v.nodeType==Node.TEXT_NODE&&!v.nodeValue.replace(/(\r\n|\r|\n)/gm,"").trim()||(m=(0,pc.getTagOfNode)(v),v.nodeType!=Node.COMMENT_NODE&&t.htmlFirstLevelChildTags.push(m))}mc(i,function(e){i.head.appendChild(e),c.additionalGlobalStyleNodes.push(e)});var h=d.indexOf(hc),y=d.lastIndexOf(gc);0<=h&&h+hc.length<=y&&(l.htmlBefore=d.substr(0,h),l.htmlAfter=d.substr(y+gc.length),t.html=d.substring(h+hc.length,y),i.body.innerHTML=e.trustedHTMLHandler(t.html),mc(i.body,function(e){var t;return null==(t=e.parentNode)?void 0:t.removeChild(e)}))}r||u||!f?!r&&d&&i&&i.body?((0,pc.moveChildNodes)(s,i.body),o&&n&&(h=e,y=n.node,r=h.api.getPendableFormatState(h,!0),a={fontFamily:(h=h.api.getStyleBasedFormatState(h,y)).fontName,fontSize:h.fontSize,textColor:h.textColor,backgroundColor:h.backgroundColor,textColors:h.textColors,backgroundColors:h.backgroundColors,bold:r.isBold,italic:r.isItalic,underline:r.isUnderline},(0,pc.applyTextStyle)(s,function(e){return(0,pc.applyFormat)(e,a)}))):u&&u.split("\n").forEach(function(e,t,n){e=e.replace(/^ /g,"").replace(/\r/g,"").replace(/ {2}/g," ");var r=p.createTextNode(e);2==n.length&&0==t?(s.appendChild(r),s.appendChild(p.createElement("br"))):0<t&&t<n.length-1?s.appendChild((0,pc.wrap)(""==e?p.createElement("br"):r)):s.appendChild(r)}):((d=p.createElement("img")).style.maxWidth="100%",d.src=f,s.appendChild(d)),e.api.triggerEvent(e,l,!0);o=new pc.HtmlSanitizer(l.sanitizingOption);return o.convertGlobalCssToInlineCss(s),o.sanitize(s,n&&(0,pc.getInheritableStyles)(n.element)),s};var s={},vc=(Object.defineProperty(s,"__esModule",{value:!0}),s.ensureTypeInContainer=void 0,t),g=(s.ensureTypeInContainer=function(e,t,n){var r=(0,vc.findClosestElementAncestor)(t.node,e.contentDiv,"table");t=(t=r&&(r=r.querySelector("td,th"))?new vc.Position(r,0):t).normalize();var o,i,r=(0,vc.getBlockElementAtNode)(e.contentDiv,t.node);r?(o=r.collapseToSingleElement(),r=(0,vc.isNodeEmpty)(o)||n&&(r=n,i=o,(0,vc.safeInstanceOf)(r.target,"Node")&&r.target.contains(i)&&r.key===i.innerText),o=o&&r?o:null):(o=(0,vc.createElement)(1,e.contentDiv.ownerDocument),e.api.insertNode(e,o,{position:1,updateCursor:!1,replaceSelection:!1,insertOnNewLine:!1}),t=new vc.Position(o.firstChild,0)),o&&(0,vc.applyFormat)(o,e.lifecycle.defaultFormat,e.lifecycle.isDarkMode),n&&e.api.selectRange(e,(0,vc.createRange)(t))},{}),yc=(Object.defineProperty(g,"__esModule",{value:!0}),g.focus=void 0,t),f=(g.focus=function(e){var t;e.lifecycle.shadowEditFragment||(e.api.hasFocus(e)&&e.api.getSelectionRange(e,!1)||e.domEvent.selectionRange&&e.api.selectRange(e,e.domEvent.selectionRange,!0)||(t=(0,yc.getFirstLeafNode)(e.contentDiv)||e.contentDiv,e.api.selectRange(e,(0,yc.createRange)(t,0),!0)),e.domEvent.selectionRange=null,e.api.hasFocus(e)||e.contentDiv.focus())},{}),bc=(Object.defineProperty(f,"__esModule",{value:!0}),f.getContent=void 0,t),tt=(f.getContent=function(e,t){var n,r,o=0==t,i=2==t,a=e.lifecycle.shadowEditFragment||e.contentDiv;return 4==t?a.textContent:3==t?(0,bc.getTextContent)(a):o||e.lifecycle.isDarkMode?(t=a,(0,bc.safeInstanceOf)(t,"DocumentFragment")?(r=t.ownerDocument.createElement("div")).appendChild(t.cloneNode(!0)):r=t.cloneNode(!0),(t=r).normalize(),n=e.api.getSelectionRange(e,!0),n=(n=i?e.lifecycle.shadowEditFragment?e.lifecycle.shadowEditSelectionPath:n?(0,bc.getSelectionPath)(e.contentDiv,n):null:null)&&(0,bc.createRange)(t,n.start,n.end),e.lifecycle.isDarkMode&&e.api.transformColor(e,t,!1,null,1),o?(e.api.triggerEvent(e,{eventType:8,clonedRoot:t},!0),t.innerHTML):n?(0,bc.getHtmlWithSelectionPath)(t,n):t.innerHTML):(0,bc.getHtmlWithSelectionPath)(a,i&&e.api.getSelectionRange(e,!0))},{}),Ec=(Object.defineProperty(tt,"__esModule",{value:!0}),tt.getPendableFormatState=void 0,t),Cc=(tt.getPendableFormatState=function(e,t){var n=e.api.getSelectionRange(e,!0),r=e.pendingFormatState.pendableFormatState,o=null==(o=e.pendingFormatState.pendableFormatPosition)?void 0:o.normalize(),i=n&&Ec.Position.getStart(n).normalize(),o=i&&n.collapsed&&i.equalTo(o);{if(n&&r&&o&&!t)return r;if(i){for(var a=e,l=i.node,s={},c=[];(0,Ec.contains)(a.contentDiv,l);)!function(){var t=(0,Ec.getTagOfNode)(l),n=1==l.nodeType&&l.style;t&&n&&Object.keys(Cc).forEach(function(e){0<=c.indexOf(e)||(s[e]=s[e]||Cc[e](t,n),wc[e](n)&&c.push(e))}),l=l.parentNode}();return s}return{}}},{isBold:function(e,t){return"B"==e||"STRONG"==e||700<=parseInt(t.fontWeight)||0<=["bold","bolder"].indexOf(t.fontWeight)},isUnderline:function(e,t){return"U"==e||0<=t.textDecoration.indexOf("underline")},isItalic:function(e,t){return"I"==e||"EM"==e||"italic"===t.fontStyle},isSubscript:function(e,t){return"SUB"==e||"sub"===t.verticalAlign},isSuperscript:function(e,t){return"SUP"==e||"super"===t.verticalAlign},isStrikeThrough:function(e,t){return"S"==e||"STRIKE"==e||0<=t.textDecoration.indexOf("line-through")}}),wc={isBold:function(e){return""!==e.fontWeight&&parseInt(e.fontWeight)<700||"normal"===e.fontWeight},isUnderline:function(e){return""!==e.textDecoration&&e.textDecoration.indexOf("underline")<0},isItalic:function(e){return""!==e.fontStyle&&"italic"!==e.fontStyle},isSubscript:function(e){return""!==e.verticalAlign&&"sub"!==e.verticalAlign},isSuperscript:function(e){return""!==e.verticalAlign&&"super"!==e.verticalAlign},isStrikeThrough:function(e){return""!==e.textDecoration&&e.textDecoration.indexOf("line-through")<0}},Lt={},Sc=(Object.defineProperty(Lt,"__esModule",{value:!0}),Lt.getSelectionRange=void 0,t),nt=(Lt.getSelectionRange=function(e,t){var n,r=null;return e.lifecycle.shadowEditFragment?e.lifecycle.shadowEditSelectionPath&&(0,Sc.createRange)(e.contentDiv,e.lifecycle.shadowEditSelectionPath.start,e.lifecycle.shadowEditSelectionPath.end):(t&&!e.api.hasFocus(e)||(n=null==(n=e.contentDiv.ownerDocument.defaultView)?void 0:n.getSelection())&&0<n.rangeCount&&(n=n.getRangeAt(0),(0,Sc.contains)(e.contentDiv,n)&&(r=n)),!r&&t?e.domEvent.selectionRange:r)},{}),xc=(Object.defineProperty(nt,"__esModule",{value:!0}),nt.getSelectionRangeEx=void 0,t);function Tc(e){return{type:0,ranges:e,areAllCollapsed:Oc(e)}}function Oc(e){return e.filter(function(e){return null==e?void 0:e.collapsed}).length==e.length}nt.getSelectionRangeEx=function(t){if(t.lifecycle.shadowEditFragment){var e=t.lifecycle,n=e.shadowEditTableSelectionPath,e=e.shadowEditSelectionPath;if(0<(null==n?void 0:n.length))return{type:1,ranges:n=t.lifecycle.shadowEditTableSelectionPath.map(function(e){return(0,xc.createRange)(t.contentDiv,e.start,e.end)}),areAllCollapsed:Oc(n),table:(0,xc.findClosestElementAncestor)(n[0].startContainer,t.contentDiv,"table"),coordinates:null};var n=e&&(0,xc.createRange)(t.contentDiv,e.start,e.end);return Tc(n?[n]:[])}if(t.api.hasFocus(t)){if(t.domEvent.tableSelectionRange)return t.domEvent.tableSelectionRange;n=null==(e=t.contentDiv.ownerDocument.defaultView)?void 0:e.getSelection();if(n&&0<n.rangeCount){e=n.getRangeAt(0);if((0,xc.contains)(t.contentDiv,e))return Tc([e])}}return null!=(n=t.domEvent.tableSelectionRange)?n:Tc(t.domEvent.selectionRange?[t.domEvent.selectionRange]:[])};var tn={},Pc=(Object.defineProperty(tn,"__esModule",{value:!0}),tn.getStyleBasedFormatState=void 0,t),rt=(tn.getStyleBasedFormatState=function(e,t){if(!t)return{};var n=t?(0,Pc.getComputedStyles)(t):[],r=e.lifecycle.isDarkMode,e=e.contentDiv,o=r&&(0,Pc.findClosestElementAncestor)(t,e,"[data-ogsc],[data-ogac]"),r=r&&(0,Pc.findClosestElementAncestor)(t,e,"[data-ogsb],[data-ogab]");return{fontName:n[0],fontSize:n[1],textColor:n[2],backgroundColor:n[3],textColors:o?{darkModeColor:n[2],lightModeColor:o.dataset.ogsc||o.dataset.ogac}:void 0,backgroundColors:r?{darkModeColor:n[3],lightModeColor:r.dataset.ogsb||r.dataset.ogab}:void 0}},{}),_c=(Object.defineProperty(rt,"__esModule",{value:!0}),rt.hasFocus=void 0,t),et=(rt.hasFocus=function(e){var t=e.contentDiv.ownerDocument.activeElement;return t&&(0,_c.contains)(e.contentDiv,t,!0)},{}),kc=(Object.defineProperty(et,"__esModule",{value:!0}),et.insertNode=void 0,t),Jt=(et.insertNode=function(l,s,c){c=c||{position:3,insertOnNewLine:!1,updateCursor:!0,replaceSelection:!0};var d=l.contentDiv;return c.updateCursor&&l.api.focus(l),4==c.position?d.parentNode.insertBefore(s,d.nextSibling):l.api.transformColor(l,s,!0,function(){switch(c.position){case 0:case 1:var e=0==c.position,t=(0,kc.getFirstLastBlockElement)(d,e);t?(t=e?t.getStartNode():t.getEndNode(),c.insertOnNewLine||3==t.nodeType||(0,kc.isVoidHtmlElement)(t)?(0,kc.safeInstanceOf)(s,"DocumentFragment")?(a=(0,kc.toArray)(s.childNodes),t.parentNode.insertBefore(s,e?t:t.nextSibling)):a=t.parentNode.insertBefore(s,e?t:t.nextSibling):a=t.insertBefore(s,e?t.firstChild:null)):a=d.appendChild(s),a&&c.insertOnNewLine&&(e=Array.isArray(a)?a:[a],(0,kc.isBlockElement)(e[0])&&(0,kc.isBlockElement)(e[e.length-1])||(0,kc.wrap)(e));break;case 2:t=d.appendChild(s);t&&c.insertOnNewLine&&!(0,kc.isBlockElement)(t)&&(0,kc.wrap)(t);break;case 5:case 3:a=c,e=(e=l).api.getSelectionRange(e,!0),t=null,5==a.position?(t=e,e=a.range):e&&(t=e.cloneRange());var n={range:e,rangeToRestore:t},r=n.range,n=n.rangeToRestore;if(!r)return;c.replaceSelection&&!r.collapsed&&r.deleteContents();var o=kc.Position.getStart(r),i=void 0,o=c.insertOnNewLine&&(i=(0,kc.getBlockElementAtNode)(d,o.normalize().node))?new kc.Position(i.getEndNode(),-3):(0,kc.adjustInsertPosition)(d,s,o,r),i=11==s.nodeType?s.lastChild:s;(r=(0,kc.createRange)(o)).insertNode(s),c.updateCursor&&i&&(n=(0,kc.createRange)(new kc.Position(i,-3).normalize())),l.api.selectRange(l,n)}var a},0),!0},{}),m=(Object.defineProperty(Jt,"__esModule",{value:!0}),Jt.restoreUndoSnapshot=void 0,Jt.restoreUndoSnapshot=function(e,t){e.undo.hasNewContent&&t<0&&e.api.addUndoSnapshot(e,null,null,!1);t=e.undo.snapshotsService.move(t);if(t&&null!=t.html)try{e.undo.isRestoring=!0,e.api.setContent(e,t.html,!0,t.metadata)}finally{e.undo.isRestoring=!1}},{}),Lc=(Object.defineProperty(m,"__esModule",{value:!0}),m.selectRange=void 0,rt),Nc=t,l=(m.selectRange=function(e,t,n){return!(e.lifecycle.shadowEditSelectionPath||!(0,Nc.contains)(e.contentDiv,t)||((0,Nc.addRangeToSelection)(t,n),(0,Lc.hasFocus)(e)||(e.domEvent.selectionRange=t),t.collapsed&&(t=(n=e).contentDiv,i=n.pendingFormatState,e=n.api.getSelectionRange,i.pendableFormatState&&(r=t.ownerDocument,o=(0,Nc.getPendableFormatState)(r),Object.keys(Nc.PendableFormatCommandMap).forEach(function(e){!!i.pendableFormatState[e]!=o[e]&&r.execCommand(Nc.PendableFormatCommandMap[e],!1,null)}),t=e(n,!0),i.pendableFormatPosition=t&&Nc.Position.getStart(t))),0));var r,o,i},{}),Rc=(Object.defineProperty(l,"__esModule",{value:!0}),l.selectTable=void 0,t),Ic="tableStyle";function Ac(e,t){var n=e.ownerDocument;if(e.id)1<n.querySelectorAll("#"+e.id).length&&(e.removeAttribute("id"),Ac(e,t));else{for(var r=0,o=function(){return n.getElementById(t+r)},i=o();i;)i=o(),r++;e.id=t+r}}function Mc(e){return(!!e||0==e)&&-1<e}l.selectTable=function(e,t,r){var n,c,d,u,f,p,h,g,m,v,y,b,o,E,i,a,l,s=e.contentDiv,C=s.ownerDocument.getElementById(Ic+s.id);if(null!=(s=null==C?void 0:C.sheet)&&s.cssRules)for(;0<C.sheet.cssRules.length;)C.sheet.deleteRule(0);return function(){if(r){var e,t=r||{},n=t.firstCell,t=t.lastCell;if(n&&t)return(e=function(e){return Mc(e.x)&&Mc(e.y)})(n)&&e(t)}}()&&t?(Ac(t,"tableSelected"),Ac(e.contentDiv,"contentDiv_"),s=r,i=(n=e).contentDiv.ownerDocument,a="#"+n.contentDiv.id,c=t,d=a,u=s.firstCell.y,f=s.firstCell.x,p=s.lastCell.y,h=s.lastCell.x,g=[],v=m=null,b=!(y=""),a=new Rc.VTable(c),s=(0,Rc.toArray)(c.childNodes).filter(function(e){return-1<["THEAD","TBODY","TFOOT"].indexOf((0,Rc.getTagOfNode)(e))}),o=0,E=s.map(function(e){e={el:(0,Rc.getTagOfNode)(e),start:o,end:e.childNodes.length+o};return o=e.end,e}),a.cells.forEach(function(e,t){var n=0,r=0;v=m=null;for(var o,i=E.filter(function(e){return e.start<=t&&e.end>t})[0],a=i?">"+i.el+">":">",l=i&&t+1>=i.start?t+1-i.start:t+1,s=0;s<e.length;s++)e[s].td&&("TD"==(o=(0,Rc.getTagOfNode)(e[s].td))&&n++,"TH"==o&&r++,u<=t&&t<=p&&f<=s&&s<=h&&(b?b=!1:y.endsWith(",")||(y+=","),function(e){var n,r;e&&(n=(0,Rc.getStyles)(e),r=0,["background-color","background"].forEach(function(e){var t;-1<(null==(t=n[e])?void 0:t.indexOf("!important"))&&(t=n[e].indexOf("!"),n[e]=n[e].substring(0,t),r++)}),0<r&&(0,Rc.setStyles)(e,n))}(e[s].td),o=d+" #"+c.id+a+" tr:nth-child("+l+")>"+o+":nth-child("+("TD"==o?n:r)+")",y+=o,m=m||c.querySelector(o),v=c.querySelector(o)));m&&v&&((i=new Range).setStartBefore(m),i.setEndAfter(v),g.push(i))}),s={css:y+="{background-color: rgba(198,198,198,0.7) !important;}",ranges:g},a=s.css,s=s.ranges,(l=i.getElementById(Ic+n.contentDiv.id))||(l=i.createElement("style"),i.head.appendChild(l),l.id=Ic+n.contentDiv.id),l.sheet.insertRule(a),i=s,n=t,l=r.firstCell,n.rows.item(l.y)&&n.rows.item(l.y).cells.item(l.x)&&e.api.selectRange(e,(0,Rc.createRange)(new Rc.Position(t.rows.item(r.firstCell.y).cells.item(r.firstCell.x),0))),{type:1,ranges:i,table:t,areAllCollapsed:i.filter(function(e){return null==e?void 0:e.collapsed}).length==i.length,coordinates:r}):null};var _e={},Dc=(Object.defineProperty(_e,"__esModule",{value:!0}),_e.setContent=void 0,t),jc=t,Jn=(_e.setContent=function(e,t,n,r){var o=!1;if(e.contentDiv.innerHTML!=t){e.api.triggerEvent(e,{eventType:20,newContent:t},!0);var t=(0,jc.setHtmlWithMetadata)(e.contentDiv,t,e.trustedHTMLHandler),i=e,a=r=r||t;switch(null==a?void 0:a.type){case 0:var l=(0,Dc.createRange)(i.contentDiv,a.start,a.end);i.api.selectRange(i,l);break;case 1:l=(0,Dc.queryElements)(i.contentDiv,"#"+a.tableId)[0];l&&i.api.selectTable(i,l,a)}o=!0}t=e.lifecycle.isDarkMode;(!r&&t||r&&!!r.isDarkMode!=!!t)&&(e.api.transformColor(e,e.contentDiv,!1,null,t?0:1,!0),o=!0),n&&o&&e.api.triggerEvent(e,{eventType:7,source:"SetContent"},!1)},{}),Bc=(Object.defineProperty(Jn,"__esModule",{value:!0}),Jn.switchShadowEdit=void 0,t);Jn.switchShadowEdit=function(e,t){var n,r=e.lifecycle,o=e.contentDiv,i=r.shadowEditFragment,a=r.shadowEditSelectionPath,l=r.shadowEditTableSelectionPath,s=!!i;t?(s||(t=e.api.getSelectionRangeEx(e),a=(n=e.api.getSelectionRange(e,!0))&&(0,Bc.getSelectionPath)(o,n),l=1==(null==t?void 0:t.type)&&t.ranges.map(function(e){return(0,Bc.getSelectionPath)(o,e)}),i=e.contentDiv.ownerDocument.createDocumentFragment(),(0,Bc.moveChildNodes)(i,o),i.normalize(),e.api.triggerEvent(e,{eventType:17,fragment:i,selectionPath:a},!1),r.shadowEditFragment=i,r.shadowEditSelectionPath=a,r.shadowEditTableSelectionPath=l),(0,Bc.moveChildNodes)(o),o.appendChild(r.shadowEditFragment.cloneNode(!0))):(r.shadowEditFragment=null,r.shadowEditSelectionPath=null,s&&(e.api.triggerEvent(e,{eventType:18},!1),(0,Bc.moveChildNodes)(o),o.appendChild(i),e.api.focus(e),a&&e.api.selectRange(e,(0,Bc.createRange)(o,a.start,a.end)),e.domEvent.tableSelectionRange)&&(t=(n=e.domEvent.tableSelectionRange).table,l=n.coordinates,r=t.id,s=e.contentDiv.querySelector("#"+r),t&&(e.domEvent.tableSelectionRange=e.api.selectTable(e,s,l))))};or={};Object.defineProperty(or,"__esModule",{value:!0}),or.transformColor=void 0;var Fc=t,Hc=(0,[((r={})[0]="color",r[1]="color",r[2]="ogsc",r[3]="ogac",r),((o={})[0]="background-color",o[1]="bgcolor",o[2]="ogsb",o[3]="ogab",o)]);function zc(e,t){return e&&"undefined"!=e&&"null"!=e?e:t}function Uc(e){return!!e.style&&!!e.dataset}or.transformColor=function(t,e,n,r,o,i){var a,l,s,e=i||t.lifecycle.isDarkMode?(i=e,e=n,n=[],(0,Fc.safeInstanceOf)(i,"HTMLElement")?(e&&n.push(i),a=i.getElementsByTagName("*"),(0,Fc.arrayPush)(n,(0,Fc.toArray)(a))):(0,Fc.safeInstanceOf)(i,"DocumentFragment")&&(a=i.querySelectorAll("*"),(0,Fc.arrayPush)(n,(0,Fc.toArray)(a))),n.filter(Uc)):[];null!=r&&r(),1==o?e.forEach(function(n){Hc.forEach(function(e){n.style.setProperty(e[0],zc(n.dataset[e[2]],"")),delete n.dataset[e[2]];var t=n.dataset[e[3]];zc(t,null)?n.setAttribute(e[1],t):n.removeAttribute(e[1]),delete n.dataset[e[3]]})}):t.lifecycle.onExternalContentTransform?e.forEach(function(e){return t.lifecycle.onExternalContentTransform(e)}):(l=e,s=t.lifecycle.getDarkColor,Hc.forEach(function(i){l.map(function(e){var t=e.style.getPropertyValue(i[0]),n=e.getAttribute(i[1]),r=e.dataset[i[2]],o=e.dataset[i[3]];return r&&r!=t||o&&o!=n||!t&&!n||"inherit"==t?null:{element:e,styleColor:t,attrColor:n,newColor:s(t||n)}}).filter(function(e){return!!e}).forEach(function(e){var t=e.element,n=e.styleColor,r=e.attrColor,e=e.newColor;t.style.setProperty(i[0],e,"important"),t.dataset[i[2]]=n||"",r&&(t.setAttribute(i[1],e),t.dataset[i[3]]=r)})}))};var d={},Vc=(Object.defineProperty(d,"__esModule",{value:!0}),d.triggerEvent=void 0,[11,12,8,21]),Ne=(d.triggerEvent=function(e,r,t){e.lifecycle.shadowEditFragment&&!(0<=Vc.indexOf(r.eventType))||!t&&e.plugins.some(function(e){return t=r,!(!(e=e).onPluginEvent||null==(n=e.willHandleEventExclusively)||!n.call(e,t))&&(e.onPluginEvent(t),!0);var t,n})||e.plugins.forEach(function(e){e.onPluginEvent&&e.onPluginEvent(r)})},Object.defineProperty(F,"__esModule",{value:!0}),F.coreApiMap=void 0,H),it=(F.coreApiMap={attachDomEvent:n.attachDomEvent,addUndoSnapshot:Ne.addUndoSnapshot,createPasteFragment:u.createPasteFragment,ensureTypeInContainer:s.ensureTypeInContainer,focus:g.focus,getContent:f.getContent,getSelectionRange:Lt.getSelectionRange,getSelectionRangeEx:nt.getSelectionRangeEx,getStyleBasedFormatState:tn.getStyleBasedFormatState,getPendableFormatState:tt.getPendableFormatState,hasFocus:rt.hasFocus,insertNode:et.insertNode,restoreUndoSnapshot:Jt.restoreUndoSnapshot,selectRange:m.selectRange,setContent:_e.setContent,switchShadowEdit:Jn.switchShadowEdit,transformColor:or.transformColor,triggerEvent:d.triggerEvent,selectTable:l.selectTable},{}),sr={},Wc=(Object.defineProperty(sr,"__esModule",{value:!0}),t);function qc(e){var n=this;this.onPaste=function(e){var t;(0,Wc.extractClipboardEvent)(e,function(e){return n.editor.paste(e)},{allowLinkPreview:n.editor.isFeatureEnabled("PasteWithLinkPreview"),allowedCustomPasteType:n.state.allowedCustomPasteType,getTempDiv:function(){return t=n.editor.getSelectionRange(),n.getTempDiv()},removeTempDiv:function(e){n.cleanUpAndRestoreSelection(e,t,!1)}})},this.state={allowedCustomPasteType:e.allowedCustomPasteType||[]}}qc.prototype.getName=function(){return"CopyPaste"},qc.prototype.initialize=function(e){var t=this;this.editor=e,this.disposer=this.editor.addDomEventHandler({paste:this.onPaste,copy:function(e){return t.onCutCopy(e,!1)},cut:function(e){return t.onCutCopy(e,!0)}})},qc.prototype.dispose=function(){this.disposer(),this.disposer=null,this.editor=null},qc.prototype.getState=function(){return this.state},qc.prototype.onCutCopy=function(e,n){var r,t,o=this,i=this.editor.getSelectionRangeEx();i&&!i.areAllCollapsed&&(t=this.editor.getContent(2),r=this.getTempDiv(!0),(t=(0,Wc.setHtmlWithSelectionPath)(r,t,this.editor.getTrustedHTMLHandler()))&&(0,Wc.addRangeToSelection)(t),this.editor.triggerPluginEvent(9,{clonedRoot:r,range:t,rawEvent:e,isCut:n}),this.editor.runAsync(function(t){o.cleanUpAndRestoreSelection(r,i,!n),n&&t.addUndoSnapshot(function(){var e=o.editor.deleteSelectedContent();t.focus(),t.select(e)},"Cut")}))},qc.prototype.getTempDiv=function(e){var t=this,n=this.editor.getCustomData("CopyPasteTempDiv",function(){var e=(0,Wc.createElement)(3,t.editor.getDocument());return t.editor.insertNode(e,{position:4}),e},function(e){var t;return null==(t=e.parentNode)?void 0:t.removeChild(e)});return e&&(n.style.backgroundColor="white",n.style.color="black"),n.style.display="",n.focus(),n},qc.prototype.cleanUpAndRestoreSelection=function(e,t,n){var r;if(null!=(r=t)&&r.type||0==t.type){var o=t;switch(o.type){case 1:this.editor.select(o.table,o.coordinates);break;case 0:var i=null==(i=o.ranges)?void 0:i[0];this.restoreRange(i,n)}}else this.restoreRange(t,n);e.style.backgroundColor="",e.style.color="",e.style.display="none",(0,Wc.moveChildNodes)(e)},qc.prototype.restoreRange=function(e,t){e&&(t&&Wc.Browser.isAndroid&&e.collapse(),this.editor.select(e))},sr.default=qc;var a={},Kc=(Object.defineProperty(a,"__esModule",{value:!0}),t);function Zc(e,t){var o=this;this.onDrop=function(e){o.editor.runAsync(function(e){e.addUndoSnapshot(function(){},"Drop")})},this.onFocus=function(){var e=o.state.tableSelectionRange||{},t=e.table,e=e.coordinates;t&&e?o.editor.select(t,e):o.editor.select(o.state.selectionRange),o.state.selectionRange=null},this.onKeyDownDocument=function(e){9!=e.which||e.defaultPrevented||o.cacheSelection()},this.onMouseDownDocument=function(e){o.state.selectionRange||o.editor.contains(e.target)||o.cacheSelection()},this.cacheSelection=function(){o.state.selectionRange||(o.state.selectionRange=o.editor.getSelectionRange(!1))},this.onScroll=function(e){o.editor.triggerPluginEvent(14,{rawEvent:e,scrollContainer:o.state.scrollContainer})},this.onKeyboardEvent=function(e){(0,Kc.isCharacterValue)(e)&&e.stopPropagation()},this.onInputEvent=function(e){e.stopPropagation()},this.onContextMenuEvent=function(e){var t=[],n=o.editor.getContentSearcherOfCursor(),n=null==n?void 0:n.getInlineElementBefore(),r=e.target;2!=e.button&&(r=null==n?void 0:n.getContainerNode()),o.state.contextMenuProviders.forEach(function(e){e=e.getContextMenuItems(r);0<(null==e?void 0:e.length)&&(0<t.length&&t.push(null),(0,Kc.arrayPush)(t,e))}),o.editor.triggerPluginEvent(16,{rawEvent:e,items:t})},this.state={isInIME:!1,scrollContainer:e.scrollContainer||t,selectionRange:null,stopPrintableKeyboardEventPropagation:!e.allowKeyboardEventPropagation,contextMenuProviders:(null==(t=e.plugins)?void 0:t.filter(Gc))||[],tableSelectionRange:null}}function Gc(e){return!(null==(e=e)||!e.getContextMenuItems)}Zc.prototype.getName=function(){return"DOMEvent"},Zc.prototype.initialize=function(t){var e,n,r=this,o=(this.editor=t,this.editor.getDocument());(n={keypress:this.getEventHandler(1),keydown:this.getEventHandler(0),keyup:this.getEventHandler(2),mousedown:5,contextmenu:this.onContextMenuEvent,compositionstart:function(){return r.state.isInIME=!0},compositionend:function(e){r.state.isInIME=!1,t.triggerPluginEvent(4,{rawEvent:e})},drop:this.onDrop,focus:this.onFocus})[Kc.Browser.isIE?"textinput":"input"]=this.getEventHandler(3);Kc.Browser.isSafari?(o.addEventListener("mousedown",this.onMouseDownDocument,!0),o.addEventListener("keydown",this.onKeyDownDocument),null!=(e=o.defaultView)&&e.addEventListener("blur",this.cacheSelection)):n[Kc.Browser.isIEOrEdge?"beforedeactivate":"blur"]=this.cacheSelection,this.disposer=t.addDomEventHandler(n),this.state.scrollContainer.addEventListener("scroll",this.onScroll),null!=(e=o.defaultView)&&e.addEventListener("scroll",this.onScroll),null!=(n=o.defaultView)&&n.addEventListener("resize",this.onScroll)},Zc.prototype.dispose=function(){var e,t=this.editor.getDocument();Kc.Browser.isSafari&&(t.removeEventListener("mousedown",this.onMouseDownDocument,!0),t.removeEventListener("keydown",this.onKeyDownDocument),null!=(e=t.defaultView)&&e.removeEventListener("blur",this.cacheSelection)),null!=(e=t.defaultView)&&e.removeEventListener("resize",this.onScroll),null!=(e=t.defaultView)&&e.removeEventListener("scroll",this.onScroll),this.state.scrollContainer.removeEventListener("scroll",this.onScroll),this.disposer(),this.disposer=null,this.editor=null},Zc.prototype.getState=function(){return this.state},Zc.prototype.getEventHandler=function(e){return this.state.stopPrintableKeyboardEventPropagation?{pluginEventType:e,beforeDispatch:3==e?this.onInputEvent:this.onKeyboardEvent}:e},a.default=Zc;var Q={},$c=(Object.defineProperty(Q,"__esModule",{value:!0}),t);function Xc(){this.state={features:{}}}Xc.prototype.getName=function(){return"Edit"},Xc.prototype.initialize=function(e){this.editor=e},Xc.prototype.dispose=function(){this.editor=null},Xc.prototype.getState=function(){return this.state},Xc.prototype.onPluginEvent=function(e){var t,n,r,o=!1,i=!1;0==e.eventType?(t=e.rawEvent,n=this.editor.getSelectionRange(),o=(i=(0,$c.isCtrlOrMetaPressed)(t))||t.altKey,r=this.state.features[t.which]||n&&!n.collapsed&&this.state.features[258]):7==e.eventType&&(r=this.state.features[257]);for(var a=0;a<(null==r?void 0:r.length);a++){var l=r[a];if((l.allowFunctionKeys||!o)&&l.shouldHandleEvent(e,this.editor,i)){l.handleEvent(e,this.editor);break}}},Q.default=Xc;var cr={},Yc=(Object.defineProperty(cr,"__esModule",{value:!0}),t),Qc=/_(\d{1,8})$/,Jc=["^_Entity$","^_EId_","^_EType_","^_EReadonly_"],ed=[6,7,4,5];function P(){var n=this;this.handleCutEvent=function(e){var t=n.editor.getSelectionRange();t&&!t.collapsed&&n.checkRemoveEntityForRange(e)},this.state={knownEntityElements:[],shadowEntityCache:{}}}P.prototype.getName=function(){return"Entity"},P.prototype.initialize=function(e){this.editor=e},P.prototype.willHandleEventExclusively=function(e){return 1==e.eventType&&!(null==(e=e.rawEvent.target)||!e.shadowRoot)},P.prototype.dispose=function(){this.editor=null,this.state.knownEntityElements=[]},P.prototype.getState=function(){return this.state},P.prototype.onPluginEvent=function(e){switch(e.eventType){case 6:this.handleMouseUpEvent(e);break;case 0:this.handleKeyDownEvent(e.rawEvent);break;case 9:e.isCut&&this.handleCutEvent(e.rawEvent);break;case 10:this.handleBeforePasteEvent(e.sanitizingOption);break;case 7:this.handleContentChangedEvent(e);break;case 11:this.handleContentChangedEvent();break;case 8:this.handleExtractContentWithDomEvent(e.clonedRoot);break;case 16:this.handleContextMenuEvent(e.rawEvent);break;case 20:this.handleBeforeSetContentEvent();break;case 15:this.handleEntityOperationEvent(e)}},P.prototype.handleContextMenuEvent=function(e){var t=e.target,t=t&&this.editor.getElementAtCursor((0,Yc.getEntitySelector)(),t);t&&(e.preventDefault(),this.triggerEvent(t,2,e))},P.prototype.handleMouseUpEvent=function(e){var t=e.rawEvent,e=e.isClicking,n=t.target;e&&n&&(e=this.editor.getElementAtCursor((0,Yc.getEntitySelector)(),n))&&(this.triggerEvent(e,1,t),td(this.editor))},P.prototype.handleKeyDownEvent=function(e){var t;!(0,Yc.isCharacterValue)(e)&&8!=e.which&&46!=e.which&&13!=e.which||(t=this.editor.getSelectionRange())&&!t.collapsed&&this.checkRemoveEntityForRange(e)},P.prototype.handleBeforePasteEvent=function(e){this.editor.getSelectionRange().collapsed||this.checkRemoveEntityForRange(null),(0,Yc.arrayPush)(e.additionalAllowedCssClasses,Jc)},P.prototype.handleBeforeSetContentEvent=function(){this.cacheShadowEntities(this.state.shadowEntityCache)},P.prototype.handleContentChangedEvent=function(e){for(var i=this,t=this.state.knownEntityElements.length-1;0<=t;t--){var n=this.state.knownEntityElements[t];this.editor.contains(n)||(this.setIsEntityKnown(n,!1),n.shadowRoot&&this.triggerEvent(n,10))}var a=this.state.knownEntityElements.map(function(e){return null==(e=(0,Yc.getEntityFromElement)(e))?void 0:e.id}).filter(function(e){return!!e});("InsertEntity"==(null==e?void 0:e.source)&&e.data?[e.data]:this.getExistingEntities().filter(function(e){e=e.wrapper;return!i.isEntityKnown(e)})).forEach(function(e){var t=e.wrapper,n=e.type,r=e.id,o=e.isReadonly;e.id=i.ensureUniqueId(n,r,a),(0,Yc.commitEntity)(t,n,o,e.id),i.handleNewEntity(e)}),Object.keys(this.state.shadowEntityCache).forEach(function(e){i.triggerEvent(i.state.shadowEntityCache[e],6),delete i.state.shadowEntityCache[e]})},P.prototype.handleEntityOperationEvent=function(e){var t=this;0<=ed.indexOf(e.operation)&&(null!=(e=this.cancelAsyncRun)&&e.call(this),this.cancelAsyncRun=this.editor.runAsync(function(){t.cancelAsyncRun=null,t.handleContentChangedEvent()}))},P.prototype.handleExtractContentWithDomEvent=function(e){var t=this;(0,Yc.toArray)(e.querySelectorAll((0,Yc.getEntitySelector)())).forEach(function(e){e.removeAttribute("contentEditable"),t.triggerEvent(e,8)})},P.prototype.checkRemoveEntityForRange=function(n){var r,o=this,t=[],e=(0,Yc.getEntitySelector)();this.editor.queryElements(e,1,function(e){e.isContentEditable?t.push(e):o.triggerEvent(e,6,n)}),0<t.length&&(r=this.editor.queryElements(e,2),t.forEach(function(e){var t=0<=r.indexOf(e);o.triggerEvent(e,t?6:7,n)}))},P.prototype.triggerEvent=function(e,t,n,r){e=e&&(0,Yc.getEntityFromElement)(e);e&&this.editor.triggerPluginEvent(15,{operation:t,rawEvent:n,entity:e,contentForShadowEntity:r})},P.prototype.handleNewEntity=function(e){var t=e.wrapper,n=this.editor.getDocument().createDocumentFragment(),r=this.state.shadowEntityCache[e.id];delete this.state.shadowEntityCache[e.id],null!=r&&r.shadowRoot&&(0,Yc.moveChildNodes)(n,r.shadowRoot),this.triggerEvent(t,0,void 0,n),n.firstChild?t.shadowRoot?(0,Yc.moveChildNodes)(t.shadowRoot,n):this.createShadowRoot(t,n):t.shadowRoot&&(this.triggerEvent(t,10),r=t.cloneNode(),(0,Yc.moveChildNodes)(r,t),this.editor.replaceNode(t,r),e.wrapper=r),this.setIsEntityKnown(e.wrapper,!0)},P.prototype.getExistingEntities=function(t){return this.editor.queryElements((0,Yc.getEntitySelector)()).map(Yc.getEntityFromElement).filter(function(e){return!(!e||t&&!e.wrapper.shadowRoot)})},P.prototype.createShadowRoot=function(e,t){var n;if(e.attachShadow)return n=e.attachShadow({mode:"open",delegatesFocus:!0}),e.contentEditable="false",this.triggerEvent(e,9),(0,Yc.moveChildNodes)(n,t),n},P.prototype.cacheShadowEntities=function(n){this.getExistingEntities(!0).forEach(function(e){var t=e.wrapper,e=e.id;n[e]=t})},P.prototype.ensureUniqueId=function(e,t,n){for(var r=Qc.exec(t),o=(r?t.substr(0,t.length-r[0].length):t)||e,i="",a=r&&parseInt(r[1])||0;;a++)if(n.indexOf(i=0<a?o+"_"+a:o)<0){n.push(i);break}return i},P.prototype.setIsEntityKnown=function(e,t){var n=this.state.knownEntityElements.indexOf(e);t&&n<0?this.state.knownEntityElements.push(e):!t&&0<=n&&this.state.knownEntityElements.splice(n,1)},P.prototype.isEntityKnown=function(e){return 0<=this.state.knownEntityElements.indexOf(e)},cr.default=P;var td=Yc.Browser.isIE?function(e){e.runAsync(function(t){var e=t.getCustomData("ENTITY_IE_FOCUS_BUTTON",function(){var e=(0,Yc.createElement)({tag:"button",style:"overflow:hidden;position:fixed;width:0;height:0;top:-1000px"},t.getDocument());return e.onblur=function(){e.style.display="none"},t.insertNode(e,{position:4}),e});(e.style.display="",Yc.addRangeToSelection)((0,Yc.createRange)(e,0))})}:function(){},ae={},nd=(Object.defineProperty(ae,"__esModule",{value:!0}),t),rd="contenteditable",od=nd.Browser.isFirefox?((gr={}).enableObjectResizing=!1,gr.enableInlineTableEditing=!1,gr):nd.Browser.isIE?((mr={}).defaultParagraphSeparator="div",mr.AutoUrlDetect=!1,mr):{},id={darkModeColor:"rgb(51,51,51)",lightModeColor:"rgb(255,255,255)"},ad={darkModeColor:"rgb(255,255,255)",lightModeColor:"rgb(0,0,0)"};function ld(e,n){var r=this;this.initialContent=e.initialContent||n.innerHTML||"",this.contentDivFormat=(0,nd.getComputedStyles)(n),null===n.getAttribute(rd)&&(this.initializer=function(){n.contentEditable="true",n.style.userSelect="text",n.style.webkitUserSelect="text"},this.disposer=function(){n.style.userSelect="",n.style.webkitUserSelect="",n.removeAttribute(rd)}),this.adjustColor=e.doNotAdjustEditorColor?function(){}:function(){var e=id,t=r.state.isDarkMode;(0,nd.setColor)(n,ad,!1,t),(0,nd.setColor)(n,e,!0,t)},this.state={customData:{},defaultFormat:e.defaultFormat||null,isDarkMode:!!e.inDarkMode,getDarkColor:e.getDarkColor||function(e){return e},onExternalContentTransform:e.onExternalContentTransform,experimentalFeatures:e.experimentalFeatures||[],shadowEditFragment:null,shadowEditSelectionPath:null,shadowEditTableSelectionPath:null}}ld.prototype.getName=function(){return"Lifecycle"},ld.prototype.initialize=function(e){this.editor=e,this.recalculateDefaultFormat(),this.editor.setContent(this.initialContent,!1),null!=(e=this.initializer)&&e.call(this),this.adjustColor(),this.adjustBrowserBehavior(),this.editor.triggerPluginEvent(11,{},!0)},ld.prototype.dispose=function(){var n=this;this.editor.triggerPluginEvent(12,{},!0),Object.keys(this.state.customData).forEach(function(e){var t=n.state.customData[e];t&&t.disposer&&t.disposer(t.value),delete n.state.customData[e]}),this.disposer&&(this.disposer(),this.disposer=null,this.initializer=null),this.editor=null},ld.prototype.getState=function(){return this.state},ld.prototype.onPluginEvent=function(e){7!=e.eventType||"SwitchToDarkMode"!=e.source&&"SwitchToLightMode"!=e.source||(this.state.isDarkMode="SwitchToDarkMode"==e.source,this.recalculateDefaultFormat(),this.adjustColor())},ld.prototype.adjustBrowserBehavior=function(){var t=this;Object.keys(od).forEach(function(e){try{t.editor.getDocument().execCommand(e,!1,od[e])}catch(e){}})},ld.prototype.recalculateDefaultFormat=function(){var e,t,n,r,o,i,a,l,s=this.state,c=s.defaultFormat,d=s.isDarkMode;d&&c&&(c.backgroundColors||(c.backgroundColors=id),c.textColors||(c.textColors=ad)),c&&0===Object.keys(c).length||(c=(s=c||{}).fontFamily,e=s.fontSize,t=s.textColor,n=s.textColors,r=s.backgroundColor,o=s.backgroundColors,i=s.bold,a=s.italic,s=s.underline,l=this.contentDivFormat,this.state.defaultFormat={fontFamily:c||l[0],fontSize:e||l[1],get textColor(){return n?d?n.darkModeColor:n.lightModeColor:t||l[2]},textColors:n,get backgroundColor(){return o?d?o.darkModeColor:o.lightModeColor:r||""},backgroundColors:o,bold:i,italic:a,underline:s})},ae.default=ld;V={};function sd(){var t=this;this.onMouseUp=function(e){t.editor&&(t.removeMouseUpEventListener(),t.editor.triggerPluginEvent(6,{rawEvent:e,isClicking:t.mouseDownX==e.pageX&&t.mouseDownY==e.pageY}))}}Object.defineProperty(V,"__esModule",{value:!0}),sd.prototype.getName=function(){return"MouseUp"},sd.prototype.initialize=function(e){this.editor=e},sd.prototype.dispose=function(){this.removeMouseUpEventListener(),this.editor=null},sd.prototype.onPluginEvent=function(e){5!=e.eventType||this.mouseUpEventListerAdded||(this.editor.getDocument().addEventListener("mouseup",this.onMouseUp,!0),this.mouseUpEventListerAdded=!0,this.mouseDownX=e.rawEvent.pageX,this.mouseDownY=e.rawEvent.pageY)},sd.prototype.removeMouseUpEventListener=function(){this.mouseUpEventListerAdded&&(this.mouseUpEventListerAdded=!1,this.editor.getDocument().removeEventListener("mouseup",this.onMouseUp,!0))},V.default=sd;var y={},cd=(Object.defineProperty(y,"__esModule",{value:!0}),t);function dd(){}dd.prototype.getName=function(){return"NormalizeTable"},dd.prototype.initialize=function(e){this.editor=e},dd.prototype.dispose=function(){this.editor=null},dd.prototype.onPluginEvent=function(e){switch(e.eventType){case 11:case 7:this.normalizeTables(this.editor.queryElements("table"));break;case 10:this.normalizeTables((0,cd.toArray)(e.fragment.querySelectorAll("table")));break;case 5:this.normalizeTableFromEvent(e.rawEvent);break;case 0:e.rawEvent.shiftKey&&this.normalizeTableFromEvent(e.rawEvent)}},dd.prototype.normalizeTableFromEvent=function(e){e=this.editor.getElementAtCursor("table",e.target);e&&this.normalizeTables([e])},dd.prototype.normalizeTables=function(e){var t,n,r,o,i,a;0<e.length&&(n=(i=0==(null==(t=this.editor.getSelectionRangeEx())?void 0:t.type)&&t.ranges[0]||{}).startContainer,r=i.endContainer,o=i.startOffset,i=i.endOffset,a=!1,e.forEach(function(e){for(var t=null,n=e.firstChild;n;n=n.nextSibling)switch((0,cd.getTagOfNode)(n)){case"TR":t||(t=e.ownerDocument.createElement("tbody"),e.insertBefore(t,n)),t.appendChild(n),n=t,a=!0;break;case"TBODY":t?((0,cd.moveChildNodes)(t,n,!0),n.parentNode.removeChild(n),n=t,a=!0):t=n;break;case"COLGROUP":e.tHead&&e.tHead.prepend(n);break;default:t=null}}),a&&(n&&r?this.editor.select(n,o,r,i):1==(null==t?void 0:t.type)&&this.editor.select(t.table,t.coordinates)))},y.default=dd;var Oe={},ud=(Object.defineProperty(Oe,"__esModule",{value:!0}),t);function fd(){this.state={pendableFormatPosition:null,pendableFormatState:null}}fd.prototype.getName=function(){return"PendingFormatState"},fd.prototype.initialize=function(e){this.editor=e},fd.prototype.dispose=function(){this.editor=null,this.clear()},fd.prototype.getState=function(){return this.state},fd.prototype.onPluginEvent=function(e){switch(e.eventType){case 13:this.state.pendableFormatPosition=this.getCurrentPosition(),this.state.pendableFormatState=e.formatState;break;case 0:case 5:case 7:this.state.pendableFormatPosition&&!this.state.pendableFormatPosition.equalTo(this.getCurrentPosition())&&this.clear()}},fd.prototype.clear=function(){this.state.pendableFormatPosition=null,this.state.pendableFormatState=null},fd.prototype.getCurrentPosition=function(){var e=this.editor.getSelectionRange();return e&&ud.Position.getStart(e).normalize()},Oe.default=fd;var p={},pd=(Object.defineProperty(p,"__esModule",{value:!0}),t);function hd(){}hd.prototype.getName=function(){return"TypeInContainer"},hd.prototype.initialize=function(e){this.editor=e},hd.prototype.dispose=function(){this.editor=null},hd.prototype.onPluginEvent=function(t){var e;1==t.eventType&&(e=this.editor.getSelectionRange())&&!this.editor.contains((0,pd.findClosestElementAncestor)(e.startContainer,null,"[style]"))&&(e.collapsed?this.editor.ensureTypeInContainer(pd.Position.getStart(e),t.rawEvent):this.editor.runAsync(function(e){e.ensureTypeInContainer(e.getFocusedPosition(),t.rawEvent)}))},p.default=hd;var zt={},gd=(Object.defineProperty(zt,"__esModule",{value:!0}),t);function md(e){var n,r;this.state={snapshotsService:e.undoMetadataSnapshotService||((r=e.undoSnapshotService)?{canMove:function(e){return r.canMove(e)},move:function(e){return{html:r.move(e),metadata:null}},addSnapshot:function(e,t){return r.addSnapshot(e.html+(e.metadata?"\x3c!--"+JSON.stringify(e.metadata)+"--\x3e":""),t)},clearRedo:function(){return r.clearRedo()},canUndoAutoComplete:function(){return r.canUndoAutoComplete()}}:void 0)||(n=(0,gd.createSnapshots)(1e7),{canMove:function(e){return(0,gd.canMoveCurrentSnapshot)(n,e)},move:function(e){return(0,gd.moveCurrentSnapshot)(n,e)},addSnapshot:function(e,t){return(0,gd.addSnapshotV2)(n,e,t)},clearRedo:function(){return(0,gd.clearProceedingSnapshotsV2)(n)},canUndoAutoComplete:function(){return(0,gd.canUndoAutoComplete)(n)}}),isRestoring:!1,hasNewContent:!1,isNested:!1,autoCompletePosition:null}}md.prototype.getName=function(){return"Undo"},md.prototype.initialize=function(e){this.editor=e},md.prototype.dispose=function(){this.editor=null},md.prototype.getState=function(){return this.state},md.prototype.willHandleEventExclusively=function(e){return 0==e.eventType&&8==e.rawEvent.which&&this.canUndoAutoComplete()},md.prototype.onPluginEvent=function(e){if(this.editor&&!this.editor.isInIME())switch(e.eventType){case 11:var t=this.editor.getUndoState();t.canUndo||t.canRedo||this.addUndoSnapshot();break;case 0:this.onKeyDown(e.rawEvent);break;case 1:this.onKeyPress(e.rawEvent);break;case 4:this.clearRedoForInput(),this.addUndoSnapshot();break;case 7:this.state.isRestoring||"SwitchToDarkMode"==e.source||"SwitchToLightMode"==e.source||this.clearRedoForInput()}},md.prototype.onKeyDown=function(e){var t;8==e.which||46==e.which?(8==e.which&&this.canUndoAutoComplete()?(e.preventDefault(),this.editor.undo(),this.state.autoCompletePosition=null):(!(t=this.editor.getSelectionRange())||t.collapsed&&this.lastKeyPress==e.which&&!(0,gd.isCtrlOrMetaPressed)(e)||this.addUndoSnapshot(),this.state.hasNewContent=!0),this.lastKeyPress=e.which):33<=e.which&&e.which<=40&&(this.state.hasNewContent&&this.addUndoSnapshot(),this.lastKeyPress=0)},md.prototype.onKeyPress=function(e){var t;e.metaKey||((t=this.editor.getSelectionRange())&&!t.collapsed||32==e.which&&32!=this.lastKeyPress||13==e.which?(this.addUndoSnapshot(),13==e.which&&(this.state.hasNewContent=!0)):this.clearRedoForInput(),this.lastKeyPress=e.which)},md.prototype.clearRedoForInput=function(){this.state.snapshotsService.clearRedo(),this.lastKeyPress=0,this.state.hasNewContent=!0},md.prototype.canUndoAutoComplete=function(){var e;return this.state.snapshotsService.canUndoAutoComplete()&&(null==(e=this.state.autoCompletePosition)?void 0:e.equalTo(this.editor.getFocusedPosition()))},md.prototype.addUndoSnapshot=function(){this.editor.addUndoSnapshot(),this.state.autoCompletePosition=null},zt.default=md,Object.defineProperty(it,"__esModule",{value:!0}),it.getPluginState=void 0;var vd,yd=sr,bd=a,Ed=Q,Cd=cr,wd=ae,Sd=V,xd=y,Td=Oe,Od=p,Pd=zt,_d=(it.default=function(e,t){var n=t.corePluginOverride||{};return{typeInContainer:n.typeInContainer||new Od.default,edit:n.edit||new Ed.default,pendingFormatState:n.pendingFormatState||new Td.default,_placeholder:null,typeAfterLink:null,undo:n.undo||new Pd.default(t),domEvent:n.domEvent||new bd.default(t,e),mouseUp:n.mouseUp||new Sd.default,copyPaste:n.copyPaste||new yd.default(t),entity:n.entity||new Cd.default,normalizeTable:n.normalizeTable||new xd.default,lifecycle:n.lifecycle||new wd.default(t,e)}},it.getPluginState=function(e){return{domEvent:e.domEvent.getState(),pendingFormatState:e.pendingFormatState.getState(),edit:e.edit.getState(),lifecycle:e.lifecycle.getState(),undo:e.undo.getState(),entity:e.entity.getState(),copyPaste:e.copyPaste.getState()}},e&&e.__assign||function(){return(_d=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)}),kd=(Object.defineProperty(B,"__esModule",{value:!0}),F),Ld=it,_=t;function k(e,t){var n=this;if(void 0===t&&(t={}),"DIV"!=(0,_.getTagOfNode)(e))throw new Error("contentDiv must be an HTML DIV element");var r=(0,Ld.default)(e,t),o=[],i=(Object.keys(r).forEach(function(e){"_placeholder"==e?(0,_.arrayPush)(o,t.plugins):o.push(r[e])}),0<t.zoomScale?t.zoomScale:1);this.core=_d(_d({contentDiv:e,api:_d(_d({},kd.coreApiMap),t.coreApiOverride||{}),originalApi:kd.coreApiMap,plugins:o.filter(function(e){return!!e})},(0,Ld.getPluginState)(r)),{trustedHTMLHandler:t.trustedHTMLHandler||function(e){return e},zoomScale:i,sizeTransformer:t.sizeTransformer||function(e){return e/i}}),this.core.plugins.forEach(function(e){return e.initialize(n)}),this.ensureTypeInContainer(new _.Position(this.core.contentDiv,0).normalize())}k.prototype.dispose=function(){for(var e=this.core.plugins.length-1;0<=e;e--)this.core.plugins[e].dispose();this.core=null},k.prototype.isDisposed=function(){return!this.core},k.prototype.insertNode=function(e,t){return!!e&&this.core.api.insertNode(this.core,e,t)},k.prototype.deleteNode=function(e){return!(!e||!this.contains(e)||(e.parentNode.removeChild(e),0))},k.prototype.replaceNode=function(e,t,n){return!(!this.contains(e)||!t||(this.core.api.transformColor(this.core,n?t:null,!0,function(){return e.parentNode.replaceChild(t,e)},0),0))},k.prototype.getBlockElementAtNode=function(e){return(0,_.getBlockElementAtNode)(this.core.contentDiv,e)},k.prototype.contains=function(e){return(0,_.contains)(this.core.contentDiv,e)},k.prototype.queryElements=function(t,e,n){var r=this,o=[],i=(e=void 0===e?0:e)instanceof Function?0:e,e=(n=e instanceof Function?e:n,0==i?null:this.getSelectionRangeEx());return e?(e.ranges.forEach(function(e){o.push.apply(o,(0,_.queryElements)(r.core.contentDiv,t,n,i,e))}),o):(0,_.queryElements)(this.core.contentDiv,t,n,i,null)},k.prototype.collapseNodes=function(e,t,n){return(0,_.collapseNodes)(this.core.contentDiv,e,t,n)},k.prototype.isEmpty=function(e){return(0,_.isNodeEmpty)(this.core.contentDiv,e)},k.prototype.getContent=function(e){return this.core.api.getContent(this.core,e=void 0===e?0:e)},k.prototype.setContent=function(e,t){this.core.api.setContent(this.core,e,t=void 0===t?!0:t)},k.prototype.insertContent=function(e,t){var n,r;e&&(n=this.getDocument(),e=null!=(e=null==(e=(new DOMParser).parseFromString(this.core.trustedHTMLHandler(e),"text/html"))?void 0:e.body)&&e.childNodes?(0,_.toArray)(e.childNodes):[],t&&t.insertOnNewLine&&1<e.length&&(e=[(0,_.wrap)(e)]),r=n.createDocumentFragment(),e.forEach(function(e){return r.appendChild(e)}),this.insertNode(r,t))},k.prototype.deleteSelectedContent=function(){var e=this.getSelectionRange();return e&&!e.collapsed&&(0,_.deleteSelectedContent)(this.core.contentDiv,e)},k.prototype.paste=function(e,t,n){var r,o,i=this;e&&(e.snapshotBeforePaste?this.setContent(e.snapshotBeforePaste):e.snapshotBeforePaste=this.getContent(2),r=(r=this.getSelectionRange())&&_.Position.getStart(r),o=this.core.api.createPasteFragment(this.core,e,r,t,n),this.addUndoSnapshot(function(){return i.insertNode(o),e},"Paste"))},k.prototype.getSelectionRange=function(e){return this.core.api.getSelectionRange(this.core,e=void 0===e?!0:e)},k.prototype.getSelectionRangeEx=function(){return this.core.api.getSelectionRangeEx(this.core)},k.prototype.getSelectionPath=function(){var e=this.getSelectionRange();return e&&(0,_.getSelectionPath)(this.core.contentDiv,e)},k.prototype.hasFocus=function(){return this.core.api.hasFocus(this.core)},k.prototype.focus=function(){this.core.api.focus(this.core)},k.prototype.select=function(e,t,n,r){if(null!=(o=e)&&o.rows)return o=this.core.api.selectTable(this.core,e,t),!!(this.core.domEvent.tableSelectionRange=o);this.core.api.selectTable(this.core,null),this.core.domEvent.tableSelectionRange=null;var o=e?(0,_.safeInstanceOf)(e,"Range")?e:Array.isArray(e.start)&&Array.isArray(e.end)?(0,_.createRange)(this.core.contentDiv,e.start,e.end):(0,_.createRange)(e,t,n,r):null;return this.contains(o)&&this.core.api.selectRange(this.core,o)},k.prototype.getFocusedPosition=function(){var e=null==(e=this.getDocument().defaultView)?void 0:e.getSelection();if(this.contains(e&&e.focusNode))return new _.Position(e.focusNode,e.focusOffset);e=this.getSelectionRange();return e?_.Position.getStart(e):null},k.prototype.getElementAtCursor=function(t,n,e){var r=this;return e=n?null:e,(0,_.cacheGetEventData)(e,"GET_ELEMENT_AT_CURSOR_"+t,function(){var e;return n||(e=r.getFocusedPosition(),n=e&&e.node),n&&(0,_.findClosestElementAncestor)(n,r.core.contentDiv,t)})},k.prototype.isPositionAtBeginning=function(e){return(0,_.isPositionAtBeginningOf)(e,this.core.contentDiv)},k.prototype.getSelectedRegions=function(t){var n=this,e=(void 0===t&&(t=0),this.getSelectionRangeEx()),r=[];return e.ranges.forEach(function(e){r.push.apply(r,e?(0,_.getRegionsFromRange)(n.core.contentDiv,e,t):[])}),r.filter(function(e,t,n){return n.indexOf(e)===t})},k.prototype.addDomEventHandler=function(e,t){var n,t="string"==typeof e?((n={})[e]=t,n):e;return this.core.api.attachDomEvent(this.core,t)},k.prototype.triggerPluginEvent=function(e,t,n){e=_d({eventType:e},t);return this.core.api.triggerEvent(this.core,e,n),e},k.prototype.triggerContentChangedEvent=function(e,t){this.triggerPluginEvent(7,{source:e=void 0===e?"SetContent":e,data:t})},k.prototype.undo=function(){this.focus(),this.core.api.restoreUndoSnapshot(this.core,-1)},k.prototype.redo=function(){this.focus(),this.core.api.restoreUndoSnapshot(this.core,1)},k.prototype.addUndoSnapshot=function(e,t,n){this.core.api.addUndoSnapshot(this.core,e,t,n)},k.prototype.getUndoState=function(){var e=this.core.undo,t=e.hasNewContent,e=e.snapshotsService;return{canUndo:t||e.canMove(-1),canRedo:e.canMove(1)}},k.prototype.getDocument=function(){return this.core.contentDiv.ownerDocument},k.prototype.getScrollContainer=function(){return this.core.domEvent.scrollContainer},k.prototype.getCustomData=function(e,t,n){return(this.core.lifecycle.customData[e]=this.core.lifecycle.customData[e]||{value:t?t():void 0,disposer:n}).value},k.prototype.isInIME=function(){return this.core.domEvent.isInIME},k.prototype.getDefaultFormat=function(){return this.core.lifecycle.defaultFormat},k.prototype.getBodyTraverser=function(e){return _.ContentTraverser.createBodyTraverser(this.core.contentDiv,e)},k.prototype.getSelectionTraverser=function(e){return(e=null!=e?e:this.getSelectionRange())&&_.ContentTraverser.createSelectionTraverser(this.core.contentDiv,e)},k.prototype.getBlockTraverser=function(e){void 0===e&&(e=3);var t=this.getSelectionRange();return t&&_.ContentTraverser.createBlockTraverser(this.core.contentDiv,t,e)},k.prototype.getContentSearcherOfCursor=function(e){var t=this;return(0,_.cacheGetEventData)(e,"ContentSearcher",function(){var e=t.getSelectionRange();return e&&new _.PositionContentSearcher(t.core.contentDiv,_.Position.getStart(e))})},k.prototype.runAsync=function(e){var t=this,n=this.core.contentDiv.ownerDocument.defaultView||window,r=n.requestAnimationFrame(function(){!t.isDisposed()&&e&&e(t)});return function(){n.cancelAnimationFrame(r)}},k.prototype.setEditorDomAttribute=function(e,t){null===t?this.core.contentDiv.removeAttribute(e):this.core.contentDiv.setAttribute(e,t)},k.prototype.getEditorDomAttribute=function(e){return this.core.contentDiv.getAttribute(e)},k.prototype.getRelativeDistanceToEditor=function(e,t){if(this.contains(e)){var n,r=this.core.contentDiv,o=r.getBoundingClientRect(),e=e.getBoundingClientRect();if(o&&e)return n=e.left-(null==o?void 0:o.left),e=e.top-(null==o?void 0:o.top),t&&(n+=r.scrollLeft,e+=r.scrollTop),[n,e]}return null},k.prototype.addContentEditFeature=function(n){var r=this;null!=n&&n.keys.forEach(function(e){var t=r.core.edit.features[e]||[];t.push(n),r.core.edit.features[e]=t})},k.prototype.getStyleBasedFormatState=function(e){var t;return e||(e=(t=this.getSelectionRange())&&_.Position.getStart(t).normalize().node),this.core.api.getStyleBasedFormatState(this.core,e)},k.prototype.getPendableFormatState=function(e){return this.core.api.getPendableFormatState(this.core,e)},k.prototype.ensureTypeInContainer=function(e,t){this.core.api.ensureTypeInContainer(this.core,e,t)},k.prototype.setDarkModeState=function(e){this.isDarkMode()!=!!e&&(this.core.api.transformColor(this.core,this.core.contentDiv,!1,null,e?0:1,!0),this.triggerContentChangedEvent(e?"SwitchToDarkMode":"SwitchToLightMode"))},k.prototype.isDarkMode=function(){return this.core.lifecycle.isDarkMode},k.prototype.transformToDarkColor=function(e){this.core.api.transformColor(this.core,e,!0,null,0)},k.prototype.startShadowEdit=function(){this.core.api.switchShadowEdit(this.core,!0)},k.prototype.stopShadowEdit=function(){this.core.api.switchShadowEdit(this.core,!1)},k.prototype.isInShadowEdit=function(){return!!this.core.lifecycle.shadowEditFragment},k.prototype.isFeatureEnabled=function(e){return 0<=this.core.lifecycle.experimentalFeatures.indexOf(e)},k.prototype.getTrustedHTMLHandler=function(){return this.core.trustedHTMLHandler},k.prototype.getSizeTransformer=function(){return this.core.sizeTransformer},k.prototype.getZoomScale=function(){return this.core.zoomScale},k.prototype.setZoomScale=function(e){var t;0<e&&e<=10&&((t=this.core.zoomScale)!=(this.core.zoomScale=e)&&this.triggerPluginEvent(21,{oldZoomScale:t,newZoomScale:e},!0))},B.default=k,ot=j,Object.defineProperty(ot,"__esModule",{value:!0}),ot.Editor=void 0,vd=B,Object.defineProperty(ot,"Editor",{enumerable:!0,get:function(){return vd.default}});var Nd,Rd,Id,Ad={},Er={},Z={},i={},sn={},Cr={},L={},er={},ce={},Md=(Object.defineProperty(ce,"__esModule",{value:!0}),t);function Dd(e,t,n){e=1==t?Math.floor(e):Math.ceil(e);var r=n[n.length-1];if(e<=n[0])e=Math.max(e+t,1);else if(r<e||e==r&&1==t)e/=10,e=1==t?Math.floor(e):Math.ceil(e),e=Math.min(Math.max(10*(e+t),r),1e3);else if(1==t){for(var o=0;o<n.length;o++)if(e<n[o]){e=n[o];break}}else for(o=n.length-1;0<=o;o--)if(e>n[o]){e=n[o];break}return e}ce.default=function(a,l){a.focus();var e,t,n=a.getSelectionRangeEx();n&&n.areAllCollapsed?(t=(e=n.ranges[0]).startContainer,"SPAN"!=(0,Md.getTagOfNode)(t)||t.firstChild&&("BR"!=(0,Md.getTagOfNode)(t.firstChild)||t.firstChild.nextSibling)?(t&&3==t.nodeType&&""==t.nodeValue&&"SPAN"==(0,Md.getTagOfNode)(t.parentNode)||(a.addUndoSnapshot(),t=a.getDocument().createTextNode(""),e.insertNode(t)),(0,Md.applyTextStyle)(t,l),a.select(t,-1)):(a.addUndoSnapshot(),l(t))):a.addUndoSnapshot(function(){var o,i;n.ranges.forEach(function(e){for(var t=a.getSelectionTraverser(e),n=t&&t.currentInlineElement;n;){var r=t.getNextInlineElement();n.applyStyle(function(e,t){l(e,t),o=o||e,i=e}),n=r}}),o&&i&&0==n.type&&a.select(o,-2,i,-3)},"Format")},Nd=er,Object.defineProperty(Nd,"__esModule",{value:!0}),Nd.getNewFontSize=Nd.FONT_SIZES=void 0,Rd=ce,Id=t,Nd.FONT_SIZES=[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72],Nd.default=function(e,t,n){void 0===n&&(n=Nd.FONT_SIZES);var r=0==t?1:-1;(0,Rd.default)(e,function(e){var t=parseFloat((0,Id.getComputedStyle)(e,"font-size"));e.style.fontSize=Dd(t,r,n)+"pt","normal"!=(0,Id.getComputedStyle)(e,"line-height")&&(e.style.lineHeight="normal")})},Nd.getNewFontSize=Dd;var Pe={},v={},Sr={},xr={},jd=(Object.defineProperty(xr,"__esModule",{value:!0}),t),Bd=(xr.default=function(e,t){var n,r;0<(null==t?void 0:t.length)&&(n=(r=e.getSelectionRange())&&jd.Position.getStart(r),r=r&&jd.Position.getEnd(r),t.forEach(function(e){return e.commit()}),e.select(n,r))},Object.defineProperty(Sr,"__esModule",{value:!0}),xr),Fd=t,E=(Sr.default=function(o,i,a){o.focus();var l=o.getSelectionRangeEx();o.addUndoSnapshot(function(t,n){var e,r;a&&!a()||(e=o.getSelectedRegions(),r=Fd.VListChain.createListChains(e,null==t?void 0:t.node),e.forEach(function(e){return i(e,t,n,r)}),(0,Bd.default)(o,r)),0==l.type?o.select(t,n):1==l.type&&o.select(l.table,l.coordinates)},"Format")},{}),Hd=(Object.defineProperty(E,"__esModule",{value:!0}),t),Ur=(E.default=function(n,t){n.focus();function r(){n.getDocument().execCommand(t,!1,null)}var e,o,i=n.getSelectionRangeEx();i&&i.areAllCollapsed?(n.addUndoSnapshot(),e=n.getPendableFormatState(!1),r(),(o=Object.keys(Hd.PendableFormatCommandMap).filter(function(e){return Hd.PendableFormatCommandMap[e]==t})[0])&&(e[o]=!e[o],n.triggerPluginEvent(13,{formatState:e}))):n.addUndoSnapshot(function(){var t;i.ranges.forEach(function(e){1==i.type&&n.select(e),r(),t=e}),t&&1==i.type&&n.select(i.table,i.coordinates)},"Format")},{}),zd=(Object.defineProperty(Ur,"__esModule",{value:!0}),ce),Ud=t,x=(Ur.default=function(n,r){(0,zd.default)(n,function(e,t){(0,Ud.setColor)(e,t?"":r,!0,n.isDarkMode())})},{}),h={},Vd=(Object.defineProperty(h,"__esModule",{value:!0}),ce),Wd=t,qd=(h.default=function(n,e,r){var t,o=[];(0,Vd.default)(n,function(e,t){r(e,t);t=n.getElementAtCursor("LI",e);t&&-1===o.indexOf(t)&&o.push(t)}),t=[e],o.forEach(function(e){(0,Wd.safeInstanceOf)(e,"HTMLLIElement")&&(0,Wd.setListItemStyle)(e,t)})},Object.defineProperty(x,"__esModule",{value:!0}),h),Vr=(x.default=function(e,n){(0,qd.default)(e,"font-family",function(e,t){e.style.fontFamily=t?"":n})},{}),Kd=(Object.defineProperty(Vr,"__esModule",{value:!0}),h),Zd=t,w=(Vr.default=function(e,n){(0,Kd.default)(e,"font-size",function(e,t){e.style.fontSize=t?"":n,"normal"!=(0,Zd.getComputedStyle)(e,"line-height")&&(e.style.lineHeight="normal")})},{}),Gd=(Object.defineProperty(w,"__esModule",{value:!0}),h),$d=t,Lo=(w.default=function(n,r,o){(0,Gd.default)(n,"color",function(e,t){o&&!o(e)||(0,$d.setColor)(e,t?"":r,!1,n.isDarkMode())})},{}),Xd=(Object.defineProperty(Lo,"__esModule",{value:!0}),E),W=(Lo.default=function(e){(0,Xd.default)(e,"bold")},{}),Yd=(Object.defineProperty(W,"__esModule",{value:!0}),E),Ho=(W.default=function(e){(0,Yd.default)(e,"italic")},{}),Qd=(Object.defineProperty(Ho,"__esModule",{value:!0}),E),Jd=(Ho.default=function(e){(0,Qd.default)(e,"underline")},Object.defineProperty(v,"__esModule",{value:!0}),Sr),eu=E,tu=Ur,nu=x,ru=Vr,ou=w,iu=Lo,au=W,lu=Ho,N=t,su=["font","text-decoration","color","background"],cu="B,I,U,STRONG,EM,SUB,SUP,STRIKE,FONT,CENTER,H1,H2,H3,H4,H5,H6,UL,OL,LI,SPAN,P,BLOCKQUOTE,CODE,S,PRE".split(","),du=["href","src","cellpadding","cellspacing"],uu=["TD","TH","TR","TABLE","TBODY","THEAD"];function fu(e){var t=(0,N.toArray)(e.childNodes).map(fu).every(function(e){return e}),n=(0,N.isBlockElement)(e),r=(0,N.getTagOfNode)(e);if(r)if(0<=cu.indexOf(r)||t&&!(0,N.isVoidHtmlElement)(e)&&uu.indexOf(r)<0)n&&!t&&(0,N.wrap)(e),(0,N.unwrap)(e);else for(var o=e,i=(0,N.safeInstanceOf)(o,"HTMLTableCellElement"),a=(0,N.safeInstanceOf)(o,"HTMLTableElement"),l=0,s=(0,N.toArray)(o.attributes);l<s.length;l++){var c=s[l];i&&"style"==c.name?hu(o):a&&"style"==c.name?pu(o,function(e,t,n){"border-collapse"!=e&&(n[e]=t[e],delete t[e])}):du.indexOf(c.name.toLowerCase())<0&&0!=c.name.indexOf("data-")&&o.removeAttribute(c.name)}return n}function pu(e,t){var n=(0,N.getStyles)(e),r={};return Object.keys(n).forEach(function(e){return t(e,n,r)}),(0,N.setStyles)(e,n),r}function hu(e){return pu(e,function(e,t,n){e.indexOf("border")<0&&(n[e]=t[e],delete t[e])})}function gu(o){o.addUndoSnapshot(function(){(0,Jd.default)(o,function(e){var t,n=(0,N.getSelectedBlockElementsInRegion)(e),r=(0,N.collapseNodesInRegion)(e,n);for(o.contains(e.rootNode)&&(n=hu(e.rootNode),0<Object.keys(n).length&&(t=(0,N.wrap)((0,N.toArray)(e.rootNode.childNodes)),(0,N.setStyles)(t,n)));0<r.length&&(0,N.isNodeInRegion)(e,r[0].parentNode);)r=[(0,N.splitBalancedNodeRange)(r)];r.forEach(fu)}),mu(o)},"Format")}function mu(e){var t,n,r=e.getDefaultFormat(),o=0===Object.keys(r).length;e.queryElements("[style]",2,function(e){var t=(0,N.getTagOfNode)(e);-1==uu.indexOf(t)?vu(t,e,o):e.childNodes.forEach(function(e){e.childNodes.forEach(function(e){var t=(0,N.getTagOfNode)(e);(0,N.safeInstanceOf)(e,"HTMLElement")&&vu(t,e,o)})})}),o||(r.fontFamily&&(0,nu.default)(e,r.fontFamily),r.fontSize&&(0,ru.default)(e,r.fontSize),r.textColor&&(n=0<(t=e.queryElements("a *, a",1)).length?function(e){return-1==t.indexOf(e)}:null,r.textColors?(0,ou.default)(e,r.textColors,n):(0,ou.default)(e,r.textColor,n)),r.backgroundColor&&(r.backgroundColors?(0,tu.default)(e,r.backgroundColors):(0,tu.default)(e,r.backgroundColor)),r.bold&&(0,iu.default)(e),r.italic&&(0,au.default)(e),r.underline&&(0,lu.default)(e))}function vu(e,t,n){-1==uu.indexOf(e)&&(su.forEach(function(e){return t.style.removeProperty(e)}),n&&""===t.getAttribute("style")&&t.removeAttribute("style"))}v.default=function e(t,n){switch(n=void 0===n?0:n){case 0:(i=t).focus(),i.addUndoSnapshot(function(){(0,eu.default)(i,"removeFormat"),i.queryElements("[class]",1,function(e){return e.removeAttribute("class")}),mu(i)},"Format");break;case 1:gu(t);break;default:((o=(r=t).getSelectionTraverser()).currentBlockElement&&o.getNextBlockElement()||!(r.getSelectionTraverser().currentInlineElement instanceof N.PartialInlineElement)?gu:e)(r)}var r,o,i},Object.defineProperty(Pe,"__esModule",{value:!0});var yu=v,No=(Pe.default=function(e){(0,yu.default)(e,1)},{}),bu=(Object.defineProperty(No,"__esModule",{value:!0}),t),Eu=/^[a-zA-Z]+:/i,Cu=/^[\w.%+-]+@/i,wu=/^ftp\./i;function Su(e){return e.queryElements("a[href]",1)[0]}function xu(e,t){t&&e.textContent!=t&&(e.textContent=t)}No.default=function(a,e,l,s,c){a.focus();e=e,n=new bu.HtmlSanitizer,(t=document.createElement("a")).href=e||"",n.sanitize(t);var t,n,d,u,e=(t.getAttribute("href")||"").trim();e&&(n=(0,bu.matchLink)(e),d=n?n.normalizedUrl:function(e){if(!e)return e;var t="";return(t=e.search(Eu)<0?0==e.search(Cu)?"mailto:":0==e.search(wu)?"ftp://":"http://":t)+e}(e),u=n?n.originalUrl:e,a.addUndoSnapshot(function(){var e,t=a.getSelectionRange(),n=null;if(t&&t.collapsed)(n=Su(a))?(n.href=d,xu(n,s)):((n=a.getDocument().createElement("A")).textContent=s||u,n.href=d,a.insertNode(n));else{a.getDocument().execCommand("createLink",!1,d);for(var r=a.getSelectionTraverser(),o=r.getNextInlineElement();o;){var i=o.getContainerNode();i.parentElement.removeChild(i),o=r.getNextInlineElement()}xu(n=Su(a),s)}return l&&n&&(n.title=l),n&&(t=n,(e=c)?t.target=e:!e&&t.getAttribute("target")&&t.removeAttribute("target")),n},"CreateLink"))};var _o={},Tu=e&&e.__assign||function(){return(Tu=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Ou=(Object.defineProperty(_o,"__esModule",{value:!0}),_o.getElementBasedFormatState=void 0,t);function Pu(e,t){var n=(0,Ou.getTagOfNode)(e.getElementAtCursor("OL,UL",null,t)),t=(0,Ou.getTagOfNode)(e.getElementAtCursor("H1,H2,H3,H4,H5,H6",null,t));return{isBullet:"UL"==n,isNumbering:"OL"==n,headerLevel:t&&parseInt(t[1])||0,canUnlink:!!e.queryElements("a[href]",1)[0],canAddImageAltText:!!e.queryElements("img",1)[0],isBlockQuote:!!e.queryElements("blockquote",1)[0],isInTable:!!e.queryElements("table",1)[0]}}_o.getElementBasedFormatState=Pu,_o.default=function(e,t){return Tu(Tu(Tu(Tu(Tu({},e.getPendableFormatState(!1)),Pu(e,t)),e.getStyleBasedFormatState()),e.getUndoState()),{isDarkMode:e.isDarkMode(),zoomScale:e.getZoomScale()})};var c={},_u=(Object.defineProperty(c,"__esModule",{value:!0}),t),ie=(c.default=function(e,t,n,r,o,i){var a,n=(0,_u.wrap)(n,r?"DIV":"SPAN"),i=(!r&&o&&(n.style.display="inline-block"),(0,_u.commitEntity)(n,t,o),e.contains(n)||(o=t=void 0,o="number"==typeof i?i:(i?(t=e.getSelectionRange(),(a=(a=i.normalize().node)&&e.getElementAtCursor((0,_u.getEntitySelector)(),a))&&(i=new _u.Position(a,-3)),e.select(i)):e.focus(),3),e.insertNode(n,{updateCursor:!1,insertOnNewLine:r,replaceSelection:!0,position:o}),3==o&&(t?e.select(t):r||e.select(n,-3))),r&&(a=e.getDocument().createElement("BR"),n.parentNode.insertBefore(a,n.nextSibling)),(0,_u.getEntityFromElement)(n));return e.triggerContentChangedEvent("InsertEntity",i),i},{}),ku=(Object.defineProperty(ie,"__esModule",{value:!0}),t);function Lu(t,n){t.addUndoSnapshot(function(){var e=t.getDocument().createElement("img");e.src=n,e.style.maxWidth="100%",t.insertNode(e)},"Format")}ie.default=function(t,e){"string"==typeof e?Lu(t,e):(0,ku.readFile)(e,function(e){e&&!t.isDisposed()&&Lu(t,e)})};var Ri={},Nu=(Object.defineProperty(Ri,"__esModule",{value:!0}),t);Ri.default=function(t,e,n,r){var o=t.getDocument(),i=o.createDocumentFragment(),a=o.createElement("table");i.appendChild(a),a.cellSpacing="0",a.cellPadding="1";for(var l=0;l<n;l++){var s=o.createElement("tr");a.appendChild(s);for(var c=0;c<e;c++){var d=o.createElement("td");s.appendChild(d),d.appendChild(o.createElement("br")),d.style.width=(d=e)<=4?"120px":d<=6?"100px":"70px"}}t.focus(),t.addUndoSnapshot(function(){var e=new Nu.VTable(a);e.applyFormat(r),e.writeBack(),t.insertNode(i),t.runAsync(function(e){return e.select(new Nu.Position(a,0).normalize())})},"Format")};var Di={},Ru=(Object.defineProperty(Di,"__esModule",{value:!0}),t),Hi=(Di.default=function(r,o){var i=r.getElementAtCursor("TD,TH");i&&r.addUndoSnapshot(function(){var e,n=new Ru.VTable(i),t=(t=n,(e=r.getSelectionRangeEx())&&1===e.type&&(t.selection=e.coordinates),n.edit(o),n.writeBack(),r.transformToDarkColor(n.table),r.focus(),function(){var e=n.row,t=n.col;switch(o){case 0:t=0;break;case 1:e+=1,t=0;break;case 2:e=0;break;case 3:e=0,t+=1}return{newRow:e,newCol:t}}());r.select(n.getCell(t.newRow,t.newCol).td,0)},"Format")},{}),Iu=(Object.defineProperty(Hi,"__esModule",{value:!0}),t),O=(Hi.default=function(r,o,i){(i=i||r.getElementAtCursor("TABLE"))&&r.addUndoSnapshot(function(e,t){var n=new Iu.VTable(i);n.applyFormat(o),n.writeBack(),r.transformToDarkColor(n.table),r.focus(),r.select(e,t)},"Format")},{}),Au=(Object.defineProperty(O,"__esModule",{value:!0}),t),Ki=(O.default=function(n){n.focus(),n.addUndoSnapshot(function(e,t){n.queryElements("a[href]",1,Au.unwrap),n.select(e,t)},"Format")},{}),Qi=(Object.defineProperty(Ki,"__esModule",{value:!0}),Ki.default=function(e,t,n,r,o){return!(!t||!n)&&(!!(o="string"==typeof t?(o=o||e.getContentSearcherOfCursor())&&o.getRangeFromText(t,r):t)&&((t=e.getSelectionRange()).collapsed&&o.endContainer==t.startContainer&&o.endOffset==t.startOffset&&(r=!0),e.insertNode(n,{position:5,updateCursor:r,replaceSelection:!0,insertOnNewLine:!1,range:o}),!0))},{}),ea=(Object.defineProperty(Qi,"__esModule",{value:!0}),Qi.default=function(e,t,n){t&&e.addUndoSnapshot(function(){t.style.transform="rotate("+n+"deg)"},"Format")},{}),Mu=(Object.defineProperty(ea,"__esModule",{value:!0}),Sr),Du=E,ju=t,na=(ea.default=function(i,a){i.addUndoSnapshot(function(){var t,o,e=i.getSelectionRangeEx(),n=e&&1===e.type,r=i.getElementAtCursor();i.isFeatureEnabled("TableAlignment")&&n&&(0,ju.isWholeTableSelected)(new ju.VTable(e.table),e.coordinates)?(n=a,e=e.table,1==n?(e.style.marginLeft="auto",e.style.marginRight="auto"):2==n?(e.style.marginLeft="auto",e.style.marginRight=""):(e.style.marginLeft="",e.style.marginRight="auto")):-1<["LI","UL","OL"].indexOf((0,ju.getTagOfNode)(r))&&i.isFeatureEnabled("ListItemAlignment")?(o=a,(0,Mu.default)(i,function(e,t,n){var r=(0,ju.getSelectedBlockElementsInRegion)(e)[0].getStartNode();(0,ju.createVListFromRegion)(e,!0,r).setAlignment(t,n,o)})):(n=i,t="left",e="justifyLeft",1==a?(e="justifyCenter",t="center"):2==a&&(e="justifyRight",t="right"),(0,Du.default)(n,e),n.queryElements("[align]",1,function(e){return e.style.textAlign=t}))},"Format")},{}),ta={},Bu=(Object.defineProperty(ta,"__esModule",{value:!0}),t);ta.default=function(e,t){for(var n,r,o=e.getSelectionTraverser(),i=o&&o.currentBlockElement,a=[];i;)r=void 0,(r=(n=i).getStartNode())==n.getEndNode()&&3==r.nodeType&&0<=["TR","TABLE"].indexOf((0,Bu.getTagOfNode)(r.parentNode))||a.push(i),i=o.getNextBlockElement();a.forEach(function(e){e=e.collapseToSingleElement();t(e)})},Object.defineProperty(na,"__esModule",{value:!0});var Fu=ta,ca=(na.default=function(n,r){n.focus(),n.addUndoSnapshot(function(e,t){(0,Fu.default)(n,function(e){e.setAttribute("dir",0==r?"ltr":"rtl"),e.style.textAlign=0==r?"left":"right"}),n.select(e,t)},"Format")},{}),fa=(Object.defineProperty(ca,"__esModule",{value:!0}),ca.default=function(e,t){e.focus(),e.addUndoSnapshot(function(){e.queryElements("img",1,function(e){return e.setAttribute("alt",t)})},"Format")},{}),Hu=(Object.defineProperty(fa,"__esModule",{value:!0}),Sr),zu=t;function Uu(e,t){e=(0,zu.collapseNodesInRegion)(e,t);(0,zu.wrap)(e,2)}function Vu(n,e){e.forEach(function(e){var t=e.collapseToSingleElement(),e=(0,zu.findClosestElementAncestor)(t,n.rootNode,"blockquote");if(e){for(t==e&&(t=(0,zu.wrap)((0,zu.toArray)(t.childNodes)));(0,zu.isNodeInRegion)(n,t)&&"BLOCKQUOTE"!=(0,zu.getTagOfNode)(t);)t=(0,zu.splitBalancedNodeRange)(t);(0,zu.isNodeInRegion)(n,t)&&(0,zu.unwrap)(t)}})}fa.default=function(f,p){var h=0==p?Uu:Vu;(0,Hu.default)(f,function(t,e,n){for(var r,o,i=(0,zu.getSelectedBlockElementsInRegion)(t,!0),a=[[]],l=0;l<i.length;l++){var s=i[l].getStartNode(),c=(0,zu.createVListFromRegion)(t,!0,s);if(c){for(;i[l+1]&&c.contains(i[l+1].getStartNode());)l++;var d,u=f.isFeatureEnabled("TabKeyTextFeatures");u&&(r=s,o=void 0,(null==(o=(d=c).items[0])?void 0:o.getNode())==r&&d.getListItemIndex(r)==(d.getStart()||1))&&(o=f,r=s,0==p||o.getElementAtCursor("blockquote",r))?(d=f.getBlockElementAtNode(c.rootList),a.push([d])):(1==p?c.setIndentation(e,n,p,!1,u):c.setIndentation(e,n,p),c.writeBack(),a.push([]))}else a[a.length-1].push(i[l])}a.forEach(function(e){return h(t,e)})},function(){var e,t=f.getSelectionRangeEx();return 1!=t.type||!(0,zu.isWholeTableSelected)(new zu.VTable(t.table),t.coordinates)||(1==p?(e=f.getElementAtCursor("blockquote",t.table),(0,zu.unwrap)(e)):0==p&&(0,zu.wrap)(t.table,2),!1)})};var Wu,qu,Ku,Zu,Gu,$u,Xu,Yu,Qu,Ju,ef,tf,nf,rf,of,af,lf,sf,cf,df,uf,ff,pf,hf,gf,mf,vf,yf,bf,Ef,Cf,wf,Sf,xf,Tf,Of,Pf,_f,pa={},kf=(Object.defineProperty(pa,"__esModule",{value:!0}),ce),Lf=t,ha=(pa.default=function(e,i,n){function r(e,t){switch(i){case"lowercase":return e.toLocaleLowerCase(t);case"uppercase":return e.toLocaleUpperCase(t);case"capitalize":for(var n=e.toLocaleLowerCase(t).split(" "),r=0;r<n.length;r++)n[r]=n[r].charAt(0).toLocaleUpperCase(t)+n[r].slice(1);return n.join(" ");case"sentence":var o=new RegExp("^\\s*\\w|[\\.\\!\\?]\\s+\\w","g");return e.toLocaleLowerCase(t).replace(o,function(e){return e.toLocaleUpperCase(t)})}}(0,kf.default)(e,function(e){for(var t=(0,Lf.getFirstLeafNode)(e);t;t=(0,Lf.getNextLeafSibling)(e,t))if(3==t.nodeType)try{t.textContent=r(t.textContent,n)}catch(e){t.textContent=r(t.textContent,void 0)}})},{}),ga={},Nf=(Object.defineProperty(ga,"__esModule",{value:!0}),Sr),Rf=t,If=(ga.default=function(e,o,i,a){void 0===a&&(a=!0),(0,Nf.default)(e,function(e,t,n,r){var r=0<i&&r.filter(function(e){return e.canAppendAtCursor(i)})[0],r=r&&t.equalTo(n)?r.createVListAtBlock(null==(r=(0,Rf.getBlockElementAtNode)(e.rootNode,t.node))?void 0:r.collapseToSingleElement(),i):(0,Rf.createVListFromRegion)(e,a);r&&(r.changeListType(t,n,o),r.writeBack())})},Object.defineProperty(ha,"__esModule",{value:!0}),ga),T=(ha.default=function(e){(0,If.default)(e,2)},{}),Af=(Object.defineProperty(T,"__esModule",{value:!0}),ga),va=(T.default=function(e,t){(0,Af.default)(e,1,t)},{}),Mf=(Object.defineProperty(va,"__esModule",{value:!0}),t),ba=(va.default=function(t,n,r){void 0===r&&(r=1),t.addUndoSnapshot(function(){t.focus();var e=t.getSelectedRegions();e[0]&&(e=(0,Mf.createVListFromRegion)(e[0],!1,n))&&(e.split(n,r),e.writeBack())},"Format")},{}),Ha={},Df=(Object.defineProperty(Ha,"__esModule",{value:!0}),Sr),jf=t,Bf=(Ha.default=function(e,r,t){(0,Df.default)(e,function(e){var t=(0,jf.getSelectedBlockElementsInRegion)(e,!0),n=(0,jf.collapseNodesInRegion)(e,t);if(0<n.length){for(1==n.length&&("BR"==(t=(0,jf.getTagOfNode)(n[0]))?n=[(0,jf.wrap)(n[0])]:"LI"!=t&&"TD"!=t||(n=(0,jf.toArray)(n[0].childNodes)));n[0]&&(0,jf.isNodeInRegion)(e,n[0].parentNode)&&n.some(function(e){return"LI"==(0,jf.getTagOfNode)(e)});)n=[(0,jf.splitBalancedNodeRange)(n)];r(n)}},t)},Object.defineProperty(ba,"__esModule",{value:!0}),Ha),Ff=t,za=(ba.default=function(e,t){(0,Bf.default)(e,function(e){e=(0,Ff.wrap)(e,"blockquote");(t||function(e){e.style.borderLeft="3px solid",e.style.borderColor="#C8C8C8",e.style.paddingLeft="10px",e.style.color="#666666"})(e)},function(){return 0==e.queryElements("blockquote",1,Ff.unwrap).length})},{}),Hf=(Object.defineProperty(za,"__esModule",{value:!0}),Ha),zf=t,Ua=(za.default=function(e,t){(0,Hf.default)(e,function(e){e=(0,zf.wrap)(e,"code"),e=(0,zf.wrap)(e,"pre");null!=t&&t(e)},function(){return 0==e.queryElements("pre>code",1,function(e){var t;e.previousSibling||e.nextSibling||(t=e.parentNode,(0,zf.unwrap)(e),(0,zf.unwrap)(t))}).length})},{}),Uf=(Object.defineProperty(Ua,"__esModule",{value:!0}),E),Va=(Ua.default=function(e){(0,Uf.default)(e,"strikeThrough")},{}),Vf=(Object.defineProperty(Va,"__esModule",{value:!0}),E),Wa=(Va.default=function(e){(0,Vf.default)(e,"subscript")},{}),Wf=(Object.defineProperty(Wa,"__esModule",{value:!0}),E),qa=(Wa.default=function(e){(0,Wf.default)(e,"superscript")},{}),qf=(Object.defineProperty(qa,"__esModule",{value:!0}),t),Za=(qa.default=function(i,a){a=Math.min(Math.max(Math.round(a),0),6),i.addUndoSnapshot(function(){i.focus();var n=!1;if(i.queryElements("H1,H2,H3,H4,H5,H6",1,function(e){n||(i.getDocument().execCommand("formatBlock",!1,"<DIV>"),n=!0);var t=i.getDocument().createElement("div");(0,qf.moveChildNodes)(t,e),i.replaceNode(e,t)}),0<a){for(var e=i.getSelectionTraverser(),t=e?e.currentBlockElement:null,r=new qf.HtmlSanitizer({cssStyleCallbacks:{"font-size":function(){return!1}}});t;){var o=t.collapseToSingleElement();r.sanitize(o),t=e.getNextBlockElement()}i.getDocument().execCommand("formatBlock",!1,"<H"+a+">")}},"Format")},{}),Kf=(Object.defineProperty(Za,"__esModule",{value:!0}),t),Zf=(Za.default=function(t,n){t.focus(),t.addUndoSnapshot(function(){t.getSelectedRegions().forEach(function(e){(0,Kf.safeInstanceOf)(e.rootNode,"HTMLTableCellElement")&&((0,Kf.setColor)(e.rootNode,n,!0,t.isDarkMode(),!0),e.rootNode.dataset.cellShade="true",e.rootNode.dataset.originalBackgroundColor=e.rootNode.style.backgroundColor)})})},S=L,Object.defineProperty(S,"__esModule",{value:!0}),S.experimentCommitListChains=S.blockFormat=S.toggleListType=S.applyCellShading=S.toggleHeader=S.toggleUnderline=S.toggleSuperscript=S.toggleSubscript=S.toggleStrikethrough=S.toggleCodeBlock=S.toggleBlockQuote=S.setOrderedListNumbering=S.toggleNumbering=S.toggleItalic=S.toggleBullet=S.toggleBold=S.changeCapitalization=S.setIndentation=S.setImageAltText=S.setFontSize=S.setFontName=S.setDirection=S.setTextColor=S.setBackgroundColor=S.setAlignment=S.rotateElement=S.replaceWithNode=S.removeLink=S.formatTable=S.editTable=S.insertTable=S.insertImage=S.insertEntity=S.getElementBasedFormatState=S.getFormatState=S.createLink=S.clearFormat=S.clearBlockFormat=S.FONT_SIZES=S.changeFontSize=void 0,Wu=er,Object.defineProperty(S,"changeFontSize",{enumerable:!0,get:function(){return Wu.default}}),Object.defineProperty(S,"FONT_SIZES",{enumerable:!0,get:function(){return Wu.FONT_SIZES}}),qu=Pe,Object.defineProperty(S,"clearBlockFormat",{enumerable:!0,get:function(){return qu.default}}),Ku=v,Object.defineProperty(S,"clearFormat",{enumerable:!0,get:function(){return Ku.default}}),Zu=No,Object.defineProperty(S,"createLink",{enumerable:!0,get:function(){return Zu.default}}),Gu=_o,Object.defineProperty(S,"getFormatState",{enumerable:!0,get:function(){return Gu.default}}),Object.defineProperty(S,"getElementBasedFormatState",{enumerable:!0,get:function(){return Gu.getElementBasedFormatState}}),$u=c,Object.defineProperty(S,"insertEntity",{enumerable:!0,get:function(){return $u.default}}),Xu=ie,Object.defineProperty(S,"insertImage",{enumerable:!0,get:function(){return Xu.default}}),Yu=Ri,Object.defineProperty(S,"insertTable",{enumerable:!0,get:function(){return Yu.default}}),Qu=Di,Object.defineProperty(S,"editTable",{enumerable:!0,get:function(){return Qu.default}}),Ju=Hi,Object.defineProperty(S,"formatTable",{enumerable:!0,get:function(){return Ju.default}}),ef=O,Object.defineProperty(S,"removeLink",{enumerable:!0,get:function(){return ef.default}}),tf=Ki,Object.defineProperty(S,"replaceWithNode",{enumerable:!0,get:function(){return tf.default}}),nf=Qi,Object.defineProperty(S,"rotateElement",{enumerable:!0,get:function(){return nf.default}}),rf=ea,Object.defineProperty(S,"setAlignment",{enumerable:!0,get:function(){return rf.default}}),of=Ur,Object.defineProperty(S,"setBackgroundColor",{enumerable:!0,get:function(){return of.default}}),af=w,Object.defineProperty(S,"setTextColor",{enumerable:!0,get:function(){return af.default}}),lf=na,Object.defineProperty(S,"setDirection",{enumerable:!0,get:function(){return lf.default}}),sf=x,Object.defineProperty(S,"setFontName",{enumerable:!0,get:function(){return sf.default}}),cf=Vr,Object.defineProperty(S,"setFontSize",{enumerable:!0,get:function(){return cf.default}}),df=ca,Object.defineProperty(S,"setImageAltText",{enumerable:!0,get:function(){return df.default}}),uf=fa,Object.defineProperty(S,"setIndentation",{enumerable:!0,get:function(){return uf.default}}),ff=pa,Object.defineProperty(S,"changeCapitalization",{enumerable:!0,get:function(){return ff.default}}),pf=Lo,Object.defineProperty(S,"toggleBold",{enumerable:!0,get:function(){return pf.default}}),hf=ha,Object.defineProperty(S,"toggleBullet",{enumerable:!0,get:function(){return hf.default}}),gf=W,Object.defineProperty(S,"toggleItalic",{enumerable:!0,get:function(){return gf.default}}),mf=T,Object.defineProperty(S,"toggleNumbering",{enumerable:!0,get:function(){return mf.default}}),vf=va,Object.defineProperty(S,"setOrderedListNumbering",{enumerable:!0,get:function(){return vf.default}}),yf=ba,Object.defineProperty(S,"toggleBlockQuote",{enumerable:!0,get:function(){return yf.default}}),bf=za,Object.defineProperty(S,"toggleCodeBlock",{enumerable:!0,get:function(){return bf.default}}),Ef=Ua,Object.defineProperty(S,"toggleStrikethrough",{enumerable:!0,get:function(){return Ef.default}}),Cf=Va,Object.defineProperty(S,"toggleSubscript",{enumerable:!0,get:function(){return Cf.default}}),wf=Wa,Object.defineProperty(S,"toggleSuperscript",{enumerable:!0,get:function(){return wf.default}}),Sf=Ho,Object.defineProperty(S,"toggleUnderline",{enumerable:!0,get:function(){return Sf.default}}),xf=qa,Object.defineProperty(S,"toggleHeader",{enumerable:!0,get:function(){return xf.default}}),Tf=Za,Object.defineProperty(S,"applyCellShading",{enumerable:!0,get:function(){return Tf.default}}),Of=ga,Object.defineProperty(S,"toggleListType",{enumerable:!0,get:function(){return Of.default}}),Pf=Sr,Object.defineProperty(S,"blockFormat",{enumerable:!0,get:function(){return Pf.default}}),_f=xr,Object.defineProperty(S,"experimentCommitListChains",{enumerable:!0,get:function(){return _f.default}}),Object.defineProperty(Cr,"__esModule",{value:!0}),Cr.AutoLinkFeatures=void 0,L),Gf=t,$f=/[.+=\s:;"',>]+$/i;function Xf(r,o){return 0==r.eventType||7==r.eventType&&"Paste"==r.source?(0,Gf.cacheGetEventData)(r,"LINK_DATA",function(){var e=7==r.eventType&&"Paste"==r.source&&r.data,e=(0,Gf.matchLink)((e.text||"").trim()),t=o.getContentSearcherOfCursor(r);if(e&&t.getRangeFromText(e.originalUrl,!1))return e;var n,e=t&&t.getWordBefore();return e&&5<e.length?(t=(e.match($f)||[])[0]||"",n=e.substring(0,e.length-t.length),["()","{}","[]"].forEach(function(e){n[n.length-1]==e[1]&&n.indexOf(e[0])<0&&(n=n.substr(0,n.length-1))}),(0,Gf.matchLink)(n)):null}):null}Cr.AutoLinkFeatures={autoLink:{keys:[13,32,257],shouldHandleEvent:Xf,handleEvent:function(t,e){var n=e.getDocument().createElement("a"),r=Xf(t,e),o=e.getContentSearcherOfCursor();n.textContent=r.originalUrl,n.href=r.normalizedUrl,e.runAsync(function(e){e.addUndoSnapshot(function(){return(0,Zf.replaceWithNode)(e,r.originalUrl,n,!1,o),(0,Gf.clearEventDataCache)(t),n},"AutoLink",!0)})}},unlinkWhenBackspaceAfterLink:{keys:[8],shouldHandleEvent:function(e,t){return t.getContentSearcherOfCursor(e).getInlineElementBefore()instanceof Gf.LinkInlineElement},handleEvent:function(e,t){e.rawEvent.preventDefault(),(0,Zf.removeLink)(t)},defaultDisabled:!0}};var Wr={},Yf=(Object.defineProperty(Wr,"__esModule",{value:!0}),Wr.CursorFeatures=void 0,t),$a={keys:[37,39],allowFunctionKeys:!0,shouldHandleEvent:function(e,t,n){var r;if(!(n&&(n=t.getSelectionRange())&&n.collapsed&&(r=Yf.Position.getStart(n))&&t.isPositionAtBeginning(r)))return!1;n="rtl"==(0,Yf.getComputedStyle)(r.element,"direction"),t=e.rawEvent;return!n&&37==t.which||n&&39==t.which},handleEvent:function(e){e.rawEvent.preventDefault()},defaultDisabled:!Yf.Browser.isChrome},vl=(Wr.CursorFeatures={noCycleCursorMove:$a},{}),Qf=(Object.defineProperty(vl,"__esModule",{value:!0}),vl.EntityFeatures=void 0,t);function Jf(t,n,e){var r=(0,Qf.cacheGetEventData)(t,"READONLY_ENTITY_ELEMENT",function(){var e=t.rawEvent.target,e=e&&n.getElementAtCursor((0,Qf.getEntitySelector)(),e);return e&&!e.isContentEditable?e:null});return r&&void 0!==e&&n.triggerPluginEvent(15,{operation:e,rawEvent:t.rawEvent,entity:(0,Qf.getEntityFromElement)(r)}),r}function e0(e,r,o,i,t){var n=(0,Qf.cacheGetEventData)(e,"NEIGHBOR_ENTITY_ELEMENT_"+o+"_"+i,function(){var e=r.getSelectionRange();if(i&&!e.collapsed)return null;e.commonAncestorContainer.normalize();var t,e=Qf.Position.getEnd(e).normalize(),n=null;return 0!=e.offset&&!e.isAtEnd||(t=r.getBodyTraverser(e.node),t=(t=o?0==e.offset?t.currentInlineElement:t.getNextInlineElement():e.isAtEnd?t.currentInlineElement:t.getPreviousInlineElement())&&t.getContainerNode(),i||((e=r.getBlockElementAtNode(e.node))&&e.contains(t)||(t=null)),n=t&&r.getElementAtCursor((0,Qf.getEntitySelector)(),t)),n});return n&&void 0!==t&&r.triggerPluginEvent(15,{operation:t,rawEvent:e.rawEvent,entity:(0,Qf.getEntityFromElement)(n)}),n}vl.EntityFeatures={clickOnEntity:{keys:[13],shouldHandleEvent:function(e,t){return Jf(e,t)},handleEvent:function(e,t){Jf(e,t,1)}},escapeFromEntity:{keys:[27],shouldHandleEvent:function(e,t){return Jf(e,t)},handleEvent:function(e,t){Jf(e,t,3)}},enterBeforeReadonlyEntity:{keys:[13],shouldHandleEvent:function(e,t){return e0(e,t,!0,!1)},handleEvent:function(e,t){e.rawEvent.preventDefault();var e=t.getSelectionRange(),e=Qf.Position.getEnd(e).normalize().node,n=t.getDocument().createElement("BR");e.parentNode.insertBefore(n,e.nextSibling);var r,e=t.getBlockElementAtNode(e);e&&(r=e.collapseToSingleElement(),null!=(e=n.parentNode)&&e.removeChild(n)),t.getSelectionRange().deleteContents(),r.nextSibling&&t.select(r.nextSibling,0)}},backspaceAfterEntity:{keys:[8],shouldHandleEvent:function(e,t){return e0(e,t,!1,!0)},handleEvent:function(e,t){e0(e,t,!1,!0,5)}},deleteBeforeEntity:{keys:[46],shouldHandleEvent:function(e,t){return e0(e,t,!0,!0)},handleEvent:function(e,t){e0(e,t,!0,!0,4)}}};var sc={},t0=(Object.defineProperty(sc,"__esModule",{value:!0}),sc.ListFeatures=void 0,L),n0=t,R={keys:[13],shouldHandleEvent:function(e,t){t=t.getElementAtCursor("LI",null,e);return!e.rawEvent.shiftKey&&t&&(0,n0.isNodeEmpty)(t)},handleEvent:function(e,t){t.addUndoSnapshot(function(){return a0(e,t,!1)},null,!0)},defaultDisabled:!n0.Browser.isIE&&!n0.Browser.isChrome};function r0(e){return/^(\*|-|[0-9]{1,2}\.|[0-9]{1,2}\>|[0-9]{1,2}\)|[0-9]{1,2}\-|\([0-9]{1,2}\))$/.test(e)}function o0(e){return n0.VListChain.createListChains(e.getSelectedRegions())}function i0(e,t){var n,r=e.getBlockElementAtNode(t.startContainer),r=null==r?void 0:r.getEndNode();r&&"BR"!=(0,n0.getTagOfNode)(r)&&(n=e.getDocument().createElement("BR"),(0,n0.isBlockElement)(r)?r.appendChild(n):r.parentNode.insertBefore(n,r.nextSibling),e.select(t.startContainer,t.startOffset))}function a0(e,t,n){void 0===n&&(n=!0);var r=l0(e,t);r&&(r=r[0],"UL"!=(r=(0,n0.getTagOfNode)(r))&&"OL"!=r||(0,t0.toggleListType)(t,"UL"==r?2:1,null,n),t.focus(),e.rawEvent.preventDefault())}function l0(e,t){e=t.getElementAtCursor("LI,TABLE",null,e),t=e&&"LI"==(0,n0.getTagOfNode)(e)&&t.getElementAtCursor("UL,OL",e);return t?[t,e]:null}sc.ListFeatures={autoBullet:{keys:[32],shouldHandleEvent:function(e,t){return!l0(e,t)&&(r0((t=t.getContentSearcherOfCursor(e)).getSubStringBefore(4))&&!t.getNearestNonTextInlineElement())},handleEvent:function(e,o){o.insertContent("&nbsp;"),e.rawEvent.preventDefault(),o.addUndoSnapshot(function(){var e,t=o.getContentSearcherOfCursor(),n=t.getSubStringBefore(4),r=t.getRangeFromText(n,!0);r&&(0==n.indexOf("*")||0==n.indexOf("-")?(i0(o,r),(0,t0.toggleBullet)(o)):r0(n)?(i0(o,r),(0,t0.toggleNumbering)(o)):(e=o.getSelectedRegions())&&1==e.length&&(e=parseInt(n),i0(o,r),(0,t0.toggleNumbering)(o,e))),null!=(r=t.getRangeFromText(n,!0))&&r.deleteContents()},null,!0)}},indentWhenTab:{keys:[9],shouldHandleEvent:function(e,t){return!e.rawEvent.shiftKey&&l0(e,t)},handleEvent:function(e,t){(0,t0.setIndentation)(t,0),e.rawEvent.preventDefault()}},outdentWhenShiftTab:{keys:[9],shouldHandleEvent:function(e,t){return e.rawEvent.shiftKey&&l0(e,t)},handleEvent:function(e,t){(0,t0.setIndentation)(t,1),e.rawEvent.preventDefault()}},outdentWhenBackspaceOnEmptyFirstLine:{keys:[8],shouldHandleEvent:function(e,t){t=t.getElementAtCursor("LI",null,e);return t&&(0,n0.isNodeEmpty)(t)&&!t.previousSibling},handleEvent:a0},outdentWhenEnterOnEmptyLine:R,mergeInNewLineWhenBackspaceOnFirstChar:{keys:[8],shouldHandleEvent:function(e,t){e=t.getElementAtCursor("LI",null,e),t=t.getSelectionRange();return e&&(null==t?void 0:t.collapsed)&&(0,n0.isPositionAtBeginningOf)(n0.Position.getStart(t),e)},handleEvent:function(r,e){var o=e.getElementAtCursor("LI",null,r);o.previousSibling?(0,t0.blockFormat)(e,function(e,t,n){e=(0,n0.createVListFromRegion)(e,!1,o);e.setIndentation(t,n,1,!0),e.writeBack(),r.rawEvent.preventDefault()}):a0(r,e)},defaultDisabled:!0},maintainListChain:{keys:[13,9,46,8,258],shouldHandleEvent:function(e,t){return 0<t.queryElements("li",1).length},handleEvent:function(e,t){var n=o0(t);t.runAsync(function(e){return(0,t0.experimentCommitListChains)(e,n)})}},maintainListChainWhenDelete:{keys:[46],shouldHandleEvent:function(e,t){if(t.getElementAtCursor("LI",null,e))return!1;var n,r=n0.Position.getEnd(t.getSelectionRange()).isAtEnd?(n=t,(0,n0.cacheGetEventData)(e,"nextSibling",function(){var e=n.getSelectionRange(),e=n0.Position.getEnd(e).normalize(),e=n.getBodyTraverser(e.node);return null==(e=null==e?void 0:e.getNextBlockElement())?void 0:e.getStartNode()})):null;return t.getElementAtCursor("LI",r,e)},handleEvent:function(e,t){var n=o0(t);t.runAsync(function(e){return(0,t0.experimentCommitListChains)(e,n)})}}};var r={},s0=(Object.defineProperty(r,"__esModule",{value:!0}),r.MarkdownFeatures=void 0,t);function c0(e,n,l,r){return{keys:[e],shouldHandleEvent:function(e,t){return e.rawEvent.shiftKey===r&&!!d0(e,t,n)},handleEvent:function(t,e){e.runAsync(function(e){var r,o,i,a;r=t,i=n,a=l,(o=e).addUndoSnapshot(function(){var e,t,n=d0(r,o,i);n&&((t=n.cloneRange()).setStart(t.startContainer,t.startOffset+1),n.setEnd(n.endContainer,n.endOffset+1),(e=o.getDocument().createElement(a)).appendChild(t.extractContents()),n.deleteContents(),t=o.getDocument().createTextNode(""),n.insertNode(t),n.insertNode(e),o.select(t,-1))},"Format",!0)})}}}function d0(e,t,i){return(0,s0.cacheGetEventData)(e,"MARKDOWN_RANGE",function(){var r,o;return t.getContentSearcherOfCursor(e).forEachTextInlineElement(function(e){if(o&&r)return!0;var t=e.getTextContent();if(0==t[t.length-1].trim().length)return!1;if(t[t.length-1]===i)return!1;if(o=o||e.getStartPosition().move(t.length),t[0]==i)r=e.getStartPosition();else for(var n=t.length-1;0<n;n--){if(r)return!0;if(t[n]==i&&0==t[n-1].trim().length)return r=e.getStartPosition().move(n),!0}}),!!r&&!!o&&(0,s0.createRange)(r,o)})}var o=c0(56,"*","b",!0),H=c0(189,"_","i",!0),n=c0(192,"~","s",!0),Ne=c0(192,"`","code",!1),u=(r.MarkdownFeatures={markdownBold:o,markdownItalic:H,markdownStrikethru:n,markdownInlineCode:Ne},{}),u0=(Object.defineProperty(u,"__esModule",{value:!0}),u.QuoteFeatures=void 0,L),f0=t,p0="BLOCKQUOTE",h0=[p0,"LI","TD","TH"].join(",");function g0(e,n){return(0,f0.cacheGetEventData)(e,"QUOTE_CHILD",function(){var e=n.getElementAtCursor(h0);if(e&&(0,f0.getTagOfNode)(e)==p0){var t=n.getFocusedPosition(),t=t&&n.getBlockElementAtNode(t.normalize().node);if(t)return e=t.getStartNode()==e?t.getStartNode():t.collapseToSingleElement(),(0,f0.isNodeEmpty)(e)?e:null}return null})}function m0(r,o){o.addUndoSnapshot(function(){var e,t,n=g0(r,o);(0,f0.getTagOfNode)(n)==p0&&(n=(0,f0.wrap)((0,f0.toArray)(n.childNodes))),e=(0,f0.splitBalancedNodeRange)(n),t=v0(e),(0,f0.unwrap)(e),o.select(n,0),t&&(0,u0.clearFormat)(o)}),r.rawEvent.preventDefault()}var v0=function(e){return!!(e&&(0,f0.safeInstanceOf)(e,"HTMLQuoteElement")&&e.style.borderLeft&&e.style.borderColor&&e.style.paddingLeft&&e.style.color)},s=(u.QuoteFeatures={unquoteWhenBackspaceOnEmptyFirstLine:{keys:[8],shouldHandleEvent:function(e,t){e=g0(e,t);return e&&(0,f0.isNodeEmpty)(e)&&!e.previousSibling},handleEvent:m0},unquoteWhenEnterOnEmptyLine:{keys:[13],shouldHandleEvent:function(e,t){t=g0(e,t);return!e.rawEvent.shiftKey&&t&&(0,f0.isNodeEmpty)(t)},handleEvent:function(e,t){return t.addUndoSnapshot(function(){return m0(e,t)},null,!0)}}},{}),y0=(Object.defineProperty(s,"__esModule",{value:!0}),s.ShortcutFeatures=void 0,t),b0=L;function E0(e,t,n){return{winKey:e,macKey:t,action:n}}var C0=[E0(4162,8258,b0.toggleBold),E0(4169,8265,b0.toggleItalic),E0(4181,8277,b0.toggleUnderline),E0(4186,8282,function(e){return e.undo()}),E0(4185,24666,function(e){return e.redo()}),E0(4286,8382,b0.toggleBullet),E0(4287,8383,b0.toggleNumbering),E0(20670,24766,function(e){return(0,b0.changeFontSize)(e,0)}),E0(20668,24764,function(e){return(0,b0.changeFontSize)(e,1)})];function w0(n){return(0,y0.cacheGetEventData)(n,"DEFAULT_SHORT_COMMAND",function(){var e=n.rawEvent,t=0!=n.eventType||e.altKey?0:e.which|(e.metaKey&&8192)|(e.shiftKey&&16384)|(e.ctrlKey&&4096);return t&&C0.filter(function(e){return(y0.Browser.isMac?e.macKey:e.winKey)==t})[0]})}s.ShortcutFeatures={defaultShortcut:{allowFunctionKeys:!0,keys:[66,73,85,89,90,188,190,191],shouldHandleEvent:w0,handleEvent:function(e,t){var n=w0(e);n&&(n.action(t),e.rawEvent.preventDefault(),e.rawEvent.stopPropagation())}}};var g={},S0=(Object.defineProperty(g,"__esModule",{value:!0}),g.StructuredNodeFeatures=void 0,t),x0={TD:"TABLE",TH:"TABLE",LI:"OL,UL"},T0=Object.keys(x0).join(",");function O0(n,r){return(0,S0.cacheGetEventData)(n,"FIRST_STRUCTURE",function(){var e=n.rawEvent.shiftKey?null:r.getElementAtCursor(T0);if(e){var t=r.getSelectionRange();if(t&&t.collapsed&&(0,S0.isPositionAtBeginningOf)(S0.Position.getStart(t),e)&&!r.getBodyTraverser(e).getPreviousBlockElement())return r.getElementAtCursor(x0[(0,S0.getTagOfNode)(e)])}return null})}g.StructuredNodeFeatures={insertLineBeforeStructuredNodeFeature:{keys:[13],shouldHandleEvent:O0,handleEvent:function(e,t){var n=O0(e,t),r=(0,S0.createElement)(1,t.getDocument());t.addUndoSnapshot(function(){n.parentNode.insertBefore(r,n),"TABLE"==(0,S0.getTagOfNode)(n)&&t.select(new S0.Position(r,0).normalize())}),e.rawEvent.preventDefault()},defaultDisabled:!0}};var f={},P0=(Object.defineProperty(f,"__esModule",{value:!0}),f.TableFeatures=void 0,L),_0=t,Lt={keys:[38,40],shouldHandleEvent:function(e,t){return k0(e,t)&&!L0(e,t)},handleEvent:function(e,t){var r=k0(e,t),o=new _0.VTable(r),i=38==e.rawEvent.which,n=i?-1:1,a=e.rawEvent.shiftKey,e=null==(e=t.getDocument().defaultView)?void 0:e.getSelection(),l=null;if(e){for(var s=e.anchorNode,c=e.anchorOffset,d=o.row;0<=d&&d<o.cells.length;d+=n){var u=o.getCell(d,o.col);if(u.td&&u.td!=r){l=u.td;break}}t.runAsync(function(e){var t,n=e.getElementAtCursor();(0,_0.contains)(o.table,n)&&!(0,_0.contains)(r,n,!0)&&(n=l?new _0.Position(l,0):new _0.Position(o.table,i?-2:-3),a?(n=1==n.node.nodeType&&(0,_0.isVoidHtmlElement)(n.node)?new _0.Position(n.node,n.isAtEnd?-3:-2):n,null!=(t=null==(t=e.getDocument().defaultView)?void 0:t.getSelection())&&t.setBaseAndExtent(s,c,n.node,n.offset)):e.select(n))})}},defaultDisabled:!_0.Browser.isChrome&&!_0.Browser.isSafari};function k0(e,t){return(0,_0.cacheGetEventData)(e,"TABLE_CELL_FOR_TABLE_FEATURES",function(){var e=t.getFocusedPosition(),e=e&&t.getElementAtCursor("TD,TH,LI",e.node);return e&&("LI"==(0,_0.getTagOfNode)(e)?null:e)})}function L0(n,r){return(0,_0.cacheGetEventData)(n,"WHOLE_TABLE_SELECTED_FOR_FEATURES",function(){var e=k0(n,r),e=N0(n,e),t=r.getSelectionRangeEx();return 1==t.type&&(0,_0.isWholeTableSelected)(e,t.coordinates)})}function N0(e,t){return(0,_0.cacheGetEventData)(e,"VTABLE_FOR_TABLE_FEATURES",function(){return new _0.VTable(t)})}f.TableFeatures={tabInTable:{keys:[9],shouldHandleEvent:function(e,t){return k0(e,t)&&!L0(e,t)},handleEvent:function(e,t){for(var n=e.rawEvent.shiftKey,r=N0(e,k0(e,t)),o=n?-1:1,i=r.row,a=r.col+o;;a+=o){if(a<0||a>=r.cells[i].length){if((i+=o)<0){t.select(r.table,-2);break}if(i>=r.cells.length){(0,P0.editTable)(t,1);break}a=n?r.cells[i].length-1:0}var l=r.getCell(i,a);if(l.td){t.select(l.td,0);break}}e.rawEvent.preventDefault()}},upDownInTable:Lt,indentTableOnTab:{keys:[9],shouldHandleEvent:function(e,t){return k0(e,t)&&L0(e,t)},handleEvent:function(r,o){r.rawEvent.preventDefault(),o.addUndoSnapshot(function(){var e=r.rawEvent.shiftKey,t=o.getSelectionRangeEx(),n=k0(r,o),n=N0(r,n);e&&o.getElementAtCursor("blockquote",n.table,r)?(0,P0.setIndentation)(o,1):e||(0,P0.setIndentation)(o,0),o.select(t.table,t.coordinates)})}}};var nt={},R0=(Object.defineProperty(nt,"__esModule",{value:!0}),nt.TextFeatures=void 0,L),I0=t;function A0(e,t){var n=!1,r=I0.Position.getStart(t),o=I0.Position.getEnd(t),r=e.getBlockElementAtNode(r.node),e=e.getBlockElementAtNode(o.node);return!r.equals(e)||(o=new I0.Position(r.getStartNode(),0),e=new I0.Position(r.getEndNode(),-1),r=(0,I0.createRange)(o,I0.Position.getStart(t)),o=(0,I0.createRange)(I0.Position.getEnd(t),e),!(n||!M0(r)||!M0(o))||n)}function M0(e){return""==e.toString()&&0==(0,I0.queryElements)(e.commonAncestorContainer,"img,table,ul,ol",null,2,e).length}function D0(e,t){for(var n,r=e.getDocument().createElement("span"),o=6-e.getContentSearcherOfCursor(t).getSubStringBefore(Number.MAX_SAFE_INTEGER).length%6,i="",a=0;a<o;a++)i+="&ensp;";e.insertNode(r),r.nextElementSibling&&"A"==(0,I0.getTagOfNode)(r.nextElementSibling)&&((n=e.getDocument().createElement("span")).textContent=" ",e.insertNode(n),e.select((0,I0.createRange)(n,-2))),e.insertContent(i,{position:5,range:(0,I0.createRange)(r,0),updateCursor:!1}),e.select((0,I0.createRange)(r,-3)),n&&e.deleteNode(n)}nt.TextFeatures={indentWhenTabText:{keys:[9],shouldHandleEvent:function(e,t){var n,r;return!(!t.isFeatureEnabled("TabKeyTextFeatures")||e.rawEvent.shiftKey)&&(n=t.getDocument().activeElement,r=t.getElementAtCursor("LI,TABLE",null,e),t=t.getElementAtCursor((0,I0.getEntitySelector)(),void 0,e),!r&&(t||n).isContentEditable)},handleEvent:function(n,r){var o=r.getSelectionRangeEx();0==o.type&&(r.addUndoSnapshot(function(){var e,t;o.areAllCollapsed?D0(r,n):(t=(e=o.ranges)[0],A0(r,t)?(0,R0.setIndentation)(r,0):(t=(0,I0.createRange)(t.startContainer,t.startOffset),e.forEach(function(e){return e.deleteContents()}),r.select(t),D0(r,n)))}),n.rawEvent.preventDefault())}},outdentWhenTabText:{keys:[9],shouldHandleEvent:function(e,t){var n;return!(!e.rawEvent.shiftKey||!t.isFeatureEnabled("TabKeyTextFeatures"))&&(0==(n=t.getSelectionRangeEx()).type&&!n.areAllCollapsed&&t.getElementAtCursor("blockquote",null,e)&&!t.getElementAtCursor("LI,TABLE",null,e)&&A0(t,n.ranges[0]))},handleEvent:function(e,t){t.addUndoSnapshot(function(){return(0,R0.setIndentation)(t,1)}),e.rawEvent.preventDefault()}}};var j0,B0,F0,H0=e&&e.__assign||function(){return(H0=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},tn=(Object.defineProperty(sn,"__esModule",{value:!0}),Cr),tt=Wr,rt=vl,et=r,Jt=u,m=s,_e=g,Jn=f,or=nt,z0=H0(H0(H0(H0(H0(H0(H0(H0(H0(H0({},sc.ListFeatures),Jt.QuoteFeatures),Jn.TableFeatures),_e.StructuredNodeFeatures),tn.AutoLinkFeatures),m.ShortcutFeatures),tt.CursorFeatures),et.MarkdownFeatures),rt.EntityFeatures),or.TextFeatures),U0=(sn.default=function(){return z0},Object.defineProperty(i,"__esModule",{value:!0}),sn);function V0(e,t){this.settingsOverride=e,this.additionalFeatures=t}V0.prototype.getName=function(){return"ContentEdit"},V0.prototype.initialize=function(t){var r=this,o=[],i=(0,U0.default)();Object.keys(i).forEach(function(e){var t=i[e],n=r.settingsOverride&&void 0!==r.settingsOverride[e];(n&&r.settingsOverride[e]||!n&&!t.defaultDisabled)&&o.push(t)}),o.concat(this.additionalFeatures||[]).forEach(function(e){return t.addContentEditFeature(e)})},V0.prototype.dispose=function(){},i.default=V0,d=Z,Object.defineProperty(d,"__esModule",{value:!0}),d.getAllFeatures=d.ContentEdit=void 0,B0=i,Object.defineProperty(d,"ContentEdit",{enumerable:!0,get:function(){return B0.default}}),F0=sn,Object.defineProperty(d,"getAllFeatures",{enumerable:!0,get:function(){return F0.default}}),l=Er,j0=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),gr=e&&e.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||j0(t,e,n)},Object.defineProperty(l,"__esModule",{value:!0}),gr(Z,l);var W0,q0,mr={},sr={},a={},K0=(Object.defineProperty(a,"__esModule",{value:!0}),t);function Z0(e){var n=this;this.options=e,this.onDismiss=function(){var e,t;n.container&&n.isMenuShowing&&(null!=(t=(e=n.options).dismiss)&&t.call(e,n.container),n.isMenuShowing=!1)}}Z0.prototype.getName=function(){return"ContextMenu"},Z0.prototype.initialize=function(e){this.editor=e},Z0.prototype.dispose=function(){this.onDismiss(),this.container&&(this.container.parentNode.removeChild(this.container),this.container=null),this.editor=null},Z0.prototype.onPluginEvent=function(e){var t;16==e.eventType&&0<e.items.length&&(t=e.rawEvent,e=e.items,this.onDismiss(),this.options.allowDefaultMenu||t.preventDefault(),this.initContainer(t.pageX,t.pageY),this.options.render(this.container,e,this.onDismiss),this.isMenuShowing=!0)},Z0.prototype.initContainer=function(e,t){this.container||(this.container=(0,K0.createElement)(5,this.editor.getDocument()),this.editor.getDocument().body.appendChild(this.container)),this.container.style.left=e+"px",this.container.style.top=t+"px"},a.default=Z0,Q=sr,Object.defineProperty(Q,"__esModule",{value:!0}),Q.ContextMenu=void 0,q0=a,Object.defineProperty(Q,"ContextMenu",{enumerable:!0,get:function(){return q0.default}}),cr=mr,W0=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),ae=e&&e.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||W0(t,e,n)},Object.defineProperty(cr,"__esModule",{value:!0}),ae(sr,cr);function G0(e,t,n,r){return{sourceString:e,replacementHTML:t,matchSourceCaseSensitive:n,shouldReplace:r}}var $0,X0,V={},y={},Oe={},Y0=(Object.defineProperty(Oe,"__esModule",{value:!0}),[G0(":)","",!0),G0(";)","",!0),G0(":O","",!0),G0(":o","",!0),G0("<3","",!0)]);function Q0(e){this.updateReplacements(e=void 0===e?Y0:e)}Q0.prototype.updateReplacements=function(e){this.replacements=e,this.longestReplacementLength=(e=this.replacements,Math.max.apply(null,e.map(function(e){return e.sourceString.length}))),this.replacementEndCharacters=function(e){for(var t=new Set,n=0,r=e;n<r.length;n++){var o=r[n],i=o.sourceString;0!=i.length&&(i=i[i.length-1],o.matchSourceCaseSensitive?t.add(i):(t.add(i.toLocaleLowerCase()),t.add(i.toLocaleUpperCase())))}return t}(this.replacements)},Q0.prototype.getName=function(){return"CustomReplace"},Q0.prototype.initialize=function(e){this.editor=e},Q0.prototype.dispose=function(){this.editor=null},Q0.prototype.onPluginEvent=function(e){var t,n,r,o,i=this;3==e.eventType&&!this.editor.isInIME()&&e.rawEvent.data&&this.replacementEndCharacters.has(e.rawEvent.data)&&null!=this.editor.getSelectionRange()&&(t=(e=this.editor.getContentSearcherOfCursor(e)).getSubStringBefore(this.longestReplacementLength),null==(t=this.getMatchingReplacement(t))||t.shouldReplace&&!t.shouldReplace(t,e.getWordBefore())||(n=e.getSubStringBefore(t.sourceString.length),r=e.getRangeFromText(n,!0),(e=this.editor.getDocument().createElement("span")).innerHTML=this.editor.getTrustedHTMLHandler()(t.replacementHTML),o=1==e.childNodes.length?e.childNodes[0]:e,this.editor.addUndoSnapshot(function(){r.deleteContents(),r.insertNode(o),i.editor.select(o,-1)},null,!0)))},Q0.prototype.getMatchingReplacement=function(e){if(0==e.length)return null;for(var t=e.replace(/\s/g," "),n=t.toLocaleLowerCase(),r=0,o=this.replacements;r<o.length;r++){var i=o[r],a=i.matchSourceCaseSensitive?[t,i.sourceString]:[n,i.sourceString.toLocaleLowerCase()],l=a[0],a=a[1];if(l.substring(l.length-a.length)==a)return i}return null},Oe.default=Q0,p=y,Object.defineProperty(p,"__esModule",{value:!0}),p.CustomReplace=void 0,X0=Oe,Object.defineProperty(p,"CustomReplace",{enumerable:!0,get:function(){return X0.default}}),zt=V,$0=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),F=e&&e.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||$0(t,e,n)},Object.defineProperty(zt,"__esModule",{value:!0}),F(y,zt);var J0,ep,it={},B={},ot={},tp=(Object.defineProperty(ot,"__esModule",{value:!0}),L),np=t;function rp(){var e=this;this.onDrop=function(){e.cacheListChains("Drop")}}rp.prototype.getName=function(){return"CutPasteListChain"},rp.prototype.initialize=function(e){this.editor=e,this.disposer=this.editor.addDomEventHandler("drop",this.onDrop)},rp.prototype.dispose=function(){var e;null!=(e=this.disposer)&&e.call(this),this.disposer=null,this.editor=null},rp.prototype.onPluginEvent=function(e){var t;switch(e.eventType){case 9:e.isCut&&this.cacheListChains("Cut");break;case 10:this.cacheListChains("Paste");break;case 7:0<(null==(t=this.chains)?void 0:t.length)&&this.expectedChangeSource==e.source&&((0,tp.experimentCommitListChains)(this.editor,this.chains),this.chains=null,this.expectedChangeSource=null)}},rp.prototype.cacheListChains=function(e){this.chains=np.VListChain.createListChains(this.editor.getSelectedRegions()),this.expectedChangeSource=e},ot.default=rp,h=B,Object.defineProperty(h,"__esModule",{value:!0}),h.CutPasteListChain=void 0,ep=ot,Object.defineProperty(h,"CutPasteListChain",{enumerable:!0,get:function(){return ep.default}}),ta=it,J0=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),ce=e&&e.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||J0(t,e,n)},Object.defineProperty(ta,"__esModule",{value:!0}),ce(B,ta);var op,ip,Ha={},E={},er={},ap=(Object.defineProperty(er,"__esModule",{value:!0}),t);function lp(e,t,n){var r=this;this.getTooltipCallback=e=void 0===e?function(e){return e}:e,this.target=t,this.onLinkClick=n,this.trackedLink=null,this.onMouse=function(e){var t=r.editor.getElementAtCursor("a[href]",e.target),n=r.tryGetHref(t);n&&r.editor.setEditorDomAttribute("title","mouseover"==e.type?r.getTooltipCallback(n,t):null)},this.onBlur=function(e){r.trackedLink&&r.updateLinkHrefIfShouldUpdate(),r.resetLinkTracking()}}lp.prototype.getName=function(){return"Hyperlink"},lp.prototype.initialize=function(e){this.editor=e,this.disposer=this.getTooltipCallback&&e.addDomEventHandler({mouseover:this.onMouse,mouseout:this.onMouse,blur:this.onBlur})},lp.prototype.dispose=function(){this.disposer&&(this.disposer(),this.disposer=null),this.editor=null},lp.prototype.onPluginEvent=function(e){var t;if(6!=e.eventType&&(2!=e.eventType||this.isContentEditValue(e.rawEvent)&&32!=e.rawEvent.which)&&7!=e.eventType||(n=(t=this.editor.getElementAtCursor("A[href]",null,e))!==this.trackedLink||2==e.eventType||7==e.eventType,this.trackedLink&&(n||this.tryGetHref(this.trackedLink)!==this.originalHref)&&(n&&this.updateLinkHrefIfShouldUpdate(),this.resetLinkTracking()),!this.trackedLink&&this.doesLinkDisplayMatchHref(t)&&(this.trackedLink=t,this.originalHref=this.tryGetHref(t))),6==e.eventType&&(t=this.editor.getElementAtCursor("A",e.rawEvent.srcElement))&&(!this.onLinkClick||!1===this.onLinkClick(t,e.rawEvent))){var n=void 0;if(!ap.Browser.isFirefox&&(n=this.tryGetHref(t))&&(0,ap.isCtrlOrMetaPressed)(e.rawEvent)&&0===e.rawEvent.button)try{var r=this.target||"_blank";this.editor.getDocument().defaultView.open(n,r)}catch(e){}}},lp.prototype.tryGetHref=function(e){try{return e?e.href:null}catch(e){}},lp.prototype.isContentEditValue=function(e){return(0,ap.isCharacterValue)(e)||8==e.which||46==e.which},lp.prototype.updateLinkHrefIfShouldUpdate=function(){this.doesLinkDisplayMatchHref(this.trackedLink)||this.updateLinkHref()},lp.prototype.resetLinkTracking=function(){this.trackedLink=null,this.originalHref=""},lp.prototype.doesLinkDisplayMatchHref=function(e){if(e){var t=e.innerText.trim().replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),t=new RegExp("^(?:https?:\\/\\/)?"+t+"\\/?","i"),e=this.tryGetHref(e);if(null!==e)return t.test(e)}return!1},lp.prototype.updateLinkHref=function(){var e,t=this;this.trackedLink&&null!==(e=(0,ap.matchLink)(this.trackedLink.innerText.trim()))&&this.editor.addUndoSnapshot(function(){t.trackedLink.href=e.normalizedUrl})},er.default=lp,Pe=E,Object.defineProperty(Pe,"__esModule",{value:!0}),Pe.HyperLink=void 0,ip=er,Object.defineProperty(Pe,"HyperLink",{enumerable:!0,get:function(){return ip.default}}),v=Ha,op=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),No=e&&e.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||op(t,e,n)},Object.defineProperty(v,"__esModule",{value:!0}),No(E,v);var sp,cp,dp,up,_o={},c={},ie={},Ri={},Di={};function fp(e,t){return Math.abs(e-t)<.001}Hi=Di,O=e&&e.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||((r=r||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},Object.defineProperty(Hi,"__esModule",{value:!0}),Hi.ImageEditInfoState=void 0,cp=["leftPercent","rightPercent","topPercent","bottomPercent"],dp=O(O([],sp=["angleRad"],!0),cp,!0),up=O(O([],dp,!0),["widthPx","heightPx"],!0),(O=Hi.ImageEditInfoState||(Hi.ImageEditInfoState={}))[O.Invalid=0]="Invalid",O[O.ResizeOnly=1]="ResizeOnly",O[O.SameWithLast=2]="SameWithLast",O[O.FullyChanged=3]="FullyChanged",Hi.default=function(t,n){return t&&t.src&&!up.some(function(e){return!("number"==typeof t[e])})?dp.every(function(e){return fp(t[e],0)})?1:n&&sp.every(function(e){return fp(t[e],0)})&&sp.every(function(e){return fp(n[e],0)})&&cp.every(function(e){return fp(t[e],n[e])})?2:3:0};var Ki={},Qi={},pp=(Object.defineProperty(Qi,"__esModule",{value:!0}),Qi.default=function(e,t){var n=e.widthPx,r=e.heightPx,o=e.angleRad,i=n/(1-e.leftPercent-e.rightPercent),e=r/(1-e.topPercent-e.bottomPercent),n=t?i:n,t=t?e:r;return{targetWidth:Math.abs(n*Math.cos(o))+Math.abs(t*Math.sin(o)),targetHeight:Math.abs(n*Math.sin(o))+Math.abs(t*Math.cos(o)),originalWidth:i,originalHeight:e,visibleWidth:n,visibleHeight:t}},Object.defineProperty(Ki,"__esModule",{value:!0}),Qi),ea=(Ki.default=function(e,t){var n=t.angleRad,r=t.widthPx,o=t.heightPx,i=t.bottomPercent,a=t.leftPercent,l=t.rightPercent,s=t.topPercent,c=t.naturalWidth,d=t.naturalHeight,l=c*(1-a-l),i=d*(1-s-i),u=document.createElement("canvas"),t=(0,pp.default)(t),f=t.targetWidth,t=t.targetHeight,p=(u.width=f,u.height=t,u.getContext("2d"));return p.translate(f/2,t/2),p.rotate(n),p.drawImage(e,c*a,d*s,l,i,-r/2,-o/2,r,o),u.toDataURL("image/png",1)},{}),hp=(Object.defineProperty(ea,"__esModule",{value:!0}),ea.getEditInfoFromImage=ea.deleteEditInfo=ea.saveEditInfo=void 0,Di),gp=(ea.saveEditInfo=function(e,t){e&&(e.dataset.roosterEditInfo=JSON.stringify(t))},ea.deleteEditInfo=function(e){e&&delete e.dataset.roosterEditInfo},ea.getEditInfoFromImage=function(e){var t=function(e){try{return JSON.parse(e)}catch(e){return null}}(null==e?void 0:e.dataset.roosterEditInfo);return 0==(0,hp.default)(t)?{src:(e=e).getAttribute("src")||"",widthPx:e.clientWidth,heightPx:e.clientHeight,naturalWidth:e.naturalWidth,naturalHeight:e.naturalHeight,leftPercent:0,rightPercent:0,topPercent:0,bottomPercent:0,angleRad:0}:t},Object.defineProperty(Ri,"__esModule",{value:!0}),Di),mp=Ki,vp=Qi,yp=ea,Ur=(Ri.default=function(e,t,n,r,o){var i="",a=(0,yp.getEditInfoFromImage)(t);switch((0,gp.default)(n,a)){case 1:i=n.src;break;case 2:i=r;break;case 3:i=(0,mp.default)(t,n)}var l,s=i!=r,e=((i=s?e.triggerPluginEvent(19,{image:t,originalSrc:n.src,previousSrc:r,newSrc:i}).newSrc:i)==n.src?(0,yp.deleteEditInfo)(t):(0,yp.saveEditInfo)(t,n),(0,vp.default)(n)),c=e.targetWidth,e=e.targetHeight;return t.src=i,l=t,c=c,e=e,o?(l.style.maxWidth="initial",l.width=c,l.height=e,l.style.width=c+"px",l.style.height=e+"px"):(l.style.maxWidth="100%",l.style.height="initial",l.style.width="initial",l.removeAttribute("height"),l.removeAttribute("width")),s||n.widthPx!=a.widthPx||n.heightPx!=a.heightPx},{}),w=(Object.defineProperty(Ur,"__esModule",{value:!0}),Ur.default=function(e){if(!e)return!1;try{var t=e.ownerDocument.createElement("canvas"),n=(t.width=10,t.height=10,t.getContext("2d"));return n.drawImage(e,0,0),n.getImageData(0,0,1,1),!0}catch(e){return!1}},{});function bp(e,t,n,r,o){var i=this;this.trigger=e,this.context=t,this.onSubmit=n,this.handler=r,this.zoomScale=o,this.onMouseDown=function(e){var t,n;e.preventDefault(),e.stopPropagation(),i.addDocumentEvents(),i.initX=e.pageX,i.initY=e.pageY,i.initValue=null==(n=(t=i.handler).onDragStart)?void 0:n.call(t,i.context,e)},this.onMouseMove=function(e){e.preventDefault();var t,n,r=(e.pageX-i.initX)/i.zoomScale,o=(e.pageY-i.initY)/i.zoomScale;null!=(n=(t=i.handler).onDragging)&&n.call(t,i.context,e,i.initValue,r,o)&&null!=(n=i.onSubmit)&&n.call(i,i.context,i.trigger)},this.onMouseUp=function(e){var t,n;e.preventDefault(),i.removeDocumentEvents(),null!=(n=(t=i.handler).onDragEnd)&&n.call(t,i.context,e,i.initValue)&&null!=(n=i.onSubmit)&&n.call(i,i.context,i.trigger)},e.addEventListener("mousedown",this.onMouseDown)}Object.defineProperty(w,"__esModule",{value:!0}),bp.prototype.dispose=function(){this.trigger.removeEventListener("mousedown",this.onMouseDown),this.removeDocumentEvents()},bp.prototype.addDocumentEvents=function(){var e=this.trigger.ownerDocument;e.addEventListener("mousemove",this.onMouseMove,!0),e.addEventListener("mouseup",this.onMouseUp,!0)},bp.prototype.removeDocumentEvents=function(){var e=this.trigger.ownerDocument;e.removeEventListener("mousemove",this.onMouseMove,!0),e.removeEventListener("mouseup",this.onMouseUp,!0)},w.default=bp;var na={},x={},Ep=e&&e.__assign||function(){return(Ep=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Cp=(Object.defineProperty(x,"__esModule",{value:!0}),x.getResizeBordersHTML=x.getSideResizeHTML=x.getCornerResizeHTML=x.doubleCheckResize=x.rotateCoordinate=x.Resizer=void 0,0,["w","","e"]),wp=["s","","n"];function Sp(e,t,n){if(0==e&&0==t)return[0,0];var r=Math.sqrt(e*e+t*t);return n=Math.atan2(t,e)-n,[r*Math.cos(n),r*Math.sin(n)]}function xp(e,t,n,r){var o="w"==e?"left":"right",i="n"==t?"top":"bottom";return""==e&&""==t?null:{tag:"div",style:"position:absolute;"+o+":"+(""==e?"50%":"0px")+";"+i+":"+(""==t?"50%":"0px"),children:[{tag:"div",style:Tp[r](t+e,i,o,n),className:"r_resizeH",dataset:{x:e,y:t}}]}}x.Resizer={onDragStart:function(e){e=e.editInfo;return Ep({},e)},onDragging:function(e,t,n,r,o){var i=e.x,a=e.y,l=e.editInfo,e=e.options,s=0<n.widthPx&&0<n.heightPx?+n.widthPx/n.heightPx:0,c=(r=(c=Sp(r,o,l.angleRad))[0],o=c[1],""==i),d=""==a,t=!(c||d)&&(e.preserveRatio||t.shiftKey),c=c?n.widthPx:Math.max(n.widthPx+r*("w"==i?-1:1),e.minWidth),r=d?n.heightPx:Math.max(n.heightPx+o*("n"==a?-1:1),e.minHeight);return t&&0<s&&(r=Math.min(r,c/s),(c=Math.min(c,r*s))<r*s?c=r*s:r=c/s),l.widthPx=c,l.heightPx=r,!0}},x.rotateCoordinate=Sp,x.doubleCheckResize=function(e,t,n,r){var o=e.widthPx,i=e.heightPx,a=0<i?o/i:0;n=Math.floor(n),r=Math.floor(r),o=Math.floor(o),i=Math.floor(i),e.widthPx=n,e.heightPx=r,t&&0<a&&(o!==n||i!==r)&&(n<o?e.heightPx=n/a:e.widthPx=r*a)},x.getCornerResizeHTML=function(e){var n=e.borderColor,r=e.handlesExperimentalFeatures,o=[];return Cp.forEach(function(t){return wp.forEach(function(e){return o.push(""==t==(""==e)?xp(t,e,n,r?1:0):null)})}),o},x.getSideResizeHTML=function(e){var n=e.borderColor,t=e.isSmallImage,r=e.handlesExperimentalFeatures;if(t)return null;var o=[];return Cp.forEach(function(t){return wp.forEach(function(e){return o.push(""==t!=(""==e)?xp(t,e,n,r?1:0):null)})}),o},x.getResizeBordersHTML=function(e){return{tag:"div",style:"position:absolute;left:0;right:0;top:0;bottom:0;border:solid 2px "+e.borderColor+";pointer-events:none;"}};var Tp={0:function(e,t,n,r){return"position:relative;width:10px;height:10px;background-color: "+r+";cursor:"+e+"-resize;"+n+":-3px;"+t+":-3px;"},1:function(e,t,n){return"position:relative;width:10px;height:10px;background-color: #FFFFFF;cursor:"+e+"-resize;"+n+":-3px;"+t+":-3px;border-radius:100%;border: 2px solid #bfbfbf;box-shadow: 0px 0.36316px 1.36185px rgba(100, 100, 100, 0.25);"}},Op=e&&e.__assign||function(){return(Op=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Pp=(Object.defineProperty(na,"__esModule",{value:!0}),na.getCropHTML=na.Cropper=void 0,x),_p=["w","e"],kp=["s","n"],Lp={sw:0,nw:90,ne:180,se:270};function Np(e,t,n,r,o){return Math.max(Math.min(n*e+t,n*(1-r)-o),0)/n}na.Cropper={onDragStart:function(e){e=e.editInfo;return Op({},e)},onDragging:function(e,t,n,r,o){var i=e.editInfo,a=e.x,l=e.y,e=e.options,s=(r=(s=(0,Pp.rotateCoordinate)(r,o,i.angleRad))[0],o=s[1],i.widthPx),c=i.heightPx,d=i.leftPercent,u=i.rightPercent,f=i.topPercent,p=i.bottomPercent,h=e.minWidth,e=e.minHeight,g=1-d-u,m=1-f-p;return 0<g&&0<m&&(s=s/g,g=c/m,c="e"!=a?Np(n.leftPercent,r,s,u,h):d,m="w"!=a?Np(n.rightPercent,-r,s,d,h):u,a="s"!=l?Np(n.topPercent,o,g,p,e):f,r="n"!=l?Np(n.bottomPercent,-o,g,f,e):p,i.leftPercent=c,i.rightPercent=m,i.topPercent=a,i.bottomPercent=r,i.widthPx=s*(1-c-m),i.heightPx=g*(1-a-r),!0)}},na.getCropHTML=function(){var e={tag:"div",style:"position:absolute;background-color:rgb(0,0,0,0.5);pointer-events:none",className:"r_cropO"},r={tag:"div",style:"position:absolute;overflow:hidden",className:"r_cropC",children:[]};return _p.forEach(function(t){return kp.forEach(function(e){return r.children.push({tag:"div",className:"r_cropH",style:"position:absolute;pointer-events:auto;cursor:"+e+t+"-resize;"+("w"==t?"left":"right")+":0;"+("n"==e?"top":"bottom")+":0;width:22px;height:22px;transform:rotate("+Lp[e+t]+"deg)",dataset:{x:t,y:e},children:(n=[],[0,1].forEach(function(t){return[0,1].forEach(function(e){n.push({tag:"div",style:"position:absolute;left:"+t+"px;bottom:"+t+"px;"+(0==e?"right:"+t+"px;height:"+(7-2*t)+"px;":"top:"+t+"px;width:"+(7-2*t)+"px;")+";background-color:"+(0==t?"white":"black")})})}),n)});var n})}),[r,e,e,e,e]};var Vr={},Rp=e&&e.__assign||function(){return(Rp=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Ip=(Object.defineProperty(Vr,"__esModule",{value:!0}),Vr.getRotateHTML=Vr.updateRotateHandlePosition=Vr.Rotator=void 0,180/Math.PI);Vr.Rotator={onDragStart:function(e){e=e.editInfo;return Rp({},e)},onDragging:function(e,t,n,r,o){var i=e.editInfo,e=e.options,a=i.heightPx/2+31,r=a*Math.sin(n.angleRad)+r,a=a*Math.cos(n.angleRad)-o,n=Math.atan2(r,a);return t.altKey||(n=Math.round(n*Ip/e.minRotateDeg)*e.minRotateDeg/Ip),i.angleRad!=n&&(i.angleRad=n,!0)}},Vr.updateRotateHandlePosition=function(e,t,n,r,o){var i;r&&o&&t&&(i=e.angleRad,e=e.heightPx,t=(i=Math.cos(i))<=0?Number.MAX_SAFE_INTEGER:(t[1]+e/2+n)/i-e/2,n=Math.max(Math.min(15,t),0),i=Math.max(Math.min(32,t-n),0),r.style.top=-n+"px",r.style.height=n+"px",o.style.top=-i+"px")},Vr.getRotateHTML=function(e){var t=e.borderColor;return[{tag:"div",className:"r_rotateC",style:"position:absolute;left:50%;width:1px;background-color:"+t,children:[{tag:"div",className:"r_rotateH",style:"position:absolute;background-color:"+e.rotateHandleBackColor+";border:solid 1px "+t+";border-radius:50%;width:32px;height:32px;left:-16px;cursor:move",children:[(e=t,{tag:"svg",namespace:"http://www.w3.org/2000/svg",style:"width:16px;height:16px;margin: 8px 8px",children:[{tag:"path",namespace:"http://www.w3.org/2000/svg",attributes:((t={d:"M 10.5,10.0 A 3.8,3.8 0 1 1 6.7,6.3",transform:"matrix(1.1 1.1 -1.1 1.1 11.6 -10.8)"})["fill-opacity"]="0",t.stroke=e,t)},{tag:"path",namespace:"http://www.w3.org/2000/svg",attributes:{d:"M12.0 3.648l.884-.884.53 2.298-2.298-.53z",stroke:e}}]})]}]}]};var Ap=e&&e.__assign||function(){return(Ap=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Mp=e&&e.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||((r=r||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},Dp=(Object.defineProperty(ie,"__esModule",{value:!0}),Ri),jp=Ur,Bp=w,Fp=Qi,Hp=na,zp=ea,Up=Vr,Vp=L,Wp=t,qp=x,Kp=2*Math.PI/8,Zp=["nw","n","ne","e","se","s","sw","w"],Gp=((ca={}).SingleDirectionResize=2,ca.ImageRotate=4,ca.ImageCrop=8,ca),$p={borderColor:"#DB626C",minWidth:10,minHeight:10,preserveRatio:!1,minRotateDeg:5,imageSelector:"img",rotateIconHTML:null},Xp=((fa={})[1]=qp.getCornerResizeHTML,fa[2]=qp.getSideResizeHTML,fa[4]=Up.getRotateHTML,fa[8]=Hp.getCropHTML,fa),Yp="IMAGE_EDIT_WRAPPER";function Qp(e){var E=this;this.allowedOperations=1,this.onBlur=function(){E.setEditingImage(null)},this.removeWrapper=function(e){var t=null==e?void 0:e.parentNode,n=null==e?void 0:e.querySelector("img");n&&t&&(n.style.position="",n.style.margin=null,n.style.textAlign=null,t.insertBefore(n,e),t.removeChild(e))},this.updateWrapper=function(e){var t,n,r,o,i,a,l,s,c,d,u,f,p,h,g,m,v,y,b=E.getImageWrapper(E.image);b&&(t=th(b,"r_cropC"),n=th(b,"r_cropO"),r=th(b,"r_rotateC")[0],o=th(b,"r_rotateH")[0],i=th(b,"r_resizeH"),a=th(b,"r_cropH"),l=1==t.length&&4==n.length,s=(g=E.editInfo).angleRad,m=g.bottomPercent,p=g.leftPercent,h=g.rightPercent,g=g.topPercent,u=(f=(0,Fp.default)(E.editInfo,l)).targetWidth,v=f.targetHeight,c=f.originalWidth,d=f.originalHeight,y=(u-(u=f.visibleWidth))/2,f=(v-(v=f.visibleHeight))/2,p=c*p,h=c*h,g=d*g,m=d*m,b.style.width=eh(u),b.style.height=eh(v),b.style.margin=f+"px "+y+"px",b.style.transform="rotate("+s+"rad)",b.style.textAlign=(u=b.parentNode,(0,Wp.safeInstanceOf)(u,"HTMLElement")&&"rtl"==(0,Wp.getComputedStyle)(u,"direction")?"right":"left"),E.image.style.width=eh(c),E.image.style.height=eh(d),l?(Jp(t[0],p,g,h,m,void 0,void 0),Jp(n[0],0,0,h,void 0,void 0,g),Jp(n[1],void 0,0,0,m,h,void 0),Jp(n[2],p,void 0,0,0,void 0,m),Jp(n[3],0,g,void 0,0,p,void 0),nh(a,s)):(E.image.style.margin=-g+"px 0 0 "+-p+"px","r_resizeH"==(null==e?void 0:e.elementClass)&&(v=b.clientWidth,y=b.clientHeight,E.wasResized=!0,(0,qp.doubleCheckResize)(E.editInfo,E.options.preserveRatio,v,y),E.updateWrapper()),(0,Up.updateRotateHandlePosition)(E.editInfo,E.editor.getRelativeDistanceToEditor(b,!0),f,r,o),nh(i,s)))},this.options=Ap(Ap({},$p),e||{})}function Jp(e,t,n,r,o,i,a){e.style.left=eh(t),e.style.top=eh(n),e.style.right=eh(r),e.style.bottom=eh(o),e.style.width=eh(i),e.style.height=eh(a)}function eh(e){return void 0===e?null:e+"px"}function th(e,t){return(0,Wp.toArray)(e.querySelectorAll("."+t))}function nh(e,n){e.map(function(e){var t;e.style.cursor=(e=e,t=n,t=(t=Math.round(t/Kp)%8)<0?8+t:t,e=e.dataset.y+e.dataset.x,e=Zp.indexOf(e),Zp[(0<=e&&e+t)%8]+"-resize")})}function rh(e){e="string"==typeof e?parseInt(e):e;return!isNaN(e)}Qp.prototype.getName=function(){return"ImageEdit"},Qp.prototype.initialize=function(e){var t=this;this.editor=e,this.disposer=e.addDomEventHandler("blur",this.onBlur),Object.keys(Gp).forEach(function(e){t.allowedOperations|=t.editor.isFeatureEnabled(e)?Gp[e]:0})},Qp.prototype.dispose=function(){this.clearDndHelpers(),this.disposer(),this.disposer=null,this.editor=null},Qp.prototype.onPluginEvent=function(e){switch(e.eventType){case 5:this.setEditingImage(null);break;case 6:var t=e.rawEvent.target;e.isClicking&&0==e.rawEvent.button&&(0,Wp.safeInstanceOf)(t,"HTMLImageElement")&&t.isContentEditable&&(0,Wp.matchesSelector)(t,this.options.imageSelector)&&this.setEditingImage(t,7);break;case 0:t=e.rawEvent.which;46==t||8==t?this.setEditingImage(null,!0):27==t&&this.image?(this.editInfo=(0,zp.getEditInfoFromImage)(this.image),this.setEditingImage(null),e.rawEvent.preventDefault()):16!=t&&17!=t&&18!=t&&this.setEditingImage(null,!0);break;case 7:"InsertEntity"==e.source&&e.data.type==Yp||this.editor.queryElements((0,Wp.getEntitySelector)(Yp),this.removeWrapper);break;case 15:e.entity.type==Yp&&(8==e.operation?this.removeWrapper(e.entity.wrapper):1==e.operation&&e.rawEvent.preventDefault());break;case 8:(0,Wp.toArray)(e.clonedRoot.querySelectorAll(this.options.imageSelector)).forEach(function(e){(0,zp.deleteEditInfo)(e)})}},Qp.prototype.setEditingImage=function(e,t){var n,r,o,i=this,a="number"==typeof t?t:0,t="number"!=typeof t&&!!t;this.image&&(this.clearDndHelpers(),(0,Dp.default)(this.editor,this.image,this.editInfo,this.lastSrc,this.wasResized)&&this.editor.addUndoSnapshot(function(){return i.image},"ImageResize"),(n=this.getImageWrapper(this.image))&&this.removeWrapper(n),t&&this.editor.select(this.image),this.image=null,this.editInfo=null,this.lastSrc=null),!this.image&&null!=e&&e.isContentEditable&&(this.editor.addUndoSnapshot(),this.image=e,this.editInfo=(0,zp.getEditInfoFromImage)(e),this.wasResized=(t=this.image,r=t.width,o=t.height,!(""!==(t=t.style).maxWidth&&"initial"!==t.maxWidth&&"auto"!==t.maxWidth||!(rh(t.height)||rh(t.width)||rh(r)||rh(o)))),a=((0,jp.default)(e)?a:3)&this.allowedOperations,n=this.createWrapper(a),this.updateWrapper(),this.dndHelpers=Mp(Mp(Mp(Mp([],this.createDndHelpers("r_resizeH",qp.Resizer),!0),this.createDndHelpers("r_rotateH",Up.Rotator),!0),this.createDndHelpers("r_cropH",Hp.Cropper),!0),this.createDndHelpers("r_cropC",Hp.Cropper),!0),this.editor.select(n,-3))},Qp.prototype.createWrapper=function(t){var e,n,r,o=this,i=(0,Vp.insertEntity)(this.editor,Yp,(0,Wp.wrap)(this.image,6),!1,!0).wrapper,a=(i.style.position="relative",i.style.maxWidth="100%",i.style.verticalAlign="bottom",i.style.display=Wp.Browser.isSafari?"inline-block":"inline-flex",this.lastSrc=this.image.getAttribute("src"),this.image.src=this.editInfo.src,this.image.style.position="absolute",this.image.style.maxWidth=null,this.editor.isFeatureEnabled("AdaptiveHandlesResizer")),l={borderColor:this.options.borderColor,rotateIconHTML:this.options.rotateIconHTML,rotateHandleBackColor:this.editor.isDarkMode()?"#333":"white",isSmallImage:(e=this.editInfo,n=a,r=e.widthPx,e=e.heightPx,r&&e&&r*r<1e4&&n),handlesExperimentalFeatures:a},s=[(0,qp.getResizeBordersHTML)(l)];return Object.keys(Xp).forEach(function(e){(t&e)==e&&(0,Wp.arrayPush)(s,Xp[e](l))}),s.forEach(function(e){e=(0,Wp.createElement)(e,o.image.ownerDocument);e&&i.appendChild(e)}),i},Qp.prototype.getImageWrapper=function(e){e=(0,Wp.getEntityFromElement)(null==(e=null==e?void 0:e.parentNode)?void 0:e.parentNode);return(null==e?void 0:e.type)==Yp?e.wrapper:null},Qp.prototype.createDndHelpers=function(e,t){var n=this,r={editInfo:this.editInfo,options:this.options,elementClass:e},o=this.getImageWrapper(this.image);return o?th(o,e).map(function(e){return new Bp.default(e,Ap(Ap({},r),{x:e.dataset.x,y:e.dataset.y}),n.updateWrapper,t,n.editor.getZoomScale())}):[]},Qp.prototype.clearDndHelpers=function(){var e;null!=(e=this.dndHelpers)&&e.forEach(function(e){return e.dispose()}),this.dndHelpers=null},ie.default=Qp;var oh,ih,ah,lh,sh,ch,dh,uh,fh,ph,pa={},Lo={},ha=(Object.defineProperty(Lo,"__esModule",{value:!0}),Lo.default=function(e,t){var n=e.naturalWidth,r=e.naturalHeight,o=e.leftPercent,i=e.topPercent;return{width:n*(1-o-e.rightPercent)*t,height:r*(1-i-e.bottomPercent)*t}},{}),hh=(Object.defineProperty(ha,"__esModule",{value:!0}),Lo),gh=ea,mh=(ha.default=function(e,t){var e=(0,gh.getEditInfoFromImage)(e),t=(0,hh.default)(e,t),n=t.width,t=t.height;return Math.round(n)==Math.round(e.widthPx)&&Math.round(t)==Math.round(e.heightPx)},Object.defineProperty(pa,"__esModule",{value:!0}),Ri),vh=Lo,yh=ha,bh=ea,W=(pa.default=function(r,o,i,a,l){var e,t,n,s=(0,bh.getEditInfoFromImage)(o);(0,yh.default)(o,i)||(e=o,t=s.src,n=function(){var e,t,n;!r.isDisposed()&&r.contains(o)&&(e=o.getAttribute("src"),t=(n=(0,vh.default)(s,i)).width,n=n.height,s.widthPx=Math.max(t,a),s.heightPx=Math.max(n,l),r.addUndoSnapshot(function(){(0,mh.default)(r,o,s,e,!0)},"ImageResize"))},e.onload=function(){e.onload=null,e.onerror=null,n()},e.onerror=function(){e.onload=null,e.onerror=null,n()},e.src=t)},{}),Eh=(Object.defineProperty(W,"__esModule",{value:!0}),ea),za=(W.default=function(e,t){e.addUndoSnapshot(function(){t.style.width="",t.style.height="",t.style.maxWidth="100%",t.removeAttribute("width"),t.removeAttribute("height"),(0,Eh.deleteEditInfo)(t)},"ImageResize")},T=c,Object.defineProperty(T,"__esModule",{value:!0}),T.resetImage=T.isResizedTo=T.resizeByPercentage=T.canRegenerateImage=T.ImageEdit=void 0,ih=ie,Object.defineProperty(T,"ImageEdit",{enumerable:!0,get:function(){return ih.default}}),ah=Ur,Object.defineProperty(T,"canRegenerateImage",{enumerable:!0,get:function(){return ah.default}}),lh=pa,Object.defineProperty(T,"resizeByPercentage",{enumerable:!0,get:function(){return lh.default}}),sh=ha,Object.defineProperty(T,"isResizedTo",{enumerable:!0,get:function(){return sh.default}}),ch=W,Object.defineProperty(T,"resetImage",{enumerable:!0,get:function(){return ch.default}}),va=_o,oh=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),ba=e&&e.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||oh(t,e,n)},Object.defineProperty(va,"__esModule",{value:!0}),ba(c,va),{}),Ua={},Va={},Wa=e&&e.__extends||(dh=function(e,t){return(dh=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}dh(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),Ho=(Object.defineProperty(Va,"__esModule",{value:!0}),uh=ie.default,Wa(Ch,uh),Ch.prototype.showResizeHandle=function(e){this.setEditingImage(e,3)},Ch.prototype.hideResizeHandle=function(e){this.setEditingImage(null,e)},Ch);function Ch(e,t,n,r,o){return uh.call(this,{minHeight:t=void 0===t?10:t,minWidth:e=void 0===e?10:e,borderColor:n=void 0===n?"#DB626C":n,preserveRatio:r=void 0===r?!1:r,imageSelector:o=void 0===o?"img":o})||this}Va.default=Ho,qa=Ua,Object.defineProperty(qa,"__esModule",{value:!0}),qa.ImageResize=void 0,ph=Va,Object.defineProperty(qa,"ImageResize",{enumerable:!0,get:function(){return ph.default}}),Za=za,fh=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),ga=e&&e.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||fh(t,e,n)},Object.defineProperty(Za,"__esModule",{value:!0}),ga(Ua,Za);var Sr={},xr={},S={},$a={},wh=(Object.defineProperty($a,"__esModule",{value:!0}),t),R=($a.default=function(e,t){var n=e.fragment,e=e.clipboardData,r=e.html,e=e.image;r&&e&&(e=(new DOMParser).parseFromString(t(r),"text/html"),(0,wh.moveChildNodes)(n,null==e?void 0:e.body))},{}),Sh=(Object.defineProperty(R,"__esModule",{value:!0}),t);function xh(e){if(e&&!e.nextSibling&&["OL","UL","MENU"].indexOf((0,Sh.getTagOfNode)(e))<0){var n=!1;if((0,Sh.toArray)(e.childNodes).every(function(e){var t;return!(!(0,Sh.safeInstanceOf)(e,"Text")||null!=(t=e.nodeValue)&&t.trim())||"LI"==(0,Sh.getTagOfNode)(e)&&(n=!0)})&&n)return 1}}R.default=function(e){xh(e)?(0,Sh.wrap)((0,Sh.toArray)(e.childNodes),"UL"):(0,Sh.safeInstanceOf)(e.firstChild,"HTMLElement")&&xh(e.firstChild)&&(0,Sh.changeElementTag)(e.firstChild,"UL")};var o={},Th=(Object.defineProperty(o,"__esModule",{value:!0}),o.excelHandler=void 0,t),Oh=/<\/\s*td\s*>((?!<\/\s*tr\s*>)[\s\S])*$/i,Ph=/<\/\s*tr\s*>((?!<\/\s*table\s*>)[\s\S])*$/i,_h=/<tr[^>]*>[^<]*/i,kh=/<table[^>]*>[^<]*/i;function Lh(e,t){var n;return e=(e=e.match(Oh)?((n=t.match(_h))?n[0]:"<TR>")+e+"</TR>":e).match(Ph)?((n=t.match(kh))?n[0]:"<TABLE>")+e+"</TABLE>":e}o.default=function(e,t){var n=e.fragment,r=e.sanitizingOption,o=e.htmlBefore,e=e.clipboardData,o=Lh(e.html,o);e.html!=o&&(e=(new DOMParser).parseFromString(t(o),"text/html"),(0,Th.moveChildNodes)(n,null==e?void 0:e.body)),(0,Th.chainSanitizerCallback)(r.elementCallbacks,"TD",function(e){return"none"==e.style.borderStyle&&(e.style.border="solid 1px #d4d4d4"),!0})},o.excelHandler=Lh;var H={},Nh=(Object.defineProperty(H,"__esModule",{value:!0}),t),n=(H.default=function(e,t){var n=e.fragment,e=e.clipboardData;e.html&&!e.text&&e.image&&(t=(new DOMParser).parseFromString(t(e.html),"text/html"),(0,Nh.moveChildNodes)(n,null==t?void 0:t.body))},{}),Ne={},Rh=(Object.defineProperty(Ne,"__esModule",{value:!0}),t),Ih=/#_msocom_/,Lt=(Ne.default=function(e){(0,Rh.chainSanitizerCallback)(e,"SPAN",function(e){var t=(0,Rh.getStyles)(e);return"comment"!=t["mso-special-character"]&&!t["mso-comment-continuation"]||null!=(t=e.parentElement)&&t.removeChild(e),!0}),(0,Rh.chainSanitizerCallback)(e,"A",function(e){var t;return(0,Rh.getStyles)(e)["mso-comment-reference"]?(0,Rh.changeElementTag)(e,"span"):(0,Rh.safeInstanceOf)(e,"HTMLAnchorElement")&&Ih.test(e.href)&&(null!=(t=e.parentElement)&&t.removeChild(e)),!0}),(0,Rh.chainSanitizerCallback)(e,"DIV",function(e){return"comment-list"==(0,Rh.getStyles)(e)["mso-element"]&&(0,Rh.moveChildNodes)(e),!0})},{}),Cr={};Object.defineProperty(Cr,"__esModule",{value:!0}),Cr.getObject=Cr.setObject=Cr.createCustomData=void 0;function Ah(e,t){var n=t.getAttribute("NodeId");return n||(n=e.nextNodeId.toString(),e.nextNodeId++,t.setAttribute("NodeId",n)),n}Cr.createCustomData=function(){return{dict:{},nextNodeId:1}},Cr.setObject=function(e,t,n,r){1==t.nodeType&&""!=(t=Ah(e,t))&&(e.dict[t]||(e.dict[t]={}),e.dict[t][n]=r)},Cr.getObject=function(e,t,n){if(1==t.nodeType){t=Ah(e,t);if(""!=t)return e.dict[t]&&e.dict[t][n]}return null},Object.defineProperty(Lt,"__esModule",{value:!0}),Lt.createWordConverter=void 0;var Mh=Cr,Wr=(Lt.createWordConverter=function(){return{nextUniqueId:1,numBulletsConverted:0,numNumberedConverted:0,wordConverterArgs:null,wordCustomData:(0,Mh.createCustomData)()}},{}),vl={},Dh=(Object.defineProperty(vl,"__esModule",{value:!0}),vl.createLevelLists=void 0,vl.createLevelLists=function(){return{listsMetadata:{},currentUniqueListId:-1}},Object.defineProperty(Wr,"__esModule",{value:!0}),Wr.createWordConverterArguments=void 0,vl),r=(Wr.createWordConverterArguments=function(e){return{nodes:e,currentIndex:0,lists:{},listItems:[],currentListIdsByLevels:[(0,Dh.createLevelLists)()],lastProcessedItem:null}},{}),jh=(Object.defineProperty(r,"__esModule",{value:!0}),r.processNodeConvert=r.processNodesDiscovery=void 0,vl),Bh=Cr,Fh=t,Hh="UniqueListId",zh="mso-list",Uh=/[\n|\r]/gi;function Vh(e,t,n,r){var o=function e(t,n,r){var o,i=null;if((o=1==n?Zh(t):(i=e(t,n-1,null)).lastChild)&&1==o.nodeType){var a=(0,Fh.getTagOfNode)(o);if("UL"==a||"OL"==a)return o}a=t.ownerDocument.createElement(r?r.tagName:"UL");return 1==n?t.parentNode.insertBefore(a,t):i.appendChild(a),a}(t,n.level,r),i=(0,Bh.getObject)(e.wordCustomData,o,Hh);return(i&&i!=n.uniqueListId||!i&&o.firstChild)&&(i=t.ownerDocument.createElement(r.tagName),o.parentNode.insertBefore(i,o.nextSibling),o=i),(0,Bh.setObject)(e.wordCustomData,o,Hh,n.uniqueListId),t=e,i=o,(n=r).tagName!=(0,Fh.getTagOfNode)(i)&&(n=i.ownerDocument.createElement(n.tagName),(0,Bh.setObject)(t.wordCustomData,n,Hh,(0,Bh.getObject)(t.wordCustomData,i,Hh)),(0,Fh.moveChildNodes)(n,i),i.parentNode.insertBefore(n,i),i.parentNode.removeChild(i),i=n),i}function Wh(t,e){for(var n,r=[],o=t.firstChild;o;o=o.nextSibling)1==o.nodeType&&1<e&&Wh(o,e-1),n=o=Kh(o,!0),("SPAN"==(0,Fh.getTagOfNode)(n)&&!n.firstChild||$h(o))&&r.push(o);r.forEach(function(e){return t.removeChild(e)})}function qh(e,t){for(var n=null,r=e.firstChild;!n&&r;)$h(r=Kh(r,!0))?0==(n=r.textContent.trim()).length&&(n="o"):1==r.nodeType&&1<t&&(n=qh(r,t-1)),r=r.nextSibling;return n}function Kh(e,t){if(8==e.nodeType){var n=e.data;if(n&&"[if !supportlists]"==n.trim().toLowerCase()){for(var r=e,o=null,i=0;i<4&&(r=Gh(r));i++)if(8==r.nodeType&&(n=r.data)&&"[endif]"==n.trim().toLowerCase()){o=r;break}if(o){var a=e.ownerDocument.createElement("span");for(a.setAttribute("style","mso-list: ignore"),r=Gh(e);r!=o;)r=r.nextSibling,a.appendChild(r.previousSibling);o.parentNode.insertBefore(a,o),t&&(e.parentNode.removeChild(e),o.parentNode.removeChild(o)),e=a}}}return e}function Zh(e){for(var t=e;(t=t.previousSibling)&&Yh(t););return t}function Gh(e){for(var t=e;(t=t.nextSibling)&&Yh(t););return t}function $h(e){if(1==e.nodeType){e=Xh(e,zh);if(e&&0<e.length&&"ignore"==e.trim().toLowerCase())return 1}}function Xh(e,t){return(0,Fh.getStyles)(e)[t]||null}function Yh(e){if(!e)return!0;if(3==e.nodeType)return 0==e.nodeValue.replace(Uh,"").trim().length;var t=(0,Fh.getTagOfNode)(e);return e.firstChild==e.lastChild&&("SPAN"==t||"FONT"==t)&&Yh(e.firstChild)}r.processNodesDiscovery=function(e){for(var t=e.wordConverterArgs;t.currentIndex<t.nodes.length;){var n=t.nodes.item(t.currentIndex),r=function(e){if(1==e.nodeType){var t=Xh(e,zh);if(t&&0<t.length)try{var n=t.split(" ");if(3==n.length)return{level:parseInt(n[1].substr("level".length)),wordListId:t,originalNode:e,uniqueListId:0}}catch(e){}}return null}(n);if(r){var o=t.currentListIdsByLevels[r.level-1]||(0,jh.createLevelLists)();if(t.currentListIdsByLevels[r.level-1]=o,t.lastProcessedItem&&Zh(n)!=t.lastProcessedItem){i=void 0;a=void 0;l=void 0;var i=t;for(var a=0;a<i.currentListIdsByLevels.length;a++){var l=i.currentListIdsByLevels[a];l&&(l.currentUniqueListId=-1)}}var s,c=o.listsMetadata[r.wordListId];c?c.ignore||1!=c.numberOfItems||(s=qh(n,5),c.tagName=c.firstFakeBullet==s?"UL":"OL"):(s=qh(n,5),c={numberOfItems:0,uniqueListId:e.nextUniqueId++,firstFakeBullet:s,ignore:!s||0==s.length,tagName:0<=["o","","","-"].indexOf(s)?"UL":"OL"},o.listsMetadata[r.wordListId]=c,t.lists[c.uniqueListId.toString()]=c),r.uniqueListId=c.uniqueListId,c.ignore||"OL"==c.tagName&&0<c.numberOfItems&&o.currentUniqueListId!=r.uniqueListId?(c.ignore=!0,t.currentListIdsByLevels[0].currentUniqueListId=-1,t.currentListIdsByLevels=t.currentListIdsByLevels.slice(0,1)):(t.currentListIdsByLevels.length>r.level&&(t.currentListIdsByLevels=t.currentListIdsByLevels.slice(0,r.level)),o.currentUniqueListId=r.uniqueListId,t.listItems.push(r),c.numberOfItems++),t.lastProcessedItem=n}else{o=t.lastProcessedItem;o&&Zh(n)==o&&n.tagName==o.tagName&&n.className==o.className&&(o.appendChild(o.ownerDocument.createElement("br")),o.appendChild(o.ownerDocument.createElement("br")),(0,Fh.moveChildNodes)(o,n,!0),n.parentNode.removeChild(n))}t.currentIndex++}return 0<t.listItems.length},r.processNodeConvert=function(e){var t=e.wordConverterArgs;for(t.currentIndex=0;t.currentIndex<t.listItems.length;){var n,r=t.listItems[t.currentIndex],o=r.originalNode,i=t.lists[r.uniqueListId.toString()];i.ignore||(r=Vh(e,o,r,i))&&(Wh(o,5),n=o.ownerDocument.createElement("LI"),(0,Fh.moveChildNodes)(n,o),r.appendChild(n),o.parentNode.removeChild(o),"UL"==i.tagName?e.numBulletsConverted++:e.numNumberedConverted++),t.currentIndex++}return 0<e.numBulletsConverted||0<e.numNumberedConverted},Object.defineProperty(n,"__esModule",{value:!0});var Qh=Ne,Jh=t,eg=Lt,tg=Wr,ng=r,rg=/%/,u=(n.default=function(e){var t=e.sanitizingOption,e=e.fragment,n=((0,Jh.chainSanitizerCallback)(t.elementCallbacks,"O:P",function(e){return(0,Jh.moveChildNodes)(e),e.appendChild(e.ownerDocument.createTextNode("")),!0}),(0,eg.createWordConverter)()),e=e.querySelectorAll("p");0<e.length&&(n.wordConverterArgs=(0,tg.createWordConverterArguments)(e),(0,ng.processNodesDiscovery)(n)&&(0,ng.processNodeConvert)(n)),["OL","UL"].forEach(function(e){(0,Jh.chainSanitizerCallback)(t.elementCallbacks,e,function(e){return"0in"==e.style.marginBottom&&(e.style.marginBottom=""),!0})}),(0,Jh.chainSanitizerCallback)(t.cssStyleCallbacks,"line-height",function(e){return!(rg.test(e)&&!isNaN(e=parseInt(e))&&e<120)}),(0,Qh.default)(t.elementCallbacks)},{}),og=(Object.defineProperty(u,"__esModule",{value:!0}),t);function ig(e){var t,n=e.start,r=e.end;n==r&&"DIV"==(0,og.getTagOfNode)(n)?(t=(0,og.changeElementTag)(n,"SPAN"),e.start=t,e.end=t,"BR"==(0,og.getTagOfNode)(t.lastChild)&&t.removeChild(t.lastChild)):"BR"==(0,og.getTagOfNode)(r)&&(t=r.ownerDocument.createTextNode(""),null!=(n=r.parentNode)&&n.insertBefore(t,r),e.end=t,null!=(n=r.parentNode)&&n.removeChild(r))}function ag(e,t,n){var r=(0,og.getBlockElementAtNode)(e,t.start),e=n?(0,og.getNextLeafSibling)(e,t.end):(0,og.getPreviousLeafSibling)(e,t.start);null!=r&&r.contains(e)&&null!=(r=(n?t.end:t.start).parentNode)&&r.insertBefore(t.start.ownerDocument.createElement("br"),n?t.end.nextSibling:t.start)}u.default=function(e){for(var t=og.ContentTraverser.createBodyTraverser(e),n=[],r=null==t?void 0:t.currentBlockElement;r;r=t.getNextBlockElement())n.push({start:r.getStartNode(),end:r.getEndNode()});0<n.length&&(ig(n[0]),ig(n[n.length-1]),ag(e,n[0],!0),ag(e,n[n.length-1],!1))};var s={},g={},lg=(Object.defineProperty(g,"__esModule",{value:!0}),g.createListItemBlock=void 0,g.createListItemBlock=function(e){return{startElement:e=void 0===e?null:e,endElement:e,insertPositionNode:null,listItemContainers:e?[e]:[]}},Object.defineProperty(s,"__esModule",{value:!0}),s.isWordOnlineWithList=void 0,g),sg=t,cg='div.ListContainerWrapper>ul[class^="BulletListStyle"],div.ListContainerWrapper>ol[class^="NumberListStyle"],span.WACImageContainer > img';function dg(e,t,n){var r,o;e&&((o=n.insertPositionNode)?(r=o.parentNode)&&r.insertBefore(e,o):((r=n.startElement.parentNode)?r:t).appendChild(e))}s.isWordOnlineWithList=function(e){return!(!e||!e.querySelector(cg))},s.default=function(f){(0,sg.toArray)(f.querySelectorAll(cg)).forEach(function(e){var t,n=new RegExp("\\bListContainerWrapper\\b","g");e.previousSibling&&((t=(0,sg.splitParentNode)(e,!0)).className=t.className.replace(n,"")),e.nextSibling&&((t=(0,sg.splitParentNode)(e,!1)).className=t.className.replace(n,""))}),function(){for(var e,t=f.querySelectorAll(".ListContainerWrapper"),n=[],r=0;r<t.length;r++){var o,i,a=t[r];e?a==(i=(o=e.listItemContainers)[o.length-1]).nextSibling||(0,sg.getFirstLeafNode)(a)==(0,sg.getNextLeafSibling)(i.parentNode,i)?(o.push(a),e.endElement=a):(e.endElement=i,n.push(e),e=(0,lg.createListItemBlock)(a)):e=(0,lg.createListItemBlock)(a)}return 0<(null==e?void 0:e.listItemContainers.length)&&n.push(e),n}().forEach(function(c){(0,sg.collapseNodes)(f,c.startElement,c.endElement,!0).forEach(function(e){"DIV"==(0,sg.getTagOfNode)(e.firstChild)&&(0,sg.unwrap)(e)}),c.insertPositionNode=c.endElement.nextSibling;var d,u=f.ownerDocument,t=(c.listItemContainers.forEach(function(e){var t,s="UL"==(t=(0,sg.getTagOfNode)(e.firstChild))||"OL"==t?t:null;d=d||u.createElement(s),(0,sg.toArray)(e.querySelectorAll("li")).forEach(function(e){var t=parseInt(e.getAttribute("data-aria-level")),t=((0,sg.getTagOfNode)(d)!=s&&1==t&&(dg(d,f,c),d=u.createElement(s)),d),n=s,r=u;if(n){for(var o,i,a=parseInt(e.getAttribute("data-aria-level")),l=t;1<a;)l=l.firstChild?(o=l.lastElementChild,"UL"==(i=(0,sg.getTagOfNode)(o))||"OL"==i?o:(l.appendChild(r.createElement(n)),l.lastElementChild)):(l.appendChild(r.createElement(n)),l.firstElementChild),a--;l.appendChild(e)}})}),dg(d,f,c),c.startElement.parentNode);t&&c.listItemContainers.forEach(function(e){t.removeChild(e)})}),f.querySelectorAll(".WACImageContainer").forEach(function(e){(0,sg.safeInstanceOf)(e,"HTMLSpanElement")&&e.childNodes.forEach(function(e){"IMG"!=(0,sg.getTagOfNode)(e)&&e.parentElement.removeChild(e)})})},Object.defineProperty(S,"__esModule",{value:!0});var ug,fg,pg=$a,hg=R,gg=o,mg=H,vg=n,yg=u,bg=t,Eg=s,Cg="google-sheets-html-origin";function wg(e){this.unknownTagReplacement=e=void 0===e?"SPAN":e}wg.prototype.getName=function(){return"Paste"},wg.prototype.initialize=function(e){this.editor=e},wg.prototype.dispose=function(){this.editor=null},wg.prototype.onPluginEvent=function(e){var t,n,r,o,i,a;10==e.eventType&&(t=e.htmlAttributes,n=e.fragment,r=e.sanitizingOption,o=e.clipboardData,i=this.editor.getTrustedHTMLHandler(),a=void 0,"urn:schemas-microsoft-com:office:word"!=t["xmlns:w"]&&"Word.Document"!=t.ProgId?"urn:schemas-microsoft-com:office:excel"==t["xmlns:x"]||"Excel.Sheet"==t.ProgId?(0,gg.default)(e,i):"PowerPoint.Slide"==t.ProgId?(0,mg.default)(e,i):(a=(0,bg.toArray)(n.querySelectorAll('ul[class^="BulletListStyle"]>.OutlineElement,ol[class^="NumberListStyle"]>.OutlineElement,span.WACImageContainer')))&&0<a.length?(a.forEach(function(e){e.style.display=null,e.style.margin=null}),(0,Eg.isWordOnlineWithList)(n)&&(0,Eg.default)(n)):n.querySelector(Cg)?r.additionalTagReplacements[Cg]="*":this.editor.isFeatureEnabled("ConvertSingleImageBody")&&1==(null==(t=o.htmlFirstLevelChildTags)?void 0:t.length)&&"IMG"==o.htmlFirstLevelChildTags[0]?(0,pg.default)(e,i):((0,hg.default)(n),(0,yg.default)(n)):(0,vg.default)(e),r.unknownTagReplacement=this.unknownTagReplacement)},S.default=wg,f=xr,Object.defineProperty(f,"__esModule",{value:!0}),f.Paste=void 0,fg=S,Object.defineProperty(f,"Paste",{enumerable:!0,get:function(){return fg.default}}),nt=Sr,ug=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),sc=e&&e.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||ug(t,e,n)},Object.defineProperty(nt,"__esModule",{value:!0}),sc(xr,nt);var Sg,xg,Jt={},Jn={},_e={},Tg=(Object.defineProperty(_e,"__esModule",{value:!0}),L),Og=t,Pg="Backspace",_g=Og.Browser.isIE?"Esc":"Escape",kg=Og.Browser.isIE?"Left":"ArrowLeft",Lg=Og.Browser.isIE?"Up":"ArrowUp",Ng=Og.Browser.isIE?"Right":"ArrowRight",Rg=Og.Browser.isIE?"Down":"ArrowDown",Ig=Og.Browser.isIE?"Del":"Delete",Ag=[0,229];function I(e,t){this.dataProvider=e,this.pickerOptions=t,this.isPendingInputEventHandling=!1}I.prototype.getName=function(){return"Picker"},I.prototype.initialize=function(e){var n=this;this.editor=e,this.dataProvider.onInitalize(function(e){n.editor.focus();var t=n.getWord(null);t&&0!=t.length||!n.lastKnownRange||(n.editor.select(n.lastKnownRange),t=n.getWord(null)),n.editor.addUndoSnapshot(function(){t?(0,Tg.replaceWithNode)(n.editor,t,e,!0):n.editor.insertNode(e),n.setIsSuggesting(!1)},n.pickerOptions.changeSource,n.pickerOptions.handleAutoComplete)},function(e){n.setIsSuggesting(e)},e)},I.prototype.dispose=function(){this.editor=null,this.dataProvider.onDispose()},I.prototype.willHandleEventExclusively=function(e){return this.isSuggesting&&(0==e.eventType||2==e.eventType||3==e.eventType)},I.prototype.onPluginEvent=function(e){switch(e.eventType){case 7:var t;"SetContent"==e.source&&this.dataProvider.onContentChanged&&(this.isSuggesting&&this.setIsSuggesting(!1),t=[],this.editor.queryElements("[id^='"+this.pickerOptions.elementIdPrefix+"']",function(e){e.id&&t.push(e.id)}),this.dataProvider.onContentChanged(t));break;case 0:this.eventHandledOnKeyDown=!1,this.isAndroidKeyboardEvent(e)?(this.currentInputLength=this.calcInputLength(e),this.isPendingInputEventHandling=!0):(this.onKeyDownEvent(e),this.isPendingInputEventHandling=!1);break;case 3:this.isPendingInputEventHandling&&this.onAndroidInputEvent(e);break;case 2:!this.eventHandledOnKeyDown&&this.shouldHandleKeyUpEvent(e)&&(this.onKeyUpDomEvent(e),this.isPendingInputEventHandling=!1);break;case 6:this.isSuggesting&&this.setIsSuggesting(!1);break;case 14:this.dataProvider.onScroll&&this.dataProvider.onScroll(e.scrollContainer)}},I.prototype.setLastKnownRange=function(e){this.lastKnownRange=e},I.prototype.setIsSuggesting=function(e){(this.isSuggesting=e)||this.setLastKnownRange(null),this.dataProvider.onIsSuggestingChanged(e),this.setAriaOwns(e),this.setAriaActiveDescendant(e?0:null)},I.prototype.cancelDefaultKeyDownEvent=function(e){this.eventHandledOnKeyDown=!0,e.rawEvent.preventDefault(),e.rawEvent.stopImmediatePropagation()},I.prototype.getIdValue=function(e){return e.attributes&&e.attributes.getNamedItem("id")?e.attributes.getNamedItem("id").value:null},I.prototype.getWordBeforeCursor=function(e){e=this.editor.getContentSearcherOfCursor(e);return e?e.getWordBefore():null},I.prototype.replaceNode=function(e,t){e&&this.editor.deleteNode(e),t&&this.editor.insertNode(t)},I.prototype.getRangeUntilAt=function(e){var o,i,a=this;return this.editor.getContentSearcherOfCursor(e).forEachTextInlineElement(function(e){for(var t=!1,n=e.getTextContent(),r=n?n.length:-1;0<=r;){if(n[r]==a.pickerOptions.triggerCharacter){o=e.getStartPosition().move(r),t=!0;break}r--}return t&&(i=e.getEndPosition()),t}),(0,Og.createRange)(o,i)||this.editor.getDocument().createRange()},I.prototype.shouldHandleKeyUpEvent=function(e){return this.isAndroidKeyboardEvent(e)||(0,Og.isCharacterValue)(e.rawEvent)||this.isSuggesting&&!(0,Og.isModifierKey)(e.rawEvent)},I.prototype.onKeyUpDomEvent=function(e){var t,n,r;this.isSuggesting?(t=(r=(n=this.getWord(e)).substring(1)).trim(),n==this.pickerOptions.triggerCharacter||t&&0<t.length&&t.split(" ").length<=4?(this.dataProvider.queryStringUpdated(t,r==t),this.setLastKnownRange(this.editor.getSelectionRange())):this.setIsSuggesting(!1)):(n=this.getWordBeforeCursor(e),this.blockSuggestions?null!=n&&n[0]!=this.pickerOptions.triggerCharacter&&(this.blockSuggestions=!1):null!=n&&n.split(" ").length<=4&&n[0]==this.pickerOptions.triggerCharacter&&(this.setIsSuggesting(!0),t=(r=n.substring(1)).trim(),this.dataProvider.queryStringUpdated(t,r==t),this.setLastKnownRange(this.editor.getSelectionRange()),this.dataProvider.setCursorPoint&&(r=this.editor.getContentSearcherOfCursor(e),t=this.editor.getDocument().createRange(),e=r.getInlineElementBefore().getContainerNode(),this.setRangeStart(t,e,n)||(r=e.previousSibling,this.setRangeStart(t,r,this.pickerOptions.triggerCharacter)),(n=0==(n=t.getBoundingClientRect()).left&&0==n.bottom&&0==n.top?t.getClientRects()[0]:n)&&(t.detach(),e={x:n.left,y:(n.bottom+n.top)/2},r=(n.bottom-n.top)/2,this.dataProvider.setCursorPoint(e,r)))))},I.prototype.onKeyDownEvent=function(e){var t,n=e.rawEvent;this.isSuggesting?n.key==_g?(this.setIsSuggesting(!1),this.blockSuggestions=!0,this.cancelDefaultKeyDownEvent(e)):n.key==Pg?this.getWord(e)==this.pickerOptions.triggerCharacter&&this.setIsSuggesting(!1):this.dataProvider.shiftHighlight&&(this.pickerOptions.isHorizontal?n.key==kg||n.key==Ng:n.key==Lg||n.key==Rg)?(this.dataProvider.shiftHighlight(this.pickerOptions.isHorizontal?n.key==Ng:n.key==Rg),this.dataProvider.getSelectedIndex&&this.setAriaActiveDescendant(this.dataProvider.getSelectedIndex()),this.cancelDefaultKeyDownEvent(e)):!this.dataProvider.selectOption||"Enter"!=n.key&&"Tab"!=n.key||(this.dataProvider.selectOption(),this.cancelDefaultKeyDownEvent(e)):n.key==Pg?this.tryRemoveNode(e)&&this.cancelDefaultKeyDownEvent(e):n.key==Ig&&(t=(n=(n=this.editor.getContentSearcherOfCursor(e)).getInlineElementAfter()?n.getInlineElementAfter().getContainerNode():null)?this.getIdValue(n):null)&&0==t.indexOf(this.pickerOptions.elementIdPrefix)&&(t=this.dataProvider.onRemove(n,!1),this.replaceNode(n,t),this.cancelDefaultKeyDownEvent(e))},I.prototype.onAndroidInputEvent=function(e){this.newInputLength=this.calcInputLength(e),(this.newInputLength<this.currentInputLength||"deleteContentBackwards"===e.rawEvent.inputType)&&this.tryRemoveNode(e)&&(this.eventHandledOnKeyDown=!0)},I.prototype.calcInputLength=function(e){e=this.getInlineElementBeforeCursor(e);return e?e.length:0},I.prototype.tryRemoveNode=function(e){var t,e=this.editor.getContentSearcherOfCursor(e),n=e.getInlineElementBefore(),n=n?n.getContainerNode():null,r=n?this.getIdValue(n):null,e=e.getInlineElementAfter();return!(!r||0!=r.indexOf(this.pickerOptions.elementIdPrefix)||null!=e&&e instanceof Og.PartialInlineElement)&&((t=this.dataProvider.onRemove(n,!0))?(this.replaceNode(n,t),this.isPendingInputEventHandling?this.editor.runAsync(function(e){e.select(t,-3)}):this.editor.select(t,-3)):this.editor.deleteNode(n),!0)},I.prototype.getWord=function(e){var t=this.getRangeUntilAt(e).toString(),e=this.getWordBeforeCursor(e);return t==this.pickerOptions.triggerCharacter&&t!=e?e:t},I.prototype.setRangeStart=function(e,t,n){n=t?t.textContent.lastIndexOf(n):-1;return-1<n&&(e.setStart(t,n),!0)},I.prototype.setAriaOwns=function(e){this.editor.setEditorDomAttribute("aria-owns",e&&this.pickerOptions.suggestionsLabel?this.pickerOptions.suggestionsLabel:null)},I.prototype.setAriaActiveDescendant=function(e){this.editor.setEditorDomAttribute("aria-activedescendant",null!=e&&this.pickerOptions.suggestionLabelPrefix?this.pickerOptions.suggestionLabelPrefix+e.toString():null)},I.prototype.getInlineElementBeforeCursor=function(e){e=this.editor.getContentSearcherOfCursor(e),e=e?e.getInlineElementBefore():null;return e?e.getTextContent():null},I.prototype.isAndroidKeyboardEvent=function(e){return"Unidentified"==e.rawEvent.key||null==e.rawEvent.key&&-1<Ag.indexOf(e.rawEvent.charCode)},_e.default=I,tn=Jn,Object.defineProperty(tn,"__esModule",{value:!0}),tn.PickerPlugin=void 0,xg=_e,Object.defineProperty(tn,"PickerPlugin",{enumerable:!0,get:function(){return xg.default}}),m=Jt,Sg=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),tt=e&&e.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||Sg(t,e,n)},Object.defineProperty(m,"__esModule",{value:!0}),tt(Jn,m);var et={},rt={},or={},i={},sn={},Mg=(Object.defineProperty(sn,"__esModule",{value:!0}),w),Dg=t;function jg(e){var t=e.td,n=e.isRTL,r=e.zoomScale,e=e.onStart,r=new Dg.VTable(t,!0,r),t=(0,Dg.normalizeRect)(t.getBoundingClientRect());return t?(e(),e=r.getCellsWithBorder(n?t.left:t.right,!n),t=r.getCellsWithBorder(n?t.left:t.right,n),{vTable:r,currentCells:e,nextCells:t}):{vTable:r,currentCells:[],nextCells:[]}}function Bg(e,t,n,r,o){var i=e.td,a=e.zoomScale,e=n.vTable;return e.table.removeAttribute("height"),e.table.style.height=null,e.forEachCellOfCurrentRow(function(e){e.td&&(e.td.style.height=e.td==i?e.height/a+o+"px":null)}),e.writeBack(!0),!0}function Fg(e,n,t){var r=e.isRTL,o=e.zoomScale,e=t.vTable,i=t.nextCells,t=t.currentCells;if(!function(e,t,n,r,o){for(var i=0;i<t.length;i++){var a=t[i];if((l=(0,Dg.normalizeRect)(a.getBoundingClientRect()))&&(s=Hg(l,e,!r)/o)<30)return}for(i=0;i<n.length;i++){var l,a=n[i],s=Number.MAX_SAFE_INTEGER;if((s=a&&(l=(0,Dg.normalizeRect)(a.getBoundingClientRect()))?Hg(l,e,r)/o:s)<30)return}return 1}(n.pageX,t,i,r,o))return!1;var a=0==i.length,l=n.shiftKey,s=((a||l)&&(e.table.style.width=null),new Map);return t.forEach(function(e){var t=(0,Dg.normalizeRect)(e.getBoundingClientRect());t&&(e.style.wordBreak="break-word",e.style.whiteSpace="normal",e.style.boxSizing="border-box",t=Hg(t,n.pageX,!r)/o,s.set(e,t))}),s.forEach(function(e,t){t.style.width=e+"px"}),l||i.forEach(function(e){e.style.wordBreak="break-word",e.style.whiteSpace="normal",e.style.boxSizing="border-box",e.style.width=null}),e.writeBack(!0),!0}function Hg(e,t,n){return n?t-e.left:e.right-t}function zg(e,t){e=e.td,e=(0,Dg.normalizeRect)(e.getBoundingClientRect());e&&(t.style.top=e.bottom-4+"px",t.style.left=e.left+"px",t.style.width=e.right-e.left+"px",t.style.height="4px")}function Ug(e,t){var n=e.td,e=e.isRTL,n=(0,Dg.normalizeRect)(n.getBoundingClientRect());n&&(t.style.top=n.top+"px",t.style.left=(e?n.left:n.right)-4+1+"px",t.style.width="4px",t.style.height=n.bottom-n.top+"px")}sn.default=function(e,t,n,r,o,i,a){var l=e.ownerDocument,s={tag:"div",style:"position: fixed; cursor: "+(r?"row":"col")+"-resize; user-select: none"},a=(null!=a&&a(s,"CellResizer"),(0,Dg.createElement)(s,l)),s=(l.body.appendChild(a),{td:e,isRTL:n,zoomScale:t,onStart:o}),l=r?zg:Ug,n=(l(s,a),{onDragStart:jg,onDragging:r?Bg:Fg,onDragEnd:i});return{node:e,div:a,featureHandler:new Mg.default(a,s,l,n,t)}};var d={},Vg=(Object.defineProperty(d,"__esModule",{value:!0}),t),Wg=(d.default=function(e,t,n,r,o,i){var a,l,s=e.getElementAtCursor("table",t),c=(0,Vg.normalizeRect)(t.getBoundingClientRect()),s=s?(0,Vg.normalizeRect)(s.getBoundingClientRect()):null;if(c&&s)return a=t.ownerDocument,l=function(e,t,n,r){t=t?"white":"#4A4A4A";return{tag:"div",style:"position: fixed; width: 12px; height: 12px; font-size: 16px; color: "+t+"; line-height: 10px; vertical-align: middle; text-align: center; cursor: pointer; border: solid 1px "+t+"; border-radius: 50%; background-color: "+r,children:[{tag:"div",style:"position: absolute; box-sizing: border-box; background-color: "+r+";"+(e?(n?"right":"left")+": 12px; top: 5px; height: 3px; border-top: 1px solid "+t+"; border-bottom: 1px solid "+t+"; border-right: 1px solid "+t+"; border-left: 0px;":"left: 5px; top: 12px; width: 3px; border-left: 1px solid "+t+"; border-right: 1px solid "+t+"; border-bottom: 1px solid "+t+"; border-top: 0px;")},"+"]}}(r,e.isDarkMode(),n,e.getDefaultFormat().backgroundColor||"white"),null!=i&&i(l,"TableInserter"),i=(0,Vg.createElement)(l,a),r?(i.style.left=(n?c.right:c.left-13)+"px",i.style.top=c.bottom-8+"px",i.firstChild.style.width=s.right-s.left+"px"):(i.style.left=(n?c.left:c.right-8)+"px",i.style.top=c.top-13+"px",i.firstChild.style.height=s.bottom-s.top+"px"),a.body.appendChild(i),{div:i,featureHandler:new Wg(i,t,r,e,o),node:t}},qg.prototype.dispose=function(){this.div.removeEventListener("click",this.insertTd),this.div=null,this.editor=null},qg);function qg(e,t,n,r,o){var i=this;this.div=e,this.td=t,this.isHorizontal=n,this.editor=r,this.onInsert=o,this.insertTd=function(){var e=new Vg.VTable(i.td);i.isHorizontal||(e.normalizeTableCellSize(i.editor.getZoomScale()),e.table.removeAttribute("width"),e.table.style.width=null),e.edit(i.isHorizontal?1:3),e.writeBack(),i.onInsert(e.table)},this.div.addEventListener("click",this.insertTd)}var gr={},Kg=(Object.defineProperty(gr,"__esModule",{value:!0}),w),Zg=t;function Gg(e){return e.onStart(),{originalRect:e.table.getBoundingClientRect(),vTable:new Zg.VTable(e.table,!0,e.zoomScale)}}function $g(e,t,n,r,o){var i=e.isRTL,a=e.zoomScale,e=n.originalRect,l=n.vTable,s=1+r/e.width*a*(i?-1:1),c=1+o/e.height*a,d=.001<Math.abs(s-1),u=.001<Math.abs(c-1);if(d||u){for(var f=0;f<l.cells.length;f++)for(var p=0;p<l.cells[f].length;p++){var h,g=l.cells[f][p];g.td&&(d&&(l.table.style.width=null,h=g.width*s/a,g.td.style.boxSizing="border-box",30<=h&&(g.td.style.wordBreak="break-word",g.td.style.whiteSpace="normal",g.td.style.width=h+"px")),u&&(l.table.style.height=null,0==p?20<=(h=g.height*c/a)&&(g.td.style.height=h+"px"):g.td.style.height=null))}return l.writeBack(!0),!0}return!1}function Xg(e,t){var n=e.table,e=e.isRTL,n=(0,Zg.normalizeRect)(n.getBoundingClientRect());n&&(t.style.top=n.bottom+"px",t.style.left=e?n.left-12-2+"px":n.right+"px")}gr.default=function(e,t,n,r,o,i){var a=e.ownerDocument,l={tag:"div",style:"position: fixed; cursor: "+(n?"ne":"nw")+"-resize; user-select: none; border: 1px solid #808080"},i=(null!=i&&i(l,"TableResizer"),(0,Zg.createElement)(l,a)),l=(i.style.width="12px",i.style.height="12px",a.body.appendChild(i),{isRTL:n,table:e,zoomScale:t,onStart:r});return Xg(l,i),{node:e,div:i,featureHandler:new Kg.default(i,l,Xg,{onDragStart:Gg,onDragging:$g,onDragEnd:o},t)}};var Z={},Yg=(Object.defineProperty(Z,"__esModule",{value:!0}),w),Qg=t;function Jg(e,t){e=e.table,e=(0,Qg.normalizeRect)(e.getBoundingClientRect());e&&(t.style.top=e.top-12+"px",t.style.left=e.left-12-2+"px")}Z.default=function(e,t,n,r){var o=e.ownerDocument,i={tag:"div",style:"position: fixed; cursor: all-scroll; user-select: none; border: 1px solid #808080"},a=(null!=r&&r(i,"TableSelector"),(0,Qg.createElement)(i,o)),r=(a.id="_Table_Selector",a.style.width="12px",a.style.height="12px",o.body.appendChild(a),{table:e,zoomScale:t}),i=(Jg(r,a),new Yg.default(a,r,Jg,{onDragEnd:function(e,t){return t.target==a&&n(e.table),!1}},t));return{div:a,featureHandler:i,node:e}};var l={},e2=(Object.defineProperty(l,"__esModule",{value:!0}),l.disposeTableEditFeature=void 0,l.disposeTableEditFeature=function(e){var t;null!=(t=e.div.parentNode)&&t.removeChild(e.div),e.div=null,e.featureHandler.dispose(),e.featureHandler=null},Object.defineProperty(i,"__esModule",{value:!0}),sn),t2=d,n2=gr,r2=Z,o2=l,i2=t;function a2(e,t,n,r){var o=this;this.editor=e,this.table=t,this.onChanged=n,this.onShowHelperElement=r,this.onFinishEditing=function(){return o.editor.focus(),o.editor.select(o.start,o.end),o.editor.addUndoSnapshot(null,"Format"),o.onChanged(),!1},this.onStartTableResize=function(){o.onStartResize()},this.onStartCellResize=function(){o.disposeTableResizer(),o.onStartResize()},this.onInserted=function(e){o.editor.transformToDarkColor(e),o.disposeTableResizer(),o.onFinishEditing()},this.onSelect=function(e){var t,n,r;o.editor.focus(),e&&(t=(r=new i2.VTable(e)).cells.length-1,n=0,r.cells[t].forEach(function(e,t){e.td&&(n=t)}),r={firstCell:{x:0,y:0},lastCell:{y:t,x:n}},o.editor.select(e,r))},this.isRTL="rtl"==(0,i2.getComputedStyle)(t,"direction"),this.tableResizer=(0,n2.default)(t,e.getZoomScale(),this.isRTL,this.onStartTableResize,this.onFinishEditing,this.onShowHelperElement),this.tableSelector=(0,r2.default)(t,e.getZoomScale(),this.onSelect,this.onShowHelperElement)}a2.prototype.dispose=function(){this.disposeTableResizer(),this.disposeCellResizers(),this.disposeTableInserter(),this.disposeTableSelector()},a2.prototype.onMouseMove=function(e,t){for(var n=0;n<this.table.rows.length;n++){for(var r=this.table.rows[n],o=0;o<r.cells.length;o++){var i=r.cells[o],a=(0,i2.normalizeRect)(i.getBoundingClientRect());if(a){var l=t<=a.bottom;if((this.isRTL?e>=a.right:e<=a.right)&&l){0==n&&t<=a.top+5?(l=(a.left+a.right)/2,l=this.isRTL?e<l:l<e,this.setInserterTd(l?i:r.cells[o-1],!1)):0==o&&(this.isRTL?e>=a.right-5:e<=a.left+5)?this.setInserterTd(t>(a.top+a.bottom)/2?i:null==(l=this.table.rows[n-1])?void 0:l.cells[0],!0):this.setInserterTd(null),this.setResizingTd(i);break}}}if(o<r.cells.length)break}},a2.prototype.setResizingTd=function(e){var t;this.horizontalResizer&&this.horizontalResizer.node!=e&&this.disposeCellResizers(),!this.horizontalResizer&&e&&(t=this.editor.getZoomScale(),this.horizontalResizer=(0,e2.default)(e,t,this.isRTL,!0,this.onStartCellResize,this.onFinishEditing,this.onShowHelperElement),this.verticalResizer=(0,e2.default)(e,t,this.isRTL,!1,this.onStartCellResize,this.onFinishEditing,this.onShowHelperElement))},a2.prototype.setInserterTd=function(e,t){var n=t?this.horizontalInserter:this.verticalInserter;n&&n.node!=e&&this.disposeTableInserter(),this.horizontalInserter||this.verticalInserter||!e||(n=(0,t2.default)(this.editor,e,this.isRTL,t,this.onInserted,this.onShowHelperElement),t?this.horizontalInserter=n:this.verticalInserter=n)},a2.prototype.disposeTableResizer=function(){this.tableResizer&&((0,o2.disposeTableEditFeature)(this.tableResizer),this.tableResizer=null)},a2.prototype.disposeTableInserter=function(){this.horizontalInserter&&((0,o2.disposeTableEditFeature)(this.horizontalInserter),this.horizontalInserter=null),this.verticalInserter&&((0,o2.disposeTableEditFeature)(this.verticalInserter),this.verticalInserter=null)},a2.prototype.disposeCellResizers=function(){this.horizontalResizer&&((0,o2.disposeTableEditFeature)(this.horizontalResizer),this.horizontalResizer=null),this.verticalResizer&&((0,o2.disposeTableEditFeature)(this.verticalResizer),this.verticalResizer=null)},a2.prototype.disposeTableSelector=function(){this.tableSelector&&((0,o2.disposeTableEditFeature)(this.tableSelector),this.tableSelector=null)},a2.prototype.onStartResize=function(){var e=this.editor.getSelectionRange();e&&(this.start=i2.Position.getStart(e),this.end=i2.Position.getEnd(e)),this.editor.addUndoSnapshot()},i.default=a2,Object.defineProperty(or,"__esModule",{value:!0});var l2,s2,c2=i,d2=t;function u2(e){var s=this;this.onShowHelperElement=e,this.tableRectMap=null,this.onMouseMove=function(e){if(!(0<e.buttons)){s.ensureTableRects();for(var t=s.editor.getDocument().defaultView,n=e.pageX-t.scrollX,r=e.pageY-t.scrollY,o=null,i=s.tableRectMap.length-1;0<=i;i--){var a=s.tableRectMap[i],l=a.table,a=a.rect;if(n>=a.left-12&&n<=a.right+12&&r>=a.top-12&&r<=a.bottom+12){o=l;break}}s.setTableEditor(o),null!=(e=s.tableEditor)&&e.onMouseMove(n,r)}},this.invalidateTableRects=function(){s.tableRectMap=null}}u2.prototype.getName=function(){return"TableResize"},u2.prototype.initialize=function(e){this.editor=e,this.onMouseMoveDisposer=this.editor.addDomEventHandler({mousemove:this.onMouseMove})},u2.prototype.dispose=function(){this.onMouseMoveDisposer(),this.invalidateTableRects(),this.setTableEditor(null),this.editor=null},u2.prototype.onPluginEvent=function(e){switch(e.eventType){case 3:case 7:case 14:case 21:this.setTableEditor(null),this.invalidateTableRects()}},u2.prototype.setTableEditor=function(e){this.tableEditor&&e!=this.tableEditor.table&&(this.tableEditor.dispose(),this.tableEditor=null),!this.tableEditor&&e&&(this.tableEditor=new c2.default(this.editor,e,this.invalidateTableRects,this.onShowHelperElement))},u2.prototype.ensureTableRects=function(){var n=this;this.tableRectMap||(this.tableRectMap=[],this.editor.queryElements("table",function(e){var t;e.isContentEditable&&(t=(0,d2.normalizeRect)(e.getBoundingClientRect()))&&n.tableRectMap.push({table:e,rect:t})}))},or.default=u2,a=rt,Object.defineProperty(a,"__esModule",{value:!0}),a.TableResize=void 0,s2=or,Object.defineProperty(a,"TableResize",{enumerable:!0,get:function(){return s2.default}}),Q=et,l2=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),ae=e&&e.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||l2(t,e,n)},Object.defineProperty(Q,"__esModule",{value:!0}),ae(rt,Q);var f2,p2,sr={},cr={},Oe={},h2=(Object.defineProperty(Oe,"__esModule",{value:!0}),t),g2=L,m2="WATERMARK_WRAPPER";function v2(e,t){var r=this;this.watermark=e,this.format=t,this.showHideWatermark=function(){var e=r.editor.hasFocus(),t=r.editor.queryElements((0,h2.getEntitySelector)(m2)),n=0<t.length;e&&n?(t.forEach(r.removeWatermark),r.editor.focus()):e||n||!r.editor.isEmpty()||(0,g2.insertEntity)(r.editor,m2,r.editor.getDocument().createTextNode(r.watermark),!1,!1,0)},this.removeWatermark=function(e){var t=e.parentNode;null!=t&&t.removeChild(e),r.editor.contains(t)&&"DIV"==(0,h2.getTagOfNode)(t)&&!t.firstChild&&t.appendChild(r.editor.getDocument().createElement("BR"))},this.format=this.format||{fontSize:"14px",textColors:{lightModeColor:"#AAAAAA",darkModeColor:"#6B6B6B"}}}v2.prototype.getName=function(){return"Watermark"},v2.prototype.initialize=function(e){this.editor=e,this.disposer=this.editor.addDomEventHandler({focus:this.showHideWatermark,blur:this.showHideWatermark})},v2.prototype.dispose=function(){this.disposer(),this.disposer=null,this.editor=null},v2.prototype.onPluginEvent=function(e){var t,n;11==e.eventType||7==e.eventType&&(null==(t=e.data)?void 0:t.type)!=m2?this.showHideWatermark():15==e.eventType&&e.entity.type==m2&&(t=e.operation,n=e.entity.wrapper,8==t?this.removeWatermark(n):0==e.operation&&((0,h2.applyFormat)(n,this.format,this.editor.isDarkMode()),n.spellcheck=!1))},Oe.default=v2,p=cr,Object.defineProperty(p,"__esModule",{value:!0}),p.Watermark=void 0,p2=Oe,Object.defineProperty(p,"Watermark",{enumerable:!0,get:function(){return p2.default}}),F=sr,f2=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),y=e&&e.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||f2(t,e,n)},Object.defineProperty(F,"__esModule",{value:!0}),y(cr,F);var y2,b2,E2,zt={},ot={},h={},ce={},B=(Object.defineProperty(ce,"__esModule",{value:!0}),ce.default=function(e){var t=(null==e?void 0:e.selection)||{},n=t.firstCell,t=t.lastCell;if(!(e&&e.selection&&n&&t))return null;function r(e){e.x<0&&(e.x=0),e.y<0&&(e.y=0),e.y>=o.length&&(e.y=o.length-1);var t=o[e.y].length;e.x>=t&&(e.x=t-1)}var o=e.cells,e={x:Math.min(n.x,t.x),y:Math.min(n.y,t.y)},n={x:Math.max(n.x,t.x),y:Math.max(n.y,t.y)};return r(e),r(n),{firstCell:e,lastCell:n}},{}),ta=(Object.defineProperty(B,"__esModule",{value:!0}),B.forEachSelectedCell=void 0,B.forEachSelectedCell=function(e,t){for(var n,r=e.selection,o=r.lastCell,i=r.firstCell,a=i.y;a<=o.y;a++)for(var l=i.x;l<=o.x;l++)null!=(n=e.cells[a][l])&&n.td&&t(e.cells[a][l])},{}),er=(Object.defineProperty(ta,"__esModule",{value:!0}),ta.getCellCoordinates=void 0,ta.getCellCoordinates=function(e,t){var n;if(null!=e&&e.cells)for(var r=0;r<e.cells.length;r++)for(var o=0;o<e.cells[r].length;o++)t==e.cells[r][o].td&&(n={x:o,y:r});return n},{}),C2=(Object.defineProperty(er,"__esModule",{value:!0}),er.removeCellsOutsideSelection=void 0,t),w2=(er.removeCellsOutsideSelection=function(e){var t,n,r,o,i,a,l;(0,C2.isWholeTableSelected)(e,e.selection)||(t=(n=e.selection).firstCell,n=n.lastCell,r=[],o=t.x,i=t.y,a=n.x,l=n.y,e.cells.forEach(function(e,n){0<(e=e.filter(function(e,t){return i<=n&&n<=l&&o<=t&&t<=a})).length&&r.push(e)}),e.cells=r)},Object.defineProperty(h,"__esModule",{value:!0}),ce),S2=B,x2=ta,T2=er,A=t,O2="td,th",P2=[16,18,91,17,44];function M(){var n=this;this.onMouseMove=function(e){if(n.editor.contains(e.target)){if(n.tableSelection&&(0,A.contains)(n.lastTarget,e.target,!0))return k2(n.editor,n.firstTarget,0),void e.preventDefault();var t;"TABLE"!=(0,A.getTagOfNode)(e.target)?(n.setData(e.target),n.firstTarget&&!n.firstTable||(n.lastTarget.lastChild==n.lastTarget.firstChild&&"TABLE"==(0,A.getTagOfNode)(n.lastTarget.lastChild)&&"DIV"==(0,A.getTagOfNode)(n.lastTarget)||!n.editor.contains(n.lastTarget)?e.preventDefault():(n.prepareSelection(),t=!!(0,A.safeInstanceOf)(n.lastTarget,"HTMLTableCellElement")&&(0,A.contains)(n.lastTarget,n.firstTable),n.firstTable&&n.firstTable==n.targetTable||t?n.selectionInsideTableMouseMove(e):n.tableSelection&&n.restoreSelection(),n.tableSelection&&(k2(n.editor,n.firstTarget,0),e.preventDefault())))):e.preventDefault()}},this.onMouseUp=function(){n.editor&&n.removeMouseUpEventListener()},this.DeleteTableContents={keys:[46,8],shouldHandleEvent:function(e,t){return 1==t.getSelectionRangeEx().type},handleEvent:function(e,t){1==t.getSelectionRangeEx().type&&t.addUndoSnapshot(function(){t.getSelectedRegions().forEach(function(e){(0,A.safeInstanceOf)(e.rootNode,"HTMLTableCellElement")&&_2(e.rootNode,t)})})}},this.lastTarget=null,this.firstTarget=null,this.tableSelection=!1,this.tableRange={firstCell:null,lastCell:null},this.startedSelection=!1}function _2(e,t){var n=new Range;n.selectNodeContents(e),n.deleteContents(),e.appendChild(t.getDocument().createElement("br"))}function k2(e,t,n,r,o){r=r||t,o=o||n,e.getDocument().defaultView.getSelection().setBaseAndExtent(t,n,r,o)}function L2(e,t){return e&&e.getElementAtCursor(O2,t)||t}function N2(e,t){return e?e.getElementAtCursor("table",t):null}M.prototype.getName=function(){return"TableCellSelection"},M.prototype.initialize=function(e){this.editor=e,this.editor.addContentEditFeature(this.DeleteTableContents)},M.prototype.dispose=function(){this.editor.select(null),this.removeMouseUpEventListener(),this.editor=null},M.prototype.onPluginEvent=function(e){if(this.editor)switch(e.eventType){case 17:var t=this.editor.getSelectionRangeEx();1==t.type&&(this.tableRange=t.coordinates,this.firstTable=t.table,this.tableSelection=!0,this.editor.select(t.table,null));break;case 18:this.firstTable&&this.tableSelection&&this.tableRange&&(1==(t=this.editor.queryElements("#"+this.firstTable.id)).length&&(this.firstTable=t[0],this.editor.select(this.firstTable,this.tableRange)));break;case 9:this.handleBeforeCutCopy(e);break;case 5:this.startedSelection||this.handleMouseDownEvent(e);break;case 0:this.startedSelection?e.rawEvent.preventDefault():this.handleKeyDownEvent(e);break;case 2:this.startedSelection?e.rawEvent.preventDefault():this.handleKeyUpEvent(e);break;case 14:this.startedSelection&&this.handleScrollEvent();break;case 20:this.tableRange&&(this.tableRange=null,this.firstTable=null,this.tableSelection=!1,this.editor.select(null))}},M.prototype.handleScrollEvent=function(){this.setData(this.editor.getElementAtCursor()),this.firstTable==this.targetTable?this.tableSelection&&(this.vTable.selection.lastCell=(0,x2.getCellCoordinates)(this.vTable,this.lastTarget),this.selectTable(),this.tableRange.lastCell=this.vTable.selection.lastCell,k2(this.editor,this.firstTarget,0)):this.tableSelection&&this.restoreSelection()},M.prototype.handleBeforeCutCopy=function(e){var t,n=this,r=this.editor.getSelectionRangeEx();1==r.type&&(t=e.clonedRoot.querySelector("table#"+r.table.id))&&(this.tableRange=r.coordinates,(r=new A.VTable(t)).selection=this.tableRange,(0,T2.removeCellsOutsideSelection)(r),r.writeBack(),e.range.selectNode(t),e.isCut&&(0,S2.forEachSelectedCell)(this.vTable,function(e){null!=e&&e.td&&_2(e.td,n.editor)}))},M.prototype.handleKeyDownEvent=function(t){var n=this,e=t.rawEvent,r=e.shiftKey,o=e.ctrlKey,i=e.metaKey,a=e.which,e=e.defaultPrevented;r&&(o||i)||16==a||e?this.preventKeyUp=e:r&&(this.firstTarget||(o=this.editor.getFocusedPosition(),i=L2(this.editor,o.node),this.firstTarget=this.firstTarget||i),(0,A.safeInstanceOf)(this.firstTarget,"HTMLTableCellElement")&&this.editor.runAsync(function(e){e=e.getFocusedPosition();n.setData(n.tableSelection?n.lastTarget:e.node),n.firstTable==n.targetTable?(n.shouldConvertToTableSelection()||n.tableSelection)&&n.handleKeySelectionInsideTable(t):n.tableSelection&&(n.firstTable&&n.editor.select(n.firstTable,null),n.tableSelection=!1)}))},M.prototype.handleKeyUpEvent=function(e){var e=e.rawEvent,t=e.shiftKey,n=e.which,e=e.ctrlKey;t||e||!this.firstTarget||this.preventKeyUp||-1!=P2.indexOf(n)||this.clearState(),this.preventKeyUp=!1},M.prototype.handleKeySelectionInsideTable=function(e){if(this.firstTarget=L2(this.editor,this.firstTarget),this.lastTarget=L2(this.editor,this.lastTarget),k2(this.editor,this.firstTarget,0),this.vTable=this.vTable||new A.VTable(this.firstTable),this.tableRange={firstCell:(0,x2.getCellCoordinates)(this.vTable,this.firstTarget),lastCell:this.getNextTD(e)},!this.tableRange.lastCell||this.tableRange.lastCell.y>this.vTable.cells.length-1||-1==this.tableRange.lastCell.y){var t,n;if(this.lastTarget=this.editor.getElementAtCursor("td,th,div",this.firstTable),!(0,A.safeInstanceOf)(this.lastTarget,"HTMLTableCellElement"))return t=new A.Position(this.targetTable,null==this.tableRange.lastCell.y||-1==this.tableRange.lastCell.y?-2:-3),o=(r=this.editor.getDocument().defaultView.getSelection()).anchorNode,n=r.anchorOffset,this.editor.select(r.getRangeAt(0)),r.setBaseAndExtent(o,n,t.node,t.offset),this.lastTarget=t.node,void e.rawEvent.preventDefault();this.prepareSelection()}this.vTable.selection=this.tableRange,this.selectTable();var r=this.isAfter(this.firstTarget,this.lastTarget),o=new A.Position(this.lastTarget,r?0:-1);k2(this.editor,o.node,o.offset),this.tableSelection=!0,e.rawEvent.preventDefault()},M.prototype.handleMouseDownEvent=function(e){var l=this,t=e.rawEvent,n=t.which,t=t.shiftKey;if(3==n&&this.tableSelection){var r=this.editor.getElementAtCursor(O2),r=(0,x2.getCellCoordinates)(this.vTable,r);if(r){var o=(0,w2.default)(this.vTable),i=o.firstCell,o=o.lastCell;if(r.y>=i.y&&r.y<=o.y&&r.x>=i.x&&r.x<=o.x)return this.firstTarget=this.vTable.getCell(i.y,i.x).td,this.lastTarget=this.vTable.getCell(o.y,o.x).td,void(this.firstTarget&&this.lastTarget&&(this.editor.getDocument().defaultView.getSelection().setBaseAndExtent(this.firstTarget,0,this.lastTarget,0),this.selectTable()))}}1!=n||t||(this.clearState(),N2(this.editor,e.rawEvent.target)&&(this.editor.getDocument().addEventListener("mouseup",this.onMouseUp,!0),this.editor.getDocument().addEventListener("mousemove",this.onMouseMove,!0),this.startedSelection=!0)),1==n&&t&&this.editor.runAsync(function(e){var t,n,r=e.getDocument().defaultView.getSelection(),o=L2(e,r.anchorNode),r=L2(e,r.focusNode),i=N2(e,o),a=N2(e,o);i==a&&(0,A.safeInstanceOf)(o,"HTMLTableCellElement")&&(0,A.safeInstanceOf)(r,"HTMLTableCellElement")&&(l.vTable=new A.VTable(o),t=(0,x2.getCellCoordinates)(l.vTable,o),n=(0,x2.getCellCoordinates)(l.vTable,r),l.vTable.selection={firstCell:t,lastCell:n},l.firstTarget=o,l.lastTarget=r,l.selectTable(),l.tableRange=l.vTable.selection,l.tableSelection=!0,l.firstTable=i,l.targetTable=a,k2(e,o,0))})},M.prototype.restoreSelection=function(){this.firstTable&&this.editor.select(this.firstTable,null),this.tableSelection=!1;var e=this.isAfter(this.firstTarget,this.lastTarget),t=new A.Position(this.lastTarget,e?-1:0),n=new Range;this.firstTarget&&n.selectNodeContents(this.firstTarget),k2(this.editor,this.firstTarget,(e?A.Position.getEnd(n):A.Position.getStart(n)).offset,t.element,t.offset)},M.prototype.selectionInsideTableMouseMove=function(e){var t;this.lastTarget!=this.firstTarget?(k2(this.editor,this.firstTarget,0),this.firstTable!=this.targetTable&&null!=(t=this.targetTable)&&t.contains(this.firstTable)&&(this.firstTarget=this.editor.getElementAtCursor(O2,this.lastTarget)),this.firstTable&&(this.tableSelection=!0,this.vTable=this.vTable||new A.VTable(this.firstTable),this.tableRange={firstCell:(0,x2.getCellCoordinates)(this.vTable,this.firstTarget),lastCell:(0,x2.getCellCoordinates)(this.vTable,this.lastTarget)},this.vTable.selection=this.tableRange,this.selectTable()),e.preventDefault()):this.lastTarget==this.firstTarget&&this.tableSelection&&(this.vTable=new A.VTable(this.firstTable),t=(0,x2.getCellCoordinates)(this.vTable,this.firstTarget),this.tableRange={firstCell:t,lastCell:t},this.vTable.selection=this.tableRange,this.selectTable())},M.prototype.removeMouseUpEventListener=function(){this.startedSelection&&(this.startedSelection=!1,this.editor.getDocument().removeEventListener("mouseup",this.onMouseUp,!0),this.editor.getDocument().removeEventListener("mousemove",this.onMouseMove,!0))},M.prototype.clearState=function(){this.editor.select(null),this.vTable=null,this.firstTarget=null,this.lastTarget=null,this.tableRange={firstCell:null,lastCell:null},this.tableSelection=!1,this.firstTable=null,this.targetTable=null},M.prototype.getNextTD=function(e){if(this.lastTarget=this.editor.getElementAtCursor(O2,this.lastTarget),(0,A.safeInstanceOf)(this.lastTarget,"HTMLTableCellElement")){var t=(0,x2.getCellCoordinates)(this.vTable,this.lastTarget);if(this.tableSelection)switch(e.rawEvent.which){case 39:t.x+=this.lastTarget.colSpan,null==this.vTable.cells[t.y][t.x]&&(t.x=this.vTable.cells[t.y].length-1,t.y++);break;case 37:0==t.x?t.y--:t.x--;break;case 38:t.y--;break;case 40:t.y++}return 0<=t.y&&0<=t.x&&(this.lastTarget=this.vTable.getTd(t.y,t.x)),t}return null},M.prototype.prepareSelection=function(){var e,t,n,r=this.lastTarget!=this.firstTarget&&(null==(t=this.firstTable)?void 0:t.contains((0,A.findClosestElementAncestor)(this.targetTable,this.firstTable,O2)));if(r&&this.tableSelection)for(;r;)this.lastTarget=(0,A.findClosestElementAncestor)(this.targetTable,this.firstTable,O2),this.targetTable=N2(this.editor,this.lastTarget),r=this.lastTarget!=this.firstTarget&&(null==(e=this.firstTable)?void 0:e.contains((0,A.findClosestElementAncestor)(this.targetTable,this.firstTable,O2)));var o=this.lastTarget!=this.firstTarget&&(null==(t=this.targetTable)?void 0:t.contains((0,A.findClosestElementAncestor)(this.firstTable,this.targetTable,O2)));if(o&&this.tableSelection)for(;o;)this.firstTarget=(0,A.findClosestElementAncestor)(this.firstTable,this.targetTable,O2),this.firstTable=this.editor.getElementAtCursor("table",this.firstTarget),o=this.lastTarget!=this.firstTarget&&(null==(n=this.targetTable)?void 0:n.contains((0,A.findClosestElementAncestor)(this.firstTable,this.targetTable,O2)))},M.prototype.setData=function(e){var t=this.editor.getFocusedPosition();t&&(this.firstTarget=this.firstTarget||L2(this.editor,t.node),this.firstTarget.nodeType==Node.TEXT_NODE&&(this.firstTarget=this.editor.getElementAtCursor(O2,this.firstTarget)),!this.editor.contains(this.firstTarget)&&this.lastTarget&&(this.firstTarget=this.lastTarget)),this.firstTable=N2(this.editor,this.firstTarget),this.lastTarget=L2(this.editor,e),this.targetTable=N2(this.editor,this.lastTarget)},M.prototype.isAfter=function(e,t){if(e&&t){if(t.contains(e)){var n=null==(n=e.getBoundingClientRect)?void 0:n.call(e),r=null==(r=t.getBoundingClientRect)?void 0:r.call(t);if(n&&r)return n.top>r.top&&n.bottom<r.bottom}return new A.Position(e,-1).isAfter(new A.Position(t,-1))}return!1},M.prototype.shouldConvertToTableSelection=function(){var t=this;if(!this.firstTable||!this.editor)return!1;var e=this.editor.getSelectedRegions();if(1==e.length)return!1;var n=!0;return e.forEach(function(e){(0,A.contains)(t.firstTable,e.rootNode)||(n=!1)}),n},M.prototype.selectTable=function(){var e;this.editor&&this.vTable&&null!=(e=this.editor)&&e.select(this.vTable.table,(0,w2.default)(this.vTable))},h.default=M,Pe=ot,Object.defineProperty(Pe,"__esModule",{value:!0}),Pe.TableCellSelection=void 0,E2=h,Object.defineProperty(Pe,"TableCellSelection",{enumerable:!0,get:function(){return E2.default}}),No=zt,b2=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),E=e&&e.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||b2(t,e,n)},Object.defineProperty(No,"__esModule",{value:!0}),E(ot,No),v=Ad,y2=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),O=e&&e.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||y2(t,e,n)},Object.defineProperty(v,"__esModule",{value:!0}),O(Er,v),O(mr,v),O(V,v),O(it,v),O(Ha,v),O(_o,v),O(za,v),O(Sr,v),O(Jt,v),O(et,v),O(sr,v),O(zt,v);var R2="top",I2="bottom",A2="right",M2="left",D2="auto",j2=[R2,I2,A2,M2],B2="start",F2="end",H2="viewport",z2="popper",U2=j2.reduce(function(e,t){return e.concat([t+"-"+B2,t+"-"+F2])},[]),V2=[].concat(j2,[D2]).reduce(function(e,t){return e.concat([t,t+"-"+B2,t+"-"+F2])},[]),W2=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function q2(e){return e?(e.nodeName||"").toLowerCase():null}function K2(e){return null==e?window:"[object Window]"!==e.toString()?(t=e.ownerDocument)&&t.defaultView||window:e;var t}function Z2(e){return e instanceof K2(e).Element||e instanceof Element}function G2(e){return e instanceof K2(e).HTMLElement||e instanceof HTMLElement}function $2(e){return"undefined"!=typeof ShadowRoot&&(e instanceof K2(e).ShadowRoot||e instanceof ShadowRoot)}Hi={name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var o=e.state;Object.keys(o.elements).forEach(function(e){var t=o.styles[e]||{},n=o.attributes[e]||{},r=o.elements[e];G2(r)&&q2(r)&&(Object.assign(r.style,t),Object.keys(n).forEach(function(e){var t=n[e];!1===t?r.removeAttribute(e):r.setAttribute(e,!0===t?"":t)}))})},effect:function(e){var r=e.state,o={popper:{position:r.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(r.elements.popper.style,o.popper),r.styles=o,r.elements.arrow&&Object.assign(r.elements.arrow.style,o.arrow),function(){Object.keys(r.elements).forEach(function(e){var t=r.elements[e],n=r.attributes[e]||{},e=Object.keys((r.styles.hasOwnProperty(e)?r.styles:o)[e]).reduce(function(e,t){return e[t]="",e},{});G2(t)&&q2(t)&&(Object.assign(t.style,e),Object.keys(n).forEach(function(e){t.removeAttribute(e)}))})}},requires:["computeStyles"]};function X2(e){return e.split("-")[0]}var Y2=Math.max,Q2=Math.min,J2=Math.round;function e1(){var e=navigator.userAgentData;return null!=e&&e.brands?e.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function t1(){return!/^((?!chrome|android).)*safari/i.test(e1())}function n1(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1);var r=e.getBoundingClientRect(),o=1,i=1,t=(t&&G2(e)&&(o=0<e.offsetWidth&&J2(r.width)/e.offsetWidth||1,i=0<e.offsetHeight&&J2(r.height)/e.offsetHeight||1),(Z2(e)?K2(e):window).visualViewport),e=!t1()&&n,n=(r.left+(e&&t?t.offsetLeft:0))/o,e=(r.top+(e&&t?t.offsetTop:0))/i,t=r.width/o,o=r.height/i;return{width:t,height:o,top:e,right:n+t,bottom:e+o,left:n,x:n,y:e}}function r1(e){var t=n1(e),n=e.offsetWidth,r=e.offsetHeight;return Math.abs(t.width-n)<=1&&(n=t.width),Math.abs(t.height-r)<=1&&(r=t.height),{x:e.offsetLeft,y:e.offsetTop,width:n,height:r}}function o1(e,t){var n=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(n&&$2(n)){var r=t;do{if(r&&e.isSameNode(r))return!0}while(r=r.parentNode||r.host)}return!1}function i1(e){return K2(e).getComputedStyle(e)}function a1(e){return((Z2(e)?e.ownerDocument:e.document)||window.document).documentElement}function l1(e){return"html"===q2(e)?e:e.assignedSlot||e.parentNode||($2(e)?e.host:null)||a1(e)}function s1(e){return G2(e)&&"fixed"!==i1(e).position?e.offsetParent:null}function c1(e){for(var t,n=K2(e),r=s1(e);r&&(t=r,0<=["table","td","th"].indexOf(q2(t)))&&"static"===i1(r).position;)r=s1(r);return(!r||"html"!==q2(r)&&("body"!==q2(r)||"static"!==i1(r).position))&&(r||function(e){var t=/firefox/i.test(e1());if(/Trident/i.test(e1())&&G2(e)&&"fixed"===i1(e).position)return null;var n=l1(e);for($2(n)&&(n=n.host);G2(n)&&["html","body"].indexOf(q2(n))<0;){var r=i1(n);if("none"!==r.transform||"none"!==r.perspective||"paint"===r.contain||-1!==["transform","perspective"].indexOf(r.willChange)||t&&"filter"===r.willChange||t&&r.filter&&"none"!==r.filter)return n;n=n.parentNode}return null}(e))||n}function d1(e){return 0<=["top","bottom"].indexOf(e)?"x":"y"}function u1(e,t,n){return Y2(e,Q2(t,n))}function f1(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function p1(n,e){return e.reduce(function(e,t){return e[t]=n,e},{})}function h1(e){return e.split("-")[1]}var g1={top:"auto",right:"auto",bottom:"auto",left:"auto"};function m1(e){var t,n=e.popper,r=e.popperRect,o=e.placement,i=e.variation,a=e.offsets,l=e.position,s=e.gpuAcceleration,c=e.adaptive,d=e.roundOffsets,e=e.isFixed,u=a.x,u=void 0===u?0:u,f=a.y,f=void 0===f?0:f,p="function"==typeof d?d({x:u,y:f}):{x:u,y:f},u=p.x,f=p.y,p=a.hasOwnProperty("x"),a=a.hasOwnProperty("y"),h=M2,g=R2,m=window;c&&(y="clientHeight",t="clientWidth",(v=c1(n))===K2(n)&&"static"!==i1(v=a1(n)).position&&"absolute"===l&&(y="scrollHeight",t="scrollWidth"),o!==R2&&(o!==M2&&o!==A2||i!==F2)||(g=I2,f=(f-((e&&v===m&&m.visualViewport?m.visualViewport.height:v[y])-r.height))*(s?1:-1)),o!==M2&&(o!==R2&&o!==I2||i!==F2)||(h=A2,u=(u-((e&&v===m&&m.visualViewport?m.visualViewport.width:v[t])-r.width))*(s?1:-1)));var v,y,n=Object.assign({position:l},c&&g1),e=!0===d?(o=(y={x:u,y:f}).y,i=window.devicePixelRatio||1,{x:J2(y.x*i)/i||0,y:J2(o*i)/i||0}):{x:u,y:f};return u=e.x,f=e.y,s?Object.assign({},n,((v={})[g]=a?"0":"",v[h]=p?"0":"",v.transform=(m.devicePixelRatio||1)<=1?"translate("+u+"px, "+f+"px)":"translate3d("+u+"px, "+f+"px, 0)",v)):Object.assign({},n,((t={})[g]=a?f+"px":"",t[h]=p?u+"px":"",t.transform="",t))}var v1={passive:!0},y1={left:"right",right:"left",bottom:"top",top:"bottom"};function b1(e){return e.replace(/left|right|bottom|top/g,function(e){return y1[e]})}var E1={start:"end",end:"start"};function C1(e){return e.replace(/start|end/g,function(e){return E1[e]})}function w1(e){e=K2(e);return{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function S1(e){return n1(a1(e)).left+w1(e).scrollLeft}function x1(e){var e=i1(e),t=e.overflow,n=e.overflowX,e=e.overflowY;return/auto|scroll|overlay|hidden/.test(t+e+n)}function T1(e,t){void 0===t&&(t=[]);var n=function e(t){return 0<=["html","body","#document"].indexOf(q2(t))?t.ownerDocument.body:G2(t)&&x1(t)?t:e(l1(t))}(e),e=n===(null==(e=e.ownerDocument)?void 0:e.body),r=K2(n),r=e?[r].concat(r.visualViewport||[],x1(n)?n:[]):n,n=t.concat(r);return e?n:n.concat(T1(l1(r)))}function O1(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function P1(e,t,n){return t===H2?O1((o=n,a=K2(r=e),l=a1(r),a=a.visualViewport,s=l.clientWidth,l=l.clientHeight,d=c=0,a&&(s=a.width,l=a.height,((i=t1())||!i&&"fixed"===o)&&(c=a.offsetLeft,d=a.offsetTop)),{width:s,height:l,x:c+S1(r),y:d})):Z2(t)?((o=n1(i=t,!1,"fixed"===n)).top=o.top+i.clientTop,o.left=o.left+i.clientLeft,o.bottom=o.top+i.clientHeight,o.right=o.left+i.clientWidth,o.width=i.clientWidth,o.height=i.clientHeight,o.x=o.left,o.y=o.top,o):O1((a=a1(e),s=a1(a),l=w1(a),c=null==(c=a.ownerDocument)?void 0:c.body,r=Y2(s.scrollWidth,s.clientWidth,c?c.scrollWidth:0,c?c.clientWidth:0),d=Y2(s.scrollHeight,s.clientHeight,c?c.scrollHeight:0,c?c.clientHeight:0),a=-l.scrollLeft+S1(a),l=-l.scrollTop,"rtl"===i1(c||s).direction&&(a+=Y2(s.clientWidth,c?c.clientWidth:0)-r),{width:r,height:d,x:a,y:l}));var r,o,i,a,l,s,c,d}function _1(e){var t,n=e.reference,r=e.element,e=e.placement,o=e?X2(e):null,e=e?h1(e):null,i=n.x+n.width/2-r.width/2,a=n.y+n.height/2-r.height/2;switch(o){case R2:t={x:i,y:n.y-r.height};break;case I2:t={x:i,y:n.y+n.height};break;case A2:t={x:n.x+n.width,y:a};break;case M2:t={x:n.x-r.width,y:a};break;default:t={x:n.x,y:n.y}}var l=o?d1(o):null;if(null!=l){var s="y"===l?"height":"width";switch(e){case B2:t[l]=t[l]-(n[s]/2-r[s]/2);break;case F2:t[l]=t[l]+(n[s]/2-r[s]/2)}}return t}function k1(e,t){var n,r,o,i,a,l,t=t=void 0===t?{}:t,s=t.placement,s=void 0===s?e.placement:s,c=t.strategy,c=void 0===c?e.strategy:c,d=t.boundary,d=void 0===d?"clippingParents":d,u=t.rootBoundary,u=void 0===u?H2:u,f=t.elementContext,f=void 0===f?z2:f,p=t.altBoundary,p=void 0!==p&&p,t=t.padding,t=void 0===t?0:t,t=f1("number"!=typeof t?t:p1(t,j2)),h=e.rects.popper,p=e.elements[p?f===z2?"reference":z2:f],c=(n=Z2(p)?p:p.contextElement||a1(e.elements.popper),p=u,r=c,i="clippingParents"===(u=d)?(a=T1(l1(i=n)),Z2(o=0<=["absolute","fixed"].indexOf(i1(i).position)&&G2(i)?c1(i):i)?a.filter(function(e){return Z2(e)&&o1(e,o)&&"body"!==q2(e)}):[]):[].concat(u),a=[].concat(i,[p]),u=a[0],(p=a.reduce(function(e,t){t=P1(n,t,r);return e.top=Y2(t.top,e.top),e.right=Q2(t.right,e.right),e.bottom=Q2(t.bottom,e.bottom),e.left=Y2(t.left,e.left),e},P1(n,u,r))).width=p.right-p.left,p.height=p.bottom-p.top,p.x=p.left,p.y=p.top,p),d=n1(e.elements.reference),u=_1({reference:d,element:h,strategy:"absolute",placement:s}),p=O1(Object.assign({},h,u)),h=f===z2?p:d,g={top:c.top-h.top+t.top,bottom:h.bottom-c.bottom+t.bottom,left:c.left-h.left+t.left,right:h.right-c.right+t.right},u=e.modifiersData.offset;return f===z2&&u&&(l=u[s],Object.keys(g).forEach(function(e){var t=0<=[A2,I2].indexOf(e)?1:-1,n=0<=[R2,I2].indexOf(e)?"y":"x";g[e]+=l[n]*t})),g}function L1(e,t,n){return{top:e.top-t.height-(n=void 0===n?{x:0,y:0}:n).y,right:e.right-t.width+n.x,bottom:e.bottom-t.height+n.y,left:e.left-t.width-n.x}}function N1(t){return[R2,A2,I2,M2].some(function(e){return 0<=t[e]})}function R1(e){var n=new Map,r=new Set,o=[];return e.forEach(function(e){n.set(e.name,e)}),e.forEach(function(e){r.has(e.name)||function t(e){r.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach(function(e){r.has(e)||(e=n.get(e))&&t(e)}),o.push(e)}(e)}),o}var I1={placement:"bottom",modifiers:[],strategy:"absolute"};function A1(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return!t.some(function(e){return!(e&&"function"==typeof e.getBoundingClientRect)})}Ki=(Di=Di=void 0===(Di={defaultModifiers:[{name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,n=e.instance,e=e.options,r=e.scroll,o=void 0===r||r,r=e.resize,i=void 0===r||r,a=K2(t.elements.popper),l=[].concat(t.scrollParents.reference,t.scrollParents.popper);return o&&l.forEach(function(e){e.addEventListener("scroll",n.update,v1)}),i&&a.addEventListener("resize",n.update,v1),function(){o&&l.forEach(function(e){e.removeEventListener("scroll",n.update,v1)}),i&&a.removeEventListener("resize",n.update,v1)}},data:{}},{name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,e=e.name;t.modifiersData[e]=_1({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}},{name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,e=e.options,n=e.gpuAcceleration,n=void 0===n||n,r=e.adaptive,r=void 0===r||r,e=e.roundOffsets,e=void 0===e||e,n={placement:X2(t.placement),variation:h1(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:n,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,m1(Object.assign({},n,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:r,roundOffsets:e})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,m1(Object.assign({},n,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:e})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}},Hi,{name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var a=e.state,t=e.options,e=e.name,t=t.offset,l=void 0===t?[0,0]:t,t=V2.reduce(function(e,t){return e[t]=(t=t,n=a.rects,r=l,o=X2(t),i=0<=[M2,R2].indexOf(o)?-1:1,n="function"==typeof r?r(Object.assign({},n,{placement:t})):r,t=n[0]||0,r=(n[1]||0)*i,0<=[M2,A2].indexOf(o)?{x:r,y:t}:{x:t,y:r}),e;var n,r,o,i},{}),n=t[a.placement],r=n.x,n=n.y;null!=a.modifiersData.popperOffsets&&(a.modifiersData.popperOffsets.x+=r,a.modifiersData.popperOffsets.y+=n),a.modifiersData[e]=t}},{name:"flip",enabled:!0,phase:"main",fn:function(e){var u=e.state,t=e.options,e=e.name;if(!u.modifiersData[e]._skip){for(var n=t.mainAxis,r=void 0===n||n,n=t.altAxis,o=void 0===n||n,n=t.fallbackPlacements,f=t.padding,p=t.boundary,h=t.rootBoundary,i=t.altBoundary,a=t.flipVariations,g=void 0===a||a,m=t.allowedAutoPlacements,a=u.options.placement,t=X2(a),n=n||(t!==a&&g?function(e){if(X2(e)===D2)return[];var t=b1(e);return[C1(e),t,C1(t)]}(a):[b1(a)]),l=[a].concat(n).reduce(function(e,t){return e.concat(X2(t)===D2?(n=u,r=(e=e=void 0===(e={placement:t,boundary:p,rootBoundary:h,padding:f,flipVariations:g,allowedAutoPlacements:m})?{}:e).placement,o=e.boundary,i=e.rootBoundary,a=e.padding,l=e.flipVariations,s=void 0===(e=e.allowedAutoPlacements)?V2:e,c=h1(r),e=c?l?U2:U2.filter(function(e){return h1(e)===c}):j2,d=(r=0===(r=e.filter(function(e){return 0<=s.indexOf(e)})).length?e:r).reduce(function(e,t){return e[t]=k1(n,{placement:t,boundary:o,rootBoundary:i,padding:a})[X2(t)],e},{}),Object.keys(d).sort(function(e,t){return d[e]-d[t]})):t);var n,r,o,i,a,l,s,c,d},[]),s=u.rects.reference,c=u.rects.popper,d=new Map,v=!0,y=l[0],b=0;b<l.length;b++){var E=l[b],C=X2(E),w=h1(E)===B2,S=0<=[R2,I2].indexOf(C),x=S?"width":"height",T=k1(u,{placement:E,boundary:p,rootBoundary:h,altBoundary:i,padding:f}),S=S?w?A2:M2:w?I2:R2,w=(s[x]>c[x]&&(S=b1(S)),b1(S)),x=[];if(r&&x.push(T[C]<=0),o&&x.push(T[S]<=0,T[w]<=0),x.every(function(e){return e})){y=E,v=!1;break}d.set(E,x)}if(v)for(var O=g?3:1;0<O&&"break"!==function(t){var e=l.find(function(e){e=d.get(e);if(e)return e.slice(0,t).every(function(e){return e})});if(e)return y=e,"break"}(O);O--);u.placement!==y&&(u.modifiersData[e]._skip=!0,u.placement=y,u.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}},{name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t,n,r,o,i,a,l,s,c,d=e.state,u=e.options,e=e.name,f=u.mainAxis,f=void 0===f||f,p=u.altAxis,p=void 0!==p&&p,h=u.boundary,g=u.rootBoundary,m=u.altBoundary,v=u.padding,y=u.tether,y=void 0===y||y,u=u.tetherOffset,u=void 0===u?0:u,h=k1(d,{boundary:h,rootBoundary:g,padding:v,altBoundary:m}),g=X2(d.placement),v=h1(d.placement),m=!v,b=d1(g),E="x"===b?"y":"x",C=d.modifiersData.popperOffsets,w=d.rects.reference,S=d.rects.popper,u="function"==typeof u?u(Object.assign({},d.rects,{placement:d.placement})):u,u="number"==typeof u?{mainAxis:u,altAxis:u}:Object.assign({mainAxis:0,altAxis:0},u),x=d.modifiersData.offset?d.modifiersData.offset[d.placement]:null,T={x:0,y:0};C&&(f&&(f="y"===b?"height":"width",a=(l=C[b])+h[n="y"===b?R2:M2],s=l-h[c="y"===b?I2:A2],t=y?-S[f]/2:0,o=(v===B2?w:S)[f],v=v===B2?-S[f]:-w[f],i=d.elements.arrow,i=y&&i?r1(i):{width:0,height:0},n=(r=d.modifiersData["arrow#persistent"]?d.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0})[n],r=r[c],c=u1(0,w[f],i[f]),i=m?w[f]/2-t-c-n-u.mainAxis:o-c-n-u.mainAxis,o=m?-w[f]/2+t+c+r+u.mainAxis:v+c+r+u.mainAxis,m=(n=d.elements.arrow&&c1(d.elements.arrow))?"y"===b?n.clientTop||0:n.clientLeft||0:0,v=l+o-(t=null!=(f=null==x?void 0:x[b])?f:0),c=u1(y?Q2(a,l+i-t-m):a,l,y?Y2(s,v):s),C[b]=c,T[b]=c-l),p&&(r="y"==E?"height":"width",o=(n=C[E])+h["x"===b?R2:M2],f=n-h["x"===b?I2:A2],i=-1!==[R2,M2].indexOf(g),m=null!=(t=null==x?void 0:x[E])?t:0,a=i?o:n-w[r]-S[r]-m+u.altAxis,v=i?n+w[r]+S[r]-m-u.altAxis:f,l=y&&i?(c=u1(a,n,s=v),s<c?s:c):u1(y?a:o,n,y?v:f),C[E]=l,T[E]=l-n),d.modifiersData[e]=T)},requiresIfExists:["offset"]},{name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,n,r,o,i=e.state,a=e.name,e=e.options,l=i.elements.arrow,s=i.modifiersData.popperOffsets,c=X2(i.placement),d=d1(c),c=0<=[M2,A2].indexOf(c)?"height":"width";l&&s&&(e=f1("number"!=typeof(e="function"==typeof(e=e.padding)?e(Object.assign({},i.rects,{placement:i.placement})):e)?e:p1(e,j2)),t=r1(l),o="y"===d?R2:M2,r="y"===d?I2:A2,n=i.rects.reference[c]+i.rects.reference[d]-s[d]-i.rects.popper[c],s=s[d]-i.rects.reference[d],l=(l=c1(l))?"y"===d?l.clientHeight||0:l.clientWidth||0:0,o=e[o],e=l-t[c]-e[r],o=u1(o,r=l/2-t[c]/2+(n/2-s/2),e),i.modifiersData[a]=((l={})[d]=o,l.centerOffset=o-r,l))},effect:function(e){var t=e.state,e=e.options.element,e=void 0===e?"[data-popper-arrow]":e;null!=e&&("string"!=typeof e||(e=t.elements.popper.querySelector(e)))&&o1(t.elements.popper,e)&&(t.elements.arrow=e)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]},{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,e=e.name,n=t.rects.reference,r=t.rects.popper,o=t.modifiersData.preventOverflow,i=k1(t,{elementContext:"reference"}),a=k1(t,{altBoundary:!0}),i=L1(i,n),n=L1(a,r,o),a=N1(i),r=N1(n);t.modifiersData[e]={referenceClippingOffsets:i,popperEscapeOffsets:n,isReferenceHidden:a,hasPopperEscaped:r},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":a,"data-popper-escaped":r})}}]})?{}:Di).defaultModifiers,M1=void 0===Ki?[]:Ki,D1=void 0===(Ki=Di.defaultOptions)?I1:Ki;var M1,D1,j1=function(r,o,t){void 0===t&&(t=D1);var n,i,p={placement:"bottom",orderedModifiers:[],options:Object.assign({},I1,D1),modifiersData:{},elements:{reference:r,popper:o},attributes:{},styles:{}},a=[],h=!1,g={state:p,setOptions:function(e){e="function"==typeof e?e(p.options):e;l(),p.options=Object.assign({},D1,p.options,e),p.scrollParents={reference:Z2(r)?T1(r):r.contextElement?T1(r.contextElement):[],popper:T1(o)};e=[].concat(M1,p.options.modifiers),t=e.reduce(function(e,t){var n=e[t.name];return e[t.name]=n?Object.assign({},n,t,{options:Object.assign({},n.options,t.options),data:Object.assign({},n.data,t.data)}):t,e},{}),n=R1(Object.keys(t).map(function(e){return t[e]}));var t,n,e=W2.reduce(function(e,t){return e.concat(n.filter(function(e){return e.phase===t}))},[]);return p.orderedModifiers=e.filter(function(e){return e.enabled}),p.orderedModifiers.forEach(function(e){var t=e.name,n=e.options,e=e.effect;"function"==typeof e&&(e=e({state:p,name:t,instance:g,options:void 0===n?{}:n}),a.push(e||function(){}))}),g.update()},forceUpdate:function(){if(!h){var e=p.elements,t=e.reference,e=e.popper;if(A1(t,e)){p.rects={reference:(t=t,a=c1(e),void 0===(l="fixed"===p.options.strategy)&&(l=!1),s=G2(a),c=G2(a)&&(u=(c=a).getBoundingClientRect(),d=J2(u.width)/c.offsetWidth||1,u=J2(u.height)/c.offsetHeight||1,1!==d||1!==u),d=a1(a),u=n1(t,c,l),t={scrollLeft:0,scrollTop:0},f={x:0,y:0},!s&&l||("body"===q2(a)&&!x1(d)||(t=(s=a)!==K2(s)&&G2(s)?{scrollLeft:s.scrollLeft,scrollTop:s.scrollTop}:w1(s)),G2(a)?((f=n1(a,!0)).x+=a.clientLeft,f.y+=a.clientTop):d&&(f.x=S1(d))),{x:u.left+t.scrollLeft-f.x,y:u.top+t.scrollTop-f.y,width:u.width,height:u.height}),popper:r1(e)},p.reset=!1,p.placement=p.options.placement,p.orderedModifiers.forEach(function(e){return p.modifiersData[e.name]=Object.assign({},e.data)});for(var n,r,o,i=0;i<p.orderedModifiers.length;i++)!0!==p.reset?(n=(o=p.orderedModifiers[i]).fn,r=o.options,o=o.name,"function"==typeof n&&(p=n({state:p,options:void 0===r?{}:r,name:o,instance:g})||p)):(p.reset=!1,i=-1)}}var a,l,s,c,d,u,f},update:(n=function(){return new Promise(function(e){g.forceUpdate(),e(p)})},function(){return i=i||new Promise(function(e){Promise.resolve().then(function(){i=void 0,e(n())})})}),destroy:function(){l(),h=!0}};return A1(r,o)&&g.setOptions(t).then(function(e){!h&&t.onFirstUpdate&&t.onFirstUpdate(e)}),g;function l(){a.forEach(function(e){return e()}),a=[]}},B1="tippy-content",F1="tippy-arrow",H1="tippy-svg-arrow",z1={passive:!0,capture:!0},U1=function(){return document.body};function V1(e,t,n){var r;return Array.isArray(e)?null==(r=e[t])?Array.isArray(n)?n[t]:n:r:e}function W1(e,t){e={}.toString.call(e);return 0===e.indexOf("[object")&&-1<e.indexOf(t+"]")}function q1(e,t){return"function"==typeof e?e.apply(void 0,t):e}function K1(t,n){return 0===n?t:function(e){clearTimeout(r),r=setTimeout(function(){t(e)},n)};var r}function Z1(e){return[].concat(e)}function G1(e,t){-1===e.indexOf(t)&&e.push(t)}function $1(e){return[].slice.call(e)}function X1(n){return Object.keys(n).reduce(function(e,t){return void 0!==n[t]&&(e[t]=n[t]),e},{})}function Y1(){return document.createElement("div")}function Q1(t){return["Element","Fragment"].some(function(e){return W1(t,e)})}function J1(e,t){e.forEach(function(e){e&&(e.style.transitionDuration=t+"ms")})}function em(e,t){e.forEach(function(e){e&&e.setAttribute("data-state",t)})}function tm(t,e,n){var r=e+"EventListener";["transitionend","webkitTransitionEnd"].forEach(function(e){t[r](e,n)})}function nm(e,t){for(var n,r=t;r;){if(e.contains(r))return!0;r=null==r.getRootNode||null==(n=r.getRootNode())?void 0:n.host}return!1}var rm={isTouch:!1},om=0;function im(){rm.isTouch||(rm.isTouch=!0,window.performance&&document.addEventListener("mousemove",am))}function am(){var e=performance.now();e-om<20&&(rm.isTouch=!1,document.removeEventListener("mousemove",am)),om=e}function lm(){var e,t=document.activeElement;t&&t._tippy&&t._tippy.reference===t&&(e=t._tippy,t.blur&&!e.state.isVisible&&t.blur())}var sm=!("undefined"==typeof window||"undefined"==typeof document||!window.msCrypto),cm=Object.assign({appendTo:U1,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},{animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},{allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999}),dm=Object.keys(cm);function um(r){var e=(r.plugins||[]).reduce(function(e,t){var n=t.name,t=t.defaultValue;return n&&(e[n]=void 0!==r[n]?r[n]:null!=(n=cm[n])?n:t),e},{});return Object.assign({},r,e)}function fm(e,t){var o,e=Object.assign({},t,{content:q1(t.content,[e])},t.ignoreAttributes?{}:(o=e,((e=t.plugins)?Object.keys(um(Object.assign({},cm,{plugins:e}))):dm).reduce(function(t,n){var r=(o.getAttribute("data-tippy-"+n)||"").trim();if(!r)return t;if("content"===n)t[n]=r;else try{t[n]=JSON.parse(r)}catch(e){t[n]=r}return t},{})));return e.aria=Object.assign({},cm.aria,e.aria),e.aria={expanded:"auto"===e.aria.expanded?t.interactive:e.aria.expanded,content:"auto"===e.aria.content?t.interactive?null:"describedby":e.aria.content},e}function pm(e,t){e.innerHTML=t}function hm(e){var t=Y1();return!0===e?t.className=F1:(t.className=H1,Q1(e)?t.appendChild(e):pm(t,e)),t}function gm(e,t){Q1(t.content)?(pm(e,""),e.appendChild(t.content)):"function"!=typeof t.content&&(t.allowHTML?pm(e,t.content):e.textContent=t.content)}function mm(e){var e=e.firstElementChild,t=$1(e.children);return{box:e,content:t.find(function(e){return e.classList.contains(B1)}),arrow:t.find(function(e){return e.classList.contains(F1)||e.classList.contains(H1)}),backdrop:t.find(function(e){return e.classList.contains("tippy-backdrop")})}}function vm(i){var a=Y1(),e=Y1(),t=(e.className="tippy-box",e.setAttribute("data-state","hidden"),e.setAttribute("tabindex","-1"),Y1());function n(e,t){var n=mm(a),r=n.box,o=n.content,n=n.arrow;t.theme?r.setAttribute("data-theme",t.theme):r.removeAttribute("data-theme"),"string"==typeof t.animation?r.setAttribute("data-animation",t.animation):r.removeAttribute("data-animation"),t.inertia?r.setAttribute("data-inertia",""):r.removeAttribute("data-inertia"),r.style.maxWidth="number"==typeof t.maxWidth?t.maxWidth+"px":t.maxWidth,t.role?r.setAttribute("role",t.role):r.removeAttribute("role"),e.content===t.content&&e.allowHTML===t.allowHTML||gm(o,i.props),t.arrow?n?e.arrow!==t.arrow&&(r.removeChild(n),r.appendChild(hm(t.arrow))):r.appendChild(hm(t.arrow)):n&&r.removeChild(n)}return t.className=B1,t.setAttribute("data-state","hidden"),gm(t,i.props),a.appendChild(e),e.appendChild(t),n(i.props,i.props),{popper:a,onUpdate:n}}vm.$$tippy=!0;var ym=1,bm=[],Em=[];function Cm(a,e){var r,t,n,o,i,l,s,c,d=fm(a,Object.assign({},cm,um(X1(e)))),u=!1,f=!1,p=!1,h=!1,g=[],m=K1(Z,d.interactiveDebounce),e=ym++,v=(c=d.plugins).filter(function(e,t){return c.indexOf(e)===t}),y={id:e,reference:a,popper:Y1(),popperInstance:null,props:d,state:{isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},plugins:v,clearDelayTimeouts:function(){clearTimeout(r),clearTimeout(t),cancelAnimationFrame(n)},setProps:function(e){var t,n;y.state.isDestroyed||(_("onBeforeUpdate",[y,e]),q(),t=y.props,n=fm(a,Object.assign({},t,X1(e),{ignoreAttributes:!0})),y.props=n,W(),t.interactiveDebounce!==n.interactiveDebounce&&(L(),m=K1(Z,n.interactiveDebounce)),t.triggerTarget&&!n.triggerTarget?Z1(t.triggerTarget).forEach(function(e){e.removeAttribute("aria-expanded")}):n.triggerTarget&&a.removeAttribute("aria-expanded"),k(),P(),E&&E(t,n),y.popperInstance&&(Y(),A().forEach(function(e){requestAnimationFrame(e._tippy.popperInstance.forceUpdate)})),_("onAfterUpdate",[y,e]))},setContent:function(e){y.setProps({content:e})},show:function(){var e=y.state.isVisible,t=y.state.isDestroyed,n=!y.state.isEnabled,r=rm.isTouch&&!y.props.touch,o=V1(y.props.duration,0,cm.duration);e||t||n||r||x().hasAttribute("disabled")||(_("onShow",[y],!1),!1!==y.props.onShow(y)&&(y.state.isVisible=!0,S()&&(b.style.visibility="visible"),P(),U(),y.state.isMounted||(b.style.transition="none"),S()&&J1([(e=O()).box,e.content],0),l=function(){var e,t;y.state.isVisible&&!h&&(h=!0,b.offsetHeight,b.style.transition=y.props.moveTransition,S()&&y.props.animation&&(J1([e=(t=O()).box,t=t.content],o),em([e,t],"visible")),F(),k(),G1(Em,y),null!=(e=y.popperInstance)&&e.forceUpdate(),_("onMount",[y]),y.props.animation&&S()&&V(o,function(){y.state.isShown=!0,_("onShown",[y])}))},t=y.props.appendTo,n=x(),(t=y.props.interactive&&t===U1||"parent"===t?n.parentNode:q1(t,[n])).contains(b)||t.appendChild(b),y.state.isMounted=!0,Y()))},hide:function(){var e,t=!y.state.isVisible,n=y.state.isDestroyed,r=!y.state.isEnabled,o=V1(y.props.duration,1,cm.duration);t||n||r||(_("onHide",[y],!1),!1!==y.props.onHide(y)&&(y.state.isVisible=!1,y.state.isShown=!1,u=h=!1,S()&&(b.style.visibility="hidden"),L(),R(),P(!0),S()&&(n=(t=O()).box,r=t.content,y.props.animation&&(J1([n,r],o),em([n,r],"hidden"))),F(),k(),y.props.animation?S()&&(e=y.unmount,V(o,function(){!y.state.isVisible&&b.parentNode&&b.parentNode.contains(b)&&e()})):y.unmount()))},hideWithInteractivity:function(e){T().addEventListener("mousemove",m),G1(bm,m),m(e)},enable:function(){y.state.isEnabled=!0},disable:function(){y.hide(),y.state.isEnabled=!1},unmount:function(){y.state.isVisible&&y.hide(),y.state.isMounted&&(Q(),A().forEach(function(e){e._tippy.unmount()}),b.parentNode&&b.parentNode.removeChild(b),Em=Em.filter(function(e){return e!==y}),y.state.isMounted=!1,_("onHidden",[y]))},destroy:function(){y.state.isDestroyed||(y.clearDelayTimeouts(),y.unmount(),q(),delete a._tippy,y.state.isDestroyed=!0,_("onDestroy",[y]))}};if(!d.render)return y;var e=d.render(y),b=e.popper,E=e.onUpdate,D=(b.setAttribute("data-tippy-root",""),b.id="tippy-"+y.id,y.popper=b,a._tippy=y,b._tippy=y,v.map(function(e){return e.fn(y)})),j=a.hasAttribute("aria-expanded");return W(),k(),P(),_("onCreate",[y]),d.showOnCreate&&J(),b.addEventListener("mouseenter",function(){y.props.interactive&&y.state.isVisible&&y.clearDelayTimeouts()}),b.addEventListener("mouseleave",function(){y.props.interactive&&0<=y.props.trigger.indexOf("mouseenter")&&T().addEventListener("mousemove",m)}),y;function C(){var e=y.props.touch;return Array.isArray(e)?e:[e,0]}function w(){return"hold"===C()[0]}function S(){var e;return null!=(e=y.props.render)&&e.$$tippy}function x(){return s||a}function T(){var e,t=x().parentNode;return t&&null!=(t=Z1(t)[0])&&null!=(e=t.ownerDocument)&&e.body?t.ownerDocument:document}function O(){return mm(b)}function B(e){return y.state.isMounted&&!y.state.isVisible||rm.isTouch||o&&"focus"===o.type?0:V1(y.props.delay,e?0:1,cm.delay)}function P(e){void 0===e&&(e=!1),b.style.pointerEvents=y.props.interactive&&!e?"":"none",b.style.zIndex=""+y.props.zIndex}function _(t,n,e){void 0===e&&(e=!0),D.forEach(function(e){e[t]&&e[t].apply(e,n)}),e&&(e=y.props)[t].apply(e,n)}function F(){var n,r,e=y.props.aria;e.content&&(n="aria-"+e.content,r=b.id,Z1(y.props.triggerTarget||a).forEach(function(e){var t=e.getAttribute(n);y.state.isVisible?e.setAttribute(n,t?t+" "+r:r):(t=t&&t.replace(r,"").trim())?e.setAttribute(n,t):e.removeAttribute(n)}))}function k(){!j&&y.props.aria.expanded&&Z1(y.props.triggerTarget||a).forEach(function(e){y.props.interactive?e.setAttribute("aria-expanded",y.state.isVisible&&e===x()?"true":"false"):e.removeAttribute("aria-expanded")})}function L(){T().removeEventListener("mousemove",m),bm=bm.filter(function(e){return e!==m})}function N(e){if(!rm.isTouch||!p&&"mousedown"!==e.type){var t=e.composedPath&&e.composedPath()[0]||e.target;if(!y.props.interactive||!nm(b,t)){if(Z1(y.props.triggerTarget||a).some(function(e){return nm(e,t)})){if(rm.isTouch)return;if(y.state.isVisible&&0<=y.props.trigger.indexOf("click"))return}else _("onClickOutside",[y,e]);!0===y.props.hideOnClick&&(y.clearDelayTimeouts(),y.hide(),f=!0,setTimeout(function(){f=!1}),y.state.isMounted||R())}}}function H(){p=!0}function z(){p=!1}function U(){var e=T();e.addEventListener("mousedown",N,!0),e.addEventListener("touchend",N,z1),e.addEventListener("touchstart",z,z1),e.addEventListener("touchmove",H,z1)}function R(){var e=T();e.removeEventListener("mousedown",N,!0),e.removeEventListener("touchend",N,z1),e.removeEventListener("touchstart",z,z1),e.removeEventListener("touchmove",H,z1)}function V(e,t){var n=O().box;function r(e){e.target===n&&(tm(n,"remove",r),t())}if(0===e)return t();tm(n,"remove",i),tm(n,"add",r),i=r}function I(t,n,r){void 0===r&&(r=!1),Z1(y.props.triggerTarget||a).forEach(function(e){e.addEventListener(t,n,r),g.push({node:e,eventType:t,handler:n,options:r})})}function W(){w()&&(I("touchstart",K,{passive:!0}),I("touchend",G,{passive:!0})),y.props.trigger.split(/\s+/).filter(Boolean).forEach(function(e){if("manual"!==e)switch(I(e,K),e){case"mouseenter":I("mouseleave",G);break;case"focus":I(sm?"focusout":"blur",$);break;case"focusin":I("focusout",$)}})}function q(){g.forEach(function(e){var t=e.node,n=e.eventType,r=e.handler,e=e.options;t.removeEventListener(n,r,e)}),g=[]}function K(t){var e,n=!1;!y.state.isEnabled||X(t)||f||(e="focus"===(null==o?void 0:o.type),s=(o=t).currentTarget,k(),!y.state.isVisible&&W1(t,"MouseEvent")&&bm.forEach(function(e){return e(t)}),"click"===t.type&&(y.props.trigger.indexOf("mouseenter")<0||u)&&!1!==y.props.hideOnClick&&y.state.isVisible?n=!0:J(t),"click"===t.type&&(u=!n),n&&!e&&M(t))}function Z(e){var l,s,t=e.target,t=x().contains(t)||b.contains(t);"mousemove"===e.type&&t||(t=A().concat(b).map(function(e){var t=null==(t=e._tippy.popperInstance)?void 0:t.state;return t?{popperRect:e.getBoundingClientRect(),popperState:t,props:d}:null}).filter(Boolean),l=e.clientX,s=e.clientY,t.every(function(e){var t=e.popperRect,n=e.popperState,e=e.props.interactiveBorder,r=n.placement.split("-")[0],n=n.modifiersData.offset;if(!n)return!0;var o="bottom"===r?n.top.y:0,i="top"===r?n.bottom.y:0,a="right"===r?n.left.x:0,r="left"===r?n.right.x:0,n=t.top-s+o>e,o=s-t.bottom-i>e,i=t.left-l+a>e,a=l-t.right-r>e;return n||o||i||a})&&(L(),M(e)))}function G(e){X(e)||0<=y.props.trigger.indexOf("click")&&u||(y.props.interactive?y.hideWithInteractivity(e):M(e))}function $(e){y.props.trigger.indexOf("focusin")<0&&e.target!==x()||y.props.interactive&&e.relatedTarget&&b.contains(e.relatedTarget)||M(e)}function X(e){return rm.isTouch&&w()!==0<=e.type.indexOf("touch")}function Y(){Q();var e=y.props,t=e.popperOptions,n=e.placement,r=e.offset,o=e.getReferenceClientRect,e=e.moveTransition,i=S()?mm(b).arrow:null,o=o?{getBoundingClientRect:o,contextElement:o.contextElement||x()}:a,r=[{name:"offset",options:{offset:r}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!e}},{name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(e){var t,n=e.state;S()&&(t=O().box,["placement","reference-hidden","escaped"].forEach(function(e){"placement"===e?t.setAttribute("data-placement",n.placement):n.attributes.popper["data-popper-"+e]?t.setAttribute("data-"+e,""):t.removeAttribute("data-"+e)}),n.attributes.popper={})}}];S()&&i&&r.push({name:"arrow",options:{element:i,padding:3}}),r.push.apply(r,(null==t?void 0:t.modifiers)||[]),y.popperInstance=j1(o,b,Object.assign({},t,{placement:n,onFirstUpdate:l,modifiers:r}))}function Q(){y.popperInstance&&(y.popperInstance.destroy(),y.popperInstance=null)}function A(){return $1(b.querySelectorAll("[data-tippy-root]"))}function J(e){y.clearDelayTimeouts(),e&&_("onTrigger",[y,e]),U();var e=B(!0),t=C(),n=t[0],t=t[1];(e=rm.isTouch&&"hold"===n&&t?t:e)?r=setTimeout(function(){y.show()},e):y.show()}function M(e){y.clearDelayTimeouts(),_("onUntrigger",[y,e]),y.state.isVisible?0<=y.props.trigger.indexOf("mouseenter")&&0<=y.props.trigger.indexOf("click")&&0<=["mouseleave","mousemove"].indexOf(e.type)&&u||((e=B(!1))?t=setTimeout(function(){y.state.isVisible&&y.hide()},e):n=requestAnimationFrame(function(){y.hide()})):R()}}function wm(e,t){var n=cm.plugins.concat((t=void 0===t?{}:t).plugins||[]),r=(document.addEventListener("touchstart",im,z1),window.addEventListener("blur",lm),Object.assign({},t,{plugins:n})),n=(Q1(t=e)?[t]:W1(t,"NodeList")?$1(t):Array.isArray(t)?t:$1(document.querySelectorAll(t))).reduce(function(e,t){t=t&&Cm(t,r);return t&&e.push(t),e},[]);return Q1(e)?n[0]:n}function Sm(e,t){var n,r,t=(t=void 0===t?{}:t).insertAt;e&&"undefined"!=typeof document&&(n=document.head||document.getElementsByTagName("head")[0],(r=document.createElement("style")).type="text/css","top"===t&&n.firstChild?n.insertBefore(r,n.firstChild):n.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e)))}wm.defaultProps=cm,wm.setDefaultProps=function(t){Object.keys(t).forEach(function(e){cm[e]=t[e]})},wm.currentInput=rm,Object.assign({},Hi,{effect:function(e){var e=e.state,t={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(e.elements.popper.style,t.popper),e.styles=t,e.elements.arrow&&Object.assign(e.elements.arrow.style,t.arrow)}}),wm.setDefaultProps({render:vm}),Sm(".autocomplete-list {\r\n  position: absolute;\r\n  background-color: #FFF;\r\n  list-style: none;\r\n  padding: 0;\r\n  overflow: auto;\r\n  width: 200px;\r\n  max-width: 200px;\r\n  max-height: 300px;\r\n  border: 1px solid #b6b6b6;\r\n  border-bottom-color: #999;\r\n  border-radius: 3px;\r\n  font: 12px Arial, Helvetica, Tahoma, Verdana, Sans-Serif;\r\n}\r\n\r\n.autocomplete-list > li,\r\n.autocomplete-list > li.active {\r\n  padding: 5px;\r\n  cursor: pointer;\r\n  text-overflow: ellipsis;\r\n  white-space: nowrap;\r\n  overflow: hidden;\r\n}\r\n\r\n.autocomplete-list >li:hover,\r\n.autocomplete-list > li.active {\r\n  background-color: #EFF0EF;\r\n}");class xm{constructor(e){this.activeOptionIndex=0,this.isPickerVisible=!1,this.insertToken=e=>{if(this.editor){const t=this.editor.getDocument().createElement("span");t.innerHTML=e,this.insertNodeCallback(t)}},this.autoSuggestPluginConfig=e,this.availableTokensSet=this.autoSuggestPluginConfig.tokensList,this.resetFilteredTokensList()}onInitalize(e,t,n){this.insertNodeCallback=e,this.setIsSuggestingCallback=t,this.editor=n}onDispose(){this.hidePickerUX(),this.editor=null}onIsSuggestingChanged(e){e?this.renderPickerUX(this.filteredTokensList):this.hidePickerUX()}getSelectedIndex(){return this.activeOptionIndex}queryStringUpdated(t){this.filteredTokensList=this.availableTokensSet.filter(e=>e.name.toLowerCase().includes(t.toLowerCase())),this.filteredTokensList.length?this.renderPickerUX(this.filteredTokensList):this.setIsSuggestingCallback(!1)}selectOption(){var e;this.isPickerVisible&&0<=this.activeOptionIndex&&this.activeOptionIndex<this.filteredTokensList.length&&(e=this.filteredTokensList[this.activeOptionIndex],this.insertToken(e.name))}shiftHighlight(e){this.isPickerVisible&&(this.activeOptionIndex+=e?1:-1,this.activeOptionIndex=this.activeOptionIndex===this.filteredTokensList.length?0:this.activeOptionIndex<0?this.filteredTokensList.length-1:this.activeOptionIndex,this.setActiveOption(this.activeOptionIndex))}onRemove(){return null}renderPickerUX(e){this.createOptions(e),this.isPickerVisible=!0}hidePickerUX(){const e=this.getInstance({createIfNotExists:!1});e&&(e.style.display="none",this.isPickerVisible=!1,this.activeOptionIndex=-1,this.setActiveOption(this.activeOptionIndex),this.resetFilteredTokensList())}createOptions(e){const t=this.getInstance({createIfNotExists:!0});if(t&&(t.style.display="inline-block",this.setOffsetAutoCompleteList(t),this.clearOptions(t)),this.activeOptionIndex=0,e){const r=document.createDocumentFragment();e.forEach((e,t)=>{const n=document.createElement("li");n.setAttribute("id","autocomplete-list-item-"+t),n.setAttribute("role","option"),n.setAttribute("title",e.name),n.addEventListener("mousedown",e=>e.preventDefault()),n.addEventListener("click",()=>this.insertToken(e.name)),n.innerText=e.name,null!=r&&r.appendChild(n)}),null!=t&&t.appendChild(r)}this.setActiveOption(this.activeOptionIndex)}getInstance(e){var t=e&&e.idPrefix?e.idPrefix:"autocomplete-list";return document.getElementById(t)||(e&&e.createIfNotExists?this.createInstance(t):null)}resetFilteredTokensList(){this.filteredTokensList=this.availableTokensSet.reduce((e,t)=>(e.push(t),e),[])}createInstance(e){const t=document.createElement("ul");return t.id=e,t.setAttribute("role","listbox"),t.style.display="none",this.setOffsetAutoCompleteList(t),t.className="autocomplete-list",document.body.setAttribute("aria-owns",e),document.body.setAttribute("aria-controls",e),null!=(e=null==(e=null==(e=this.editor)?void 0:e.getDocument())?void 0:e.body)&&e.appendChild(t),t}setActiveOption(r){const o=this.getInstance({createIfNotExists:!0});o&&o.children&&Array.from(o.children).forEach((e,t)=>{var n;if(r===t){const r=o.children.item(t);r.classList.add("active"),r.setAttribute("aria-selected","true"),this.scrollActiveOptionIntoView(r)}else null!=(n=o.children.item(t))&&n.classList.remove("active"),null!=(n=o.children.item(t))&&n.setAttribute("aria-selected","false")})}scrollActiveOptionIntoView(e){const t=e.parentElement;var n;t&&(n=t.clientHeight/e.clientHeight,t.scrollTop+t.clientHeight<e.offsetTop+e.clientHeight?t.scrollTop=e.offsetTop-(n-1)*e.clientHeight:t.scrollTop>e.offsetTop&&(t.scrollTop=e.offsetTop))}clearOptions(e){if(e=e||this.getInstance({createIfNotExists:!1}))for(;e.firstChild;)e.firstChild.removeEventListener("mousedown",()=>{}),e.firstChild.removeEventListener("click",()=>{}),e.removeChild(e.firstChild)}setOffsetAutoCompleteList(n){const e=window.getSelection();if(0!==(null==e?void 0:e.rangeCount)){const t=null==e?void 0:e.getRangeAt(0).cloneRange();null!=t&&t.collapse(!0);var r=null==t?void 0:t.getClientRects()[0];if(r){let e=(null==r?void 0:r.y)+window.scrollY,t=(window.innerHeight-r.y<=n.offsetHeight&&(e-=n.offsetHeight+30),r.x+window.scrollX);window.innerWidth-r.x<=n.offsetWidth&&(t-=n.offsetWidth),n.style.top=e+"px",n.style.left=t+"px"}}}}class Tm{constructor(e,t=300){this.handleChange=e,this.handleChange=((t,n)=>{let r;return(...e)=>{clearTimeout(r),r=setTimeout(()=>{t(...e)},n)}})(e,t)}getName(){return"OnChangePlugin"}initialize(e){this.editor=e}getContent(){return this.editor.getContent()}dispose(){this.editor=null}onPluginEvent(e){var t,n;switch(e.eventType){case 3:case 7:this.handleChange(this.getContent());break;case 10:null==(t=null==e?void 0:e.clipboardData)||!t.image||null!=(n=null==(t=null==e?void 0:e.fragment)?void 0:t.removeChild)&&n.call(t,e.fragment.firstChild)}}}const Om=[new Er.ContentEdit,new it.CutPasteListChain,new Ha.HyperLink,new Sr.Paste,new zt.TableCellSelection,new et.TableResize,new Ad.ImageEdit];function Pm(e,t,...n){const r=document.createElement(e);if(t)for(const e in t)r.setAttribute(e,t[e]);for(const e of n)"string"==typeof e?r.appendChild(document.createTextNode(e)):r.appendChild(e);return r}Sm(":root {\r\n    --border-color: #f1f3f4;\r\n    --active-color: #e8f0fe;\r\n}\r\n\r\n.toolbar {\r\n    display: flex;\r\n    flex: 0 0 auto;\r\n    /* border: 2px solid var(--border-color); */\r\n    width: 100%;\r\n    box-sizing: border-box;\r\n    gap: 4px;\r\n    flex-wrap: wrap;\r\n    padding: 4px;\r\n    padding-bottom: 0px;\r\n    margin-bottom: 2px;\r\n}\r\n\r\n.toolbar-button {\r\n    border-width: 0;\r\n    border-radius: 4px;\r\n    margin: 2px;\r\n    padding: 0;\r\n    background-color: #fff;\r\n    cursor: pointer;\r\n    height: 30px;\r\n}\r\n\r\n.toolbar-button:hover,\r\n.toolbar-button:focus {\r\n    background-color: var(--border-color);\r\n    /* outline: none; */\r\n}\r\n\r\n.active {\r\n    background-color: var(--active-color);\r\n}\r\n");const _m=new Map,km=[{nonInclusiveWord:"Afghanis",rephrasedWord:"Afghans",severity:3},{nonInclusiveWord:"white list",rephrasedWord:"allow list",severity:2},{nonInclusiveWord:"black list",rephrasedWord:"block list",severity:2},{nonInclusiveWord:"slow learner",rephrasedWord:"has cognitive disabilities",severity:1},{nonInclusiveWord:"Taiwan China",rephrasedWord:"Taiwan",severity:1}].map(e=>{var t=e.nonInclusiveWord.toLowerCase();return _m.set(t,Object.assign({},e)),t}),Lm=new RegExp(`\\b(${km.join("|")})\\b`,"ig"),Nm=(document.addEventListener("click",e=>{var t;const n=e.target;if(n.classList.contains("pi-rephrase-btn")){const e=n.dataset.word,r=n.dataset.replace;r&&(null!=(t=document.querySelector(`mark[data-word="${e}"]`))&&t.replaceWith(r),null!=(t=null==(t=n.parentElement)?void 0:t.parentElement)&&t.remove())}}),(e,t=!0)=>{const n=t?Rm(e):e,r=null==n?void 0:n.match(Lm),o=new RegExp(`\\b(${null==r?void 0:r.join("|")})\\b`,"ig");return n.replace(o,(e,t)=>{var n=_m.get(null==t?void 0:t.toLowerCase()),r=(null==n?void 0:n.rephrasedWord)||t;return`<mark class='sev-${null==n?void 0:n.severity}' data-tippy-content='${`<div style="font-size: 10px;"> Rephrase to <br /> <button class="pi-rephrase-btn" data-word="${t}" data-replace="${r}">${r}</button></div>`}' data-word='${t}'>${t}</span></mark>`})}),Rm=e=>{let n=e;return(new DOMParser).parseFromString(e,"text/html").querySelectorAll("mark").forEach(e=>{var t=e.textContent||"";n=n.replace(e.outerHTML,t)}),n},Im={bold:{title:"Bold",image:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-6255 -8740 32 32'%3e %3cdefs%3e %3cstyle%3e .cls-1 %7b fill: none%3b %7d .cls-2 %7b fill: %23666%3b %7d %3c/style%3e %3c/defs%3e %3cg id='FB:_Bold' data-name='FB: Bold' transform='translate(-6999 -9195.999)'%3e %3crect id='Rectangle_2297' data-name='Rectangle 2297' class='cls-1' width='32' height='32' rx='2' transform='translate(744 455.999)'/%3e %3cpath id='Path_1536' data-name='Path 1536' class='cls-2' d='M9.828-9.031a3.888%2c3.888%2c0%2c0%2c1%2c1.548.311%2c4.012%2c4.012%2c0%2c0%2c1%2c1.27.855%2c4.012%2c4.012%2c0%2c0%2c1%2c.855%2c1.27%2c3.888%2c3.888%2c0%2c0%2c1%2c.311%2c1.548A3.888%2c3.888%2c0%2c0%2c1%2c13.5-3.5a4.012%2c4.012%2c0%2c0%2c1-.855%2c1.27%2c4.012%2c4.012%2c0%2c0%2c1-1.27.855%2c3.888%2c3.888%2c0%2c0%2c1-1.548.311H3.188V-15.937H9.828a3.384%2c3.384%2c0%2c0%2c1%2c1.345.27%2c3.465%2c3.465%2c0%2c0%2c1%2c1.1.739%2c3.465%2c3.465%2c0%2c0%2c1%2c.739%2c1.1%2c3.384%2c3.384%2c0%2c0%2c1%2c.27%2c1.345%2c3.384%2c3.384%2c0%2c0%2c1-.27%2c1.345%2c3.465%2c3.465%2c0%2c0%2c1-.739%2c1.1%2c3.465%2c3.465%2c0%2c0%2c1-1.1.739A3.384%2c3.384%2c0%2c0%2c1%2c9.828-9.031ZM6.375-9.562H7.969a2.034%2c2.034%2c0%2c0%2c0%2c.822-.17%2c2.176%2c2.176%2c0%2c0%2c0%2c.677-.457%2c2.19%2c2.19%2c0%2c0%2c0%2c.457-.672%2c2.024%2c2.024%2c0%2c0%2c0%2c.17-.826%2c2.034%2c2.034%2c0%2c0%2c0-.17-.822%2c2.176%2c2.176%2c0%2c0%2c0-.457-.677%2c2.176%2c2.176%2c0%2c0%2c0-.677-.457%2c2.034%2c2.034%2c0%2c0%2c0-.822-.17H6.375ZM8.5-3.187a2.034%2c2.034%2c0%2c0%2c0%2c.822-.17A2.176%2c2.176%2c0%2c0%2c0%2c10-3.814a2.19%2c2.19%2c0%2c0%2c0%2c.457-.672%2c2.024%2c2.024%2c0%2c0%2c0%2c.17-.826%2c2.034%2c2.034%2c0%2c0%2c0-.17-.822A2.176%2c2.176%2c0%2c0%2c0%2c10-6.811a2.176%2c2.176%2c0%2c0%2c0-.677-.457%2c2.034%2c2.034%2c0%2c0%2c0-.822-.17H6.375v4.25Z' transform='translate(752 479.999)'/%3e %3c/g%3e%3c/svg%3e",onClick:L.toggleBold,checked:e=>!!e.isBold},italic:{title:"Italic",image:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-6219 -8740 32 32'%3e %3cdefs%3e %3cstyle%3e .cls-1 %7b fill: none%3b %7d .cls-2 %7b fill: %23666%3b %7d %3c/style%3e %3c/defs%3e %3cg id='FB:_Italics' data-name='FB: Italics' transform='translate(-6999 -9195.999)'%3e %3crect id='Rectangle_2298' data-name='Rectangle 2298' class='cls-1' width='32' height='32' rx='2' transform='translate(780 455.999)'/%3e %3cpath id='Path_1552' data-name='Path 1552' class='cls-2' d='M10.808-17H11.92L6.259%2c0H5.138Z' transform='translate(788 479.999)'/%3e %3c/g%3e%3c/svg%3e",onClick:L.toggleItalic,checked:e=>!!e.isItalic},underline:{title:"Underline",image:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-6183 -8740 32 32'%3e %3cdefs%3e %3cstyle%3e .cls-1 %7b fill: none%3b %7d .cls-2 %7b fill: %23666%3b %7d %3c/style%3e %3c/defs%3e %3cg id='FB:_Underline' data-name='FB: Underline' transform='translate(-6999 -9196)'%3e %3crect id='Rectangle_2299' data-name='Rectangle 2299' class='cls-1' width='32' height='32' rx='2' transform='translate(816 456)'/%3e %3cpath id='Path_1568' data-name='Path 1568' class='cls-2' d='M13.813-17v9.563A5.2%2c5.2%2c0%2c0%2c1%2c13.4-5.366%2c5.344%2c5.344%2c0%2c0%2c1%2c12.26-3.677%2c5.344%2c5.344%2c0%2c0%2c1%2c10.571-2.54%2c5.2%2c5.2%2c0%2c0%2c1%2c8.5-2.125%2c5.2%2c5.2%2c0%2c0%2c1%2c6.429-2.54%2c5.344%2c5.344%2c0%2c0%2c1%2c4.74-3.677%2c5.344%2c5.344%2c0%2c0%2c1%2c3.6-5.366a5.2%2c5.2%2c0%2c0%2c1-.415-2.071V-17H4.25v9.563a4.092%2c4.092%2c0%2c0%2c0%2c.336%2c1.652A4.336%2c4.336%2c0%2c0%2c0%2c5.5-4.437a4.336%2c4.336%2c0%2c0%2c0%2c1.349.913A4.092%2c4.092%2c0%2c0%2c0%2c8.5-3.187a4.092%2c4.092%2c0%2c0%2c0%2c1.652-.336A4.336%2c4.336%2c0%2c0%2c0%2c11.5-4.437a4.336%2c4.336%2c0%2c0%2c0%2c.913-1.349%2c4.092%2c4.092%2c0%2c0%2c0%2c.336-1.652V-17ZM3.188-1.062H13.813V0H3.188Z' transform='translate(824 480)'/%3e %3c/g%3e%3c/svg%3e",onClick:L.toggleUnderline,checked:e=>!!e.isUnderline},strikeThrough:{title:"Strike through",image:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-5860 -8860 32 32'%3e %3cdefs%3e %3cstyle%3e .cls-1 %7b fill: none%3b %7d .cls-2 %7b fill: %23666%3b %7d %3c/style%3e %3c/defs%3e %3cg id='FB:_Strikeout' data-name='FB: Strikeout' transform='translate(-6880 -9195.999)'%3e %3crect id='Rectangle_2295' data-name='Rectangle 2295' class='cls-1' width='32' height='32' rx='2' transform='translate(1020 335.999)'/%3e %3cpath id='Path_1745' data-name='Path 1745' class='cls-2' d='M8.5-7.437H4.292a2.083%2c2.083%2c0%2c0%2c0%2c.145.643%2c1.589%2c1.589%2c0%2c0%2c0%2c.324.506%2c1.391%2c1.391%2c0%2c0%2c0%2c.494.328%2c1.753%2c1.753%2c0%2c0%2c0%2c.656.116%2c1.725%2c1.725%2c0%2c0%2c0%2c.618-.112%2c2.287%2c2.287%2c0%2c0%2c0%2c.552-.3v.73a2.183%2c2.183%2c0%2c0%2c1-.623.253%2c2.936%2c2.936%2c0%2c0%2c1-.681.079%2c2.4%2c2.4%2c0%2c0%2c1-.909-.166%2c2.108%2c2.108%2c0%2c0%2c1-.71-.465%2c2.16%2c2.16%2c0%2c0%2c1-.469-.71%2c2.562%2c2.562%2c0%2c0%2c1-.187-.9H2.582a3.234%2c3.234%2c0%2c0%2c1-.2.876%2c2.347%2c2.347%2c0%2c0%2c1-.423.714%2c1.886%2c1.886%2c0%2c0%2c1-.652.477A2.127%2c2.127%2c0%2c0%2c1%2c.423-5.2%2c1.58%2c1.58%2c0%2c0%2c1-1.013-6h-.017v.689h-.764V-7.437H-3.237v2.125h-.772V-6.06h-.017A1.6%2c1.6%2c0%2c0%2c1-5.5-5.2a2%2c2%2c0%2c0%2c1-.6-.087%2c1.35%2c1.35%2c0%2c0%2c1-.481-.261%2c1.213%2c1.213%2c0%2c0%2c1-.32-.436%2c1.469%2c1.469%2c0%2c0%2c1-.116-.6%2c2%2c2%2c0%2c0%2c1%2c.05-.444%2c1.253%2c1.253%2c0%2c0%2c1%2c.174-.411H-8.5V-8.5h4.491a1.357%2c1.357%2c0%2c0%2c0-.249-.768.859.859%2c0%2c0%2c0-.73-.295%2c2.236%2c2.236%2c0%2c0%2c0-.834.154%2c2.7%2c2.7%2c0%2c0%2c0-.726.436v-.789a2.635%2c2.635%2c0%2c0%2c1%2c.78-.336%2c3.478%2c3.478%2c0%2c0%2c1%2c.847-.1%2c1.638%2c1.638%2c0%2c0%2c1%2c1.253.436A1.847%2c1.847%2c0%2c0%2c1-3.246-8.5h1.453v-3.893h.764v3.138h.017A1.8%2c1.8%2c0%2c0%2c1%2c.639-10.2a2.059%2c2.059%2c0%2c0%2c1%2c.722.12%2c1.675%2c1.675%2c0%2c0%2c1%2c.564.344%2c1.873%2c1.873%2c0%2c0%2c1%2c.4.54%2c2.513%2c2.513%2c0%2c0%2c1%2c.224.7H3.619a2.274%2c2.274%2c0%2c0%2c1%2c.344-.739A2.269%2c2.269%2c0%2c0%2c1%2c4.5-9.77a2.262%2c2.262%2c0%2c0%2c1%2c.685-.324%2c2.9%2c2.9%2c0%2c0%2c1%2c.8-.108%2c3.219%2c3.219%2c0%2c0%2c1%2c.569.05%2c1.887%2c1.887%2c0%2c0%2c1%2c.535.183v.78a1.892%2c1.892%2c0%2c0%2c0-1.137-.374%2c1.539%2c1.539%2c0%2c0%2c0-.934.282%2c1.794%2c1.794%2c0%2c0%2c0-.594.78H8.5Zm-12.509%2c0h-1.7a.825.825%2c0%2c0%2c0-.407.3.921.921%2c0%2c0%2c0-.116.5.77.77%2c0%2c0%2c0%2c.075.349.735.735%2c0%2c0%2c0%2c.2.249.851.851%2c0%2c0%2c0%2c.291.149%2c1.207%2c1.207%2c0%2c0%2c0%2c.349.05%2c1.284%2c1.284%2c0%2c0%2c0%2c.548-.112%2c1.25%2c1.25%2c0%2c0%2c0%2c.411-.3A1.338%2c1.338%2c0%2c0%2c0-4.1-6.707a1.626%2c1.626%2c0%2c0%2c0%2c.091-.548ZM.448-9.562A1.431%2c1.431%2c0%2c0%2c0-.44-9.28a1.434%2c1.434%2c0%2c0%2c0-.515.78h2.7a1.422%2c1.422%2c0%2c0%2c0-.457-.772A1.247%2c1.247%2c0%2c0%2c0%2c.448-9.562ZM.332-5.844a1.366%2c1.366%2c0%2c0%2c0%2c.61-.129%2c1.3%2c1.3%2c0%2c0%2c0%2c.44-.349%2c1.653%2c1.653%2c0%2c0%2c0%2c.278-.51%2c2.75%2c2.75%2c0%2c0%2c0%2c.133-.606H-1.029v.174a1.527%2c1.527%2c0%2c0%2c0%2c.1.556%2c1.376%2c1.376%2c0%2c0%2c0%2c.278.448%2c1.307%2c1.307%2c0%2c0%2c0%2c.432.3A1.348%2c1.348%2c0%2c0%2c0%2c.332-5.844Z' transform='translate(1036 359.999)'/%3e %3c/g%3e%3c/svg%3e",onClick:L.toggleStrikethrough,checked:e=>!!e.isStrikeThrough},bullet:{title:"Bullet",image:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-10568 -10457 32 32'%3e %3cdefs%3e %3cstyle%3e .cls-1 %7b fill: none%3b %7d .cls-2 %7b fill: %23666%3b %7d .cls-3 %7b fill: %232E77D0%3b %7d %3c/style%3e %3c/defs%3e %3cg id='_00-UL' data-name='00-UL' transform='translate(-11635 -10912.999)'%3e %3crect id='Rectangle_2306' data-name='Rectangle 2306' class='cls-1' width='32' height='32' rx='2' transform='translate(1067 455.999)'/%3e %3crect id='Rectangle_3057' data-name='Rectangle 3057' class='cls-2' width='13' height='1' transform='translate(1078 466.999)'/%3e %3crect id='Rectangle_3058' data-name='Rectangle 3058' class='cls-2' width='13' height='1' transform='translate(1078 469.999)'/%3e %3crect id='Rectangle_3059' data-name='Rectangle 3059' class='cls-2' width='13' height='1' transform='translate(1078 472.999)'/%3e %3crect id='Rectangle_3060' data-name='Rectangle 3060' class='cls-2' width='13' height='1' transform='translate(1078 475.999)'/%3e %3crect id='Rectangle_3062' data-name='Rectangle 3062' class='cls-3' width='1' height='1' transform='translate(1075 466.999)'/%3e %3crect id='Rectangle_3065' data-name='Rectangle 3065' class='cls-3' width='1' height='1' transform='translate(1075 469.999)'/%3e %3crect id='Rectangle_3064' data-name='Rectangle 3064' class='cls-3' width='1' height='1' transform='translate(1075 472.999)'/%3e %3crect id='Rectangle_3063' data-name='Rectangle 3063' class='cls-3' width='1' height='1' transform='translate(1075 475.999)'/%3e %3c/g%3e%3c/svg%3e",onClick:L.toggleBullet,checked:e=>!!e.isBullet},numbering:{title:"Numbering",image:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-10536 -10457 32 32'%3e %3cdefs%3e %3cstyle%3e .cls-1 %7b fill: none%3b %7d .cls-2 %7b fill: %23666%3b %7d .cls-3 %7b fill: %232E77D0%3b %7d %3c/style%3e %3c/defs%3e %3cg id='_01-OL' data-name='01-OL' transform='translate(-11603 -10912.999)'%3e %3crect id='Rectangle_2306' data-name='Rectangle 2306' class='cls-1' width='32' height='32' rx='2' transform='translate(1067 455.999)'/%3e %3crect id='Rectangle_3057' data-name='Rectangle 3057' class='cls-2' width='12' height='1' transform='translate(1079 466.999)'/%3e %3crect id='Rectangle_3058' data-name='Rectangle 3058' class='cls-2' width='12' height='1' transform='translate(1079 470.999)'/%3e %3crect id='Rectangle_3059' data-name='Rectangle 3059' class='cls-2' width='12' height='1' transform='translate(1079 474.999)'/%3e %3cpath id='Path_1833' data-name='Path 1833' class='cls-3' d='M1.121-14.1a1.5%2c1.5%2c0%2c0%2c1-.311.178.877.877%2c0%2c0%2c1-.353.087v-.573q.257-.091.49-.2a2.376%2c2.376%2c0%2c0%2c0%2c.448-.274H1.8v3.2H1.121Zm-.008%2c3.486a1.414%2c1.414%2c0%2c0%2c1%2c.394.054.9.9%2c0%2c0%2c1%2c.324.166.794.794%2c0%2c0%2c1%2c.216.278.9.9%2c0%2c0%2c1%2c.079.39.982.982%2c0%2c0%2c1-.1.452%2c1.49%2c1.49%2c0%2c0%2c1-.245.349%2c2.013%2c2.013%2c0%2c0%2c1-.32.274q-.174.12-.32.224A1.744%2c1.744%2c0%2c0%2c0%2c.9-8.222a.307.307%2c0%2c0%2c0-.1.212H2.125v.573H.042q0-.191%2c0-.34A.89.89%2c0%2c0%2c1%2c.125-8.1a1.39%2c1.39%2c0%2c0%2c1%2c.34-.477q.216-.2.427-.361a3.419%2c3.419%2c0%2c0%2c0%2c.369-.332.548.548%2c0%2c0%2c0%2c.158-.39.366.366%2c0%2c0%2c0-.125-.315.549.549%2c0%2c0%2c0-.332-.091.958.958%2c0%2c0%2c0-.411.091%2c1.608%2c1.608%2c0%2c0%2c0-.361.232v-.606A1.674%2c1.674%2c0%2c0%2c1%2c1.112-10.617Zm.3%2c5.8a.944.944%2c0%2c0%2c1%2c.506.224.639.639%2c0%2c0%2c1%2c.208.506.877.877%2c0%2c0%2c1-.1.44.865.865%2c0%2c0%2c1-.27.295%2c1.19%2c1.19%2c0%2c0%2c1-.386.166%2c1.858%2c1.858%2c0%2c0%2c1-.444.054%2c2.5%2c2.5%2c0%2c0%2c1-.4-.033%2c1.341%2c1.341%2c0%2c0%2c1-.386-.125v-.606a1.155%2c1.155%2c0%2c0%2c0%2c.344.174%2c1.292%2c1.292%2c0%2c0%2c0%2c.386.058.8.8%2c0%2c0%2c0%2c.386-.091.351.351%2c0%2c0%2c0%2c.17-.34.326.326%2c0%2c0%2c0-.108-.27.657.657%2c0%2c0%2c0-.261-.125%2c1.347%2c1.347%2c0%2c0%2c0-.32-.037H.448v-.531H.714A1.377%2c1.377%2c0%2c0%2c0%2c1-5.084.508.508%2c0%2c0%2c0%2c1.233-5.2a.323.323%2c0%2c0%2c0%2c.1-.257.32.32%2c0%2c0%2c0-.137-.3.621.621%2c0%2c0%2c0-.328-.083%2c1.068%2c1.068%2c0%2c0%2c0-.614.2V-6.2a1.452%2c1.452%2c0%2c0%2c1%2c.378-.129%2c2.092%2c2.092%2c0%2c0%2c1%2c.394-.037%2c1.643%2c1.643%2c0%2c0%2c1%2c.365.042.946.946%2c0%2c0%2c1%2c.324.137.787.787%2c0%2c0%2c1%2c.232.245.671.671%2c0%2c0%2c1%2c.091.357.74.74%2c0%2c0%2c1-.162.5.868.868%2c0%2c0%2c1-.461.261Z' transform='translate(1075 480.999)'/%3e %3c/g%3e%3c/svg%3e",onClick:e=>L.toggleNumbering(e),checked:e=>!!e.isNumbering},outdent:{title:"Decrease indent",image:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-10408 -10457 32 32'%3e %3cdefs%3e %3cstyle%3e .cls-1 %7b fill: none%3b %7d .cls-2 %7b fill: %23666%3b %7d .cls-3 %7b fill: %232E77D0%3b %7d %3c/style%3e %3c/defs%3e %3cg id='_05-IndentLeft' data-name='05-IndentLeft' transform='translate(-11475 -10912.999)'%3e %3crect id='Rectangle_2306' data-name='Rectangle 2306' class='cls-1' width='32' height='32' rx='2' transform='translate(1067 455.999)'/%3e %3crect id='Rectangle_3057' data-name='Rectangle 3057' class='cls-2' width='9' height='1' transform='translate(1082 466.999)'/%3e %3crect id='Rectangle_3058' data-name='Rectangle 3058' class='cls-2' width='6' height='1' transform='translate(1082 468.999)'/%3e %3crect id='Rectangle_3059' data-name='Rectangle 3059' class='cls-2' width='9' height='1' transform='translate(1082 470.999)'/%3e %3crect id='Rectangle_3060' data-name='Rectangle 3060' class='cls-2' width='6' height='1' transform='translate(1082 472.999)'/%3e %3crect id='Rectangle_3061' data-name='Rectangle 3061' class='cls-2' width='9' height='1' transform='translate(1082 474.999)'/%3e %3cg id='Group_3989' data-name='Group 3989' transform='translate(-11)'%3e %3crect id='Rectangle_3062' data-name='Rectangle 3062' class='cls-3' width='6' height='1' transform='translate(1086 470.999)'/%3e %3cpath id='Arrow' class='cls-3' d='M11395%2c10917v-4h4v1h-3v3Z' transform='translate(-14689.138 812.326) rotate(-45)'/%3e %3c/g%3e %3c/g%3e%3c/svg%3e",onClick:e=>L.setIndentation(e,1)},indent:{title:"Increase indent",image:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-10376 -10457 32 32'%3e %3cdefs%3e %3cstyle%3e .cls-1 %7b fill: none%3b %7d .cls-2 %7b fill: %23666%3b %7d .cls-3 %7b fill: %232E77D0%3b %7d %3c/style%3e %3c/defs%3e %3cg id='_06-IndentRight' data-name='06-IndentRight' transform='translate(-11443 -10912.999)'%3e %3crect id='Rectangle_2306' data-name='Rectangle 2306' class='cls-1' width='32' height='32' rx='2' transform='translate(1067 455.999)'/%3e %3crect id='Rectangle_3057' data-name='Rectangle 3057' class='cls-2' width='9' height='1' transform='translate(1082 466.999)'/%3e %3crect id='Rectangle_3058' data-name='Rectangle 3058' class='cls-2' width='6' height='1' transform='translate(1082 468.999)'/%3e %3crect id='Rectangle_3059' data-name='Rectangle 3059' class='cls-2' width='9' height='1' transform='translate(1082 470.999)'/%3e %3crect id='Rectangle_3060' data-name='Rectangle 3060' class='cls-2' width='6' height='1' transform='translate(1082 472.999)'/%3e %3crect id='Rectangle_3061' data-name='Rectangle 3061' class='cls-2' width='9' height='1' transform='translate(1082 474.999)'/%3e %3cg id='Group_3988' data-name='Group 3988' transform='translate(2165.999 942.998) rotate(180)'%3e %3crect id='Rectangle_3062' data-name='Rectangle 3062' class='cls-3' width='6' height='1' transform='translate(1086 470.999)'/%3e %3cpath id='Arrow' class='cls-3' d='M11395%2c10917v-4h4v1h-3v3Z' transform='translate(-14689.138 812.326) rotate(-45)'/%3e %3c/g%3e %3c/g%3e%3c/svg%3e",onClick:e=>L.setIndentation(e,0)},alignLeft:{title:"Align left",image:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-10504 -10457 32 32'%3e %3cdefs%3e %3cstyle%3e .cls-1 %7b fill: none%3b %7d .cls-2 %7b fill: %23666%3b %7d %3c/style%3e %3c/defs%3e %3cg id='_02-Left' data-name='02-Left' transform='translate(-11571 -10912.999)'%3e %3crect id='Rectangle_2306' data-name='Rectangle 2306' class='cls-1' width='32' height='32' rx='2' transform='translate(1067 455.999)'/%3e %3crect id='Rectangle_3057' data-name='Rectangle 3057' class='cls-2' width='17' height='1' transform='translate(1075 464.999)'/%3e %3crect id='Rectangle_3058' data-name='Rectangle 3058' class='cls-2' width='13' height='1' transform='translate(1075 467.999)'/%3e %3crect id='Rectangle_3059' data-name='Rectangle 3059' class='cls-2' width='17' height='1' transform='translate(1075 470.999)'/%3e %3crect id='Rectangle_3060' data-name='Rectangle 3060' class='cls-2' width='13' height='1' transform='translate(1075 473.999)'/%3e %3crect id='Rectangle_3061' data-name='Rectangle 3061' class='cls-2' width='17' height='1' transform='translate(1075 476.999)'/%3e %3c/g%3e%3c/svg%3e",onClick:e=>L.setAlignment(e,0)},alignCenter:{title:"Align center",image:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-10472 -10457 32 32'%3e %3cdefs%3e %3cstyle%3e .cls-1 %7b fill: none%3b %7d .cls-2 %7b fill: %23666%3b %7d %3c/style%3e %3c/defs%3e %3cg id='_03-Center' data-name='03-Center' transform='translate(-11539 -10912.999)'%3e %3crect id='Rectangle_2306' data-name='Rectangle 2306' class='cls-1' width='32' height='32' rx='2' transform='translate(1067 455.999)'/%3e %3crect id='Rectangle_3057' data-name='Rectangle 3057' class='cls-2' width='17' height='1' transform='translate(1075 464.999)'/%3e %3crect id='Rectangle_3058' data-name='Rectangle 3058' class='cls-2' width='13' height='1' transform='translate(1077 467.999)'/%3e %3crect id='Rectangle_3059' data-name='Rectangle 3059' class='cls-2' width='17' height='1' transform='translate(1075 470.999)'/%3e %3crect id='Rectangle_3060' data-name='Rectangle 3060' class='cls-2' width='13' height='1' transform='translate(1077 473.999)'/%3e %3crect id='Rectangle_3061' data-name='Rectangle 3061' class='cls-2' width='17' height='1' transform='translate(1075 476.999)'/%3e %3c/g%3e%3c/svg%3e",onClick:e=>L.setAlignment(e,1)},alignRight:{title:"Align right",image:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-10440 -10457 32 32'%3e %3cdefs%3e %3cstyle%3e .cls-1 %7b fill: none%3b %7d .cls-2 %7b fill: %23666%3b %7d %3c/style%3e %3c/defs%3e %3cg id='_04-Right' data-name='04-Right' transform='translate(-11507 -10912.999)'%3e %3crect id='Rectangle_2306' data-name='Rectangle 2306' class='cls-1' width='32' height='32' rx='2' transform='translate(1067 455.999)'/%3e %3crect id='Rectangle_3057' data-name='Rectangle 3057' class='cls-2' width='17' height='1' transform='translate(1075 464.999)'/%3e %3crect id='Rectangle_3058' data-name='Rectangle 3058' class='cls-2' width='13' height='1' transform='translate(1079 467.999)'/%3e %3crect id='Rectangle_3059' data-name='Rectangle 3059' class='cls-2' width='17' height='1' transform='translate(1075 470.999)'/%3e %3crect id='Rectangle_3060' data-name='Rectangle 3060' class='cls-2' width='13' height='1' transform='translate(1079 473.999)'/%3e %3crect id='Rectangle_3061' data-name='Rectangle 3061' class='cls-2' width='17' height='1' transform='translate(1075 476.999)'/%3e %3c/g%3e%3c/svg%3e",onClick:e=>L.setAlignment(e,2)},unlink:{title:"Remove hyperlink",image:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-5860 -8896 32 32'%3e %3cdefs%3e %3cstyle%3e .cls-1 %7b fill: none%3b %7d .cls-2 %7b fill: %23666%3b %7d .cls-3 %7b fill: %23D82300%3b %7d %3c/style%3e %3c/defs%3e %3cg id='FB:_Unlink' data-name='FB: Unlink' transform='translate(-6880 -9199.999)'%3e %3crect id='Rectangle_2295' data-name='Rectangle 2295' class='cls-1' width='32' height='32' rx='2' transform='translate(1020 303.999)'/%3e %3cg id='Group_3910' data-name='Group 3910'%3e %3cpath id='Path_1712' data-name='Path 1712' class='cls-2' d='M-.531-13.812a3.558%2c3.558%2c0%2c0%2c1%2c1.444.295%2c3.854%2c3.854%2c0%2c0%2c1%2c1.179.8%2c3.7%2c3.7%2c0%2c0%2c1%2c.8%2c1.179%2c3.632%2c3.632%2c0%2c0%2c1%2c.291%2c1.448%2c3.632%2c3.632%2c0%2c0%2c1-.291%2c1.448%2c3.7%2c3.7%2c0%2c0%2c1-.8%2c1.179%2c3.854%2c3.854%2c0%2c0%2c1-1.179.8%2c3.558%2c3.558%2c0%2c0%2c1-1.444.295h-.531V-7.437h.531A2.572%2c2.572%2c0%2c0%2c0%2c.5-7.645a2.679%2c2.679%2c0%2c0%2c0%2c.843-.569%2c2.724%2c2.724%2c0%2c0%2c0%2c.573-.847%2c2.558%2c2.558%2c0%2c0%2c0%2c.212-1.033%2c2.529%2c2.529%2c0%2c0%2c0-.212-1.029%2c2.737%2c2.737%2c0%2c0%2c0-.573-.843A2.737%2c2.737%2c0%2c0%2c0%2c.5-12.538%2c2.529%2c2.529%2c0%2c0%2c0-.531-12.75h-4.25a2.558%2c2.558%2c0%2c0%2c0-1.033.212%2c2.724%2c2.724%2c0%2c0%2c0-.847.573%2c2.679%2c2.679%2c0%2c0%2c0-.569.843%2c2.572%2c2.572%2c0%2c0%2c0-.208%2c1.029A2.6%2c2.6%2c0%2c0%2c0-7.23-9.06a2.666%2c2.666%2c0%2c0%2c0%2c.569.847%2c2.666%2c2.666%2c0%2c0%2c0%2c.847.569%2c2.6%2c2.6%2c0%2c0%2c0%2c1.033.208h.531v1.063h-.531A3.587%2c3.587%2c0%2c0%2c1-6.23-6.67a3.788%2c3.788%2c0%2c0%2c1-1.179-.8%2c3.788%2c3.788%2c0%2c0%2c1-.8-1.179A3.587%2c3.587%2c0%2c0%2c1-8.5-10.094a3.587%2c3.587%2c0%2c0%2c1%2c.295-1.448%2c3.788%2c3.788%2c0%2c0%2c1%2c.8-1.179%2c3.788%2c3.788%2c0%2c0%2c1%2c1.179-.8%2c3.587%2c3.587%2c0%2c0%2c1%2c1.448-.295ZM7.421-7.1a2.661%2c2.661%2c0%2c0%2c0-.261-.971%2c2.686%2c2.686%2c0%2c0%2c0-.573-.78%2c2.65%2c2.65%2c0%2c0%2c0-.818-.523%2c2.574%2c2.574%2c0%2c0%2c0-.988-.191H4.25v-1.062h.531a3.587%2c3.587%2c0%2c0%2c1%2c1.448.295%2c3.788%2c3.788%2c0%2c0%2c1%2c1.179.8%2c3.788%2c3.788%2c0%2c0%2c1%2c.8%2c1.179A3.587%2c3.587%2c0%2c0%2c1%2c8.5-6.906a3.632%2c3.632%2c0%2c0%2c1-.091.8Zm-9.546.191a2.6%2c2.6%2c0%2c0%2c0%2c.208%2c1.033%2c2.666%2c2.666%2c0%2c0%2c0%2c.569.847A2.666%2c2.666%2c0%2c0%2c0-.5-4.458%2c2.6%2c2.6%2c0%2c0%2c0%2c.531-4.25H1.992L3.055-3.187H.531A3.587%2c3.587%2c0%2c0%2c1-.917-3.482a3.788%2c3.788%2c0%2c0%2c1-1.179-.8%2c3.788%2c3.788%2c0%2c0%2c1-.8-1.179%2c3.587%2c3.587%2c0%2c0%2c1-.295-1.448%2c3.587%2c3.587%2c0%2c0%2c1%2c.295-1.448%2c3.788%2c3.788%2c0%2c0%2c1%2c.8-1.179%2c3.788%2c3.788%2c0%2c0%2c1%2c1.179-.8%2c3.587%2c3.587%2c0%2c0%2c1%2c1.448-.295h.531v1.063H.531A2.558%2c2.558%2c0%2c0%2c0-.5-9.351a2.724%2c2.724%2c0%2c0%2c0-.847.573%2c2.679%2c2.679%2c0%2c0%2c0-.569.843A2.572%2c2.572%2c0%2c0%2c0-2.125-6.906Zm10.6%2c2.374L6.6-2.656%2c8.475-.772l-.747.747L5.844-1.9%2c3.959-.017%2c3.212-.772%2c5.1-2.656%2c3.212-4.541l.747-.747L5.844-3.4%2c7.728-5.288Z' transform='translate(1036 327.999)'/%3e %3cpath id='Path_1391' data-name='Path 1391' class='cls-3' d='M8.475-4.532%2c6.6-2.656%2c8.475-.772l-.747.747L5.844-1.9%2c3.959-.017%2c3.212-.772%2c5.1-2.656%2c3.212-4.541l.747-.747L5.844-3.4%2c7.728-5.288Z' transform='translate(1036 327.999)'/%3e %3c/g%3e %3c/g%3e%3c/svg%3e",onClick:L.removeLink},code:{title:"Code block",image:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32'%3e %3cg%3e %3cline id='svg_1' y2='16.5' x2='7' y1='10' x1='13' stroke-width='1' stroke='black' fill='none'/%3e %3cline id='svg_2' y2='16.5' x2='7' y1='23' x1='13' stroke-width='1' stroke='black' fill='none'/%3e %3cline id='svg_3' y2='16.5' x2='26' y1='10' x1='20' stroke-width='1' stroke='black' fill='none'/%3e %3cline id='svg_4' y2='16.5' x2='26' y1='23' x1='20' stroke-width='1' stroke='black' fill='none'/%3e %3c/g%3e%3c/svg%3e",onClick:e=>L.toggleCodeBlock(e)},ltr:{title:"Left-to-right",image:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-5896 -8824 32 32'%3e %3cdefs%3e %3cstyle%3e .cls-1 %7b fill: none%3b %7d .cls-2 %7b fill: %23666%3b %7d .cls-3 %7b fill: %232E77D0%3b %7d %3c/style%3e %3c/defs%3e %3cg id='FB:_Paragraph_In' data-name='FB: Paragraph In' transform='translate(-6884 -9191.999)'%3e %3crect id='Rectangle_2295' data-name='Rectangle 2295' class='cls-1' width='32' height='32' rx='2' transform='translate(988 367.999)'/%3e %3cg id='Group_3954' data-name='Group 3954'%3e %3cpath id='Path_1756' data-name='Path 1756' class='cls-2' d='M-7.437-12.966l5.528%2c5.528L-7.437-1.909Zm1.063%2c8.5L-3.4-7.437l-2.972-2.972ZM6.375-14.875v12.75H7.438v1.063H2.125V-2.125H3.188V-8.5H1.594A3.632%2c3.632%2c0%2c0%2c1%2c.145-8.791a3.745%2c3.745%2c0%2c0%2c1-1.183-.8%2c3.745%2c3.745%2c0%2c0%2c1-.8-1.183%2c3.632%2c3.632%2c0%2c0%2c1-.291-1.448%2c3.632%2c3.632%2c0%2c0%2c1%2c.291-1.448%2c3.745%2c3.745%2c0%2c0%2c1%2c.8-1.183%2c3.745%2c3.745%2c0%2c0%2c1%2c1.183-.8%2c3.632%2c3.632%2c0%2c0%2c1%2c1.448-.291H7.438v1.063ZM3.188-9.562v-5.312H1.594a2.558%2c2.558%2c0%2c0%2c0-1.033.212%2c2.724%2c2.724%2c0%2c0%2c0-.847.573%2c2.679%2c2.679%2c0%2c0%2c0-.569.843%2c2.572%2c2.572%2c0%2c0%2c0-.208%2c1.029%2c2.6%2c2.6%2c0%2c0%2c0%2c.208%2c1.033%2c2.666%2c2.666%2c0%2c0%2c0%2c.569.847A2.666%2c2.666%2c0%2c0%2c0%2c.56-9.77a2.6%2c2.6%2c0%2c0%2c0%2c1.033.208ZM5.313-2.125v-12.75H4.25v12.75Z' transform='translate(1004 391.999)'/%3e %3cpath id='Path_1404' data-name='Path 1404' class='cls-3' d='M-7.437-12.966l5.528%2c5.528L-7.437-1.909Zm1.063%2c8.5L-3.4-7.437l-2.972-2.972Z' transform='translate(1004 391.999)'/%3e %3c/g%3e %3c/g%3e%3c/svg%3e",onClick:e=>L.setDirection(e,0)},rtl:{title:"Right-to-left",image:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-5860 -8824 32 32'%3e %3cdefs%3e %3cstyle%3e .cls-1 %7b fill: none%3b %7d .cls-2 %7b fill: %23666%3b %7d .cls-3 %7b fill: %232E77D0%3b %7d %3c/style%3e %3c/defs%3e %3cg id='FB:_Paragraph_Out' data-name='FB: Paragraph Out' transform='translate(-6880 -9191.999)'%3e %3crect id='Rectangle_2295' data-name='Rectangle 2295' class='cls-1' width='32' height='32' rx='2' transform='translate(1020 367.999)'/%3e %3cg id='Group_3965' data-name='Group 3965'%3e %3cpath id='Path_1767' data-name='Path 1767' class='cls-2' d='M1.063-15.937v1.063H0v12.75H1.063v1.063H-4.25V-2.125h1.063V-8.5H-4.781A3.632%2c3.632%2c0%2c0%2c1-6.23-8.791a3.745%2c3.745%2c0%2c0%2c1-1.183-.8%2c3.745%2c3.745%2c0%2c0%2c1-.8-1.183A3.632%2c3.632%2c0%2c0%2c1-8.5-12.219a3.632%2c3.632%2c0%2c0%2c1%2c.291-1.448%2c3.745%2c3.745%2c0%2c0%2c1%2c.8-1.183%2c3.745%2c3.745%2c0%2c0%2c1%2c1.183-.8%2c3.632%2c3.632%2c0%2c0%2c1%2c1.448-.291Zm-4.25%2c6.375v-5.312H-4.781a2.558%2c2.558%2c0%2c0%2c0-1.033.212%2c2.724%2c2.724%2c0%2c0%2c0-.847.573%2c2.679%2c2.679%2c0%2c0%2c0-.569.843%2c2.572%2c2.572%2c0%2c0%2c0-.208%2c1.029%2c2.6%2c2.6%2c0%2c0%2c0%2c.208%2c1.033%2c2.666%2c2.666%2c0%2c0%2c0%2c.569.847%2c2.666%2c2.666%2c0%2c0%2c0%2c.847.569%2c2.6%2c2.6%2c0%2c0%2c0%2c1.033.208Zm2.125%2c7.438v-12.75H-2.125v12.75Zm8.5-10.841V-1.909L1.909-7.437ZM6.375-10.409%2c3.4-7.437%2c6.375-4.466Z' transform='translate(1036 391.999)'/%3e %3cpath id='Path_1401' data-name='Path 1401' class='cls-3' d='M7.438-12.966V-1.909L1.909-7.437ZM6.375-10.409%2c3.4-7.437%2c6.375-4.466Z' transform='translate(1036 391.999)'/%3e %3c/g%3e %3c/g%3e%3c/svg%3e",onClick:e=>L.setDirection(e,1)},undo:{title:"Undo",image:"data:image/svg+xml,%3c%3fxml version='1.0' encoding='UTF-8'%3f%3e%3csvg viewBox='-8 -8 32 32' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e %3cdefs%3e %3cpath d='M8.5%2c0.03125 C9.0000025%2c0.03125 9.48176852%2c0.0963535156 9.9453125%2c0.2265625 C10.4088565%2c0.356771484 10.843748%2c0.541665469 11.25%2c0.78125 C11.656252%2c1.02083453 12.02604%2c1.30729 12.359375%2c1.640625 C12.69271%2c1.97396 12.9791655%2c2.34374797 13.21875%2c2.75 C13.4583345%2c3.15625203 13.6432285%2c3.59114352 13.7734375%2c4.0546875 C13.9036465%2c4.51823148 13.96875%2c4.9999975 13.96875%2c5.5 C13.96875%2c6.21354523 13.8320326%2c6.90234043 13.5585938%2c7.56640625 C13.2851549%2c8.23047207 12.8958359%2c8.81510164 12.390625%2c9.3203125 L5.8515625%2c15.8515625 L5.1484375%2c15.1484375 L11.6796875%2c8.609375 C12.0911479%2c8.19791461 12.408853%2c7.72265895 12.6328125%2c7.18359375 C12.856772%2c6.64452855 12.96875%2c6.08333625 12.96875%2c5.5 C12.96875%2c4.89062195 12.8502616%2c4.31510687 12.6132812%2c3.7734375 C12.3763009%2c3.23176813 12.0546895%2c2.75781453 11.6484375%2c2.3515625 C11.2421855%2c1.94531047 10.7682319%2c1.6236991 10.2265625%2c1.38671875 C9.68489312%2c1.1497384 9.10937805%2c1.03125 8.5%2c1.03125 C7.93749719%2c1.03125 7.4414084%2c1.11588457 7.01171875%2c1.28515625 C6.5820291%2c1.45442793 6.18489766%2c1.67838402 5.8203125%2c1.95703125 C5.45572734%2c2.23567848 5.10547043%2c2.55208156 4.76953125%2c2.90625 C4.43359207%2c3.26041844 4.08073102%2c3.62499813 3.7109375%2c4 L7%2c4 L7%2c5 L2%2c5 L2%2c0 L3%2c0 L3%2c3.2890625 C3.28645977%2c2.99739438 3.5611966%2c2.71484512 3.82421875%2c2.44140625 C4.0872409%2c2.16796738 4.3502591%2c1.91015746 4.61328125%2c1.66796875 C4.8763034%2c1.42578004 5.14452988%2c1.20442809 5.41796875%2c1.00390625 C5.69140762%2c0.803384414 5.98307137%2c0.631511133 6.29296875%2c0.48828125 C6.60286613%2c0.345051367 6.93880027%2c0.23307332 7.30078125%2c0.15234375 C7.66276223%2c0.0716141797 8.06249781%2c0.03125 8.5%2c0.03125 Z' id='path-1'%3e%3c/path%3e %3c/defs%3e %3cg id='Undo_16x16' stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'%3e %3cg id='undo'%3e %3cuse id='Mask' fill='%23666666' fill-rule='evenodd' xlink:href='%23path-1'%3e%3c/use%3e %3c/g%3e %3c/g%3e%3c/svg%3e",onClick:e=>e.undo()},redo:{title:"Redo",image:"data:image/svg+xml,%3c%3fxml version='1.0' encoding='UTF-8'%3f%3e%3csvg viewBox='-8 -8 32 32' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e %3cdefs%3e %3cpath d='M8.5%2c0.03125 C9.0000025%2c0.03125 9.48176852%2c0.0963535156 9.9453125%2c0.2265625 C10.4088565%2c0.356771484 10.843748%2c0.541665469 11.25%2c0.78125 C11.656252%2c1.02083453 12.02604%2c1.30729 12.359375%2c1.640625 C12.69271%2c1.97396 12.9791655%2c2.34374797 13.21875%2c2.75 C13.4583345%2c3.15625203 13.6432285%2c3.59114352 13.7734375%2c4.0546875 C13.9036465%2c4.51823148 13.96875%2c4.9999975 13.96875%2c5.5 C13.96875%2c6.21354523 13.8320326%2c6.90234043 13.5585938%2c7.56640625 C13.2851549%2c8.23047207 12.8958359%2c8.81510164 12.390625%2c9.3203125 L5.8515625%2c15.8515625 L5.1484375%2c15.1484375 L11.6796875%2c8.609375 C12.0911479%2c8.19791461 12.408853%2c7.72265895 12.6328125%2c7.18359375 C12.856772%2c6.64452855 12.96875%2c6.08333625 12.96875%2c5.5 C12.96875%2c4.89062195 12.8502616%2c4.31510687 12.6132812%2c3.7734375 C12.3763009%2c3.23176813 12.0546895%2c2.75781453 11.6484375%2c2.3515625 C11.2421855%2c1.94531047 10.7682319%2c1.6236991 10.2265625%2c1.38671875 C9.68489312%2c1.1497384 9.10937805%2c1.03125 8.5%2c1.03125 C7.93749719%2c1.03125 7.4414084%2c1.11588457 7.01171875%2c1.28515625 C6.5820291%2c1.45442793 6.18489766%2c1.67838402 5.8203125%2c1.95703125 C5.45572734%2c2.23567848 5.10547043%2c2.55208156 4.76953125%2c2.90625 C4.43359207%2c3.26041844 4.08073102%2c3.62499813 3.7109375%2c4 L7%2c4 L7%2c5 L2%2c5 L2%2c0 L3%2c0 L3%2c3.2890625 C3.28645977%2c2.99739438 3.5611966%2c2.71484512 3.82421875%2c2.44140625 C4.0872409%2c2.16796738 4.3502591%2c1.91015746 4.61328125%2c1.66796875 C4.8763034%2c1.42578004 5.14452988%2c1.20442809 5.41796875%2c1.00390625 C5.69140762%2c0.803384414 5.98307137%2c0.631511133 6.29296875%2c0.48828125 C6.60286613%2c0.345051367 6.93880027%2c0.23307332 7.30078125%2c0.15234375 C7.66276223%2c0.0716141797 8.06249781%2c0.03125 8.5%2c0.03125 Z' id='path-1'%3e%3c/path%3e %3c/defs%3e %3cg id='Redo_16x16' stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'%3e %3cg id='undo' transform='translate(8.000000%2c 8.000000) scale(-1%2c 1) translate(-8.000000%2c -8.000000) '%3e %3cuse id='Mask' fill='%23666666' fill-rule='evenodd' xlink:href='%23path-1'%3e%3c/use%3e %3c/g%3e %3c/g%3e%3c/svg%3e",onClick:e=>e.redo()},clearFormat:{title:"Clear format",image:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-5860 -8788 32 32'%3e %3cdefs%3e %3cstyle%3e .cls-1 %7b fill: none%3b %7d .cls-2%2c .cls-3 %7b fill: %232E77D0%3b %7d .cls-3 %7b stroke: white%3b stroke-width: 1.5px%3b %7d .cls-4 %7b fill: %23666%3b %7d %3c/style%3e %3c/defs%3e %3cg id='FB:_Formatting' data-name='FB: Formatting' transform='translate(-6820 -9291.998)'%3e %3crect id='Rectangle_2295' data-name='Rectangle 2295' class='cls-1' width='32' height='32' rx='2' transform='translate(960 503.998)'/%3e %3cg id='Group_3976' data-name='Group 3976'%3e %3cpath id='Path_1800' data-name='Path 1800' class='cls-2' d='M10.318-1.062h3.495V0H5.62L3.561-2.059a1.561%2c1.561%2c0%2c0%2c1-.344-.519%2c1.6%2c1.6%2c0%2c0%2c1-.12-.61%2c1.6%2c1.6%2c0%2c0%2c1%2c.12-.61%2c1.561%2c1.561%2c0%2c0%2c1%2c.344-.519L7.172-7.927l-.54-1.635H2.93L2.225-7.437H1.063L4.25-17H5.313L8.043-8.8l3.113-3.1%2c5%2c5ZM6.275-10.625%2c4.781-15.107%2c3.287-10.625Zm4.881.216L6.591-5.844l3.5%2c3.5%2c4.565-4.565ZM8.807-1.062l.54-.531-3.5-3.5L4.316-3.561a.511.511%2c0%2c0%2c0-.158.374.511.511%2c0%2c0%2c0%2c.158.374L6.068-1.062Z' transform='translate(968 527.998)'/%3e %3cpath id='Path_1397' data-name='Path 1397' class='cls-3' d='M8.807-1.062l.54-.531-3.5-3.5L4.316-3.561a.511.511%2c0%2c0%2c0-.158.374.511.511%2c0%2c0%2c0%2c.158.374L6.068-1.062Z' transform='translate(968 527.998)'/%3e %3cpath id='Path_1398' data-name='Path 1398' class='cls-4' d='M10.318-1.062h3.495V0H5.62L3.561-2.059a1.561%2c1.561%2c0%2c0%2c1-.344-.519%2c1.6%2c1.6%2c0%2c0%2c1-.12-.61%2c1.6%2c1.6%2c0%2c0%2c1%2c.12-.61%2c1.561%2c1.561%2c0%2c0%2c1%2c.344-.519l7.6-7.587%2c5%2c5Zm.838-9.347L6.591-5.844l3.5%2c3.5%2c4.565-4.565ZM8.807-1.062l.54-.531-3.5-3.5L4.316-3.561a.511.511%2c0%2c0%2c0-.158.374.511.511%2c0%2c0%2c0%2c.158.374L6.068-1.062Z' transform='translate(968 527.998)'/%3e %3c/g%3e %3c/g%3e%3c/svg%3e",onClick:e=>L.clearFormat(e)},inclusiveCheck:{title:"Inclusive Check",image:"data:image/svg+xml,%3c%3fxml version='1.0' encoding='UTF-8'%3f%3e%3csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' width='12' height='12' viewBox='0 0 16 16' version='1.1'%3e %3cg id='surface1'%3e %3cpath style=' stroke:none%3bfill-rule:nonzero%3bfill:black%3bfill-opacity:1%3b' d='M 4.890625 0.0507812 C 4.773438 0.0742188 4.554688 0.152344 4.410156 0.222656 C 3.671875 0.570312 3.226562 1.222656 3.164062 2.027344 C 3.070312 3.382812 4.230469 4.492188 5.582031 4.339844 C 6.132812 4.28125 6.375 4.144531 7.261719 3.40625 C 7.652344 3.082031 7.988281 2.8125 8 2.8125 C 8.011719 2.8125 8.347656 3.082031 8.738281 3.40625 C 9.625 4.144531 9.867188 4.28125 10.417969 4.339844 C 11.765625 4.492188 12.929688 3.382812 12.835938 2.03125 C 12.773438 1.222656 12.328125 0.570312 11.589844 0.222656 C 11.300781 0.0859375 10.945312 0 10.65625 0 C 10.25 0 9.757812 0.15625 9.4375 0.386719 C 9.320312 0.472656 8.296875 1.3125 8.054688 1.523438 C 8.007812 1.566406 7.945312 1.523438 7.367188 1.039062 C 7.015625 0.746094 6.660156 0.457031 6.570312 0.394531 C 6.101562 0.0546875 5.476562 -0.0703125 4.890625 0.0507812 Z M 5.785156 1.027344 C 5.914062 1.078125 6.121094 1.230469 6.605469 1.632812 C 6.960938 1.925781 7.246094 2.179688 7.242188 2.191406 C 7.21875 2.257812 5.996094 3.230469 5.847656 3.304688 C 5.6875 3.382812 5.640625 3.390625 5.328125 3.390625 C 5.007812 3.390625 4.972656 3.382812 4.800781 3.296875 C 4.539062 3.164062 4.332031 2.953125 4.210938 2.695312 C 4.117188 2.503906 4.109375 2.457031 4.109375 2.1875 C 4.113281 1.816406 4.1875 1.601562 4.40625 1.367188 C 4.566406 1.191406 4.839844 1.023438 5.050781 0.972656 C 5.234375 0.925781 5.585938 0.953125 5.785156 1.027344 Z M 11.203125 1.074219 C 11.484375 1.210938 11.714844 1.453125 11.816406 1.710938 C 11.875 1.851562 11.886719 1.953125 11.890625 2.1875 C 11.890625 2.457031 11.882812 2.503906 11.789062 2.695312 C 11.667969 2.953125 11.460938 3.164062 11.199219 3.296875 C 11.027344 3.382812 10.992188 3.390625 10.671875 3.390625 C 10.359375 3.390625 10.3125 3.382812 10.148438 3.304688 C 9.996094 3.226562 8.757812 2.234375 8.75 2.183594 C 8.75 2.164062 9.914062 1.191406 10.039062 1.113281 C 10.21875 0.992188 10.472656 0.9375 10.730469 0.949219 C 10.933594 0.960938 11.015625 0.984375 11.203125 1.074219 Z M 11.203125 1.074219 '/%3e %3cpath style=' stroke:none%3bfill-rule:nonzero%3bfill:%232e77d0%3bfill-opacity:1%3b' d='M 1.078125 2.917969 C 0.816406 2.984375 0.617188 3.097656 0.417969 3.296875 C 0.207031 3.507812 0.0859375 3.730469 0.03125 4.015625 C 0.0078125 4.148438 0 4.992188 0.0078125 7.0625 C 0.0195312 9.898438 0.0195312 9.925781 0.0859375 10.179688 C 0.125 10.324219 0.207031 10.550781 0.265625 10.679688 C 0.328125 10.8125 0.855469 11.640625 1.4375 12.515625 L 2.5 14.109375 L 2.5 14.867188 C 2.5 15.570312 2.507812 15.636719 2.5625 15.75 C 2.601562 15.832031 2.667969 15.898438 2.75 15.9375 C 2.867188 15.996094 2.929688 16 5 16 C 7.070312 16 7.132812 15.996094 7.25 15.9375 C 7.332031 15.898438 7.398438 15.832031 7.4375 15.746094 C 7.503906 15.625 7.503906 15.589844 7.492188 13.382812 C 7.480469 11.1875 7.480469 11.132812 7.414062 10.882812 C 7.335938 10.582031 7.179688 10.238281 7.011719 9.976562 C 6.945312 9.871094 6.398438 9.300781 5.695312 8.585938 C 4.367188 7.253906 4.332031 7.226562 3.882812 7.152344 C 3.585938 7.101562 3.289062 7.152344 3.007812 7.296875 L 2.8125 7.402344 L 2.8125 5.78125 C 2.8125 4.691406 2.800781 4.105469 2.777344 3.992188 C 2.71875 3.726562 2.59375 3.5 2.390625 3.292969 C 2.039062 2.941406 1.550781 2.800781 1.078125 2.917969 Z M 1.625 3.875 C 1.707031 3.914062 1.773438 3.980469 1.8125 4.0625 C 1.871094 4.179688 1.875 4.242188 1.875 6.074219 C 1.875 8.109375 1.882812 8.230469 2.039062 8.625 C 2.207031 9.03125 2.296875 9.140625 3.453125 10.304688 C 4.070312 10.929688 4.617188 11.460938 4.667969 11.492188 C 4.789062 11.554688 5.007812 11.550781 5.125 11.476562 C 5.320312 11.367188 5.398438 11.113281 5.308594 10.882812 C 5.292969 10.835938 4.820312 10.335938 4.261719 9.777344 C 3.414062 8.929688 3.242188 8.742188 3.21875 8.644531 C 3.144531 8.3125 3.433594 8.015625 3.773438 8.078125 C 3.875 8.097656 4.023438 8.226562 4.960938 9.164062 C 6.046875 10.242188 6.25 10.476562 6.386719 10.789062 C 6.554688 11.164062 6.5625 11.285156 6.5625 13.25 L 6.5625 15.0625 L 3.4375 15.0625 L 3.4375 14.46875 C 3.4375 13.976562 3.429688 13.851562 3.386719 13.773438 C 3.359375 13.71875 2.855469 12.957031 2.273438 12.082031 C 1.6875 11.203125 1.167969 10.398438 1.117188 10.292969 C 0.9375 9.90625 0.9375 9.925781 0.941406 6.921875 C 0.941406 3.832031 0.925781 4.039062 1.175781 3.886719 C 1.324219 3.796875 1.460938 3.792969 1.625 3.875 Z M 1.625 3.875 '/%3e %3cpath style=' stroke:none%3bfill-rule:nonzero%3bfill:%232e77d0%3bfill-opacity:1%3b' d='M 14.265625 2.917969 C 14.003906 2.984375 13.804688 3.097656 13.605469 3.296875 C 13.402344 3.5 13.277344 3.722656 13.222656 3.992188 C 13.199219 4.101562 13.1875 4.710938 13.1875 5.78125 L 13.1875 7.402344 L 12.992188 7.296875 C 12.714844 7.15625 12.414062 7.101562 12.121094 7.152344 C 11.679688 7.226562 11.660156 7.242188 10.382812 8.511719 C 9.742188 9.148438 9.148438 9.757812 9.074219 9.855469 C 8.882812 10.105469 8.675781 10.550781 8.585938 10.875 C 8.519531 11.136719 8.519531 11.179688 8.507812 13.382812 C 8.496094 15.589844 8.496094 15.625 8.5625 15.746094 C 8.601562 15.832031 8.667969 15.898438 8.75 15.9375 C 8.867188 15.996094 8.929688 16 11 16 C 13.070312 16 13.132812 15.996094 13.25 15.9375 C 13.332031 15.898438 13.398438 15.832031 13.4375 15.75 C 13.492188 15.636719 13.5 15.570312 13.5 14.867188 L 13.5 14.109375 L 14.558594 12.515625 C 15.640625 10.890625 15.722656 10.757812 15.839844 10.414062 C 15.996094 9.957031 16 9.878906 16 6.917969 C 16 4.980469 15.992188 4.109375 15.964844 3.992188 C 15.90625 3.726562 15.78125 3.5 15.578125 3.292969 C 15.226562 2.941406 14.738281 2.800781 14.265625 2.917969 Z M 14.8125 3.875 C 14.894531 3.914062 14.960938 3.980469 15 4.0625 C 15.0625 4.1875 15.066406 4.21875 15.054688 7.023438 C 15.042969 10.144531 15.054688 9.957031 14.851562 10.355469 C 14.808594 10.441406 14.28125 11.246094 13.679688 12.152344 L 12.578125 13.796875 L 12.570312 14.429688 L 12.558594 15.0625 L 9.4375 15.0625 L 9.4375 13.230469 C 9.4375 11.253906 9.445312 11.171875 9.613281 10.785156 C 9.75 10.476562 9.957031 10.242188 11.039062 9.164062 C 11.976562 8.226562 12.125 8.097656 12.226562 8.078125 C 12.566406 8.015625 12.855469 8.3125 12.78125 8.644531 C 12.757812 8.742188 12.585938 8.929688 11.738281 9.777344 C 11.179688 10.335938 10.707031 10.835938 10.691406 10.882812 C 10.601562 11.113281 10.679688 11.367188 10.875 11.476562 C 10.992188 11.550781 11.210938 11.554688 11.332031 11.492188 C 11.382812 11.460938 11.929688 10.929688 12.546875 10.304688 C 13.703125 9.140625 13.792969 9.03125 13.960938 8.625 C 14.117188 8.230469 14.125 8.109375 14.125 6.070312 C 14.128906 3.9375 14.117188 4.035156 14.363281 3.886719 C 14.511719 3.796875 14.648438 3.792969 14.8125 3.875 Z M 14.8125 3.875 '/%3e %3c/g%3e%3c/svg%3e",onClick:e=>{var t=e.getContent();e.runAsync(()=>{wm("[data-tippy-content]",{theme:"light",allowHTML:!0,interactive:!0})}),e.setContent(Nm(t))}},insertImage:{title:"Insert inline image",image:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-6111 -8692 32 32'%3e %3cdefs%3e %3cstyle%3e .cls-1 %7b fill: none%3b %7d .cls-2 %7b fill: %232E77D0%3b stroke: white%3b stroke-width: 1.5px%3b %7d .cls-3 %7b fill: %23666%3b %7d %3c/style%3e %3c/defs%3e %3cg id='TB:_Insert' data-name='TB: Insert' transform='translate(-6366 -9160.999)'%3e %3crect id='Rectangle_2291' data-name='Rectangle 2291' class='cls-1' width='32' height='32' rx='2' transform='translate(255 468.999)'/%3e %3cg id='Group_3880' data-name='Group 3880'%3e %3cpath id='Path_990' data-name='Path 990' class='cls-2' d='M1.063-3.187H11.995L4.781-10.409%2c1.063-6.682Zm14.875%2c0v-.307L12.219-7.222%2c10.841-5.844l2.665%2c2.656Z' transform='translate(263 492.999)'/%3e %3cpath id='Path_1452' data-name='Path 1452' class='cls-3' d='M17-14.875v12.75H0v-12.75ZM1.063-13.812v5.62L4.781-11.9l5.313%2c5.313%2c2.125-2.125%2c3.719%2c3.71v-8.807Zm0%2c10.625H11.995L4.781-10.409%2c1.063-6.682Zm14.875%2c0v-.307L12.219-7.222%2c10.841-5.844l2.665%2c2.656Zm-2.656-7.437a.511.511%2c0%2c0%2c1-.374-.158.511.511%2c0%2c0%2c1-.158-.374.511.511%2c0%2c0%2c1%2c.158-.374.511.511%2c0%2c0%2c1%2c.374-.158.511.511%2c0%2c0%2c1%2c.374.158.511.511%2c0%2c0%2c1%2c.158.374.511.511%2c0%2c0%2c1-.158.374A.511.511%2c0%2c0%2c1%2c13.281-10.625Z' transform='translate(263 492.999)'/%3e %3c/g%3e %3c/g%3e%3c/svg%3e",onClick:(n,r)=>{const e=n.getDocument(),o=e.createElement("input");o.type="file",o.accept="image/*",o.style.display="none",o.addEventListener("change",()=>{var e=void 0,a=void 0,l=void 0,s=function*(){var e,[t]=null!=(e=null==o?void 0:o.files)?e:[];if(t&&r){const e=yield r(t);"string"==typeof e?L.insertImage(n,e):L.insertImage(n,t)}};return new(l=l||Promise)(function(n,t){function r(e){try{i(s.next(e))}catch(e){t(e)}}function o(e){try{i(s.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?n(e.value):((t=e.value)instanceof l?t:new l(function(e){e(t)})).then(r,o)}i((s=s.apply(e,a||[])).next())})}),e.body.appendChild(o),o.click(),e.body.removeChild(o)}}};function Am(e,t,n){var r;const o=Pm("div",{class:"toolbar"}),i=L.getFormatState(n),a=null==e?void 0:e.parentNode,l=Object.keys(t);for(const[e,s]of l.entries())if(Im[s]){const{image:l="",onClick:c,checked:d=null,title:u}=Im[s],f="function"==typeof d,p=!!f&&d(i),h=Pm("button",{class:"toolbar-button",id:s,title:u,"aria-label":u,type:"button",tabindex:0===e?"0":"-1"},Pm("img",{src:l,alt:u,width:"30",height:"30"}));h.onclick=()=>{f&&h.classList.toggle("active"),h.setAttribute("tabindex","0"),null!=t&&t.insertImage?c(n,null==t?void 0:t.insertImage):c(n)},null!=(r=null==a?void 0:a.querySelector("#"+s))&&r.classList.toggle("active",p),o.appendChild(h)}return o.onkeydown=e=>{var t;if("ArrowLeft"===e.key||"ArrowRight"===e.key){const n=document.querySelector(".toolbar"),r=null==n?void 0:n.querySelector('button[tabindex="0"]');"ArrowRight"===e.key&&r.nextSibling?(r.setAttribute("tabindex","-1"),r.classList.remove("active"),null!=(t=r.nextElementSibling)&&t.setAttribute("tabindex","0"),null!=(t=r.nextElementSibling)&&t.focus()):"ArrowLeft"===e.key&&r.previousSibling&&(r.setAttribute("tabindex","-1"),r.classList.remove("active"),null!=(t=r.previousElementSibling)&&t.setAttribute("tabindex","0"),null!=(e=r.previousElementSibling)&&e.focus())}},o}class Mm{constructor(e,t){this.rootElement=e,this.toolbarConfig=t}getName(){return"Toolbar"}initialize(e){this.editor=e}dispose(){this.editor=null}getEditor(){return this.editor}updateToolbarOptions(){this.editor&&Am(this.rootElement,this.toolbarConfig,this.editor)}onPluginEvent(e){if(this.editor)if(0==e.eventType||6==e.eventType)this.updateToolbarOptions();else if(7==e.eventType){const t=this.editor.getCustomData("LAST_CLIPBOARD_DATA")||{data:null};"Paste"==e.source?t.data=e.data:t.data=null}else 11==e.eventType&&this.updateToolbarOptions()}}return Sm('.tippy-box[data-animation=fade][data-state=hidden]{opacity:0}[data-tippy-root]{max-width:calc(100vw - 10px)}.tippy-box{position:relative;background-color:#333;color:#fff;border-radius:4px;font-size:14px;line-height:1.4;white-space:normal;outline:0;transition-property:transform,visibility,opacity}.tippy-box[data-placement^=top]>.tippy-arrow{bottom:0}.tippy-box[data-placement^=top]>.tippy-arrow:before{bottom:-7px;left:0;border-width:8px 8px 0;border-top-color:initial;transform-origin:center top}.tippy-box[data-placement^=bottom]>.tippy-arrow{top:0}.tippy-box[data-placement^=bottom]>.tippy-arrow:before{top:-7px;left:0;border-width:0 8px 8px;border-bottom-color:initial;transform-origin:center bottom}.tippy-box[data-placement^=left]>.tippy-arrow{right:0}.tippy-box[data-placement^=left]>.tippy-arrow:before{border-width:8px 0 8px 8px;border-left-color:initial;right:-7px;transform-origin:center left}.tippy-box[data-placement^=right]>.tippy-arrow{left:0}.tippy-box[data-placement^=right]>.tippy-arrow:before{left:-7px;border-width:8px 8px 8px 0;border-right-color:initial;transform-origin:center right}.tippy-box[data-inertia][data-state=visible]{transition-timing-function:cubic-bezier(.54,1.5,.38,1.11)}.tippy-arrow{width:16px;height:16px;color:#333}.tippy-arrow:before{content:"";position:absolute;border-color:transparent;border-style:solid}.tippy-content{position:relative;padding:5px 9px;z-index:1}'),Sm(".tippy-box[data-theme~=light]{color:#26323d;box-shadow:0 0 20px 4px rgba(154,161,177,.15),0 4px 80px -8px rgba(36,40,47,.25),0 4px 4px -2px rgba(91,94,105,.15);background-color:#fff}.tippy-box[data-theme~=light][data-placement^=top]>.tippy-arrow:before{border-top-color:#fff}.tippy-box[data-theme~=light][data-placement^=bottom]>.tippy-arrow:before{border-bottom-color:#fff}.tippy-box[data-theme~=light][data-placement^=left]>.tippy-arrow:before{border-left-color:#fff}.tippy-box[data-theme~=light][data-placement^=right]>.tippy-arrow:before{border-right-color:#fff}.tippy-box[data-theme~=light]>.tippy-backdrop{background-color:#fff}.tippy-box[data-theme~=light]>.tippy-svg-arrow{fill:#fff}"),Sm('.editor-container {\n    display: flex;\n    flex-direction: column;\n    position: relative;\n}\n\n.editor-textarea {\n    flex: 1 1 auto;\n    min-height: 100px;\n    border: 2px solid #ddd;\n    overflow: auto;\n    padding: 10px;\n}\n\n\ndiv[contenteditable="false"].editor-textarea {\n    overflow-wrap: anywhere;\n}\n\ndiv[contenteditable="true"].editor-textarea mark {\n    all: unset;\n    text-decoration: underline;\n    text-decoration-thickness: 3px;\n    text-underline-offset: 4px;\n}\n\ndiv[contenteditable="true"].editor-textarea mark:not(.sev-1,.sev-2, .sev-3) {\n    all: unset\n}\n\ndiv[contenteditable="true"].editor-textarea mark.sev-1 {\n    /* background-color: rgba(255, 0, 0, 0.95);\n    color: white; */\n    text-decoration-color: #f27388;\n\n}\n\ndiv[contenteditable="true"].editor-textarea mark.sev-2 {\n    text-decoration-color: #ffa600;\n}\n\ndiv[contenteditable="true"].editor-textarea mark.sev-3 {\n    text-decoration-color: #a2fcb8;\n}\n\nimg[alt="Inclusive Check"] {\n    padding: 0px 6px;\n}\n\n.pi-rephrase-btn {\n    border: none;\n    margin: 5px;\n    padding: 8px 12px;\n    border-radius: 2px;\n}\n\n.pi-rephrase-btn:hover {\n    color: white;\n    cursor: pointer;\n    background-color: #11a683;\n}\n\n\ndiv[id*="tippy-"] {\n    min-width: 216px;\n    max-width: 324px;\n}\n\n'),D.PiTextEditor=class{constructor(e,t){this.rootElement=e,this.config=Object.assign(Object.assign({},t),{width:(null==t?void 0:t.width)||"100%",height:(null==t?void 0:t.height)||"100%"})}mount(){var e;this.createWrapperDiv(),this.editor=new j.Editor(this.rootElement,{plugins:this.getPlugins()}),this.rootElement.classList.add("editor-textarea"),this.rootElement.tabIndex=0,this.rootElement.spellcheck=(null==(e=this.config)?void 0:e.spellcheck)||!1,this.config.readonly?(this.rootElement.contentEditable="false",this.rootElement.spellcheck=!1,this.rootElement.style.cssText=`height:${this.config.height}; width:${this.config.width};`):this.mountWithToolbar()}unmount(){var e;null!=(e=this.editor)&&e.dispose(),this.replaceWrapperDiv()}getContent(e,t=!0){e=this.editor.getContent(e);return t?Rm(e):e}setContent(e){return this.config.toolbar.inclusiveCheck&&this.editor.runAsync(()=>{wm("[data-tippy-content]",{theme:"light",appendTo:this.rootElement,allowHTML:!0,interactive:!0})}),this.editor.setContent(this.config.toolbar.inclusiveCheck?Nm(e):e)}getPlugins(){var e;const t=[...Om,...null!=(e=this.config)&&e.onChange?[new Tm(this.config.onChange,null==(e=this.config)?void 0:e.debounceOnChange)]:[],new Mm(this.rootElement,null==(e=this.config)?void 0:e.toolbar)];if(this.config.autoSuggestPluginConfig){const e=this.config.autoSuggestPluginConfig;t.push(new Ad.PickerPlugin(new xm(this.config.autoSuggestPluginConfig),{elementIdPrefix:e.elementIdPrefix||"",changeSource:e.changeSource||"",triggerCharacter:this.config.autoSuggestPluginConfig.triggerCharacter}))}return t}createWrapperDiv(){const e=Pm("div",{class:"editor-container"});e.style.cssText=`height:${this.config.height}; width:${this.config.width};`,this.container=e}replaceWrapperDiv(){var e,t;this.rootElement&&null!=(e=null==(t=this.rootElement.parentNode)?void 0:t.parentNode)&&e.replaceChild(this.rootElement,t)}mountWithToolbar(){var e,t;if(!this.config.toolbar)throw new Error("Toolbar options are not passed in config.");this.container&&(t=Am(this.rootElement,null==(t=this.config)?void 0:t.toolbar,this.editor),null!=(e=null==(e=this.rootElement)?void 0:e.parentElement)&&e.replaceChild(this.container,this.rootElement),null!=(e=this.container)&&e.appendChild(this.rootElement),null!=(e=this.container)&&e.prepend(t))}},Object.defineProperty(D,"__esModule",{value:!0}),D}({});
