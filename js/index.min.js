var PiTextEditor=function(D){"use strict";var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},j={},B={},F={},H={},t={},n={},z={},r={},o={};function U(e){e=e&&(e.commonAncestorContainer||e),e=e&&(e.ownerDocument||("[object HTMLDocument]"==Object.prototype.toString.apply(e)?e:null));return e&&(e.defaultView||window)}Object.defineProperty(o,"__esModule",{value:!0}),o.getTargetWindow=void 0,o.getTargetWindow=U,o.default=function(e,t){var n=U(e),n=n&&n[t],r=window,r=r&&r[t];return r&&e instanceof r||n&&e instanceof n},Object.defineProperty(r,"__esModule",{value:!0});var V=o,i=(r.default=function(e,t,n){return!(!e||!t)&&(!(!n||e!=t)||((0,V.default)(t,"Range")&&(t=t&&t.commonAncestorContainer,n=!0),t&&3==t.nodeType&&(t=t.parentNode,n=!0),1!=e.nodeType&&11!=e.nodeType?!!n&&e==t:!(!n&&e==t)&&function(e,t){if(e.contains)return e.contains(t);for(;t;){if(t==e)return!0;t=t.parentNode}return!1}(e,t)))},{}),a={},W=(Object.defineProperty(a,"__esModule",{value:!0}),a.default=function(e,t){return!(!e||!t||4!=(4&t.compareDocumentPosition(e)))},Object.defineProperty(i,"__esModule",{value:!0}),i.splitBalancedNodeRange=void 0,a);function K(e,t){var n;if(!e||!e.parentNode)return null;var r=e.parentNode,o=r.cloneNode(!1);if(o.removeAttribute("id"),t)for(;r.firstChild&&r.firstChild!=e;)o.appendChild(r.firstChild);else for(;e.nextSibling;)o.appendChild(e.nextSibling);return o.firstChild&&""!=o.innerHTML?null!=(n=r.parentNode)&&n.insertBefore(o,t?r:r.nextSibling):o=null,o}i.default=K,i.splitBalancedNodeRange=function(e){var t,n=Array.isArray(e)?e[0]:e,e=Array.isArray(e)?e[e.length-1]:e,r=n&&e&&n.parentNode==e.parentNode?n.parentNode:null;return r&&((0,W.default)(n,e)&&(t=e,e=n,n=t),K(n,!0),K(e,!1)),r};var q={},G=(Object.defineProperty(q,"__esModule",{value:!0}),q.default=function(e){return[].slice.call(e)},Object.defineProperty(z,"__esModule",{value:!0}),z.collapse=void 0,r),Z=i,Y=q;function $(e,t,n,r,o){for(;t.parentNode!=e&&!(0,G.default)(t.parentNode,n);){if(r&&t.previousSibling||!r&&t.nextSibling){if(!o)break;(0,Z.default)(t,r)}if(!t.parentNode)break;t=t.parentNode}return t}z.default=function(e,t,n,r){var o;return(0,G.default)(e,t)&&(0,G.default)(e,n)?(t=$(e,t,n,!0,r),n=$(e,n,t,!1,r),(0,G.default)(t,n,!0)?[t]:(0,G.default)(n,t)?[n]:t.parentNode==n.parentNode?(e=(r=t.parentNode?(0,Y.default)(null==(e=t.parentNode)?void 0:e.childNodes):[]).indexOf(t),o=r.indexOf(n),r.slice(e,o+1)):[t,n]):[]},z.collapse=$;var l={},X=(Object.defineProperty(l,"__esModule",{value:!0}),l.default=function(e){return e&&1==e.nodeType?e.tagName.toUpperCase():""},{}),Q=(Object.defineProperty(X,"__esModule",{value:!0}),l),J="ADDRESS,ARTICLE,ASIDE,BLOCKQUOTE,CANVAS,DD,DIV,DL,DT,FIELDSET,FIGCAPTION,FIGURE,FOOTER,FORM,H1,H2,H3,H4,H5,H6,HEADER,HR,LI,MAIN,NAV,NOSCRIPT,OL,OUTPUT,P,PRE,SECTION,TABLE,TD,TH,TFOOT,UL,VIDEO".split(","),ee=["block","list-item","table-cell"],s=(X.default=function(e){var t=(0,Q.default)(e);return!(!t||!(0<=ee.indexOf(e.style.display)||0<=J.indexOf(t)))},{}),te=(Object.defineProperty(s,"__esModule",{value:!0}),r),ne=a;function re(e){this.element=e}re.prototype.collapseToSingleElement=function(){return this.element},re.prototype.getStartNode=function(){return this.element},re.prototype.getEndNode=function(){return this.element},re.prototype.equals=function(e){return this.element==e.getStartNode()},re.prototype.isAfter=function(e){return(0,ne.default)(this.element,e.getEndNode())},re.prototype.contains=function(e){return(0,te.default)(this.element,e,!0)},re.prototype.getTextContent=function(){var e;return(null==(e=this.element)?void 0:e.textContent)||""},s.default=re;var c={},oe={},ie={},ae=(Object.defineProperty(ie,"__esModule",{value:!0}),l),le="AREA,BASE,BR,COL,COMMAND,EMBED,HR,IMG,INPUT,KEYGEN,LINK,META,PARAM,SOURCE,TRACK,WBR".split(","),d=(ie.default=function(e){return!!e&&0<=le.indexOf((0,ae.default)(e))},{}),se={},ce={},de=(Object.defineProperty(ce,"__esModule",{value:!0}),o),ue=(ce.default=function(e,t){return(0,de.default)(e,"HTMLElement")&&(e.matches||e.msMatchesSelector).call(e,t)},Object.defineProperty(se,"__esModule",{value:!0}),r),fe=ce,he=(se.default=function(e,t,n){var r=(e=e?1==e.nodeType?e:e.parentNode:null)&&1==e.nodeType?e:null;if(r&&n)if(r.closest)r=r.closest(n);else for(;r&&r!=t&&!(0,fe.default)(r,n);)r=r.parentElement;return!t||(0,ue.default)(t,r)?r:null},Object.defineProperty(d,"__esModule",{value:!0}),se),pe=a;function ge(e,t,n){switch(void 0===t&&(t=0),this.isFromEndOfRange=n,e.node?(this.node=e.node,t=e.offset):this.node=e,t){case-2:this.offset=me(this.node),this.node=this.node.parentNode,this.isAtEnd=!1;break;case-3:this.offset=me(this.node)+1,this.isAtEnd=!this.node.nextSibling,this.node=this.node.parentNode;break;case-1:this.offset=ve(this.node),this.isAtEnd=!0;break;default:var r=ve(this.node);this.offset=Math.max(0,Math.min(t,r)),this.isAtEnd=0<t&&r<=t}this.element=(0,he.default)(this.node)}function me(e){for(var t=0;e=(null==e?void 0:e.previousSibling)||null;)t++;return t}function ve(e){var t;return 3==e.nodeType?(null==(t=e.nodeValue)?void 0:t.length)||0:1==e.nodeType?e.childNodes.length:1}ge.prototype.normalize=function(){if(3==this.node.nodeType||!this.node.firstChild)return this;for(var e=this.node,t=this.isAtEnd?-1:this.offset;1==e.nodeType||11==e.nodeType;){var n=this.isFromEndOfRange?-1==t?e.lastChild:e.childNodes[t-1]:0==t?e.firstChild:-1==t?e.lastChild:e.childNodes[t];if(!n)break;e=n,t=this.isAtEnd||this.isFromEndOfRange?-1:0}return new ge(e,t,this.isFromEndOfRange)},ge.prototype.equalTo=function(e){return e&&(this==e||this.node==e.node&&this.offset==e.offset&&this.isAtEnd==e.isAtEnd)},ge.prototype.isAfter=function(e){return this.node==e.node?this.isAtEnd&&!e.isAtEnd||this.offset>e.offset:(0,pe.default)(this.node,e.node)},ge.prototype.move=function(e){return new ge(this.node,Math.max(this.offset+e,0))},ge.getStart=function(e){return new ge(e.startContainer,e.startOffset)},ge.getEnd=function(e){return e.collapsed?ge.getStart(e):new ge(e.endContainer,e.endOffset,!0)},d.default=ge,Object.defineProperty(oe,"__esModule",{value:!0});var ye=ie,be=d,Ee=o;function Ce(e){return 1==e.node.nodeType&&(0,ye.default)(e.node)?new be.default(e.node,e.isAtEnd?-3:-2):e}function we(e){return e&&e.node}function Se(e,t){if(!e||!t)return null;for(var n=0,r=0;r<t.length&&(n=t[r],r<t.length-1&&e&&1==e.nodeType&&e.childNodes.length>n);r++)e=e.childNodes[n];return new be.default(e,n)}oe.default=function(e,t,n,r){var o=null,i=null;return we(e)?(o=e,i=we(t)?t:null):(0,Ee.default)(e,"Node")&&(Array.isArray(t)?(o=Se(e,t),i=Array.isArray(n)?Se(e,n):null):"number"==typeof t?(o=new be.default(e,t),i=(0,Ee.default)(n,"Node")?new be.default(n,r):null):!(0,Ee.default)(t,"Node")&&t||(o=new be.default(e,-2),i=new be.default(t||e,-3))),null!=(n=null==o?void 0:o.node)&&n.ownerDocument?(r=o.node.ownerDocument.createRange(),o=Ce(o),i=Ce(i||o),r.setStart(o.node,o.offset),r.setEnd(i.node,i.offset),r):null};var Te,Pe,Oe={},u={},xe={},_e=(Object.defineProperty(xe,"__esModule",{value:!0}),xe.Browser=xe.getBrowserInfo=void 0,/android/i);function Ne(e,t){var n=-1!=e.indexOf("rv:")&&-1!=e.indexOf("Trident"),r=-1!=e.indexOf("MSIE")||n,o=!1,i=!1,a=!1,l=!1,s=-1!=e.indexOf("WebKit");return r||(o=-1!=e.indexOf("Chrome"),i=-1!=e.indexOf("Firefox"),-1!=e.indexOf("Safari")&&(a=-1==e.indexOf("Chrome")&&-1==e.indexOf("Android")),(l=-1!=e.indexOf("Edge"))&&(s=o=i=!1)),{isMac:-1!=t.indexOf("Mac"),isWin:-1!=t.indexOf("Win")||-1!=t.indexOf("NT"),isWebKit:s,isIE:r,isIE11OrGreater:n,isSafari:a,isChrome:o,isFirefox:i,isEdge:l,isIEOrEdge:r||l,isAndroid:_e.test(e)}}xe.getBrowserInfo=Ne,xe.Browser=window?Ne(window.navigator.userAgent,window.navigator.appVersion):{},Te=u,Object.defineProperty(Te,"__esModule",{value:!0}),Te.KnownCreateElementData=void 0,Pe=o,Re=xe,Te.KnownCreateElementData=((f={})[0]={tag:""},f[1]=Re.Browser.isEdge?{tag:"div",children:[{tag:"span",children:[{tag:"br"}]}]}:{tag:"div",children:[{tag:"br"}]},f[2]={tag:"blockquote",style:"margin-top:0;margin-bottom:0"},f[3]={tag:"div",style:"width: 1px; height: 1px; overflow: hidden; position: fixed; top: 0; left; 0; -webkit-user-select: text",attributes:{contenteditable:"true"}},f[4]={tag:"li",style:"display:block"},f[5]={tag:"div",style:"position: fixed; width: 0; height: 0"},f[6]={tag:"div",style:"width:100%;height:100%;position:relative;overflow:hidden"},f[7]={tag:"div",style:"position: fixed; cursor: row-resize; user-select: none"},f[8]={tag:"div",style:"position: fixed; cursor: col-resize; user-select: none"},f[9]={tag:"div",style:"position: fixed; cursor: nw-resize; user-select: none; border: 1px solid #808080"},f[10]={tag:"div",style:"position: fixed; cursor: ne-resize; user-select: none; border: 1px solid #808080"},f[11]={tag:"div",style:"position: fixed; cursor: all-scroll; user-select: none; border: 1px solid #808080"},f),Te.default=function t(e,n){if(!(e="number"==typeof e?Te.KnownCreateElementData[e]:e)||!e.tag)return null;var r=e.tag,o=e.namespace,i=e.className,a=e.style,l=e.dataset,s=e.attributes,e=e.children,c=o?n.createElementNS(o,r):n.createElement(r);return a&&c.setAttribute("style",a),i&&(c.className=i),l&&(0,Pe.default)(c,"HTMLElement")&&Object.keys(l).forEach(function(e){c.dataset[e]=l[e]}),s&&Object.keys(s).forEach(function(e){c.setAttribute(e,s[e])}),e&&e.forEach(function(e){"string"==typeof e?c.appendChild(n.createTextNode(e)):e&&(e=t(e,n))&&c.appendChild(e)}),c};var Re={},ke=(Object.defineProperty(Re,"__esModule",{value:!0}),q),Le=(Re.default=function(e,t){t=t.createElement("DIV");return t.innerHTML=e,(0,ke.default)(t.childNodes)},Object.defineProperty(Oe,"__esModule",{value:!0}),u),Ie=Re,Me=o,Ae=(Oe.default=function(e,t){if(0==(e=e?(0,Me.default)(e,"Node")?[e]:e:[]).length||!e[0]||!e[0].ownerDocument)return null;(0,Me.default)(t=t||"div","HTMLElement")||(n=e[0].ownerDocument,t="string"==typeof t?/^\w+$/.test(t)?n.createElement(t):(0,Ie.default)(t,n)[0]:(0,Le.default)(t,n));var n=e[0].parentNode;n&&n.insertBefore(t,e[0]);for(var r=0,o=e;r<o.length;r++){var i=o[r];t.appendChild(i)}return t},Object.defineProperty(c,"__esModule",{value:!0}),z),De=r,je=oe,Be=l,Fe=X,He=a,ze=Oe,Ue=i,Ve=["TD","TH","LI","BLOCKQUOTE"];function We(e,t,n){this.rootNode=e,this.startNode=t,this.endNode=n}We.getBlockContext=function(e){for(var t=e;t&&!(0,Fe.default)(t);)t=t.parentNode;return t},We.prototype.collapseToSingleElement=function(){for(var e=We.getBlockContext(this.startNode),t=e?(0,Ae.default)(e,this.startNode,this.endNode,!0):[],n=We.getBlockContext(this.startNode);t[0]&&t[0]!=n&&t[0].parentNode!=this.rootNode&&Ve.indexOf((0,Be.default)(t[0].parentNode))<0;)t=[(0,Ue.splitBalancedNodeRange)(t)];return 1==t.length&&(0,Fe.default)(t[0])?t[0]:(0,ze.default)(t)},We.prototype.getStartNode=function(){return this.startNode},We.prototype.getEndNode=function(){return this.endNode},We.prototype.equals=function(e){return this.startNode==e.getStartNode()&&this.endNode==e.getEndNode()},We.prototype.isAfter=function(e){return(0,He.default)(this.getStartNode(),e.getEndNode())},We.prototype.contains=function(e){return(0,De.default)(this.startNode,e,!0)||(0,De.default)(this.endNode,e,!0)||(0,He.default)(e,this.startNode)&&(0,He.default)(this.endNode,e)},We.prototype.getTextContent=function(){var e=(0,je.default)(this.getStartNode(),this.getEndNode());return e?e.toString():""},c.default=We,Object.defineProperty(n,"__esModule",{value:!0});var Ke=z,qe=r,Ge=l,Ze=X,Ye=s,$e=c;function Xe(e,t,n){var r=e;if("BR"==(0,Ge.default)(r)&&n)return r;for(;r;){for(var o=e;e.parentNode&&!(o=n?e.nextSibling:e.previousSibling);)if((e=e.parentNode)==t)return r;for(;o;){if((0,Ze.default)(o))return r;if("BR"==(0,Ge.default)(o))return n?o:r;e=o,o=n?e.firstChild:e.lastChild}r=e}return r}n.default=function(e,t){if(!(0,qe.default)(e,t))return null;var n=$e.default.getBlockContext(t);if(!n)return null;if(n==t)return new Ye.default(n);var r=Xe(t,n,!1),o=Xe(t,n,!0),t=(0,Ke.default)(e,r,o,!1),r=t[0],o=t[t.length-1];if(r.parentNode!=o.parentNode)return new $e.default(e,r,o);for(;!r.previousSibling&&!o.nextSibling;){var i=r.parentNode;if(i==n){n!=e&&(r=o=i);break}if(!i||i==e)break;r=o=i}return r==o&&(0,Ze.default)(r)?new Ye.default(r):new $e.default(e,r,o)};var f={},Qe=(Object.defineProperty(f,"__esModule",{value:!0}),n),c=(f.default=function(e,t){for(var n=e;(n=n&&(t?n.firstChild:n.lastChild))&&n.firstChild;);return n&&(0,Qe.default)(e,n)||null},{}),Je={},h={},et={},tt={},nt={},rt={},p=(Object.defineProperty(rt,"__esModule",{value:!0}),rt.default=function(e,t,n){var r=(null==(r=e.nodeValue)?void 0:r.substring(0,t))||"",o=(null==(o=e.nodeValue)?void 0:o.substring(t))||"",t=e.ownerDocument.createTextNode(n?r:o);return e.nodeValue=n?o:r,null!=(o=e.parentNode)&&o.insertBefore(t,n?e:e.nextSibling),t},{}),g={},ot={},it=(Object.defineProperty(ot,"__esModule",{value:!0}),ot.getComputedStyle=void 0,se);function at(e,t){void 0===t&&(t=["font-family","font-size","color","background-color"]);var e=(0,it.default)(e),n=[];if(t=Array.isArray(t)?t:[t],e){var r=(e.ownerDocument.defaultView||window).getComputedStyle(e);if(r)for(var o=0,i=t;o<i.length;o++){var a=i[o],l=r.getPropertyValue(a)||"",l="font-family"!=a?l.toLowerCase():l;l="font-size"==a?(a=l)&&a.indexOf("px")==a.length-2?Math.round(75*parseFloat(a)+.05)/100+"pt":a:l,n.push(l)}}return n}ot.default=at,ot.getComputedStyle=function(e,t){return at(e,t)[0]||""},Object.defineProperty(g,"__esModule",{value:!0});var lt=l,st=ot,ct=/^[\r\n]+$/gm,dt=/[\t\r\n\u0020\u200B]/gm,ut=(g.default=function e(t,n){if(3==t.nodeType)return!(t.nodeValue&&""!=t.textContent&&!ct.test(t.nodeValue)&&(!n||""!=t.nodeValue.replace(dt,"")));if(1!=t.nodeType)return!0;if("none"==(0,st.getComputedStyle)(t,"display"))return!0;var r=(0,lt.default)(t);if("DIV"!=r&&"SPAN"!=r)return!1;for(var o=t.firstChild;o;o=o.nextSibling)if(!e(o,n))return!1;return!0},Object.defineProperty(p,"__esModule",{value:!0}),p.getPreviousLeafSibling=p.getNextLeafSibling=p.getLeafSibling=void 0,r),ft=l,ht=g;function pt(e,t,n,r,o){var i=null,a=n?function(e){return(null==e?void 0:e.nextSibling)||null}:function(e){return(null==e?void 0:e.previousSibling)||null},l=n?function(e){return e.firstChild}:function(e){return e.lastChild};if((0,ut.default)(e,t))for(var s=t,c=!0;c;){for(var d=(null==s?void 0:s.parentNode)||null,s=a(s);!s&&d!=e;)s=a(d),d=(null==d?void 0:d.parentNode)||null;for(;s&&(!r||r.indexOf((0,ft.default)(s))<0)&&l(s);)s=l(s);if(!(c=!!s&&(0,ht.default)(s,o))){i=s;break}}return i}p.getLeafSibling=pt,p.getNextLeafSibling=function(e,t,n){return pt(e,t,!0,n)},p.getPreviousLeafSibling=function(e,t,n){return pt(e,t,!1,n)},Object.defineProperty(nt,"__esModule",{value:!0});var gt=l,mt=d,vt=rt,yt=Oe,bt=p,Et=i,Ct="SPAN,B,I,U,EM,STRONG,STRIKE,S,SMALL".split(",");function wt(e,t){e&&1==e.nodeType&&t(e,!0)}nt.default=function(e,t,n,r){void 0===n&&(n=new mt.default(e,0).normalize()),void 0===r&&(r=new mt.default(e,-1).normalize());for(var o,i=[],a=n,l=r;a&&l&&l.isAfter(a);){var s=a.node,c=(0,gt.default)(s.parentNode),d=(0,bt.getNextLeafSibling)(e,s);3==s.nodeType&&["TR","TABLE"].indexOf(c)<0&&(s!=l.node||l.isAtEnd||(s=(0,vt.default)(s,l.offset,!0)),0<a.offset&&(s=(0,vt.default)(s,a.offset,!1)),i.push(s)),a=d&&new mt.default(d,0)}0<i.length&&(i.every(function(e){return e.parentNode==i[0].parentNode})&&(o=i.shift(),i.forEach(function(e){var t=(o.nodeValue||"")+(e.nodeValue||"");o.nodeValue=t,null!=(t=e.parentNode)&&t.removeChild(e)}),i=[o]),i.forEach(function(e){for(;"SPAN"!=(0,gt.default)(e)&&0<=Ct.indexOf((0,gt.default)(e.parentNode));)wt(e,t),e=(0,Et.splitBalancedNodeRange)(e);"SPAN"!=(0,gt.default)(e)&&(wt(e,t),e=(0,yt.default)(e,"SPAN")),t(e)}))},Object.defineProperty(tt,"__esModule",{value:!0});var St=nt,Tt=a,Pt=d;function Ot(e,t){this.containerNode=e,this.parentBlock=t}Ot.prototype.getTextContent=function(){return(3==this.containerNode.nodeType?this.containerNode.nodeValue:this.containerNode.textContent)||""},Ot.prototype.getContainerNode=function(){return this.containerNode},Ot.prototype.getParentBlock=function(){return this.parentBlock},Ot.prototype.getStartPosition=function(){return new Pt.default(this.containerNode,0).normalize()},Ot.prototype.getEndPosition=function(){return new Pt.default(this.containerNode,-1).normalize()},Ot.prototype.isTextualInlineElement=function(){return this.containerNode&&3==this.containerNode.nodeType},Ot.prototype.isAfter=function(e){return e&&(0,Tt.default)(this.containerNode,e.getContainerNode())},Ot.prototype.contains=function(e){var t=this.getStartPosition(),n=this.getEndPosition();return e&&e.isAfter(t)&&n.isAfter(e)},Ot.prototype.applyStyle=function(e){(0,St.default)(this.containerNode,e)},tt.default=Ot;var xt,_t,Nt=e&&e.__extends||(xt=function(e,t){return(xt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}xt(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),Nt=(Object.defineProperty(et,"__esModule",{value:!0}),_t=tt.default,Nt(Rt,_t),Rt);function Rt(e,t){return _t.call(this,e,t)||this}et.default=Nt;var kt,Lt,Nt={},m=e&&e.__extends||(kt=function(e,t){return(kt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}kt(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),m=(Object.defineProperty(Nt,"__esModule",{value:!0}),Lt=tt.default,m(It,Lt),It);function It(e,t){return Lt.call(this,e,t)||this}Nt.default=m,Object.defineProperty(h,"__esModule",{value:!0});var Mt=n,At=l,Dt=et,jt=Nt,Bt=tt,Ft=o,m=(h.default=function(e,t){e=(0,Ft.default)(e,"Node")?(0,Mt.default)(e,t):e;return t&&e&&function(e,t){for(var n,r=[e],o=e.parentNode;o&&t.contains(o);o=o.parentNode)r.push(o);for(var i=r.length-1;0<=i&&!n;i--){var a=r[i],l=(0,At.default)(a);"A"==l?n=new jt.default(a,t):"IMG"==l&&(n=new Dt.default(a,t))}return n||new Bt.default(e,t)}(t,e)},{}),Ht={},zt=(Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.getLastLeafNode=Ht.getFirstLeafNode=void 0,g),Ut=p;function Vt(e,t){for(var n=function(e){return t?e.firstChild:e.lastChild},r=n(e);r&&n(r);)r=n(r);return r=r&&(0,zt.default)(r)?(0,Ut.getLeafSibling)(e,r,t):r}Ht.getFirstLeafNode=function(e){return Vt(e,!0)},Ht.getLastLeafNode=function(e){return Vt(e,!1)},Object.defineProperty(m,"__esModule",{value:!0}),m.getLastInlineElement=m.getFirstInlineElement=void 0;var Wt=h,Kt=Ht,qt=(m.getFirstInlineElement=function(e){var t=(0,Kt.getFirstLeafNode)(e);return t?(0,Wt.default)(e,t):null},m.getLastInlineElement=function(e){var t=(0,Kt.getLastLeafNode)(e);return t?(0,Wt.default)(e,t):null},Object.defineProperty(Je,"__esModule",{value:!0}),r),Gt=n,Zt=f,Yt=h,$t=m;function Xt(e,t){this.rootNode=e,this.startNode=(0,qt.default)(e,t)?t:null}Xt.prototype.getStartBlockElement=function(){return this.startNode?(0,Gt.default)(this.rootNode,this.startNode):(0,Zt.default)(this.rootNode,!0)},Xt.prototype.getStartInlineElement=function(){return this.startNode?(0,Yt.default)(this.rootNode,this.startNode):(0,$t.getFirstInlineElement)(this.rootNode)},Xt.prototype.isBlockInScope=function(e){return(0,qt.default)(this.rootNode,e.getStartNode())},Xt.prototype.trimInlineElement=function(e){return e},Je.default=Xt;var Qt={};function Jt(e,t){this.position=e,this.parentBlock=t}Object.defineProperty(Qt,"__esModule",{value:!0}),Jt.prototype.getTextContent=function(){return""},Jt.prototype.getContainerNode=function(){return this.position.node},Jt.prototype.getParentBlock=function(){return this.parentBlock},Jt.prototype.getStartPosition=function(){return this.position},Jt.prototype.getEndPosition=function(){return this.position},Jt.prototype.isAfter=function(e){return e&&this.position.isAfter(e.getEndPosition())},Jt.prototype.isTextualInlineElement=function(){return!1},Jt.prototype.contains=function(e){return!1},Jt.prototype.applyStyle=function(e){},Qt.default=Jt;var en={},tn=(Object.defineProperty(en,"__esModule",{value:!0}),nt),nn=oe,rn=d,on=p;function an(e,t,n){void 0===t&&(t=null),void 0===n&&(n=null),this.inlineElement=e,this.start=t,this.end=n}an.prototype.getDecoratedInline=function(){return this.inlineElement},an.prototype.getContainerNode=function(){return this.inlineElement.getContainerNode()},an.prototype.getParentBlock=function(){return this.inlineElement.getParentBlock()},an.prototype.getTextContent=function(){return(0,nn.default)(this.getStartPosition(),this.getEndPosition()).toString()},an.prototype.getStartPosition=function(){return this.start||this.inlineElement.getStartPosition()},an.prototype.getEndPosition=function(){return this.end||this.inlineElement.getEndPosition()},Object.defineProperty(an.prototype,"nextInlineElement",{get:function(){return this.end?new an(this.inlineElement,this.end):null},enumerable:!1,configurable:!0}),Object.defineProperty(an.prototype,"previousInlineElement",{get:function(){return this.start?new an(this.inlineElement,void 0,this.start):null},enumerable:!1,configurable:!0}),an.prototype.contains=function(e){return e&&e.isAfter(this.getStartPosition())&&this.getEndPosition().isAfter(e)},an.prototype.isTextualInlineElement=function(){return this.inlineElement&&this.inlineElement.isTextualInlineElement()},an.prototype.isAfter=function(e){var t=this.getStartPosition(),e=e&&e.getEndPosition();return e&&(t.isAfter(e)||t.equalTo(e))},an.prototype.applyStyle=function(e){var t,n=this.getStartPosition().normalize(),r=this.getEndPosition().normalize(),o=this.getContainerNode();n.isAtEnd&&(n=(t=(0,on.getNextLeafSibling)(o,n.node))?new rn.default(t,0):null),0==r.offset&&(r=(t=(0,on.getPreviousLeafSibling)(o,r.node))?new rn.default(t,-1):null),(0,tn.default)(o,e,n||void 0,r||void 0)},en.default=an;var ln={},v={},sn=(Object.defineProperty(v,"__esModule",{value:!0}),v.getInlineElementBeforeAfter=v.getInlineElementAfter=v.getInlineElementBefore=void 0,h),cn=en,dn=g,un=p;function fn(e,t,n){if(!e||!t||!t.node)return null;var r=(t=t.normalize()).offset,o=t.isAtEnd,i=t.node,a=!1,o=(!n&&0==r&&!o||n&&o?i=(0,un.getLeafSibling)(e,i,n):3==i.nodeType&&(!n&&!o||n&&0<r)&&(a=!0),i&&(0,dn.default)(i)&&(i=(0,un.getLeafSibling)(e,i,n)),(0,sn.default)(e,i));return o=o&&(a||o.contains(t))?n?new cn.default(o,t,void 0):new cn.default(o,void 0,t):o}v.getInlineElementBefore=function(e,t){return fn(e,t,!1)},v.getInlineElementAfter=function(e,t){return fn(e,t,!0)},v.getInlineElementBeforeAfter=fn,Object.defineProperty(ln,"__esModule",{value:!0});var hn=Qt,pn=n,gn=h,mn=s,vn=d,yn=o,bn=v,En=m;function Cn(e,t,n){this.rootNode=e,this.startFrom=n,t=(0,yn.default)(t,"Range")?vn.default.getStart(t):t,this.position=t.normalize(),this.block=(0,pn.default)(this.rootNode,this.position.node)}Cn.prototype.getStartBlockElement=function(){return this.block},Cn.prototype.getStartInlineElement=function(){if(this.block)switch(this.startFrom){case 0:case 1:case 2:return e=this.block,t=0==this.startFrom,e instanceof mn.default?(n=e.getStartNode(),(t?(0,En.getFirstInlineElement):(0,En.getLastInlineElement))(n)):(0,gn.default)(e,t?e.getStartNode():e.getEndNode());case 3:n=(0,bn.getInlineElementAfter)(this.rootNode,this.position);return n&&this.block.contains(n.getContainerNode())?n:new hn.default(this.position,this.block)}var e,t,n;return null},Cn.prototype.isBlockInScope=function(e){return!(!this.block||!e)&&this.block.equals(e)},Cn.prototype.trimInlineElement=function(e){return this.block&&e&&this.block.contains(e.getContainerNode())?e:null},ln.default=Cn;var s={},wn=(Object.defineProperty(s,"__esModule",{value:!0}),n),Sn=en,Tn=d,Pn=v;function On(e,t){this.rootNode=e,this.startBlock=null,this.startInline=null,this.start=Tn.default.getStart(t).normalize(),this.end=Tn.default.getEnd(t).normalize()}On.prototype.getStartBlockElement=function(){return this.startBlock||(this.startBlock=(0,wn.default)(this.rootNode,this.start.node)),this.startBlock},On.prototype.getStartInlineElement=function(){return this.startInline||(this.startInline=this.trimInlineElement((0,Pn.getInlineElementAfter)(this.rootNode,this.start))),this.startInline},On.prototype.isBlockInScope=function(e){if(!e)return!1;var t,n=this.getStartBlockElement();return this.start.equalTo(this.end)?!!n&&n.equals(e):(t=(0,wn.default)(this.rootNode,this.end.node),!!n&&!!t&&(e.equals(n)||e.equals(t)||e.isAfter(n)&&t.isAfter(e)))},On.prototype.trimInlineElement=function(e){if(!e||this.start.equalTo(this.end))return null;var t=e.getStartPosition(),n=e.getEndPosition();if(t.isAfter(this.end)||this.start.isAfter(n))return null;var r=!1,o=!1;return this.start.isAfter(t)&&(t=this.start,r=!0),n.isAfter(this.end)&&(n=this.end,o=!0),t.isAfter(n)||t.equalTo(n)?null:r||o?new Sn.default(e,r?t:void 0,o?n:void 0):e},s.default=On,Object.defineProperty(c,"__esModule",{value:!0});var xn=Je,_n=Qt,Nn=n,Rn=h,kn=en,Ln=ln,In=s,Mn=v,An=p;function Dn(e,t){this.scoper=e,this.skipTags=t,this.currentInline=null,this.currentBlock=null}Dn.createBodyTraverser=function(e,t,n){return new Dn(new xn.default(e,t))},Dn.createSelectionTraverser=function(e,t,n){return new Dn(new In.default(e,t),n)},Dn.createBlockTraverser=function(e,t,n,r){return new Dn(new Ln.default(e,t,n=void 0===n?3:n))},Object.defineProperty(Dn.prototype,"currentBlockElement",{get:function(){return this.currentBlock||(this.currentBlock=this.scoper.getStartBlockElement()),this.currentBlock},enumerable:!1,configurable:!0}),Dn.prototype.getNextBlockElement=function(){return this.getPreviousNextBlockElement(!0)},Dn.prototype.getPreviousBlockElement=function(){return this.getPreviousNextBlockElement(!1)},Dn.prototype.getPreviousNextBlockElement=function(e){var t=this.currentBlockElement;if(!t)return null;var n=(0,An.getLeafSibling)(this.scoper.rootNode,e?t.getEndNode():t.getStartNode(),e,this.skipTags),n=n?(0,Nn.default)(this.scoper.rootNode,n):null;return n&&this.scoper.isBlockInScope(n)&&(e&&n.isAfter(t)||!e&&t.isAfter(n))?(this.currentBlock=n,this.currentBlock):null},Object.defineProperty(Dn.prototype,"currentInlineElement",{get:function(){return this.currentInline||(this.currentInline=this.scoper.getStartInlineElement()),this.currentInline instanceof _n.default?null:this.currentInline},enumerable:!1,configurable:!0}),Dn.prototype.getNextInlineElement=function(){return this.getPreviousNextInlineElement(!0)},Dn.prototype.getPreviousInlineElement=function(){return this.getPreviousNextInlineElement(!1)},Dn.prototype.getPreviousNextInlineElement=function(e){var t,n=this.currentInlineElement||this.currentInline;return n?(n instanceof _n.default?(t=(0,Mn.getInlineElementBeforeAfter)(this.scoper.rootNode,n.getStartPosition(),e))&&!n.getParentBlock().contains(t.getContainerNode())&&(t=null):t=(t=function(e,t,n){if(!t)return null;if(t instanceof kn.default){var r=n?t.nextInlineElement:t.previousInlineElement;if(r)return r}r=t.getContainerNode(),r=(0,An.getLeafSibling)(e,r,n);return(0,Rn.default)(e,r)}(this.scoper.rootNode,n,e))&&n&&(e&&t.isAfter(n)||!e&&n.isAfter(t))?t:null,(t=t&&this.scoper.trimInlineElement(t))?(this.currentInline=t,this.currentInline):null):null},c.default=Dn;var m={},jn=(Object.defineProperty(m,"__esModule",{value:!0}),c),Bn=oe,Fn=/[\s\u00A0\u200B\u3000]+([^\s\u00A0\u200B\u3000]*)$/i;function Hn(e,t){this.rootNode=e,this.position=t,this.text="",this.word="",this.inlineBefore=null,this.inlineAfter=null,this.traverser=null,this.traversingComplete=!1,this.inlineElements=[],this.nearestNonTextInlineElement=null}Hn.prototype.getWordBefore=function(){var e=this;return this.word||this.traverse(function(){return e.word}),this.word||""},Hn.prototype.getInlineElementBefore=function(){return this.inlineBefore||this.traverse(null),this.inlineBefore},Hn.prototype.getInlineElementAfter=function(){return this.inlineAfter||(this.inlineAfter=jn.default.createBlockTraverser(this.rootNode,this.position).currentInlineElement),this.inlineAfter},Hn.prototype.getSubStringBefore=function(e){var t=this;return this.text.length<e&&this.traverse(function(){return t.text.length>=e}),this.text.substr(Math.max(0,this.text.length-e))},Hn.prototype.getRangeFromText=function(r,o){if(!r)return null;var i=null,a=null,l=r.length-1;return this.forEachTextInlineElement(function(e){for(var t=e.getTextContent()||"",n=t.length-1;0<=n&&0<=l;n--)if(r.charCodeAt(l)==t.charCodeAt(n))l--,a=a||e.getStartPosition().move(n+1);else if(o||a)return!0;return-1==l&&(i=e.getStartPosition().move(n+1),!0)}),i&&a&&(0,Bn.default)(i,a)},Hn.prototype.forEachTextInlineElement=function(e){this.inlineElements.some(e)||this.traverse(e)},Hn.prototype.getNearestNonTextInlineElement=function(){var e=this;return this.nearestNonTextInlineElement||this.traverse(function(){return e.nearestNonTextInlineElement}),this.nearestNonTextInlineElement},Hn.prototype.traverse=function(e){if(this.traverser=this.traverser||jn.default.createBlockTraverser(this.rootNode,this.position),this.traverser&&!this.traversingComplete)for(var t=this.traverser.getPreviousInlineElement();!this.traversingComplete;){if(this.inlineBefore=this.inlineBefore||t,!t||!t.isTextualInlineElement()){this.nearestNonTextInlineElement=t,this.traversingComplete=!0,this.word||(this.word=this.text);break}var n,r=t.getTextContent();if(this.word||(n=Fn.exec(r))&&2==n.length&&(this.word=n[1]+this.text),this.text=r+this.text,this.inlineElements.push(t),e&&e(t))break;t=this.traverser.getPreviousInlineElement()}},m.default=Hn;Je={},Qt={},ln={};Object.defineProperty(ln,"__esModule",{value:!0}),ln.default=function(e,t){var n;e&&((n=new FileReader).onload=function(){t(n.result)},n.onerror=function(){t(null)},n.readAsDataURL(e))};var zn=e&&e.__assign||function(){return(zn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Un=(Object.defineProperty(Qt,"__esModule",{value:!0}),ln),Vn=xe,Wn=/^Version:[0-9\.]+\s+StartHTML:\s*([0-9]+)\s+EndHTML:\s*([0-9]+)\s+/i,Kn=((s={})["text/html"]=function(e,t){return e.rawHtml=Vn.Browser.isEdge?(e=t,3==(null==(r=Wn.exec(e))?void 0:r.length)&&(n=parseInt(r[1]),r=parseInt(r[2]),0<n&&n<r&&(e=e.substring(n,r))),e):t;var n,r},s["text/plain"]=function(e,t){return e.text=t},s["text/*"]=function(e,t,n){return!!n&&(e.customValues[n]=t)},s);function qn(e,t){try{e.customValues["link-preview"]=t,e.linkPreview=JSON.parse(t)}catch(e){}}Qt.default=function(e,t){var a={types:[],text:"",image:null,files:[],rawHtml:null,customValues:{}},l=zn({},Kn);return null!=t&&t.allowLinkPreview&&(l["text/link-preview"]=qn),Promise.all((e||[]).map(function(n){var r=n.type;if(0!=r.indexOf("image/")||a.image||"file"!=n.kind){if("file"==n.kind)return new Promise(function(e){var t=n.getAsFile();t&&(a.types.push(r),a.files.push(t)),e()});var o=function(e,t){e=0==e.indexOf("text/")?e.substring("text/".length):null,t=t&&e?t.indexOf(e):-1;return e&&0<=t?e:void 0}(r,null==t?void 0:t.allowedCustomPasteType),i=l[r]||(o?l["text/*"]:null);return new Promise(function(t){return i?n.getAsString(function(e){a.types.push(r),i(a,e,o),t()}):t()})}return a.types.push(r),a.image=n.getAsFile(),new Promise(function(t){a.image?(0,Un.default)(a.image,function(e){a.imageDataUri=e,t()}):t()})})).then(function(){return a})};var v={},Gn=(Object.defineProperty(v,"__esModule",{value:!0}),ln),Zn=q,Yn=(v.default=function(e,t,n){for(var r,o,i={types:e.types?(0,Zn.default)(e.types):[],text:e.getData("text"),image:null,files:[],rawHtml:null,customValues:{}},a=0;a<(e.files?e.files.length:0);a++){var l=e.files.item(a);if(0==(null==(r=null==l?void 0:l.type)?void 0:r.indexOf("image/"))){i.image=l;break}}function s(){i.image?(0,Gn.default)(i.image,function(e){i.imageDataUri=e,t(i)}):t(i)}var c;null!=n&&n.getTempDiv&&null!=n&&n.removeTempDiv?((c=n.getTempDiv()).contentEditable="true",c.innerHTML="",c.focus(),null!=(o=null==(o=c.ownerDocument)?void 0:o.defaultView)&&o.setTimeout(function(){var e;i.rawHtml=c.innerHTML,null!=(e=n.removeTempDiv)&&e.call(n,c),s()},0)):(i.rawHtml=void 0,s())},Object.defineProperty(Je,"__esModule",{value:!0}),Qt),$n=v,Xn=q,s=(Je.default=function(e,t,n){var r=e.clipboardData||(null==(r=e.target.ownerDocument)?void 0:r.defaultView).clipboardData;r.items?(e.preventDefault(),(0,Yn.default)((0,Xn.default)(r.items),n).then(t)):(0,$n.default)(r,t,n)},{}),Qn=(Object.defineProperty(s,"__esModule",{value:!0}),s.default=function(e,t){Array.prototype.push.apply(e,t)},{}),Jn={};Object.defineProperty(Jn,"__esModule",{value:!0});var er="#ffffff";Jn.default=function e(t,n,r,o,i){var a="string"==typeof n?n.trim():"",n="string"==typeof n?null:n;if((a||n)&&(t.style.setProperty(r?"background-color":"color",(o?null==n?void 0:n.darkModeColor:null==n?void 0:n.lightModeColor)||a),t.dataset&&(a=r?"ogsb":"ogsc",o?n&&(t.dataset[a]=n.lightModeColor):delete t.dataset[a]),r&&i)){var l=t,s=o;if(null==(n=l.firstElementChild)||!n.hasAttribute("style")){var c,d,u,n=l.style.getPropertyValue("background-color"),n=s&&(l.dataset.ogsb||l.dataset.ogab)||n;if(n&&"transparent"!==n)switch(n="#"==n.substring(0,1)?(u=(c=function(e){return e=(e=4===e.length?e.replace(/(.)/g,"$1$1"):e).replace("#",""),[parseInt(e.substr(0,2),16),parseInt(e.substr(2,2),16),parseInt(e.substr(4,2),16)]}(n))[0],d=c[1],c[2]):(c=n.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/),u=(n=[parseInt(c[1]),parseInt(c[2]),parseInt(c[3])])[0],d=n[1],n[2]),u/=255,d/=255,n/=255,(u=50*(Math.max(u,d,n)+Math.min(u,d,n)))<20?1:80<u?0:2){case 1:e(l,{lightModeColor:er,darkModeColor:"#333333"},!1,s);break;case 0:e(l,{lightModeColor:"#000000",darkModeColor:er},!1,s)}}}},Object.defineProperty(Qn,"__esModule",{value:!0});var tr,nr=Jn,rr=(Qn.default=function(e,t,n){var r,o,i,a,l,s,c,d,u;t&&(r=e.style,o=t.fontFamily,i=t.fontSize,a=t.textColor,l=t.textColors,s=t.backgroundColor,c=t.backgroundColors,d=t.bold,u=t.italic,t=t.underline,o&&(r.fontFamily=o),i&&(r.fontSize=i),l?(0,nr.default)(e,l,!1,n):a&&(0,nr.default)(e,a,!1,n),c?(0,nr.default)(e,c,!0,n):s&&(0,nr.default)(e,s,!0,n),d&&(r.fontWeight="bold"),u&&(r.fontStyle="italic"),t&&(r.textDecoration="underline"))},{}),or={},ir=(Object.defineProperty(or,"__esModule",{value:!0}),or.default=function(e,t,n){if(e){for(;!n&&e.firstChild;)e.removeChild(e.firstChild);for(;null!=t&&t.firstChild;)e.appendChild(t.firstChild)}},Object.defineProperty(rr,"__esModule",{value:!0}),ot),ar=l,lr=or,sr=(rr.default=function(e,t){if(!e||!t)return null;var n=(0,ar.default)(e);if(n==t.toUpperCase())return e;for(var r=e.ownerDocument.createElement(t),o=0;o<e.attributes.length;o++){var i=e.attributes[o];r.setAttribute(i.name,i.value)}return(0,lr.default)(r,e),"P"!=n&&"P"!=(0,ar.default)(r)||(t=(0,ir.default)(e,["margin-top","margin-bottom"]),r.style.marginTop=t[0],r.style.marginBottom=t[1]),e.parentNode&&e.parentNode.replaceChild(r,e),r},{}),cr=(tr=sr,Object.defineProperty(tr,"__esModule",{value:!0}),tr.PendableFormatCommandMap=void 0,tr.PendableFormatCommandMap={isBold:"bold",isItalic:"italic",isUnderline:"underline",isStrikeThrough:"strikeThrough",isSubscript:"subscript",isSuperscript:"superscript"},tr.default=function(n){return Object.keys(tr.PendableFormatCommandMap).reduce(function(e,t){return e[t]=n.queryCommandState(tr.PendableFormatCommandMap[t]),e},{})},{}),dr=(Object.defineProperty(cr,"__esModule",{value:!0}),l),ur=["IMG"],fr=["TABLE","IMG","LI"].join(","),hr=/\u200b/g;function pr(e,t){return e=e.replace(hr,""),t?e.trim():e}cr.default=function(e,t){if(!e)return!1;if(3==e.nodeType)return""==pr(e.nodeValue||"",t);if(1==e.nodeType)if(""!=pr(e.textContent||"",t)||0<=ur.indexOf((0,dr.default)(e))||e.querySelectorAll(fr)[0])return!1;return!0};var gr={},mr=(Object.defineProperty(gr,"__esModule",{value:!0}),/^[^?]+%[^0-9a-f]+|^[^?]+%[0-9a-f][^0-9a-f]+|^[^?]+%00|^[^?]+%$|^https?:\/\/[^?\/]+@|^www\.[^?\/]+@/i),y="(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)*[a-z0-9](?:[a-z0-9-]*[a-z0-9])?(?:\\:[0-9]+)?(?:[\\/\\?]\\S*)?",vr={http:{match:new RegExp("^(?:microsoft-edge:)?http:\\/\\/"+y+"|www\\."+y,"i"),except:mr,normalizeUrl:function(e){return new RegExp("^(?:microsoft-edge:)?http:\\/\\/","i").test(e)?e:"http://"+e}},https:{match:new RegExp("^(?:microsoft-edge:)?https:\\/\\/"+y,"i"),except:mr},mailto:{match:new RegExp("^mailto:\\S+@\\S+\\.\\S+","i")},notes:{match:new RegExp("^notes:\\/\\/\\S+","i")},file:{match:new RegExp("^file:\\/\\/\\/?\\S+","i")},unc:{match:new RegExp("^\\\\\\\\\\S+","i")},ftp:{match:new RegExp("^ftp:\\/\\/"+y+"|ftp\\."+y,"i"),normalizeUrl:function(e){return new RegExp("^ftp:\\/\\/","i").test(e)?e:"ftp://"+e}},news:{match:new RegExp("^news:(\\/\\/)?"+y,"i")},telnet:{match:new RegExp("^telnet:(\\/\\/)?"+y,"i")},gopher:{match:new RegExp("^gopher:\\/\\/"+y,"i")},wais:{match:new RegExp("^wais:(\\/\\/)?"+y,"i")}},mr=(gr.default=function(e){if(e)for(var t=0,n=Object.keys(vr);t<n.length;t++){var r=n[t],o=vr[r],i=e.match(o.match);if(i&&i[0]==e&&(!o.except||!o.except.test(e)))return{scheme:r,originalUrl:e,normalizedUrl:o.normalizeUrl?o.normalizeUrl(e):e}}return null},{}),yr=(Object.defineProperty(mr,"__esModule",{value:!0}),q);function br(t,e){return e.some(function(e){return 0==e?0==t:(t&e)==e})}mr.default=function(e,t,n,o,r){if(void 0===o&&(o=0),!e||!t)return[];var i,a,e=(0,yr.default)(e.querySelectorAll(t));return 0!=o&&r&&(a=r.startContainer,t=r.startOffset,i=r.endContainer,r=r.endOffset,1==a.nodeType&&a.firstChild&&(a=a.childNodes[t]||a.lastChild),i=1==i.nodeType&&i.firstChild&&0<r?i.childNodes[r-1]:i,e=e.filter(function(e){var t=a,n=i,r=2==o;return t=e.compareDocumentPosition(t),e=e.compareDocumentPosition(n),n=[0,8],r||n.push(16),br(t,n)||br(e,n)||br(t,[2])&&br(e,[4])&&!br(e,[16])})),n&&e.forEach(n),e};var y={},Er=(Object.defineProperty(y,"__esModule",{value:!0}),y.default=function(e){var t=e?e.parentNode:null;if(!t)return null;for(;e.firstChild;)t.insertBefore(e.firstChild,e);return t.removeChild(e),t},{}),Cr=(Object.defineProperty(Er,"__esModule",{value:!0}),Er.default=function(e){var e=e||{left:0,right:0,top:0,bottom:0},t=e.left,n=e.right,r=e.top,e=e.bottom;return 0<t+n+r+e?{left:Math.round(t),right:Math.round(n),top:Math.round(r),bottom:Math.round(e)}:null},{}),wr=(Object.defineProperty(Cr,"__esModule",{value:!0}),o),Sr=(Cr.default=function(e){return(0,wr.default)(e,"HTMLElement")?e.innerHTML:e?((t=e.ownerDocument.createElement("span")).appendChild(e.cloneNode(!0)),t.innerHTML):"";var t},{}),Tr={},Pr=(Object.defineProperty(Tr,"__esModule",{value:!0}),rr),Or=Jn,b="transparent";function xr(e){return e.td&&e.td.dataset.cellShade}function _r(e){return"solid 1px "+(e||"transparent")}Tr.default=function(e,t,n){var r,o,i,a,l,s,c,d,u,f,h;function p(e){return e%2==0?a.bgColorEven:a.bgColorOdd}n&&(e.style.borderCollapse="collapse",h=n,(f=t).forEach(function(s,c){s.forEach(function(e,t){if(e.td){var n=h,r=e.td,o=0===c,i=c===f.length-1,a=0===t,l=t===s.length-1;switch(e=n,(t=r).style.borderTop=_r(e.topBorderColor),t.style.borderLeft=_r(e.verticalBorderColor),t.style.borderRight=_r(e.verticalBorderColor),t.style.borderBottom=_r(e.bottomBorderColor),n.tableBorderFormat){case 0:return;case 1:a||(r.style.borderLeftColor=b),l||(r.style.borderRightColor=b);break;case 4:o||(r.style.borderTopColor=b),i||o||(r.style.borderBottomColor=b),a||(r.style.borderLeftColor=b),l||a||(r.style.borderRightColor=b),a&&o&&(r.style.borderRightColor=b);break;case 2:o&&(r.style.borderTopColor=b,r.style.borderRightColor=b,r.style.borderLeftColor=b),a&&(r.style.borderLeftColor=b),l&&(r.style.borderRightColor=b);break;case 3:a&&(r.style.borderLeftColor=b),l&&(r.style.borderRightColor=b);break;case 5:o&&(r.style.borderRightColor=b,r.style.borderLeftColor=b),a&&(r.style.borderBottomColor=b,r.style.borderTopColor=b),o&&a&&(r.style.borderLeftColor=n.verticalBorderColor||b,r.style.borderBottomColor=n.bottomBorderColor||b,r.style.borderTopColor=n.topBorderColor||b);break;case 6:o&&(r.style.borderRightColor=b,r.style.borderLeftColor=b),a&&(r.style.borderBottomColor=b,r.style.borderTopColor=b),o&&a&&(r.style.borderLeftColor=n.verticalBorderColor||b,r.style.borderBottomColor=n.bottomBorderColor||b,r.style.borderTopColor=n.topBorderColor||b),o||a||(r.style.borderLeftColor=b,r.style.borderBottomColor=b,r.style.borderTopColor=b,r.style.borderRightColor=b);break;case 7:o&&(r.style.borderLeftColor=b,r.style.borderTopColor=b,r.style.borderRightColor=b),a&&(r.style.borderLeftColor=b,r.style.borderTopColor=b,r.style.borderBottomColor=b),o||a||(r.style.borderLeftColor=b,r.style.borderBottomColor=b,r.style.borderTopColor=b,r.style.borderRightColor=b),o&&a&&(r.style.borderBottomColor=n.bottomBorderColor||b)}}})}),e=t,l=(a=n).hasBandedRows,s=a.hasBandedColumns,c=a.bgColorOdd,d=a.bgColorEven,u=!l&&c===d,e.forEach(function(e,n){e.forEach(function(e){var t;e.td&&!xr(e)&&(l?(t=p(n),(0,Or.default)(e.td,t||b,!0,void 0,!0)):u?(0,Or.default)(e.td,a.bgColorOdd||b,!0,void 0,!0):(0,Or.default)(e.td,b,!0,void 0,!0))})}),s&&e.forEach(function(e){e.forEach(function(e,t){t=p(t);e.td&&t&&!xr(e)&&(0,Or.default)(e.td,t,!0,void 0,!0)})}),i=t,n.hasFirstColumn?i.forEach(function(e,n){e.forEach(function(e,t){e.td&&0===t&&(0===n||xr(e)||(e.td.style.borderTopColor=b,(0,Or.default)(e.td,b,!0,void 0,!0)),n!==i.length-1&&0!==n&&(e.td.style.borderBottomColor=b),e.td=(0,Pr.default)(e.td,"TH"),e.td.scope="col")})}):i.forEach(function(e){e.forEach(function(e,t){e.td&&0===t&&(e.td=(0,Pr.default)(e.td,"TD"),e.td.scope="")})}),c=t,(r=n).hasHeaderRow?null!=(o=c[0])&&o.forEach(function(e){e.td&&r.headerRowColor&&(xr(e)||(0,Or.default)(e.td,r.headerRowColor,!0,void 0,!0),e.td.style.borderRightColor=r.headerRowColor,e.td.style.borderLeftColor=r.headerRowColor,e.td.style.borderTopColor=r.headerRowColor,e.td=(0,Pr.default)(e.td,"TH"),e.td.scope="row")}):null!=(o=c[0])&&o.forEach(function(e){e.td&&(e.td=(0,Pr.default)(e.td,"TD"),e.td.scope="")}))};var Nr={},Rr=(Object.defineProperty(Nr,"__esModule",{value:!0}),Nr.saveTableInfo=Nr.getTableFormatInfo=void 0,Nr.getTableFormatInfo=function(e){e=function(e){if(!e)return null;try{return JSON.parse(e)}catch(e){return null}}(null==e?void 0:e.dataset.roosterTableInfo);return function(e){var t,n,r,o,i,a,l,s,c;if(e)return t=e.topBorderColor,n=e.verticalBorderColor,r=e.bottomBorderColor,o=e.bgColorOdd,i=e.bgColorEven,c=e.hasBandedColumns,a=e.hasBandedRows,l=e.hasFirstColumn,s=e.hasHeaderRow,e=e.tableBorderFormat,c=[c,a,l,s],![t,n,r,o,i].some(function(e){return!(null==e||"string"==typeof e)})&&!c.some(function(e){return!("boolean"==typeof e)})&&-1<e&&e<8?1:void 0}(e)?e:null},Nr.saveTableInfo=function(e,t){e&&t&&(e.dataset.roosterTableInfo=JSON.stringify(t))},e&&e.__assign||function(){return(Rr=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)}),kr=(Object.defineProperty(Sr,"__esModule",{value:!0}),Tr),Lr=or,Ir=Er,Mr=o,Ar=q,Dr=Nr,jr={topBorderColor:"#ABABAB",bottomBorderColor:"#ABABAB",verticalBorderColor:"#ABABAB",hasHeaderRow:!1,hasFirstColumn:!1,hasBandedRows:!1,hasBandedColumns:!1,bgColorEven:null,bgColorOdd:"#ABABAB20",headerRowColor:"#ABABAB",tableBorderFormat:0,keepCellShade:!1};function E(t,e,n){var d,r,u=this;this.cells=null,this.selection=null,this.formatInfo=null,this.trs=[],this.table=(0,Mr.default)(t,"HTMLTableElement")?t:function(){for(var e=t;e&&"TABLE"!=e.tagName;e=e.parentElement);return e}(),this.table&&(d=(0,Mr.default)(t,"HTMLTableElement")?null:t,r=(0,Ar.default)(this.table.rows),this.cells=r.map(function(e){return[]}),r.forEach(function(e,t){var n;u.trs[t%2]=e;for(var r=0,o=0;r<e.cells.length;r++){for(;u.cells[t][o];o++);var i=e.cells[r];i==d&&(u.col=o,u.row=t);for(var a=0;a<i.colSpan;a++,o++)for(var l=0;l<i.rowSpan;l++){var s=a+l==0,c=i.getBoundingClientRect();null!=(n=u.cells)&&n[t+l]&&(u.cells[t+l][o]={td:s?i:null,spanLeft:0<a,spanAbove:0<l,width:s?c.width:void 0,height:s?c.height:void 0})}}}),this.formatInfo=(0,Dr.getTableFormatInfo)(this.table),e&&this.normalizeSize("number"==typeof n?function(e){return e/n}:n))}function Br(e,t,n){e&&(e.removeAttribute("width"),e.removeAttribute("height"),e.style.boxSizing="border-box",e.style.width=t+"px",e.style.height=n+"px")}function Fr(e){return{td:Hr(e.td),spanAbove:e.spanAbove,spanLeft:e.spanLeft}}function Hr(e){var t=e?e.cloneNode(!1):null;return(0,Mr.default)(t,"HTMLTableCellElement")&&(t.removeAttribute("id"),t.firstChild||t.appendChild(e.ownerDocument.createElement("br"))),t}E.prototype.writeBack=function(e){var o=this;this.cells?((0,Lr.default)(this.table),this.cells.forEach(function(e,n){var r=Hr(o.trs[n%2]||o.trs[0]);r&&(o.table.appendChild(r),e.forEach(function(e,t){e.td&&(o.recalculateSpans(n,t),r.appendChild(e.td))}))}),this.formatInfo&&!e&&((0,Dr.saveTableInfo)(this.table,this.formatInfo),(0,kr.default)(this.table,this.cells,this.formatInfo))):this.table&&null!=(e=this.table.parentNode)&&e.removeChild(this.table)},E.prototype.applyFormat=function(e){this.table&&(this.formatInfo=Rr(Rr(Rr({},jr),this.formatInfo||{}),e||{}),this.formatInfo.keepCellShade||this.deleteCellShadeDataset(this.cells))},E.prototype.deleteCellShadeDataset=function(e){null!=e&&e.forEach(function(e){e.forEach(function(e){e.td&&e.td.dataset.cellShade&&delete e.td.dataset.cellShade})})},E.prototype.edit=function(e){var a=this;if(this.table&&this.cells&&void 0!==this.row&&null!=this.col){var n=this.cells[this.row],t=n[this.col],r=this.selection?this.selection.firstCell.y:this.row,o=this.selection?this.selection.lastCell.y:this.row,i=this.selection?this.selection.firstCell.x:this.col,l=this.selection?this.selection.lastCell.x:this.col;switch(e){case 0:for(var s=r;s<=o;s++)this.cells.splice(r,0,n.map(Fr));break;case 1:for(var c=this,s=r;s<=o;s++)!function(){var r=o+c.countSpanAbove(o,c.col);c.cells.splice(r,0,c.cells[r-1].map(function(e,t){var n=a.getCell(r,t);return n.spanAbove?Fr(n):e.spanLeft?((n=Fr(e)).spanAbove=!1,n):{td:Hr(a.getTd(a.row,t))}}))}();break;case 2:var d=this;for(s=i;s<=l;s++)!function(n){d.forEachCellOfCurrentColumn(function(e,t){t.splice(n,0,Fr(e))})}(s);break;case 3:var u=this;for(s=i;s<=l;s++)!function(){var i=l+u.countSpanLeft(u.row,l);u.forEachCellOfColumn(i-1,function(e,t,n){var r,o=a.getCell(n,i);o.spanLeft?r=Fr(o):e.spanAbove?(r=Fr(e)).spanLeft=!1:r={td:Hr(a.getTd(n,a.col))},t.splice(i,0,r)})}();break;case 6:for(var f=this,h=r;h<=o;h++)!function(n){f.forEachCellOfRow(n,function(e,t){t=a.getCell(n+1,t);e.td&&1<e.td.rowSpan&&t.spanAbove&&(t.td=e.td)})}(h);var p=this.selection?this.selection.lastCell.y-this.selection.firstCell.y:0;this.cells.splice(r,1+p);break;case 5:for(var g=0,m=this,v=i;v<=l;v++)!function(r){m.forEachCellOfColumn(r,function(e,t,n){n=a.getCell(n,r+1),e.td&&1<e.td.colSpan&&n.spanLeft&&(n.td=e.td),n=a.selection?r-g:a.col;t.splice(n,1)}),g++}(v);break;case 7:case 8:for(var y=7==e?-1:1,h=this.row+y;0<=h&&h<this.cells.length;h+=y)if((T=this.getCell(h,this.col)).td&&!T.spanAbove){var b=h<this.row?T:t,E=h<this.row?t:T;this.mergeCells(b,E);break}break;case 9:case 10:for(var C=9==e?-1:1,v=this.col+C;0<=v&&v<this.cells[this.row].length;v+=C)if((T=this.getCell(this.row,v)).td&&!T.spanLeft){var w=v<this.col?T:t,S=v<this.col?t:T;this.mergeCells(w,S,!0);break}break;case 11:for(v=i;v<=l;v++)for(h=r+1;h<=o;h++){var T=this.getCell(r,v),P=this.getCell(h,v);this.mergeCells(T,P)}for(v=i+1;v<=l;v++){var T=this.getCell(r,i),O=this.getCell(r,v);this.mergeCells(T,O,!0)}break;case 4:this.cells=null;break;case 13:t.td&&1<t.td.rowSpan?this.getCell(this.row+1,this.col).td=Hr(t.td):(p=n.map(function(e){return{td:e==t?Hr(e.td):null,spanAbove:e!=t,spanLeft:e.spanLeft}}),this.cells.splice(this.row+1,0,p));break;case 12:t.td&&1<t.td.colSpan?this.getCell(this.row,this.col+1).td=Hr(t.td):this.forEachCellOfCurrentColumn(function(e,t){t.splice(a.col+1,0,{td:t==n?Hr(e.td):null,spanAbove:e.spanAbove,spanLeft:t!=n})});break;case 14:this.table.style.marginLeft="auto",this.table.style.marginRight="auto";break;case 15:this.table.style.marginLeft="",this.table.style.marginRight="auto";break;case 16:this.table.style.marginLeft="auto",this.table.style.marginRight="";break;case 18:this.setAlignmentToSelectedCells(r,o,i,l,"center");break;case 17:this.setAlignmentToSelectedCells(r,o,i,l,"left");break;case 19:this.setAlignmentToSelectedCells(r,o,i,l,"right");break;case 20:this.setAlignmentToSelectedCells(r,o,i,l,"top",!0);break;case 21:this.setAlignmentToSelectedCells(r,o,i,l,"middle",!0);break;case 22:this.setAlignmentToSelectedCells(r,o,i,l,"bottom",!0)}}},E.prototype.setAlignmentToSelectedCells=function(e,t,n,r,o,i){for(var a,l,s=e;s<=t;s++)for(var c=n;c<=r;c++)this.cells&&(l=this.cells[s][c].td,i&&l?null!=(a=l.style)&&a.setProperty("vertical-align",o):l&&null!=(a=l.style)&&a.setProperty("text-align",o))},E.prototype.mergeCells=function(e,t,n){var r=n?(null==(r=e.td)?void 0:r.rowSpan)===(null==(r=t.td)?void 0:r.rowSpan)&&!e.spanLeft:(null==(r=e.td)?void 0:r.colSpan)===(null==(r=t.td)?void 0:r.colSpan)&&!e.spanAbove;e.td&&t.td&&r&&((0,Lr.default)(e.td,t.td,!0),t.td=null,n?t.spanLeft=!0:t.spanAbove=!0)},E.prototype.forEachCellOfCurrentColumn=function(e){this.forEachCellOfColumn(this.col,e)},E.prototype.getCellsWithBorder=function(e,t){for(var n=[],r=0;this.cells&&r<this.cells.length;r++)for(var o=0;o<this.cells[r].length;o++){var i=this.getCell(r,o);if(i.td){var a=(0,Ir.default)(i.td.getBoundingClientRect());if(a){var l=!1;if(t){if(a.right==e)l=!0,n.push(i.td);else if(l)break}else if(a.left==e)l=!0,n.push(i.td);else if(l)break}}}return n},E.prototype.forEachCellOfCurrentRow=function(e){this.forEachCellOfRow(this.row,e)},E.prototype.getCell=function(e,t){return this.cells&&this.cells[e]&&this.cells[e][t]||{}},E.prototype.getCurrentTd=function(){return this.getTd(this.row,this.col)},E.prototype.getTd=function(e,t){if(this.cells&&void 0!==e&&void 0!==t&&(e=Math.min(this.cells.length-1,e),t=this.cells[e]?Math.min(this.cells[e].length-1,t):t,!isNaN(e)&&!isNaN(t)))for(;0<=e&&0<=t;){var n=this.getCell(e,t);if(n.td)return n.td;if(n.spanLeft)t--;else{if(!n.spanAbove)break;e--}}return null},E.prototype.forEachCellOfColumn=function(e,t){if(void 0!==e)for(var n=0;this.cells&&n<this.cells.length;n++)t(this.getCell(n,e),this.cells[n],n)},E.prototype.forEachCellOfRow=function(e,t){if(void 0!==e)for(var n=0;this.cells&&n<this.cells[e].length;n++)t(this.getCell(e,n),n)},E.prototype.recalculateSpans=function(e,t){var n=this.getCell(e,t).td;n&&(n.colSpan=this.countSpanLeft(e,t),n.rowSpan=this.countSpanAbove(e,t),1==n.colSpan&&n.removeAttribute("colSpan"),1==n.rowSpan&&n.removeAttribute("rowSpan"))},E.prototype.countSpanLeft=function(e,t){for(var n=1,r=t+1;this.cells&&r<this.cells[e].length;r++){var o=this.getCell(e,r);if(o.td||!o.spanLeft)break;n++}return n},E.prototype.countSpanAbove=function(e,t){for(var n=1,r=e+1;this.cells&&r<this.cells.length;r++){var o=this.getCell(r,t);if(o.td||!o.spanAbove)break;n++}return n},E.prototype.normalizeEmptyTableCells=function(){for(var e,t=0;e=this.table.rows[t];t++)for(var n=0,r=void 0;r=e.cells[n];n++)!r||r.innerHTML&&r.innerHTML.trim()||r.appendChild(document.createElement("br"))},E.prototype.normalizeTableCellSize=function(t){for(var e=0,n=void 0;n=this.table.rows[e];e++)n.removeAttribute("width"),n.style.setProperty("width",null),n.removeAttribute("height"),n.style.setProperty("height",null);for(e=0;this.cells&&e<this.cells.length;e++)for(var r=0;r<this.cells[e].length;r++){var o,i,a=this.cells[e][r];a&&(o=a.width||0,i=a.height||0,Br(a.td,(null==(a="number"==typeof t?function(e){return e/t}:t)?void 0:a(o))||o,(null==a?void 0:a(i))||i))}},E.prototype.normalizeSize=function(e){this.normalizeEmptyTableCells(),this.normalizeTableCellSize(e);var t=this.table.getBoundingClientRect();Br(this.table,(null==e?void 0:e(t.width))||t.width,(null==e?void 0:e(t.height))||t.height)},Sr.default=E;var Tr={},Nr=(Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.default=function(e,t){if(!t||!e.cells)return!1;var n=t.firstCell,t=t.lastCell,r=e.cells.length-1,e=e.cells[r].length-1,o=n.x,n=n.y,i=t.x,t=t.y;return 0==o&&0==n&&i==e&&t==r},{}),C={},zr=(Object.defineProperty(C,"__esModule",{value:!0}),C.isListElement=void 0,l);function Ur(e){switch((0,zr.default)(e)){case"OL":return 1;case"UL":return 2;default:return 0}}C.default=Ur,C.isListElement=function(e){return 0!=Ur(e)};var Vr={},Wr={},Kr={},w=(Object.defineProperty(Kr,"__esModule",{value:!0}),Kr.default=function(e){var r={};return((null==e?void 0:e.getAttribute("style"))||"").split(";").forEach(function(e){var t=e.indexOf(":"),n=e.slice(0,t),e=e.slice(t+1);n&&e&&(r[n.trim()]=e.trim())}),r},{}),qr=(Object.defineProperty(w,"__esModule",{value:!0}),w.default=function(e,n){var t;e&&((t=Object.keys(n||{}).map(function(e){var t=n[e],e=e?e.trim():null,t=t?t.trim():null;return e&&t?e+":"+t:null}).filter(function(e){return e}).join(";"))?e.setAttribute("style",t):e.removeAttribute("style"))},Object.defineProperty(Wr,"__esModule",{value:!0}),c),Gr=se,Zr=Kr,Yr=o,$r=w,Xr=(Wr.default=function(o,e){var n=function(){for(var e=[],t=qr.default.createBodyTraverser(o),n=null;t.currentInlineElement!=n;){var r=(r=(null==(n=t.currentInlineElement)?void 0:n.getContainerNode())||null)?(0,Gr.default)(r):null;(0,Yr.default)(r,"HTMLElement")&&(r=(0,Zr.default)(r))&&e.push(r),t.getNextInlineElement()}return e}(),r=(0,Zr.default)(o);e.forEach(function(t){var e=n.map(function(e){return void 0!==e[t]?e[t]:""});e&&(1==e.length||1==new Set(e).size)&&e[0]&&(r[t]=e[0])}),(0,$r.default)(o,r)},e&&e.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||((r=r||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}),Qr=(Object.defineProperty(Vr,"__esModule",{value:!0}),r),Jr=C,eo=l,to=X,no=or,ro=o,oo=Wr,io=q,ao=y,lo=Oe,so=[null,"lower-alpha","lower-roman"];function co(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(this.newListStart=void 0,!e)throw new Error("node must not be null");this.node=(0,ro.default)(e,"HTMLLIElement")?e:(0,lo.default)(e,4);e=this.node.style.display;this.dummy="list-item"!=e&&""!=e,this.listTypes=Xr([0],t,!0)}function uo(e,t,n){return e=!(0<e.length)||t&&(0,to.default)(e[0])||n&&(0,to.default)(e[e.length])?e:[(0,lo.default)(e)]}co.prototype.getListType=function(){return this.listTypes[this.listTypes.length-1]},co.prototype.getLevel=function(){return this.listTypes.length-1},co.prototype.getNode=function(){return this.node},co.prototype.getNewListStart=function(){return this.newListStart},co.prototype.contains=function(e){return(0,Qr.default)(this.node,e,!0)},co.prototype.isDummy=function(){return this.dummy},co.prototype.isOrphanItem=function(){return!1},co.prototype.canMerge=function(n){return!(null==n||!n.isOrphanItem()||this.listTypes.length!=n.listTypes.length)&&this.listTypes.every(function(e,t){return n.listTypes[t]==e})},co.prototype.mergeItems=function(e){var t=this;uo((null==e?void 0:e.map(function(e){return e.node}))||[],!0,!1).forEach(function(e){return t.node.appendChild(e)})},co.prototype.indent=function(){if("-.25in"==this.node.style.marginLeft)return this.node.style.margin="",void(this.node.style.marginLeft="");var e=this.getListType();0!=e&&this.listTypes.push(e)},co.prototype.outdent=function(e){this.listTypes.length>((e=void 0===e?!1:e)?2:1)&&this.listTypes.pop()},co.prototype.addNegativeMargins=function(){this.node.style.margin="0in 0in 0in 0.5in",this.node.style.marginLeft="-.25in"},co.prototype.changeListType=function(e){0==e?this.listTypes=[e]:(this.outdent(),this.listTypes.push(e))},co.prototype.setIsDummy=function(e){this.dummy=e},co.prototype.setNewListStart=function(e){this.newListStart=e},co.prototype.writeBack=function(e,t){for(var n,r,o,i,a,l,s=1;s<e.length;s++)if((0,Jr.default)(e[s])!==this.listTypes[s]){e.splice(s);break}for(;s<this.listTypes.length;s++){var c,d=e.length-1,u=(u=e[0],o=this.listTypes[s],i=s,a=t,c=l=void 0,c=u.ownerDocument,1==i&&a&&o==(0,Jr.default)(a)?(0,Qr.default)(u,a)?(l=a.cloneNode(!1)).removeAttribute("id"):((0,no.default)(a),l=a):l=c.createElement(1==o?"ol":"ul"),1==o&&1<i&&l.style.setProperty("list-style-type",so[(i-1)%so.length]),l);e[d].appendChild(u),e.push(u),this.getDeepChildIndex(t)==d&&(c=null==(a=this.node.parentElement)?void 0:a.style.listStyleType)&&(u.style.listStyleType=c)}e[e.length-1].appendChild(this.node),this.node.style.setProperty("display",this.dummy?"block":null),1<this.listTypes.length&&!(this.node.style.fontSize||this.node.style.color||this.node.style.fontFamily)&&(0,oo.default)(this.node,["font-size","font-family","color"]),this.listTypes.length<=1&&uo("LI"==(0,eo.default)(this.node)?(n=this.node,r=(0,io.default)(n.childNodes),(0,ao.default)(n),r):[this.node],!0,!0)},co.prototype.getDeepChildIndex=function(e){var t=this.node.parentElement;if(e&&t){for(var n=0;t&&t!=e;)n++,t=(null==t?void 0:t.parentElement)||null;return n}return-1},Vr.default=co;var fo=e&&e.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||((r=r||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},ho=(Object.defineProperty(Nr,"__esModule",{value:!0}),rr),po=C,go=l,mo=X,vo=cr,yo=d,bo=mr,Eo=o,Co=i,wo=q,So=y,To=Vr,Po=Oe;function Oo(e){if(this.rootList=e,this.items=[],!e)throw new Error("rootList must not be null");xo(this.rootList),(0,bo.default)(this.rootList,"ol,ul",xo),(0,bo.default)(this.rootList,"li",_o),this.populateItems(this.rootList)}function xo(e){var t=null;(0,wo.default)(e.childNodes).forEach(function(e){"LI"==(0,go.default)(e)?t=e:(0,po.isListElement)(e)?t=null:t&&!(0,vo.default)(e,!0)&&t.appendChild((0,mo.default)(e)?e:(0,Po.default)(e))})}function _o(t){for(;!(0,po.isListElement)(t.parentNode);){(0,Co.default)(t,!0);var e=(0,wo.default)(t.parentNode.childNodes).slice(1);0<e.length&&(e=(0,mo.default)(e[0])?e:[(0,Po.default)(e)]).forEach(function(e){return t.appendChild(e)}),(0,So.default)(t.parentNode)}}Oo.prototype.contains=function(t){return this.items.some(function(e){return e.contains(t)})},Oo.prototype.getLastItemNumber=function(){var e=this.getStart();return void 0===e?e:e-1+this.items.filter(function(e){return 1==e.getListType()&&1==e.getLevel()&&!e.isDummy()}).length},Oo.prototype.writeBack=function(){var n=this;if(!this.rootList)throw new Error("rootList must not be null");var r,e=this.rootList.ownerDocument,o=[e.createDocumentFragment()],e=e.createTextNode(""),i=this.getStart()||1;this.rootList.parentNode.replaceChild(e,this.rootList),this.items.forEach(function(e){var t=e.getNewListStart(),t=(t&&t!=i&&(o.splice(1,o.length-1),i=t),e.writeBack(o,n.rootList),o[1]);(0,Eo.default)(t,"HTMLOListElement")&&(r!=t&&(1==i?t.removeAttribute("start"):t.start=i),1==e.getLevel()&&i++),r=t}),e.parentNode.replaceChild(o[0],e)},Oo.prototype.split=function(e,t){if(!this.rootList)throw new Error("rootList must not be null");for(var n=0;n<this.items.length;n++)if(this.items[n].getNode()==e)return void this.items[n].setNewListStart(t)},Oo.prototype.setIndentation=function(e,t,n,r,o){var i=this,a=(void 0===o&&(o=!1),!1);if(this.findListItems(e,t,function(e){a=a||0==i.items.indexOf(e),1==n?r&&!e.isDummy()?e.setIsDummy(!0):e.outdent(o):e.indent()}),a&&o)for(var l=0;l<this.items.length;l++)this.items[l].addNegativeMargins()},Oo.prototype.setAlignment=function(e,t,n){this.rootList.style.display="flex",this.rootList.style.flexDirection="column",this.findListItems(e,t,function(e){var t="start";1==n?t="center":2==n&&(t="end"),e.getNode().style.alignSelf=t})},Oo.prototype.changeListType=function(e,t,n){var r=!1;this.findListItems(e,t,function(e){r=r||e.getListType()!=n}),this.findListItems(e,t,function(e){return r?e.changeListType(n):e.outdent()})},Oo.prototype.appendItem=function(e,t){var n=(0,go.default)(e);"DIV"==n?e=(0,ho.default)(e,"LI"):"LI"!=n&&(e=(0,Po.default)(e,"LI")),this.items.push(0==t?new To.default(e):new To.default(e,t))},Oo.prototype.mergeVList=function(e){var t,n=this;e&&e!=this&&(e.items.forEach(function(e){return n.items.push(e)}),e.items.splice(0,e.items.length),null!=(t=e.rootList.parentNode)&&t.removeChild(e.rootList))},Oo.prototype.getListItemIndex=function(e){if(this.items)for(var t=(this.getStart()||1)-1,n=0;n<this.items.length;n++){var r=this.items[n];if(1!=r.getLevel()||r.isDummy()||t++,r.getNode()==e)return t}return-1},Oo.prototype.getStart=function(){return(0,Eo.default)(this.rootList,"HTMLOListElement")?this.rootList.start:void 0},Oo.prototype.findListItems=function(n,r,e){if(0==this.items.length)return[];var t=new yo.default(this.items[0].getNode(),0),o=new yo.default(this.items[this.items.length-1].getNode(),-1),i=t.isAfter(n)?0:-1,a=this.items.length-(r.isAfter(o)?1:0),t=(this.items.forEach(function(e,t){i=e.contains(n.node)?t:i,a=e.contains(r.node)?t:a}),i=a<this.items.length?Math.max(0,i):i,a=0<=i?Math.min(this.items.length-1,a):a,i<=a?this.items.slice(i,a+1):[]);return e&&t.forEach(e),t},Oo.prototype.populateItems=function(e,n){var r=this,o=(void 0===n&&(n=[]),(0,po.default)(e));(0,wo.default)(e.childNodes).forEach(function(e){var t=fo(fo([],n,!0),[o],!1);(0,po.isListElement)(e)?r.populateItems(e,t):3==e.nodeType&&""==(e.nodeValue||"").trim()||r.items.push(new(To.default.bind.apply(To.default,fo([void 0,e],t,!1))))})},Nr.default=Oo;var No={},Ro={},ko=(Object.defineProperty(Ro,"__esModule",{value:!0}),se),Lo=(Ro.default=function(e,t,n){var r=e&&(0,ko.default)(n,e.rootNode,t);if(r)for(var o;o=(0,ko.default)(r.parentNode,e.rootNode,t);)r=o;return r},{}),Io={},Mo=(Object.defineProperty(Io,"__esModule",{value:!0}),oe),Ao=d,Do=p,jo=(Io.default=function(e){if(!e)return null;var t=e.nodeBefore,n=e.nodeAfter,r=e.rootNode,o=e.skipTags,t=t?(0,Do.getNextLeafSibling)(e.rootNode,t,e.skipTags):r.firstChild,n=n?(0,Do.getPreviousLeafSibling)(r,n,o):r.lastChild,o=t&&n&&(0,Mo.default)(t,n);if(!e.fullSelectionEnd||!e.fullSelectionStart)return o;if(o){r=Ao.default.getStart(o).normalize(),t=Ao.default.getEnd(o).normalize(),n=e.fullSelectionEnd,o=e.fullSelectionStart;if(!o.isAfter(t)&&!r.isAfter(n))return e=o.isAfter(r)?o:r,o=n.isAfter(t)?t:n,(0,Mo.default)(e,o)}return null},Object.defineProperty(Lo,"__esModule",{value:!0}),c),Bo=u,Fo=n,Ho=Io,zo=g,Uo=(Lo.default=function(e,t){var n=(0,Ho.default)(e),r=[];if(n){for(var o=e.rootNode,i=e.skipTags,a=jo.default.createSelectionTraverser(o,n,i),l=null==a?void 0:a.currentBlockElement;l;l=a.getNextBlockElement())r.push(l);r=r.filter(function(e){var t=e.getStartNode();return t!=e.getEndNode()||!(0,zo.default)(t,!0)||(null!=(e=t.parentNode)&&e.removeChild(t),!1)})}return 0==r.length&&e&&!e.rootNode.firstChild&&t&&(o=(0,Bo.default)(1,e.rootNode.ownerDocument),e.rootNode.appendChild(o),(l=(0,Fo.default)(e.rootNode,o))&&r.push(l)),r},{}),Vo=(Object.defineProperty(Uo,"__esModule",{value:!0}),r),Wo=(Uo.default=function(e,t){return!(!e||!(0,Vo.default)(e.rootNode,t)||e.nodeBefore&&4!=e.nodeBefore.compareDocumentPosition(t)||e.nodeAfter&&2!=e.nodeAfter.compareDocumentPosition(t))},Object.defineProperty(No,"__esModule",{value:!0}),u),Ko=Ro,qo=Lo,Go=Uo,Zo=d,Yo=o,$o=g,Xo=q,Qo=Nr,Jo=Oe,ei=p,ti=C,ni="ol,ul";function ri(e,t,n){var r=t[n?t.length-1:0],r=(0,ei.getLeafSibling)(e.rootNode,r,n,e.skipTags,!0);r=(0,Ko.default)(e,ni,r),(0,Go.default)(e,r)&&(0,ti.isListElement)(r)&&(n?(0,Yo.default)(r,"HTMLOListElement")&&1!=r.start||t.push(r):t.unshift(r))}No.default=function(n,r,e){if(!n)return null;var t,o,i=[],a=(e?(e=(0,Ko.default)(n,ni,e))&&i.push(e):((0,qo.default)(n).forEach(function(e){var t=(0,Ko.default)(n,ni,e.getStartNode());t?(i[i.length-1]!=t&&i.push(t),1==i.length&&(0,Yo.default)(t,"HTMLOListElement")&&1<t.start&&(r=!1)):i.push(e.collapseToSingleElement())}),0!=i.length||n.rootNode.firstChild||(e=(0,Wo.default)(1,n.rootNode.ownerDocument),n.rootNode.appendChild(e),i.push(e),n.fullSelectionStart=new Zo.default(e,0),n.fullSelectionEnd=new Zo.default(e,-1)),r&&(ri(n,i,!1),ri(n,i,!0)),i=i.filter(function(e){return!(0,$o.default)(e,!0)})),null);return 0<i.length&&(e=i.shift()||null,(a=(0,ti.isListElement)(e)?new Qo.default(e):e?(e=e,t=1==(t=(0,Xo.default)(e.childNodes)).length?t[0]:(0,Jo.default)(t,"SPAN"),o=e.ownerDocument.createElement("ol"),e.appendChild(o),(e=new Qo.default(o)).appendItem(t,0),e):null)&&i.forEach(function(e){(0,ti.isListElement)(e)?a.mergeVList(new Qo.default(e)):a.appendItem(e,0)})),a};var g={},oi=(Object.defineProperty(g,"__esModule",{value:!0}),s),ii=Ro,ai=a,li=Uo,si=mr,ci=Nr,di=0;function ui(e,t){this.region=e,this.name=t,this.lastNumber=0,this.lastNumberBeforeCursor=0}ui.createListChains=function(e,l,s){var e=Array.isArray(e)?e:e?[e]:[],t=[];return e.forEach(function(o){var i,a=[];(0,si.default)(o.rootNode,"ol",function(e){var t,n,r=(0,ii.default)(o,"ol",e);i!=r&&(e=a.filter(function(e){return e.canAppendToTail(r)})[0]||new ui(o,(s||function(){return"__List_Chain_"+di++})()),t=a.indexOf(e),(n=!!l&&(0,ai.default)(r,l))?t<0&&a.push(e):(0<=t&&a.splice(t,1),a.unshift(e)),e.append(r,n),i=r)}),(0,oi.default)(t,a)}),t},ui.prototype.canAppendAtCursor=function(e){return 1<e&&this.lastNumberBeforeCursor+1==e},ui.prototype.createVListAtBlock=function(e,t){var n;return e&&e.parentNode?((n=e.ownerDocument.createElement("ol")).start=t,this.applyChainName(n),e.parentNode.insertBefore(n,e),(t=new ci.default(n)).appendItem(e,0),t):null},ui.prototype.commit=function(){for(var e=this.getLists(),t=0,n=0;n<e.length;n++){var r=e[n],o=(r.start=t+1,new ci.default(r)),t=o.getLastItemNumber()||0;delete r.dataset.listchain,delete r.dataset.listchainafter,o.writeBack()}},ui.prototype.canAppendToTail=function(e){return this.lastNumber+1==e.start},ui.prototype.append=function(e,t){this.applyChainName(e),this.lastNumber=new ci.default(e).getLastItemNumber()||0,t?e.dataset.listchainafter="true":this.lastNumberBeforeCursor=this.lastNumber},ui.prototype.applyChainName=function(e){e.dataset.listchain=this.name},ui.prototype.getLists=function(){var t=this;return(0,si.default)(this.region.rootNode,"ol[data-listchain="+this.name+"]").filter(function(e){return(0,li.default)(t.region,e)})},g.default=ui;var C={},fi=(Object.defineProperty(C,"__esModule",{value:!0}),C.getRegionCreator=void 0,r),hi=se,pi=d,gi=mr,mi=p,vi=((Ro={})[0]={skipTags:["TABLE"],outerSelector:"table",innerSelector:"td,th"},Ro);function yi(e,r){var o=pi.default.getStart(e).normalize(),i=pi.default.getEnd(e).normalize();return function(e,t,n){return function(e,t,n,r){var o,i;if(e)return o=t&&(0,mi.getNextLeafSibling)(e,t,r),r=n&&(0,mi.getPreviousLeafSibling)(e,n,r),i=!t||(0,fi.default)(e,t)&&(0,fi.default)(e,o),e=!n||(0,fi.default)(e,n)&&(0,fi.default)(e,r),r=!(t&&n&&((0,fi.default)(t,n,!0)||(0,fi.default)(t,r,!0)||(0,fi.default)(n,t,!0)||(0,fi.default)(n,o,!0))),i&&e&&r}(e,t,n,r)?{rootNode:e,nodeBefore:t,nodeAfter:n,skipTags:r,fullSelectionStart:o,fullSelectionEnd:i}:null}}C.default=function(e,t,n){var r,o,a,i,l,s,c,d=[];return e&&t&&(o=(r=vi[n]).innerSelector,r=r.skipTags,i=t,l=[{innerNode:a=e,children:[]}],n=vi[n],s=n.outerSelector,n=n.innerSelector,c=(0,gi.default)(a,s,null,2,i),(0,gi.default)(a,n,function(e){var t=(0,hi.default)(e,a,s);if(t&&c.indexOf(t)<0){for(var n={innerNode:e,children:[]},r=l.length-1;0<=r;r--){var o=l[r],i=o.innerNode,o=o.children;if((0,fi.default)(i,t)){i=o.filter(function(e){return e.outerNode==t})[0];i||o.push(i={outerNode:t,boundaries:[]}),i.boundaries.push(n);break}}l.push(n)}},1,i),n=l[0],i=(0,hi.default)(t.startContainer,e,o)||e,o=(0,hi.default)(t.endContainer,e,o)||e,d=function n(r,e,o,i,a){a=a||e.innerNode==o;var l=!1,t=e.children,s=e.innerNode,c=[];if(0==t.length)(u=r(s))&&c.push(u);else for(var d=0;d<=t.length&&!l;d++){var u,f=(h=t[d]||{}).outerNode,h=h.boundaries,p=null==(p=t[d-1])?void 0:p.outerNode;a&&(u=r(s,p,f))&&c.push(u),null!=h&&h.forEach(function(e){var t=(e=n(r,e,o,i,a))[0];a=e[1],l=e[2],c=c.concat(t)})}return[c,a,l||s==i]}(yi(t,r),n,i,o)[0]),d.filter(function(e){return!!e})},C.getRegionCreator=yi;var a={},bi=(Object.defineProperty(a,"__esModule",{value:!0}),z),Ei=Uo,Ci=o,Ro=(a.default=function(t,e){if(!e||0==e.length)return[];var e=(0,Ci.default)(e[0],"Node")?e:[e[0].getStartNode(),e[e.length-1].getEndNode()],n=(e=e&&e.filter(function(e){return(0,Ei.default)(t,e)}))[0],e=e[e.length-1];return(0,Ei.default)(t,n)&&(0,Ei.default)(t,e)?(0,bi.default)(t.rootNode,n,e,!0):[]},{}),wi={},Si=(Object.defineProperty(wi,"__esModule",{value:!0}),l),Ti={B:{"font-weight":"bold"},EM:{"font-style":"italic"},I:{"font-style":"italic"},U:{"text-decoration":"underline"},P:{"margin-top":"1em","margin-bottom":"1em"},PRE:{"white-space":"pre"},S:{"text-decoration":"line-through"},STRIKE:{"text-decoration":"line-through"},SUB:{"vertical-align":"sub","font-size":"smaller"},SUP:{"vertical-align":"super","font-size":"smaller"}},Pi=(wi.default=function(e,t){e=(0,Si.default)(e);return Ti[e]||(t||{})[e]},e&&e.__assign||function(){return(Pi=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)}),Oi=(Object.defineProperty(Ro,"__esModule",{value:!0}),rr),xi=r,_i=n,Ni=wi,Ri=Kr,ki=Uo,Li=o,Ii=w,Mi=z,Ai=(Ro.default=function(e,t,n){var r;if((0,ki.default)(e,t)&&(0,ki.default)(e,n)&&(n=(0,_i.default)(e.rootNode,n))&&!n.contains(t)){for(var o=n.collapseToSingleElement(),i=(0,Mi.collapse)(e.rootNode,o,t,!1,!0),a=o;(0,xi.default)(i,a);){var l,s=a.parentNode;(0,Li.default)(s,"HTMLElement")&&(l=Pi(Pi(Pi({},(0,Ni.default)(s)||{}),(0,Ri.default)(s)),(0,Ri.default)(o)),(0,Ii.default)(o,l)),a=s}for(var c=null,n=1==o.childNodes.length&&0==o.attributes.length?o.firstChild:(0,Oi.default)(o,"SPAN"),a=n;(0,xi.default)(i,a)&&1==(null==(r=a.parentNode)?void 0:r.childNodes.length);a=a.parentNode)c=a.parentNode;null!=(e=t.parentNode)&&e.insertBefore(n,t.nextSibling),null!=(e=null==c?void 0:c.parentNode)&&e.removeChild(c)}},{}),Di=(Object.defineProperty(Ai,"__esModule",{value:!0}),u),ji=oe,Bi=Er,Fi=(Ai.default=function(e){if(!e)return null;var t=(0,ji.default)(e),n=t.getBoundingClientRect&&(0,Bi.default)(t.getBoundingClientRect());if(n)return n;e=e.normalize();var r=t.getClientRects&&t.getClientRects();if(n=r&&1==r.length?(0,Bi.default)(r[0]):null)return n;if(3==e.node.nodeType&&e.node.ownerDocument){r=(0,Di.default)({tag:"span",children:["​"]},e.node.ownerDocument);if((t=(0,ji.default)(e)).insertNode(r),n=r.getBoundingClientRect&&(0,Bi.default)(r.getBoundingClientRect()),null!=(t=r.parentNode)&&t.removeChild(r),n)return n}t=e.element;return t&&t.getBoundingClientRect&&(n=(0,Bi.default)(t.getBoundingClientRect()))?n:null},{}),Hi=(Object.defineProperty(Fi,"__esModule",{value:!0}),r),zi=l,Ui=cr;Fi.default=function(e,t){if(e){var n=(e=e.normalize()).node;if(0==e.offset){for(;n&&(0,Hi.default)(t,n)&&function(e){for(;e.previousSibling;)if(e=e.previousSibling,"BR"==(0,zi.default)(e)||!(0,Ui.default)(e))return;return 1}(n);)n=(null==n?void 0:n.parentNode)||null;return n==t}}return!1};var Vi={},Wi=(Object.defineProperty(Vi,"__esModule",{value:!0}),r),Ki=d;function qi(e,t){var n,r;if(!e||!t)return[];var o,i=e.node,a=e.offset,l=[];if(!(0,Wi.default)(t,i,!0))return[];if(3==i.nodeType){for(o=i.parentNode;i.previousSibling&&3==i.previousSibling.nodeType;)a+=(null==(n=i.previousSibling.nodeValue)?void 0:n.length)||0,i=i.previousSibling;l.unshift(a)}else i=(o=i).childNodes[a];do{for(var a=0,s=!1,c=(null==o?void 0:o.firstChild)||null;c&&c!=i;c=c.nextSibling){if(3==c.nodeType){if(0===(null==(r=c.nodeValue)?void 0:r.length)||s)continue;s=!0}else s=!1;a++}}while(l.unshift(a),o=(null==(i=o)?void 0:o.parentNode)||null,i&&i!=t);return l}Vi.default=function(e,t){return t?{start:qi(Ki.default.getStart(t),e),end:qi(Ki.default.getEnd(t),e)}:null};var Gi={},Zi=(Object.defineProperty(Gi,"__esModule",{value:!0}),Cr),Yi=Vi,S=(Gi.default=function(e,t){if(!e)return"";var n=(0,Zi.default)(e),e=t&&(0,Yi.default)(e,t);return e?n+"\x3c!--"+JSON.stringify(e)+"--\x3e":n},{}),$i=(Object.defineProperty(S,"__esModule",{value:!0}),S.setHtmlWithMetadata=void 0,oe),Xi=o;function Qi(e,t,n){if(e){t=t||"",e.innerHTML=(null==n?void 0:n(t))||t;n=e.lastChild;if((0,Xi.default)(n,"Comment"))try{var r=JSON.parse(n.nodeValue||"");if(function(e){if(e&&"object"==typeof e)switch(e.type||0){case 0:var t=e;if(Ji(t.start)&&Ji(t.end))return e.type=0,e.isDarkMode=!!e.isDarkMode,1;break;case 1:if("string"==typeof e.tableId&&e.tableId&&ea(e.firstCell)&&ea(e.lastCell))return e.isDarkMode=!!e.isDarkMode,1}}(r))return e.removeChild(n),r}catch(e){}}}function Ji(e){return e&&Array.isArray(e)&&e.every(function(e){return"number"==typeof e})}function ea(e){return e&&"object"==typeof e&&"number"==typeof e.x&&"number"==typeof e.y}S.default=function(e,t,n){t=Qi(e,t,n);return 0==(null==t?void 0:t.type)?(0,$i.default)(e,t.start,t.end):null},S.setHtmlWithMetadata=Qi;var T={},ta=(Object.defineProperty(T,"__esModule",{value:!0}),xe),na=(T.default=function(e,t){var n=null==(n=null==(n=null==(n=null==e?void 0:e.commonAncestorContainer)?void 0:n.ownerDocument)?void 0:n.defaultView)?void 0:n.getSelection();if(n){var r=!0;if(0<n.rangeCount)try{var o=null;(t||ta.Browser.isEdge)&&(o=1==n.rangeCount?n.getRangeAt(0):null)&&o.startContainer==e.startContainer&&o.startOffset==e.startOffset&&o.endContainer==e.endContainer&&o.endOffset==e.endOffset?r=!1:n.removeAllRanges()}catch(e){}r&&n.addRange(e)}},{}),ra={},oa={},ia=(Object.defineProperty(oa,"__esModule",{value:!0}),oa.default=function(e,t){t=e.currentIndex+t;return 0<=t&&t<e.snapshots.length},Object.defineProperty(ra,"__esModule",{value:!0}),ra.clearProceedingSnapshotsV2=void 0,oa);function aa(e,t){if(t=t||function(e){return(null==(e=e)?void 0:e.length)||0},(0,ia.default)(e,1)){for(var n=0,r=e.currentIndex+1;r<e.snapshots.length;r++)n+=t(e.snapshots[r]);e.snapshots.splice(e.currentIndex+1),e.totalSize-=n,e.autoCompleteIndex=-1}}ra.default=aa,ra.clearProceedingSnapshotsV2=function(e){aa(e,function(e){return(null==(e=e.html)?void 0:e.length)||0})},Object.defineProperty(na,"__esModule",{value:!0}),na.addSnapshotV2=void 0;var la=ra;function sa(e,t,n,r,o){r=r||function(e){return(null==(e=e)?void 0:e.length)||0},o=o||da;var i=e.snapshots[e.currentIndex];if(e.currentIndex<0||!i||!o(t,i)){(0,la.default)(e,r),e.snapshots.push(t),e.currentIndex++,e.totalSize+=r(t);for(var a=0;a<e.snapshots.length&&e.totalSize>e.maxSize;)e.totalSize-=r(e.snapshots[a]),a++;0<a&&(e.snapshots.splice(0,a),e.currentIndex-=a,e.autoCompleteIndex-=a),n&&(e.autoCompleteIndex=e.currentIndex)}}function ca(e,t){return e.html==t.html}function da(e,t){return e==t}na.default=sa,na.addSnapshotV2=function(e,t,n){sa(e,t,n,function(e){return(null==(e=e.html)?void 0:e.length)||0},ca)};var ua={},fa=(Object.defineProperty(ua,"__esModule",{value:!0}),ua.moveCurrentSnapsnot=void 0,oa);function ha(e,t){return(0,fa.default)(e,t)?(e.currentIndex+=t,e.autoCompleteIndex=-1,e.snapshots[e.currentIndex]):null}ua.default=ha,ua.moveCurrentSnapsnot=ha;var pa={},ga=(Object.defineProperty(pa,"__esModule",{value:!0}),pa.default=function(e){return{snapshots:[],totalSize:0,currentIndex:-1,autoCompleteIndex:-1,maxSize:e}},{}),ma=(Object.defineProperty(ga,"__esModule",{value:!0}),ga.default=function(e){return 0<=e.autoCompleteIndex&&e.currentIndex-e.autoCompleteIndex==1},{}),va={},ya=(Object.defineProperty(va,"__esModule",{value:!0}),"border-spacing,caption-side,color,cursor,direction,empty-cells,font-family,font-size,font-style,font-variant,font-weight,font,letter-spacing,line-height,list-style-image,list-style-position,list-style-type,list-style,orphans,quotes,text-align,text-indent,text-transform,visibility,white-space,widows,word-spacing".split(",")),ba=(va.default=function(e){var t=e&&e.ownerDocument&&e.ownerDocument.defaultView,n=t&&e&&t.getComputedStyle(e),r={};return ya.forEach(function(e){return r[e]=n&&n.getPropertyValue(e)||""}),r},{}),Ea=(Object.defineProperty(ba,"__esModule",{value:!0}),ba.cloneObject=void 0,Object.assign?function(e,t){return Object.assign(t||{},e)}:function(e,t){var n=t||{};if(e)for(var r=0,o=Object.keys(e);r<o.length;r++){var i=o[r];n[i]=e[i]}return n}),P=(ba.cloneObject=function(e,t){return Ea(e,t)},{}),Ca=e&&e.__assign||function(){return(Ca=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},wa=(Object.defineProperty(P,"__esModule",{value:!0}),P.getStyleCallbacks=P.getDefaultStyleValues=P.getAllowedCssClassesRegex=P.getAllowedAttributes=P.getTagReplacement=void 0,ba),Sa={a:"*",abbr:"*",address:"*",area:"*",article:"*",aside:"*",b:"*",bdi:"*",bdo:"*",blockquote:"*",body:"*",br:"*",button:"*",canvas:"*",caption:"*",center:"*",cite:"*",code:"*",col:"*",colgroup:"*",data:"*",datalist:"*",dd:"*",del:"*",details:"*",dfn:"*",dialog:"*",dir:"*",div:"*",dl:"*",dt:"*",em:"*",fieldset:"*",figcaption:"*",figure:"*",font:"*",footer:"*",h1:"*",h2:"*",h3:"*",h4:"*",h5:"*",h6:"*",head:"*",header:"*",hgroup:"*",hr:"*",html:"*",i:"*",img:"*",input:"*",ins:"*",kbd:"*",label:"*",legend:"*",li:"*",main:"*",map:"*",mark:"*",menu:"*",menuitem:"*",meter:"*",nav:"*",ol:"*",optgroup:"*",option:"*",output:"*",p:"*",picture:"*",pre:"*",progress:"*",q:"*",rp:"*",rt:"*",ruby:"*",s:"*",samp:"*",section:"*",select:"*",small:"*",span:"*",strike:"*",strong:"*",sub:"*",summary:"*",sup:"*",table:"*",tbody:"*",td:"*",textarea:"*",tfoot:"*",th:"*",thead:"*",time:"*",tr:"*",tt:"*",u:"*",ul:"*",var:"*",wbr:"*",xmp:"*",form:"SPAN",applet:null,audio:null,base:null,basefont:null,embed:null,frame:null,frameset:null,iframe:null,link:null,meta:null,noscript:null,object:null,param:null,script:null,slot:null,source:null,style:null,template:null,title:null,track:null,video:null},Ta="accept,align,alt,checked,cite,color,cols,colspan,contextmenu,coords,datetime,default,dir,dirname,disabled,download,face,headers,height,hidden,high,href,hreflang,ismap,kind,label,lang,list,low,max,maxlength,media,min,multiple,open,optimum,pattern,placeholder,readonly,rel,required,reversed,rows,rowspan,scope,selected,shape,size,sizes,span,spellcheck,src,srclang,srcset,start,step,style,tabindex,target,title,translate,type,usemap,valign,value,width,wrap".split(","),Pa={"background-color":"transparent","border-bottom-color":"rgb(0, 0, 0)","border-bottom-style":"none","border-bottom-width":"0px","border-image-outset":"0","border-image-repeat":"stretch","border-image-slice":"100%","border-image-source":"none","border-image-width":"1","border-left-color":"rgb(0, 0, 0)","border-left-style":"none","border-left-width":"0px","border-right-color":"rgb(0, 0, 0)","border-right-style":"none","border-right-width":"0px","border-top-color":"rgb(0, 0, 0)","border-top-style":"none","border-top-width":"0px","outline-color":"transparent","outline-style":"none","outline-width":"0px",overflow:"visible","text-decoration":"none","-webkit-text-stroke-width":"0px","word-wrap":"break-word","margin-left":"0px","margin-right":"0px",padding:"0px","padding-top":"0px","padding-left":"0px","padding-right":"0px","padding-bottom":"0px",border:"0px","border-top":"0px","border-left":"0px","border-right":"0px","border-bottom":"0px","vertical-align":"baseline",float:"none"},Oa=[];function xa(){return null}function _a(e,t){t=t.tagName;return!("LI"==t||"DIV"==t)}P.getTagReplacement=function(e){var t=Ca({},Sa),n=e||{};return Object.keys(n).forEach(function(e){e&&(t[e.toLowerCase()]=n[e])}),t},P.getAllowedAttributes=function(e){return Ta.concat(e||[]).filter(function(e,t,n){return n.indexOf(e)==t}).map(function(e){return e.toLocaleLowerCase()})},P.getAllowedCssClassesRegex=function(e){e=Oa.concat(e||[]);return 0<e.length?new RegExp(e.join("|")):null},P.getDefaultStyleValues=function(n){var r=(0,wa.cloneObject)(Pa);return n&&Object.keys(n).forEach(function(e){var t=n[e];null!=t?r[e]=t:delete r[e]}),r},P.getStyleCallbacks=function(e){e=(0,wa.cloneObject)(e);return e.position=e.position||xa,e.width=e.width||_a,e},Object.defineProperty(ma,"__esModule",{value:!0});var Na=rr,Ra=va,ka=wi,La=Kr,Ia=l,Ma=o,Aa=w,Da=q,ja=ba,Ba=P;function Fa(e){this.elementCallbacks=(0,ja.cloneObject)((e=e||{}).elementCallbacks),this.styleCallbacks=(0,Ba.getStyleCallbacks)(e.cssStyleCallbacks),this.attributeCallbacks=(0,ja.cloneObject)(e.attributeCallbacks),this.tagReplacements=(0,Ba.getTagReplacement)(e.additionalTagReplacements),this.allowedAttributes=(0,Ba.getAllowedAttributes)(e.additionalAllowedAttributes),this.allowedCssClassesRegex=(0,Ba.getAllowedCssClassesRegex)(e.additionalAllowedCssClasses),this.defaultStyleValues=(0,Ba.getDefaultStyleValues)(e.additionalDefaultStyleValues),this.additionalPredefinedCssForElement=e.additionalPredefinedCssForElement||null,this.additionalGlobalStyleNodes=e.additionalGlobalStyleNodes||[],this.preserveHtmlComments=e.preserveHtmlComments||!1,this.unknownTagReplacement=e.unknownTagReplacement||null}Fa.convertInlineCss=function(e,t){return new Fa({additionalGlobalStyleNodes:t}).exec(e,!0)},Fa.sanitizeHtml=function(e,t){var n=new Fa(t=t||{}),r=(0,Ma.default)(t.currentElementOrStyle,"HTMLElement")?(0,Ra.default)(t.currentElementOrStyle):t.currentElementOrStyle;return n.exec(e,t.convertCssOnly,r)},Fa.prototype.exec=function(e,t,n){e=(new DOMParser).parseFromString(e||"","text/html");return e&&e.body&&e.body.firstChild&&(this.convertGlobalCssToInlineCss(e),t||this.sanitize(e.body,n)),e&&e.body&&e.body.innerHTML||""},Fa.prototype.sanitize=function(e,t){if(!e)return"";t=(0,ja.cloneObject)(t,(0,Ra.default)(null)),this.processNode(e,t,{})},Fa.prototype.convertGlobalCssToInlineCss=function(i){for(var e=(0,Da.default)(i.querySelectorAll("style")),t=0,n=this.additionalGlobalStyleNodes.reverse().map(function(e){return e.sheet}).concat(e.map(function(e){return e.sheet}).reverse()).filter(function(e){return e});t<n.length;t++)for(var a=n[t],r=a.cssRules.length-1;0<=r;r--)!function(e){var e=a.cssRules[e],t=e&&e.style?e.style.cssText:null;if(e.type!=CSSRule.STYLE_RULE||!t||!e.selectorText)return;for(var n=0,r=e.selectorText.split(",");n<r.length;n++){var o=r[n];!o||!o.trim()||0<=o.indexOf(":")||(0,Da.default)(i.querySelectorAll(o)).forEach(function(e){return e.setAttribute("style",t+(e.getAttribute("style")||""))})}}(r);e.forEach(function(e){e.parentNode&&e.parentNode.removeChild(e)})},Fa.prototype.processNode=function(e,t,n){var r,o,i=e.nodeType,a=1==i,l=3==i,s=11==i,i=8==i,c=!1;if(a?(u=(0,Ia.default)(e),o=this.elementCallbacks[u],void 0===(r=this.tagReplacements[u.toLowerCase()])&&(r=this.unknownTagReplacement),o?c=o(e,n):0<u.indexOf(":")||u==r||"*"==r?c=!0:r&&/^[a-zA-Z][\w\-]*$/.test(r)&&(e=(0,Na.default)(e,r),c=!0)):c=l?"pre"==(o=t["white-space"])||"pre-line"==o||"pre-wrap"==o||!/^[\r\n]*$/g.test(e.nodeValue||""):!!s||!!i&&this.preserveHtmlComments,c)if(!l||"pre"!=t["white-space"]&&"pre-wrap"!=t["white-space"]){if(a||s){var d=(0,ja.cloneObject)(t),u=e;a&&(this.processAttributes(u,n),this.preprocessCss(u,d),this.processCss(u,d,n));for(var f,h=u.firstChild;h;h=f)f=h.nextSibling,this.processNode(h,d,n)}}else e.nodeValue=(e.nodeValue||"").replace(/^ /gm," ").replace(/ {2}/g,"  ");else null!=(r=e.parentNode)&&r.removeChild(e)},Fa.prototype.preprocessCss=function(e,t){var n=(0,ka.default)(e,this.additionalPredefinedCssForElement);n&&Object.keys(n).forEach(function(e){t[e]=n[e]})},Fa.prototype.processCss=function(o,i,a){var l=this,s=(0,La.default)(o);Object.keys(s).forEach(function(e){var t=s[e],n=l.styleCallbacks[e],r=null!=i[e],n=(!n||n(t,o,i,a))&&"inherit"!=t&&t.indexOf("expression")<0&&"-"!=e.substr(0,1)&&l.defaultStyleValues[e]!=t&&(r&&t!=i[e]||!r&&"initial"!=t&&"normal"!=t);n&&r&&(i[e]=t),n||delete s[e]}),(0,Aa.default)(o,s)},Fa.prototype.processAttributes=function(e,t){for(var n=e.attributes.length-1;0<=n;n--){var r=e.attributes[n],o=r.name.toLowerCase().trim(),i=r.value,a=this.attributeCallbacks[o],a=a?a(i,e,t):0<=this.allowedAttributes.indexOf(o)||0==o.indexOf("data-")?i:null;null==(a="class"==o&&this.allowedCssClassesRegex?this.processCssClass(i,a):a)||a.match(/s\n*c\n*r\n*i\n*p\n*t\n*:/i)?e.removeAttribute(o):r.value=a}},Fa.prototype.processCssClass=function(e,t){var n=this,e=e?e.split(" "):[],r=t?t.split(" "):[];return e.forEach(function(e){var t;null!=(t=n.allowedCssClassesRegex)&&t.test(e)&&r.indexOf(e)<0&&r.push(e)}),0<(null==r?void 0:r.length)?r.join(" "):null},ma.default=Fa;var wi={},ba=(Object.defineProperty(wi,"__esModule",{value:!0}),wi.default=function(){return{elementCallbacks:{},attributeCallbacks:{},cssStyleCallbacks:{},additionalTagReplacements:{},additionalAllowedAttributes:[],additionalAllowedCssClasses:[],additionalDefaultStyleValues:{},additionalGlobalStyleNodes:[],additionalPredefinedCssForElement:{},preserveHtmlComments:!1,unknownTagReplacement:null}},{}),P=(Object.defineProperty(ba,"__esModule",{value:!0}),ba.default=function(e,t,n){var r;e[t]?(r=e[t],e[t]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.apply(void 0,e),n.apply(void 0,e)}):e[t]=n},{}),Ha=(Object.defineProperty(P,"__esModule",{value:!0}),"contenteditable"),za=(P.default=function(e,t,n,r){e&&(e.className="_Entity _EType_"+t+" "+(r?"_EId_"+r+" ":"")+"_EReadonly_"+(n?"1":"0"),n?e.contentEditable="false":e.getAttribute(Ha)&&e.removeAttribute(Ha))},{}),Ua=(Object.defineProperty(za,"__esModule",{value:!0}),za.default=function(e){var t,n=!1,r="",o="",i=!1;return null!=(t=null==e?void 0:e.className)&&t.split(" ").forEach(function(e){"_Entity"==e?n=!0:0==e.indexOf("_EType_")?r=e.substr("_EType_".length):0==e.indexOf("_EId_")?o=e.substr("_EId_".length):0==e.indexOf("_EReadonly_")&&(i="1"==e.substr("_EReadonly_".length))}),n?{wrapper:e,id:o,type:r,isReadonly:i}:null},{}),Va=(Object.defineProperty(Ua,"__esModule",{value:!0}),Ua.default=function(e,t){return"._Entity"+(e?"._EType_"+e:"")+(t?"._EId_"+t:"")},{}),Wa=(Object.defineProperty(Va,"__esModule",{value:!0}),Va.default=function(e,t,n){n=e&&e.eventDataCache&&e.eventDataCache.hasOwnProperty(t)?e.eventDataCache[t]:n();return e&&(e.eventDataCache=e.eventDataCache||{},e.eventDataCache[t]=n),n},{}),Ka=(Object.defineProperty(Wa,"__esModule",{value:!0}),Wa.default=function(e,t){e&&e.eventDataCache&&(t&&e.eventDataCache.hasOwnProperty(t)?delete e.eventDataCache[t]:t||(e.eventDataCache={}))},{}),qa=(Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.default=function(e){var t=e.ctrlKey||"Control"===e.key,n=e.altKey||"Alt"===e.key,e=e.metaKey||"Meta"===e.key;return t||n||e},{}),Ga=(Object.defineProperty(qa,"__esModule",{value:!0}),Ka),Za=(qa.default=function(e){return!(0,Ga.default)(e)&&!!e.key&&1==e.key.length},{}),Ya=(Object.defineProperty(Za,"__esModule",{value:!0}),xe.Browser.isMac?function(e){return e.metaKey}:function(e){return e.ctrlKey}),$a=(Za.default=function(e){return Ya(e)},{}),Xa=(Object.defineProperty($a,"__esModule",{value:!0}),rr),Qa=r,Ja=oe,el=se,tl=n,nl=l,rl=cr,ol=Fi,il=ie,al=Nt,ll=d,sl=m,cl=mr,dl=rt,ul=q,fl=y,hl=Sr,pl=Oe,gl=i,ml=[function(e,t,n,r){var o=(0,tl.default)(e,n.node);if(o){var i=(0,cl.default)(e,"a[href]",null,1,(0,Ja.default)(n)).filter(function(e){return o.contains(e)})[0];if(i&&(0,rl.default)(i)&&(n=new ll.default(i,-2),vl(i),i=null),i&&null!=(a=t)&&a.querySelector&&null!=(a=t)&&a.querySelector("a[href]")){var t=n.normalize(),a=t.node.parentNode,t=3==t.node.nodeType?(0,dl.default)(t.node,t.offset,!1):t.isAtEnd?t.node.nextSibling:t.node,l=e.ownerDocument.createTextNode("");for(a.insertBefore(l,t);(0,Qa.default)(i,l);)l=(0,gl.splitBalancedNodeRange)(l);n=new ll.default(l,-2),vl(l)}}return n},function(e,t,n,r){11==t.nodeType&&(t=1==(l=(0,ul.default)(t.childNodes).filter(function(e){return"BR"!=(0,nl.default)(e)})).length?l[0]:null);var o,i,a,l=(0,nl.default)(t),s=l&&t&&"BR"==(0,nl.default)(t.nextSibling),c=(0,el.default)(n.node,e,"LI"),d=c&&(0,el.default)(c,e,"OL,UL"),u=(0,el.default)(n.node,e,"TD,TH"),e=u&&(0,el.default)(u,e,"TR");return"LI"==l&&(l=d?(0,nl.default)(d):"UL",t=(0,pl.default)(t,l)),"OL"!=l&&"UL"!=l||!t||"LI"!=(0,nl.default)(t.firstChild)?"TABLE"==l&&e&&(i=new hl.default(t),0==(a=new hl.default(u)).col&&u==a.getCell(a.row||0,0).td&&null!=(o=i.cells)&&o[0]&&i.cells[0].length==(null==(o=a.cells)?void 0:o[0].length)&&(0,ol.default)(n,u)&&("TBODY"!=(0,nl.default)(t.firstChild)||null!=(i=t.firstChild)&&i.nextSibling||(0,fl.default)(t.firstChild),(0,fl.default)(t),n=new ll.default(e,-3))):(a=!t.firstChild.nextSibling&&!s,s&&t.parentNode&&vl(t.nextSibling),a?((0,fl.default)(t.firstChild),(0,fl.default)(t)):(0,nl.default)(d)==l&&((0,fl.default)(t),n=new ll.default(c,(0,ol.default)(n,c)?-2:-3))),n},function(e,t,n,r){var o,i;return"P"==(0,nl.default)(n.node)&&(o=n.normalize(),i=(0,Xa.default)(n.node,"div"),o.node!=i&&(n=o)),n},function(e,t,n,r){return n=(0,il.default)(n.node)?new ll.default(n.node,n.isAtEnd?-3:-2):n},function(e,t,n,r){return r&&r.collapsed&&(r=(e=new sl.default(e,ll.default.getStart(r))).getInlineElementBefore(),e=e.getInlineElementAfter(),r instanceof al.default?n=new ll.default(r.getContainerNode(),-3):e instanceof al.default&&(n=new ll.default(e.getContainerNode(),-2))),n}];function vl(e){var t;null!=(t=null==e?void 0:e.parentNode)&&t.removeChild(e)}$a.default=function(t,n,r,o){return ml.forEach(function(e){r=e(t,n,r,o)}),r};var yl={},bl=(Object.defineProperty(yl,"__esModule",{value:!0}),s),El=a,Cl=C,wl=Io,Sl=Ro,Tl=d,Pl=mr,Ol=o,xl=rt;function _l(e,t,n){if((0,Ol.default)(e,"Text"))return r=(0,xl.default)(e,t,n),n?[r,e]:[e,r];var r=e.childNodes[t-1],t=e.childNodes[t];return r||t||(n?r=(t=e).previousSibling:t=(r=e).nextSibling),!r&&!t||r&&t||(n=e.ownerDocument.createTextNode(""),null!=(e=null==(e=r||t)?void 0:e.parentNode)&&e.insertBefore(n,t),r?t=n:r=n),[r,t]}yl.default=function(e,t){var i=null,a=(0,Pl.default)(e,"table,tr",null,2,t),e=(0,Cl.default)(e,t,0).map(function(e){var t=(0,wl.default)(e);if(!t)return null;var n=t.startContainer,r=t.endContainer,o=t.startOffset,r=_l(r,t.endOffset,!1),t=r[0],r=r[1],n=_l(n,o,!0),o=n[0],n=n[1],n=(i=i||o,(0,El.default)(e,[n,t]));return(0,bl.default)(a,n),{region:e,beforeStart:o,afterEnd:r}}).filter(function(e){return!!e});return a.forEach(function(e){var t;return null==(t=e.parentNode)?void 0:t.removeChild(e)}),e.forEach(function(e){e&&(0,Sl.default)(e.region,e.beforeStart,e.afterEnd)}),i&&new Tl.default(i,-1)};var Nl,Rl,kl,Ll,Il,Ml,Al,Dl,jl,Bl,Fl,Hl,zl,Ul,Vl,Wl,Kl,ql,Gl,Zl,Yl,$l,Xl,Ql,Jl,es,ts,ns,rs,os,is,as,ls,ss,cs,ds,us,fs,hs,ps,gs,ms,vs,ys,bs,Es,Cs,ws,Ss,Ts,Ps,Os,xs,_s,Ns,Rs,ks,Ls,Is,Ms,As,Ds,js,Bs,Fs,Hs,zs,Us,Vs,Ws,Ks,qs,Gs,Zs,Ys,$s,Xs,Qs,Js,ec,tc,nc,rc,oc,ic,ac,lc,sc,cc={},dc=(Object.defineProperty(cc,"__esModule",{value:!0}),c),uc=(cc.default=function(e){for(var t=dc.default.createBodyTraverser(e),n=t&&t.currentBlockElement,r=[];n;)r.push(n.getTextContent()),n=t.getNextBlockElement();return r.join("\n")},L=t,Object.defineProperty(L,"__esModule",{value:!0}),L.KnownCreateElementData=L.createElement=L.matchesSelector=L.setColor=L.getInnerHTML=L.readFile=L.safeInstanceOf=L.toArray=L.normalizeRect=L.splitTextNode=L.getLastLeafNode=L.getFirstLeafNode=L.getPreviousLeafSibling=L.getNextLeafSibling=L.wrap=L.unwrap=L.splitBalancedNodeRange=L.splitParentNode=L.queryElements=L.matchLink=L.isVoidHtmlElement=L.isNodeEmpty=L.isBlockElement=L.getTagOfNode=L.PendableFormatCommandMap=L.getPendableFormatState=L.getComputedStyle=L.getComputedStyles=L.fromHtml=L.findClosestElementAncestor=L.contains=L.collapseNodes=L.changeElementTag=L.applyFormat=L.getBrowserInfo=L.Browser=L.arrayPush=L.extractClipboardItemsForIE=L.extractClipboardItems=L.extractClipboardEvent=L.applyTextStyle=L.PartialInlineElement=L.NodeInlineElement=L.LinkInlineElement=L.ImageInlineElement=L.getInlineElementAtNode=L.PositionContentSearcher=L.ContentTraverser=L.getFirstLastBlockElement=L.getBlockElementAtNode=void 0,L.getTextContent=L.deleteSelectedContent=L.adjustInsertPosition=L.setStyles=L.getStyles=L.isCtrlOrMetaPressed=L.isCharacterValue=L.isModifierKey=L.clearEventDataCache=L.cacheGetEventData=L.getEntitySelector=L.getEntityFromElement=L.commitEntity=L.chainSanitizerCallback=L.createDefaultHtmlSanitizerOptions=L.getInheritableStyles=L.HtmlSanitizer=L.canUndoAutoComplete=L.createSnapshots=L.moveCurrentSnapsnot=L.moveCurrentSnapshot=L.clearProceedingSnapshotsV2=L.clearProceedingSnapshots=L.canMoveCurrentSnapshot=L.addSnapshotV2=L.addSnapshot=L.addRangeToSelection=L.setHtmlWithMetadata=L.setHtmlWithSelectionPath=L.getHtmlWithSelectionPath=L.getSelectionPath=L.isPositionAtBeginningOf=L.getPositionRect=L.createRange=L.Position=L.mergeBlocksInRegion=L.getSelectionRangeInRegion=L.isNodeInRegion=L.collapseNodesInRegion=L.getSelectedBlockElementsInRegion=L.getRegionsFromRange=L.setListItemStyle=L.VListChain=L.createVListFromRegion=L.VListItem=L.VList=L.isWholeTableSelected=L.VTable=L.moveChildNodes=void 0,Nl=n,Object.defineProperty(L,"getBlockElementAtNode",{enumerable:!0,get:function(){return Nl.default}}),Rl=f,Object.defineProperty(L,"getFirstLastBlockElement",{enumerable:!0,get:function(){return Rl.default}}),kl=c,Object.defineProperty(L,"ContentTraverser",{enumerable:!0,get:function(){return kl.default}}),Ll=m,Object.defineProperty(L,"PositionContentSearcher",{enumerable:!0,get:function(){return Ll.default}}),Il=h,Object.defineProperty(L,"getInlineElementAtNode",{enumerable:!0,get:function(){return Il.default}}),Ml=et,Object.defineProperty(L,"ImageInlineElement",{enumerable:!0,get:function(){return Ml.default}}),Al=Nt,Object.defineProperty(L,"LinkInlineElement",{enumerable:!0,get:function(){return Al.default}}),Dl=tt,Object.defineProperty(L,"NodeInlineElement",{enumerable:!0,get:function(){return Dl.default}}),jl=en,Object.defineProperty(L,"PartialInlineElement",{enumerable:!0,get:function(){return jl.default}}),Bl=nt,Object.defineProperty(L,"applyTextStyle",{enumerable:!0,get:function(){return Bl.default}}),Fl=Je,Object.defineProperty(L,"extractClipboardEvent",{enumerable:!0,get:function(){return Fl.default}}),Hl=Qt,Object.defineProperty(L,"extractClipboardItems",{enumerable:!0,get:function(){return Hl.default}}),zl=v,Object.defineProperty(L,"extractClipboardItemsForIE",{enumerable:!0,get:function(){return zl.default}}),Ul=s,Object.defineProperty(L,"arrayPush",{enumerable:!0,get:function(){return Ul.default}}),Vl=xe,Object.defineProperty(L,"Browser",{enumerable:!0,get:function(){return Vl.Browser}}),Object.defineProperty(L,"getBrowserInfo",{enumerable:!0,get:function(){return Vl.getBrowserInfo}}),Wl=Qn,Object.defineProperty(L,"applyFormat",{enumerable:!0,get:function(){return Wl.default}}),Kl=rr,Object.defineProperty(L,"changeElementTag",{enumerable:!0,get:function(){return Kl.default}}),ql=z,Object.defineProperty(L,"collapseNodes",{enumerable:!0,get:function(){return ql.default}}),Gl=r,Object.defineProperty(L,"contains",{enumerable:!0,get:function(){return Gl.default}}),Zl=se,Object.defineProperty(L,"findClosestElementAncestor",{enumerable:!0,get:function(){return Zl.default}}),Yl=Re,Object.defineProperty(L,"fromHtml",{enumerable:!0,get:function(){return Yl.default}}),$l=ot,Object.defineProperty(L,"getComputedStyles",{enumerable:!0,get:function(){return $l.default}}),Object.defineProperty(L,"getComputedStyle",{enumerable:!0,get:function(){return $l.getComputedStyle}}),Xl=sr,Object.defineProperty(L,"getPendableFormatState",{enumerable:!0,get:function(){return Xl.default}}),Object.defineProperty(L,"PendableFormatCommandMap",{enumerable:!0,get:function(){return Xl.PendableFormatCommandMap}}),Ql=l,Object.defineProperty(L,"getTagOfNode",{enumerable:!0,get:function(){return Ql.default}}),Jl=X,Object.defineProperty(L,"isBlockElement",{enumerable:!0,get:function(){return Jl.default}}),es=cr,Object.defineProperty(L,"isNodeEmpty",{enumerable:!0,get:function(){return es.default}}),ts=ie,Object.defineProperty(L,"isVoidHtmlElement",{enumerable:!0,get:function(){return ts.default}}),ns=gr,Object.defineProperty(L,"matchLink",{enumerable:!0,get:function(){return ns.default}}),rs=mr,Object.defineProperty(L,"queryElements",{enumerable:!0,get:function(){return rs.default}}),os=i,Object.defineProperty(L,"splitParentNode",{enumerable:!0,get:function(){return os.default}}),Object.defineProperty(L,"splitBalancedNodeRange",{enumerable:!0,get:function(){return os.splitBalancedNodeRange}}),is=y,Object.defineProperty(L,"unwrap",{enumerable:!0,get:function(){return is.default}}),as=Oe,Object.defineProperty(L,"wrap",{enumerable:!0,get:function(){return as.default}}),ls=p,Object.defineProperty(L,"getNextLeafSibling",{enumerable:!0,get:function(){return ls.getNextLeafSibling}}),Object.defineProperty(L,"getPreviousLeafSibling",{enumerable:!0,get:function(){return ls.getPreviousLeafSibling}}),ss=Ht,Object.defineProperty(L,"getFirstLeafNode",{enumerable:!0,get:function(){return ss.getFirstLeafNode}}),Object.defineProperty(L,"getLastLeafNode",{enumerable:!0,get:function(){return ss.getLastLeafNode}}),cs=rt,Object.defineProperty(L,"splitTextNode",{enumerable:!0,get:function(){return cs.default}}),ds=Er,Object.defineProperty(L,"normalizeRect",{enumerable:!0,get:function(){return ds.default}}),us=q,Object.defineProperty(L,"toArray",{enumerable:!0,get:function(){return us.default}}),fs=o,Object.defineProperty(L,"safeInstanceOf",{enumerable:!0,get:function(){return fs.default}}),hs=ln,Object.defineProperty(L,"readFile",{enumerable:!0,get:function(){return hs.default}}),ps=Cr,Object.defineProperty(L,"getInnerHTML",{enumerable:!0,get:function(){return ps.default}}),gs=Jn,Object.defineProperty(L,"setColor",{enumerable:!0,get:function(){return gs.default}}),ms=ce,Object.defineProperty(L,"matchesSelector",{enumerable:!0,get:function(){return ms.default}}),vs=u,Object.defineProperty(L,"createElement",{enumerable:!0,get:function(){return vs.default}}),Object.defineProperty(L,"KnownCreateElementData",{enumerable:!0,get:function(){return vs.KnownCreateElementData}}),ys=or,Object.defineProperty(L,"moveChildNodes",{enumerable:!0,get:function(){return ys.default}}),bs=Sr,Object.defineProperty(L,"VTable",{enumerable:!0,get:function(){return bs.default}}),Es=Tr,Object.defineProperty(L,"isWholeTableSelected",{enumerable:!0,get:function(){return Es.default}}),Cs=Nr,Object.defineProperty(L,"VList",{enumerable:!0,get:function(){return Cs.default}}),ws=Vr,Object.defineProperty(L,"VListItem",{enumerable:!0,get:function(){return ws.default}}),Ss=No,Object.defineProperty(L,"createVListFromRegion",{enumerable:!0,get:function(){return Ss.default}}),Ts=g,Object.defineProperty(L,"VListChain",{enumerable:!0,get:function(){return Ts.default}}),Ps=Wr,Object.defineProperty(L,"setListItemStyle",{enumerable:!0,get:function(){return Ps.default}}),Os=C,Object.defineProperty(L,"getRegionsFromRange",{enumerable:!0,get:function(){return Os.default}}),xs=Lo,Object.defineProperty(L,"getSelectedBlockElementsInRegion",{enumerable:!0,get:function(){return xs.default}}),_s=a,Object.defineProperty(L,"collapseNodesInRegion",{enumerable:!0,get:function(){return _s.default}}),Ns=Uo,Object.defineProperty(L,"isNodeInRegion",{enumerable:!0,get:function(){return Ns.default}}),Rs=Io,Object.defineProperty(L,"getSelectionRangeInRegion",{enumerable:!0,get:function(){return Rs.default}}),ks=Ro,Object.defineProperty(L,"mergeBlocksInRegion",{enumerable:!0,get:function(){return ks.default}}),Ls=d,Object.defineProperty(L,"Position",{enumerable:!0,get:function(){return Ls.default}}),Is=oe,Object.defineProperty(L,"createRange",{enumerable:!0,get:function(){return Is.default}}),Ms=Ai,Object.defineProperty(L,"getPositionRect",{enumerable:!0,get:function(){return Ms.default}}),As=Fi,Object.defineProperty(L,"isPositionAtBeginningOf",{enumerable:!0,get:function(){return As.default}}),Ds=Vi,Object.defineProperty(L,"getSelectionPath",{enumerable:!0,get:function(){return Ds.default}}),js=Gi,Object.defineProperty(L,"getHtmlWithSelectionPath",{enumerable:!0,get:function(){return js.default}}),Bs=S,Object.defineProperty(L,"setHtmlWithSelectionPath",{enumerable:!0,get:function(){return Bs.default}}),Object.defineProperty(L,"setHtmlWithMetadata",{enumerable:!0,get:function(){return Bs.setHtmlWithMetadata}}),Fs=T,Object.defineProperty(L,"addRangeToSelection",{enumerable:!0,get:function(){return Fs.default}}),Hs=na,Object.defineProperty(L,"addSnapshot",{enumerable:!0,get:function(){return Hs.default}}),Object.defineProperty(L,"addSnapshotV2",{enumerable:!0,get:function(){return Hs.addSnapshotV2}}),zs=oa,Object.defineProperty(L,"canMoveCurrentSnapshot",{enumerable:!0,get:function(){return zs.default}}),Us=ra,Object.defineProperty(L,"clearProceedingSnapshots",{enumerable:!0,get:function(){return Us.default}}),Object.defineProperty(L,"clearProceedingSnapshotsV2",{enumerable:!0,get:function(){return Us.clearProceedingSnapshotsV2}}),Vs=ua,Object.defineProperty(L,"moveCurrentSnapshot",{enumerable:!0,get:function(){return Vs.default}}),Object.defineProperty(L,"moveCurrentSnapsnot",{enumerable:!0,get:function(){return Vs.moveCurrentSnapsnot}}),Ws=pa,Object.defineProperty(L,"createSnapshots",{enumerable:!0,get:function(){return Ws.default}}),Ks=ga,Object.defineProperty(L,"canUndoAutoComplete",{enumerable:!0,get:function(){return Ks.default}}),qs=ma,Object.defineProperty(L,"HtmlSanitizer",{enumerable:!0,get:function(){return qs.default}}),Gs=va,Object.defineProperty(L,"getInheritableStyles",{enumerable:!0,get:function(){return Gs.default}}),Zs=wi,Object.defineProperty(L,"createDefaultHtmlSanitizerOptions",{enumerable:!0,get:function(){return Zs.default}}),Ys=ba,Object.defineProperty(L,"chainSanitizerCallback",{enumerable:!0,get:function(){return Ys.default}}),$s=P,Object.defineProperty(L,"commitEntity",{enumerable:!0,get:function(){return $s.default}}),Xs=za,Object.defineProperty(L,"getEntityFromElement",{enumerable:!0,get:function(){return Xs.default}}),Qs=Ua,Object.defineProperty(L,"getEntitySelector",{enumerable:!0,get:function(){return Qs.default}}),Js=Va,Object.defineProperty(L,"cacheGetEventData",{enumerable:!0,get:function(){return Js.default}}),ec=Wa,Object.defineProperty(L,"clearEventDataCache",{enumerable:!0,get:function(){return ec.default}}),tc=Ka,Object.defineProperty(L,"isModifierKey",{enumerable:!0,get:function(){return tc.default}}),nc=qa,Object.defineProperty(L,"isCharacterValue",{enumerable:!0,get:function(){return nc.default}}),rc=Za,Object.defineProperty(L,"isCtrlOrMetaPressed",{enumerable:!0,get:function(){return rc.default}}),oc=Kr,Object.defineProperty(L,"getStyles",{enumerable:!0,get:function(){return oc.default}}),ic=w,Object.defineProperty(L,"setStyles",{enumerable:!0,get:function(){return ic.default}}),ac=$a,Object.defineProperty(L,"adjustInsertPosition",{enumerable:!0,get:function(){return ac.default}}),lc=yl,Object.defineProperty(L,"deleteSelectedContent",{enumerable:!0,get:function(){return lc.default}}),sc=cc,Object.defineProperty(L,"getTextContent",{enumerable:!0,get:function(){return sc.default}}),e&&e.__assign||function(){return(uc=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)}),fc=(Object.defineProperty(H,"__esModule",{value:!0}),H.addUndoSnapshot=void 0,t);function hc(e,t){var n,r;e.lifecycle.shadowEditFragment||(n=e.api.getSelectionRangeEx(e),r=e.lifecycle.isDarkMode,r=1==(null==n?void 0:n.type)?uc({type:1,tableId:n.table.id,isDarkMode:r},n.coordinates):uc({type:0,isDarkMode:r,start:[],end:[]},(0,fc.getSelectionPath)(e.contentDiv,n.ranges[0])||{}),e.undo.snapshotsService.addSnapshot({html:e.contentDiv.innerHTML,metadata:r},t),e.undo.hasNewContent=!1)}H.addUndoSnapshot=function(e,t,n,r){var o,i,a=e.undo,l=a.isNested;l||(a.isNested=!0,hc(e,r));try{t&&(o=t((i=e.api.getSelectionRange(e,!0))&&fc.Position.getStart(i).normalize(),i&&fc.Position.getEnd(i).normalize()),l||hc(e,!1))}finally{l||(a.isNested=!1)}t&&n&&e.api.triggerEvent(e,{eventType:7,source:n,data:o},!0),r&&(i=e.api.getSelectionRange(e,!1))&&(e.undo.hasNewContent=!1,e.undo.autoCompletePosition=fc.Position.getStart(i))};var n={},f=(Object.defineProperty(n,"__esModule",{value:!0}),n.attachDomEvent=void 0,n.attachDomEvent=function(a,l){var e=Object.keys(l||{}).map(function(e){n=l[e],r={pluginEventType:null,beforeDispatch:null},"number"==typeof n?r.pluginEventType=n:"function"==typeof n?r.beforeDispatch=n:"object"==typeof n&&(r=n);function t(e){i&&i(e),null!=o&&a.api.triggerEvent(a,{eventType:o,rawEvent:e},!1)}var n,r,o=r.pluginEventType,i=r.beforeDispatch;return a.contentDiv.addEventListener(e,t),function(){a.contentDiv.removeEventListener(e,t)}});return function(){return e.forEach(function(e){return e()})}},{}),pc=(Object.defineProperty(f,"__esModule",{value:!0}),f.createPasteFragment=void 0,t),gc="\x3c!--StartFragment--\x3e",mc="\x3c!--EndFragment--\x3e";function vc(e,t){(0,pc.toArray)(e.querySelectorAll("style")).forEach(t)}f.createPasteFragment=function(e,t,n,r,o){if(!t)return null;var i,a,l={eventType:10,clipboardData:t,fragment:e.contentDiv.ownerDocument.createDocumentFragment(),sanitizingOption:(0,pc.createDefaultHtmlSanitizerOptions)(),htmlBefore:"",htmlAfter:"",htmlAttributes:{}},s=l.fragment,c=l.sanitizingOption,d=t.rawHtml,u=t.text,f=t.imageDataUri,h=e.contentDiv.ownerDocument;if(d&&null!=(p=i=(new DOMParser).parseFromString(e.trustedHTMLHandler(d),"text/html"))&&p.body){var p=null==(p=i.querySelector("html"))?void 0:p.attributes;(p?(0,pc.toArray)(p):[]).reduce(function(e,t){return e[t.name]=t.value,e},l.htmlAttributes),(0,pc.toArray)(i.querySelectorAll("meta")).reduce(function(e,t){return e[t.name]=t.content,e},l.htmlAttributes),t.htmlFirstLevelChildTags=[],null!=i&&i.body.normalize();for(var g=0;g<(null==i?void 0:i.body.childNodes.length);g++){var m,v=null==i?void 0:i.body.childNodes.item(g);v.nodeType==Node.TEXT_NODE&&!v.nodeValue.replace(/(\r\n|\r|\n)/gm,"").trim()||(m=(0,pc.getTagOfNode)(v),v.nodeType!=Node.COMMENT_NODE&&t.htmlFirstLevelChildTags.push(m))}vc(i,function(e){i.head.appendChild(e),c.additionalGlobalStyleNodes.push(e)});var p=d.indexOf(gc),y=d.lastIndexOf(mc);0<=p&&p+gc.length<=y&&(l.htmlBefore=d.substr(0,p),l.htmlAfter=d.substr(y+mc.length),t.html=d.substring(p+gc.length,y),i.body.innerHTML=e.trustedHTMLHandler(t.html),vc(i.body,function(e){var t;return null==(t=e.parentNode)?void 0:t.removeChild(e)}))}r||u||!f?!r&&d&&i&&i.body?((0,pc.moveChildNodes)(s,i.body),o&&n&&(p=e,y=n.node,r=p.api.getPendableFormatState(p,!0),a={fontFamily:(p=p.api.getStyleBasedFormatState(p,y)).fontName,fontSize:p.fontSize,textColor:p.textColor,backgroundColor:p.backgroundColor,textColors:p.textColors,backgroundColors:p.backgroundColors,bold:r.isBold,italic:r.isItalic,underline:r.isUnderline},(0,pc.applyTextStyle)(s,function(e){return(0,pc.applyFormat)(e,a)}))):u&&u.split("\n").forEach(function(e,t,n){e=e.replace(/^ /g," ").replace(/\r/g,"").replace(/ {2}/g,"  ");var r=h.createTextNode(e);2==n.length&&0==t?(s.appendChild(r),s.appendChild(h.createElement("br"))):0<t&&t<n.length-1?s.appendChild((0,pc.wrap)(""==e?h.createElement("br"):r)):s.appendChild(r)}):((d=h.createElement("img")).style.maxWidth="100%",d.src=f,s.appendChild(d)),e.api.triggerEvent(e,l,!0);o=new pc.HtmlSanitizer(l.sanitizingOption);return o.convertGlobalCssToInlineCss(s),o.sanitize(s,n&&(0,pc.getInheritableStyles)(n.element)),s};var c={},yc=(Object.defineProperty(c,"__esModule",{value:!0}),c.ensureTypeInContainer=void 0,t),m=(c.ensureTypeInContainer=function(e,t,n){var r=(0,yc.findClosestElementAncestor)(t.node,e.contentDiv,"table");t=(t=r&&(r=r.querySelector("td,th"))?new yc.Position(r,0):t).normalize();var o,i,r=(0,yc.getBlockElementAtNode)(e.contentDiv,t.node);r?(o=r.collapseToSingleElement(),r=(0,yc.isNodeEmpty)(o)||n&&(r=n,i=o,(0,yc.safeInstanceOf)(r.target,"Node")&&r.target.contains(i)&&r.key===i.innerText),o=o&&r?o:null):(o=(0,yc.createElement)(1,e.contentDiv.ownerDocument),e.api.insertNode(e,o,{position:1,updateCursor:!1,replaceSelection:!1,insertOnNewLine:!1}),t=new yc.Position(o.firstChild,0)),o&&(0,yc.applyFormat)(o,e.lifecycle.defaultFormat,e.lifecycle.isDarkMode),n&&e.api.selectRange(e,(0,yc.createRange)(t))},{}),bc=(Object.defineProperty(m,"__esModule",{value:!0}),m.focus=void 0,t),h=(m.focus=function(e){var t;e.lifecycle.shadowEditFragment||(e.api.hasFocus(e)&&e.api.getSelectionRange(e,!1)||e.domEvent.selectionRange&&e.api.selectRange(e,e.domEvent.selectionRange,!0)||(t=(0,bc.getFirstLeafNode)(e.contentDiv)||e.contentDiv,e.api.selectRange(e,(0,bc.createRange)(t,0),!0)),e.domEvent.selectionRange=null,e.api.hasFocus(e)||e.contentDiv.focus())},{}),Ec=(Object.defineProperty(h,"__esModule",{value:!0}),h.getContent=void 0,t),et=(h.getContent=function(e,t){var n,r,o=0==t,i=2==t,a=e.lifecycle.shadowEditFragment||e.contentDiv;return 4==t?a.textContent:3==t?(0,Ec.getTextContent)(a):o||e.lifecycle.isDarkMode?(t=a,(0,Ec.safeInstanceOf)(t,"DocumentFragment")?(r=t.ownerDocument.createElement("div")).appendChild(t.cloneNode(!0)):r=t.cloneNode(!0),(t=r).normalize(),n=e.api.getSelectionRange(e,!0),n=(n=i?e.lifecycle.shadowEditFragment?e.lifecycle.shadowEditSelectionPath:n?(0,Ec.getSelectionPath)(e.contentDiv,n):null:null)&&(0,Ec.createRange)(t,n.start,n.end),e.lifecycle.isDarkMode&&e.api.transformColor(e,t,!1,null,1),o?(e.api.triggerEvent(e,{eventType:8,clonedRoot:t},!0),t.innerHTML):n?(0,Ec.getHtmlWithSelectionPath)(t,n):t.innerHTML):(0,Ec.getHtmlWithSelectionPath)(a,i&&e.api.getSelectionRange(e,!0))},{}),Cc=(Object.defineProperty(et,"__esModule",{value:!0}),et.getPendableFormatState=void 0,t),wc=(et.getPendableFormatState=function(e,t){var n=e.api.getSelectionRange(e,!0),r=e.pendingFormatState.pendableFormatState,o=null==(o=e.pendingFormatState.pendableFormatPosition)?void 0:o.normalize(),i=n&&Cc.Position.getStart(n).normalize(),o=i&&n.collapsed&&i.equalTo(o);{if(n&&r&&o&&!t)return r;if(i){for(var a=e,l=i.node,s={},c=[];(0,Cc.contains)(a.contentDiv,l);)!function(){var t=(0,Cc.getTagOfNode)(l),n=1==l.nodeType&&l.style;t&&n&&Object.keys(wc).forEach(function(e){0<=c.indexOf(e)||(s[e]=s[e]||wc[e](t,n),Sc[e](n)&&c.push(e))}),l=l.parentNode}();return s}return{}}},{isBold:function(e,t){return"B"==e||"STRONG"==e||700<=parseInt(t.fontWeight)||0<=["bold","bolder"].indexOf(t.fontWeight)},isUnderline:function(e,t){return"U"==e||0<=t.textDecoration.indexOf("underline")},isItalic:function(e,t){return"I"==e||"EM"==e||"italic"===t.fontStyle},isSubscript:function(e,t){return"SUB"==e||"sub"===t.verticalAlign},isSuperscript:function(e,t){return"SUP"==e||"super"===t.verticalAlign},isStrikeThrough:function(e,t){return"S"==e||"STRIKE"==e||0<=t.textDecoration.indexOf("line-through")}}),Sc={isBold:function(e){return""!==e.fontWeight&&parseInt(e.fontWeight)<700||"normal"===e.fontWeight},isUnderline:function(e){return""!==e.textDecoration&&e.textDecoration.indexOf("underline")<0},isItalic:function(e){return""!==e.fontStyle&&"italic"!==e.fontStyle},isSubscript:function(e){return""!==e.verticalAlign&&"sub"!==e.verticalAlign},isSuperscript:function(e){return""!==e.verticalAlign&&"super"!==e.verticalAlign},isStrikeThrough:function(e){return""!==e.textDecoration&&e.textDecoration.indexOf("line-through")<0}},Nt={},Tc=(Object.defineProperty(Nt,"__esModule",{value:!0}),Nt.getSelectionRange=void 0,t),tt=(Nt.getSelectionRange=function(e,t){var n,r=null;return e.lifecycle.shadowEditFragment?e.lifecycle.shadowEditSelectionPath&&(0,Tc.createRange)(e.contentDiv,e.lifecycle.shadowEditSelectionPath.start,e.lifecycle.shadowEditSelectionPath.end):(t&&!e.api.hasFocus(e)||(n=null==(n=e.contentDiv.ownerDocument.defaultView)?void 0:n.getSelection())&&0<n.rangeCount&&(n=n.getRangeAt(0),(0,Tc.contains)(e.contentDiv,n)&&(r=n)),!r&&t?e.domEvent.selectionRange:r)},{}),Pc=(Object.defineProperty(tt,"__esModule",{value:!0}),tt.getSelectionRangeEx=void 0,t);function Oc(e){return{type:0,ranges:e,areAllCollapsed:xc(e)}}function xc(e){return e.filter(function(e){return null==e?void 0:e.collapsed}).length==e.length}tt.getSelectionRangeEx=function(t){if(t.lifecycle.shadowEditFragment){var e=t.lifecycle,n=e.shadowEditTableSelectionPath,e=e.shadowEditSelectionPath;if(0<(null==n?void 0:n.length))return{type:1,ranges:n=t.lifecycle.shadowEditTableSelectionPath.map(function(e){return(0,Pc.createRange)(t.contentDiv,e.start,e.end)}),areAllCollapsed:xc(n),table:(0,Pc.findClosestElementAncestor)(n[0].startContainer,t.contentDiv,"table"),coordinates:null};var n=e&&(0,Pc.createRange)(t.contentDiv,e.start,e.end);return Oc(n?[n]:[])}if(t.api.hasFocus(t)){if(t.domEvent.tableSelectionRange)return t.domEvent.tableSelectionRange;n=null==(e=t.contentDiv.ownerDocument.defaultView)?void 0:e.getSelection();if(n&&0<n.rangeCount){e=n.getRangeAt(0);if((0,Pc.contains)(t.contentDiv,e))return Oc([e])}}return null!=(n=t.domEvent.tableSelectionRange)?n:Oc(t.domEvent.selectionRange?[t.domEvent.selectionRange]:[])};var en={},_c=(Object.defineProperty(en,"__esModule",{value:!0}),en.getStyleBasedFormatState=void 0,t),nt=(en.getStyleBasedFormatState=function(e,t){if(!t)return{};var n=t?(0,_c.getComputedStyles)(t):[],r=e.lifecycle.isDarkMode,e=e.contentDiv,o=r&&(0,_c.findClosestElementAncestor)(t,e,"[data-ogsc],[data-ogac]"),r=r&&(0,_c.findClosestElementAncestor)(t,e,"[data-ogsb],[data-ogab]");return{fontName:n[0],fontSize:n[1],textColor:n[2],backgroundColor:n[3],textColors:o?{darkModeColor:n[2],lightModeColor:o.dataset.ogsc||o.dataset.ogac}:void 0,backgroundColors:r?{darkModeColor:n[3],lightModeColor:r.dataset.ogsb||r.dataset.ogab}:void 0}},{}),Nc=(Object.defineProperty(nt,"__esModule",{value:!0}),nt.hasFocus=void 0,t),Je=(nt.hasFocus=function(e){var t=e.contentDiv.ownerDocument.activeElement;return t&&(0,Nc.contains)(e.contentDiv,t,!0)},{}),Rc=(Object.defineProperty(Je,"__esModule",{value:!0}),Je.insertNode=void 0,t),Qt=(Je.insertNode=function(l,s,c){c=c||{position:3,insertOnNewLine:!1,updateCursor:!0,replaceSelection:!0};var d=l.contentDiv;return c.updateCursor&&l.api.focus(l),4==c.position?d.parentNode.insertBefore(s,d.nextSibling):l.api.transformColor(l,s,!0,function(){switch(c.position){case 0:case 1:var e=0==c.position,t=(0,Rc.getFirstLastBlockElement)(d,e);t?(t=e?t.getStartNode():t.getEndNode(),c.insertOnNewLine||3==t.nodeType||(0,Rc.isVoidHtmlElement)(t)?(0,Rc.safeInstanceOf)(s,"DocumentFragment")?(a=(0,Rc.toArray)(s.childNodes),t.parentNode.insertBefore(s,e?t:t.nextSibling)):a=t.parentNode.insertBefore(s,e?t:t.nextSibling):a=t.insertBefore(s,e?t.firstChild:null)):a=d.appendChild(s),a&&c.insertOnNewLine&&(e=Array.isArray(a)?a:[a],(0,Rc.isBlockElement)(e[0])&&(0,Rc.isBlockElement)(e[e.length-1])||(0,Rc.wrap)(e));break;case 2:t=d.appendChild(s);t&&c.insertOnNewLine&&!(0,Rc.isBlockElement)(t)&&(0,Rc.wrap)(t);break;case 5:case 3:a=c,e=(e=l).api.getSelectionRange(e,!0),t=null,5==a.position?(t=e,e=a.range):e&&(t=e.cloneRange());var n={range:e,rangeToRestore:t},r=n.range,n=n.rangeToRestore;if(!r)return;c.replaceSelection&&!r.collapsed&&r.deleteContents();var o=Rc.Position.getStart(r),i=void 0,o=c.insertOnNewLine&&(i=(0,Rc.getBlockElementAtNode)(d,o.normalize().node))?new Rc.Position(i.getEndNode(),-3):(0,Rc.adjustInsertPosition)(d,s,o,r),i=11==s.nodeType?s.lastChild:s;(r=(0,Rc.createRange)(o)).insertNode(s),c.updateCursor&&i&&(n=(0,Rc.createRange)(new Rc.Position(i,-3).normalize())),l.api.selectRange(l,n)}var a},0),!0},{}),v=(Object.defineProperty(Qt,"__esModule",{value:!0}),Qt.restoreUndoSnapshot=void 0,Qt.restoreUndoSnapshot=function(e,t){e.undo.hasNewContent&&t<0&&e.api.addUndoSnapshot(e,null,null,!1);t=e.undo.snapshotsService.move(t);if(t&&null!=t.html)try{e.undo.isRestoring=!0,e.api.setContent(e,t.html,!0,t.metadata)}finally{e.undo.isRestoring=!1}},{}),kc=(Object.defineProperty(v,"__esModule",{value:!0}),v.selectRange=void 0,nt),Lc=t,s=(v.selectRange=function(e,t,n){return!(e.lifecycle.shadowEditSelectionPath||!(0,Lc.contains)(e.contentDiv,t)||((0,Lc.addRangeToSelection)(t,n),(0,kc.hasFocus)(e)||(e.domEvent.selectionRange=t),t.collapsed&&(t=(n=e).contentDiv,i=n.pendingFormatState,e=n.api.getSelectionRange,i.pendableFormatState&&(r=t.ownerDocument,o=(0,Lc.getPendableFormatState)(r),Object.keys(Lc.PendableFormatCommandMap).forEach(function(e){!!i.pendableFormatState[e]!=o[e]&&r.execCommand(Lc.PendableFormatCommandMap[e],!1,null)}),t=e(n,!0),i.pendableFormatPosition=t&&Lc.Position.getStart(t))),0));var r,o,i},{}),Ic=(Object.defineProperty(s,"__esModule",{value:!0}),s.selectTable=void 0,t),Mc="tableStyle";function Ac(e,t){var n=e.ownerDocument;if(e.id)1<n.querySelectorAll("#"+e.id).length&&(e.removeAttribute("id"),Ac(e,t));else{for(var r=0,o=function(){return n.getElementById(t+r)},i=o();i;)i=o(),r++;e.id=t+r}}function Dc(e){return(!!e||0==e)&&-1<e}s.selectTable=function(e,t,r){var n,c,d,u,f,h,p,g,m,v,y,b,o,E,i,a,l,s=e.contentDiv,C=s.ownerDocument.getElementById(Mc+s.id);if(null!=(s=null==C?void 0:C.sheet)&&s.cssRules)for(;0<C.sheet.cssRules.length;)C.sheet.deleteRule(0);return function(){if(r){var e,t=r||{},n=t.firstCell,t=t.lastCell;if(n&&t)return(e=function(e){return Dc(e.x)&&Dc(e.y)})(n)&&e(t)}}()&&t?(Ac(t,"tableSelected"),Ac(e.contentDiv,"contentDiv_"),s=r,i=(n=e).contentDiv.ownerDocument,a="#"+n.contentDiv.id,c=t,d=a,u=s.firstCell.y,f=s.firstCell.x,h=s.lastCell.y,p=s.lastCell.x,g=[],v=m=null,b=!(y=""),a=new Ic.VTable(c),s=(0,Ic.toArray)(c.childNodes).filter(function(e){return-1<["THEAD","TBODY","TFOOT"].indexOf((0,Ic.getTagOfNode)(e))}),o=0,E=s.map(function(e){e={el:(0,Ic.getTagOfNode)(e),start:o,end:e.childNodes.length+o};return o=e.end,e}),a.cells.forEach(function(e,t){var n=0,r=0;v=m=null;for(var o,i=E.filter(function(e){return e.start<=t&&e.end>t})[0],a=i?">"+i.el+">":">",l=i&&t+1>=i.start?t+1-i.start:t+1,s=0;s<e.length;s++)e[s].td&&("TD"==(o=(0,Ic.getTagOfNode)(e[s].td))&&n++,"TH"==o&&r++,u<=t&&t<=h&&f<=s&&s<=p&&(b?b=!1:y.endsWith(",")||(y+=","),function(e){var n,r;e&&(n=(0,Ic.getStyles)(e),r=0,["background-color","background"].forEach(function(e){var t;-1<(null==(t=n[e])?void 0:t.indexOf("!important"))&&(t=n[e].indexOf("!"),n[e]=n[e].substring(0,t),r++)}),0<r&&(0,Ic.setStyles)(e,n))}(e[s].td),o=d+" #"+c.id+a+" tr:nth-child("+l+")>"+o+":nth-child("+("TD"==o?n:r)+")",y+=o,m=m||c.querySelector(o),v=c.querySelector(o)));m&&v&&((i=new Range).setStartBefore(m),i.setEndAfter(v),g.push(i))}),s={css:y+="{background-color: rgba(198,198,198,0.7) !important;}",ranges:g},a=s.css,s=s.ranges,(l=i.getElementById(Mc+n.contentDiv.id))||(l=i.createElement("style"),i.head.appendChild(l),l.id=Mc+n.contentDiv.id),l.sheet.insertRule(a),i=s,n=t,l=r.firstCell,n.rows.item(l.y)&&n.rows.item(l.y).cells.item(l.x)&&e.api.selectRange(e,(0,Ic.createRange)(new Ic.Position(t.rows.item(r.firstCell.y).cells.item(r.firstCell.x),0))),{type:1,ranges:i,table:t,areAllCollapsed:i.filter(function(e){return null==e?void 0:e.collapsed}).length==i.length,coordinates:r}):null};var xe={},jc=(Object.defineProperty(xe,"__esModule",{value:!0}),xe.setContent=void 0,t),Bc=t,Qn=(xe.setContent=function(e,t,n,r){var o=!1;if(e.contentDiv.innerHTML!=t){e.api.triggerEvent(e,{eventType:20,newContent:t},!0);var t=(0,Bc.setHtmlWithMetadata)(e.contentDiv,t,e.trustedHTMLHandler),i=e,a=r=r||t;switch(null==a?void 0:a.type){case 0:var l=(0,jc.createRange)(i.contentDiv,a.start,a.end);i.api.selectRange(i,l);break;case 1:l=(0,jc.queryElements)(i.contentDiv,"#"+a.tableId)[0];l&&i.api.selectTable(i,l,a)}o=!0}t=e.lifecycle.isDarkMode;(!r&&t||r&&!!r.isDarkMode!=!!t)&&(e.api.transformColor(e,e.contentDiv,!1,null,t?0:1,!0),o=!0),n&&o&&e.api.triggerEvent(e,{eventType:7,source:"SetContent"},!1)},{}),Fc=(Object.defineProperty(Qn,"__esModule",{value:!0}),Qn.switchShadowEdit=void 0,t);Qn.switchShadowEdit=function(e,t){var n,r=e.lifecycle,o=e.contentDiv,i=r.shadowEditFragment,a=r.shadowEditSelectionPath,l=r.shadowEditTableSelectionPath,s=!!i;t?(s||(t=e.api.getSelectionRangeEx(e),a=(n=e.api.getSelectionRange(e,!0))&&(0,Fc.getSelectionPath)(o,n),l=1==(null==t?void 0:t.type)&&t.ranges.map(function(e){return(0,Fc.getSelectionPath)(o,e)}),i=e.contentDiv.ownerDocument.createDocumentFragment(),(0,Fc.moveChildNodes)(i,o),i.normalize(),e.api.triggerEvent(e,{eventType:17,fragment:i,selectionPath:a},!1),r.shadowEditFragment=i,r.shadowEditSelectionPath=a,r.shadowEditTableSelectionPath=l),(0,Fc.moveChildNodes)(o),o.appendChild(r.shadowEditFragment.cloneNode(!0))):(r.shadowEditFragment=null,r.shadowEditSelectionPath=null,s&&(e.api.triggerEvent(e,{eventType:18},!1),(0,Fc.moveChildNodes)(o),o.appendChild(i),e.api.focus(e),a&&e.api.selectRange(e,(0,Fc.createRange)(o,a.start,a.end)),e.domEvent.tableSelectionRange)&&(t=(n=e.domEvent.tableSelectionRange).table,l=n.coordinates,r=t.id,s=e.contentDiv.querySelector("#"+r),t&&(e.domEvent.tableSelectionRange=e.api.selectTable(e,s,l))))};rr={};Object.defineProperty(rr,"__esModule",{value:!0}),rr.transformColor=void 0;var Hc=t,zc=(0,[((z={})[0]="color",z[1]="color",z[2]="ogsc",z[3]="ogac",z),((r={})[0]="background-color",r[1]="bgcolor",r[2]="ogsb",r[3]="ogab",r)]);function Uc(e,t){return e&&"undefined"!=e&&"null"!=e?e:t}function Vc(e){return!!e.style&&!!e.dataset}rr.transformColor=function(t,e,n,r,o,i){var a,l,s,e=i||t.lifecycle.isDarkMode?(i=e,e=n,n=[],(0,Hc.safeInstanceOf)(i,"HTMLElement")?(e&&n.push(i),a=i.getElementsByTagName("*"),(0,Hc.arrayPush)(n,(0,Hc.toArray)(a))):(0,Hc.safeInstanceOf)(i,"DocumentFragment")&&(a=i.querySelectorAll("*"),(0,Hc.arrayPush)(n,(0,Hc.toArray)(a))),n.filter(Vc)):[];null!=r&&r(),1==o?e.forEach(function(n){zc.forEach(function(e){n.style.setProperty(e[0],Uc(n.dataset[e[2]],"")),delete n.dataset[e[2]];var t=n.dataset[e[3]];Uc(t,null)?n.setAttribute(e[1],t):n.removeAttribute(e[1]),delete n.dataset[e[3]]})}):t.lifecycle.onExternalContentTransform?e.forEach(function(e){return t.lifecycle.onExternalContentTransform(e)}):(l=e,s=t.lifecycle.getDarkColor,zc.forEach(function(i){l.map(function(e){var t=e.style.getPropertyValue(i[0]),n=e.getAttribute(i[1]),r=e.dataset[i[2]],o=e.dataset[i[3]];return r&&r!=t||o&&o!=n||!t&&!n||"inherit"==t?null:{element:e,styleColor:t,attrColor:n,newColor:s(t||n)}}).filter(function(e){return!!e}).forEach(function(e){var t=e.element,n=e.styleColor,r=e.attrColor,e=e.newColor;t.style.setProperty(i[0],e,"important"),t.dataset[i[2]]=n||"",r&&(t.setAttribute(i[1],e),t.dataset[i[3]]=r)})}))};var se={},Wc=(Object.defineProperty(se,"__esModule",{value:!0}),se.triggerEvent=void 0,[11,12,8,21]),Re=(se.triggerEvent=function(e,r,t){e.lifecycle.shadowEditFragment&&!(0<=Wc.indexOf(r.eventType))||!t&&e.plugins.some(function(e){return t=r,!(!(e=e).onPluginEvent||null==(n=e.willHandleEventExclusively)||!n.call(e,t))&&(e.onPluginEvent(t),!0);var t,n})||e.plugins.forEach(function(e){e.onPluginEvent&&e.onPluginEvent(r)})},Object.defineProperty(F,"__esModule",{value:!0}),F.coreApiMap=void 0,H),ot=(F.coreApiMap={attachDomEvent:n.attachDomEvent,addUndoSnapshot:Re.addUndoSnapshot,createPasteFragment:f.createPasteFragment,ensureTypeInContainer:c.ensureTypeInContainer,focus:m.focus,getContent:h.getContent,getSelectionRange:Nt.getSelectionRange,getSelectionRangeEx:tt.getSelectionRangeEx,getStyleBasedFormatState:en.getStyleBasedFormatState,getPendableFormatState:et.getPendableFormatState,hasFocus:nt.hasFocus,insertNode:Je.insertNode,restoreUndoSnapshot:Qt.restoreUndoSnapshot,selectRange:v.selectRange,setContent:xe.setContent,switchShadowEdit:Qn.switchShadowEdit,transformColor:rr.transformColor,triggerEvent:se.triggerEvent,selectTable:s.selectTable},{}),sr={},Kc=(Object.defineProperty(sr,"__esModule",{value:!0}),t);function qc(e){var n=this;this.onPaste=function(e){var t;(0,Kc.extractClipboardEvent)(e,function(e){return n.editor.paste(e)},{allowLinkPreview:n.editor.isFeatureEnabled("PasteWithLinkPreview"),allowedCustomPasteType:n.state.allowedCustomPasteType,getTempDiv:function(){return t=n.editor.getSelectionRange(),n.getTempDiv()},removeTempDiv:function(e){n.cleanUpAndRestoreSelection(e,t,!1)}})},this.state={allowedCustomPasteType:e.allowedCustomPasteType||[]}}qc.prototype.getName=function(){return"CopyPaste"},qc.prototype.initialize=function(e){var t=this;this.editor=e,this.disposer=this.editor.addDomEventHandler({paste:this.onPaste,copy:function(e){return t.onCutCopy(e,!1)},cut:function(e){return t.onCutCopy(e,!0)}})},qc.prototype.dispose=function(){this.disposer(),this.disposer=null,this.editor=null},qc.prototype.getState=function(){return this.state},qc.prototype.onCutCopy=function(e,n){var r,t,o=this,i=this.editor.getSelectionRangeEx();i&&!i.areAllCollapsed&&(t=this.editor.getContent(2),r=this.getTempDiv(!0),(t=(0,Kc.setHtmlWithSelectionPath)(r,t,this.editor.getTrustedHTMLHandler()))&&(0,Kc.addRangeToSelection)(t),this.editor.triggerPluginEvent(9,{clonedRoot:r,range:t,rawEvent:e,isCut:n}),this.editor.runAsync(function(t){o.cleanUpAndRestoreSelection(r,i,!n),n&&t.addUndoSnapshot(function(){var e=o.editor.deleteSelectedContent();t.focus(),t.select(e)},"Cut")}))},qc.prototype.getTempDiv=function(e){var t=this,n=this.editor.getCustomData("CopyPasteTempDiv",function(){var e=(0,Kc.createElement)(3,t.editor.getDocument());return t.editor.insertNode(e,{position:4}),e},function(e){var t;return null==(t=e.parentNode)?void 0:t.removeChild(e)});return e&&(n.style.backgroundColor="white",n.style.color="black"),n.style.display="",n.focus(),n},qc.prototype.cleanUpAndRestoreSelection=function(e,t,n){var r;if(null!=(r=t)&&r.type||0==t.type){var o=t;switch(o.type){case 1:this.editor.select(o.table,o.coordinates);break;case 0:var i=null==(i=o.ranges)?void 0:i[0];this.restoreRange(i,n)}}else this.restoreRange(t,n);e.style.backgroundColor="",e.style.color="",e.style.display="none",(0,Kc.moveChildNodes)(e)},qc.prototype.restoreRange=function(e,t){e&&(t&&Kc.Browser.isAndroid&&e.collapse(),this.editor.select(e))},sr.default=qc;var l={},Gc=(Object.defineProperty(l,"__esModule",{value:!0}),t);function Zc(e,t){var o=this;this.onDrop=function(e){o.editor.runAsync(function(e){e.addUndoSnapshot(function(){},"Drop")})},this.onFocus=function(){var e=o.state.tableSelectionRange||{},t=e.table,e=e.coordinates;t&&e?o.editor.select(t,e):o.editor.select(o.state.selectionRange),o.state.selectionRange=null},this.onKeyDownDocument=function(e){9!=e.which||e.defaultPrevented||o.cacheSelection()},this.onMouseDownDocument=function(e){o.state.selectionRange||o.editor.contains(e.target)||o.cacheSelection()},this.cacheSelection=function(){o.state.selectionRange||(o.state.selectionRange=o.editor.getSelectionRange(!1))},this.onScroll=function(e){o.editor.triggerPluginEvent(14,{rawEvent:e,scrollContainer:o.state.scrollContainer})},this.onKeyboardEvent=function(e){(0,Gc.isCharacterValue)(e)&&e.stopPropagation()},this.onInputEvent=function(e){e.stopPropagation()},this.onContextMenuEvent=function(e){var t=[],n=o.editor.getContentSearcherOfCursor(),n=null==n?void 0:n.getInlineElementBefore(),r=e.target;2!=e.button&&(r=null==n?void 0:n.getContainerNode()),o.state.contextMenuProviders.forEach(function(e){e=e.getContextMenuItems(r);0<(null==e?void 0:e.length)&&(0<t.length&&t.push(null),(0,Gc.arrayPush)(t,e))}),o.editor.triggerPluginEvent(16,{rawEvent:e,items:t})},this.state={isInIME:!1,scrollContainer:e.scrollContainer||t,selectionRange:null,stopPrintableKeyboardEventPropagation:!e.allowKeyboardEventPropagation,contextMenuProviders:(null==(t=e.plugins)?void 0:t.filter(Yc))||[],tableSelectionRange:null}}function Yc(e){return!(null==(e=e)||!e.getContextMenuItems)}Zc.prototype.getName=function(){return"DOMEvent"},Zc.prototype.initialize=function(t){var e,n,r=this,o=(this.editor=t,this.editor.getDocument());(n={keypress:this.getEventHandler(1),keydown:this.getEventHandler(0),keyup:this.getEventHandler(2),mousedown:5,contextmenu:this.onContextMenuEvent,compositionstart:function(){return r.state.isInIME=!0},compositionend:function(e){r.state.isInIME=!1,t.triggerPluginEvent(4,{rawEvent:e})},drop:this.onDrop,focus:this.onFocus})[Gc.Browser.isIE?"textinput":"input"]=this.getEventHandler(3);Gc.Browser.isSafari?(o.addEventListener("mousedown",this.onMouseDownDocument,!0),o.addEventListener("keydown",this.onKeyDownDocument),null!=(e=o.defaultView)&&e.addEventListener("blur",this.cacheSelection)):n[Gc.Browser.isIEOrEdge?"beforedeactivate":"blur"]=this.cacheSelection,this.disposer=t.addDomEventHandler(n),this.state.scrollContainer.addEventListener("scroll",this.onScroll),null!=(e=o.defaultView)&&e.addEventListener("scroll",this.onScroll),null!=(n=o.defaultView)&&n.addEventListener("resize",this.onScroll)},Zc.prototype.dispose=function(){var e,t=this.editor.getDocument();Gc.Browser.isSafari&&(t.removeEventListener("mousedown",this.onMouseDownDocument,!0),t.removeEventListener("keydown",this.onKeyDownDocument),null!=(e=t.defaultView)&&e.removeEventListener("blur",this.cacheSelection)),null!=(e=t.defaultView)&&e.removeEventListener("resize",this.onScroll),null!=(e=t.defaultView)&&e.removeEventListener("scroll",this.onScroll),this.state.scrollContainer.removeEventListener("scroll",this.onScroll),this.disposer(),this.disposer=null,this.editor=null},Zc.prototype.getState=function(){return this.state},Zc.prototype.getEventHandler=function(e){return this.state.stopPrintableKeyboardEventPropagation?{pluginEventType:e,beforeDispatch:3==e?this.onInputEvent:this.onKeyboardEvent}:e},l.default=Zc;var X={},$c=(Object.defineProperty(X,"__esModule",{value:!0}),t);function Xc(){this.state={features:{}}}Xc.prototype.getName=function(){return"Edit"},Xc.prototype.initialize=function(e){this.editor=e},Xc.prototype.dispose=function(){this.editor=null},Xc.prototype.getState=function(){return this.state},Xc.prototype.onPluginEvent=function(e){var t,n,r,o=!1,i=!1;0==e.eventType?(t=e.rawEvent,n=this.editor.getSelectionRange(),o=(i=(0,$c.isCtrlOrMetaPressed)(t))||t.altKey,r=this.state.features[t.which]||n&&!n.collapsed&&this.state.features[258]):7==e.eventType&&(r=this.state.features[257]);for(var a=0;a<(null==r?void 0:r.length);a++){var l=r[a];if((l.allowFunctionKeys||!o)&&l.shouldHandleEvent(e,this.editor,i)){l.handleEvent(e,this.editor);break}}},X.default=Xc;var cr={},O=(Object.defineProperty(cr,"__esModule",{value:!0}),t),Qc=/_(\d{1,8})$/,Jc=["^_Entity$","^_EId_","^_EType_","^_EReadonly_"],ed=[6,7,4,5];function x(){var n=this;this.handleCutEvent=function(e){var t=n.editor.getSelectionRange();t&&!t.collapsed&&n.checkRemoveEntityForRange(e)},this.state={knownEntityElements:[],shadowEntityCache:{}}}x.prototype.getName=function(){return"Entity"},x.prototype.initialize=function(e){this.editor=e},x.prototype.willHandleEventExclusively=function(e){return 1==e.eventType&&!(null==(e=e.rawEvent.target)||!e.shadowRoot)},x.prototype.dispose=function(){this.editor=null,this.state.knownEntityElements=[]},x.prototype.getState=function(){return this.state},x.prototype.onPluginEvent=function(e){switch(e.eventType){case 6:this.handleMouseUpEvent(e);break;case 0:this.handleKeyDownEvent(e.rawEvent);break;case 9:e.isCut&&this.handleCutEvent(e.rawEvent);break;case 10:this.handleBeforePasteEvent(e.sanitizingOption);break;case 7:this.handleContentChangedEvent(e);break;case 11:this.handleContentChangedEvent();break;case 8:this.handleExtractContentWithDomEvent(e.clonedRoot);break;case 16:this.handleContextMenuEvent(e.rawEvent);break;case 20:this.handleBeforeSetContentEvent();break;case 15:this.handleEntityOperationEvent(e)}},x.prototype.handleContextMenuEvent=function(e){var t=e.target,t=t&&this.editor.getElementAtCursor((0,O.getEntitySelector)(),t);t&&(e.preventDefault(),this.triggerEvent(t,2,e))},x.prototype.handleMouseUpEvent=function(e){var t=e.rawEvent,e=e.isClicking,n=t.target;e&&n&&(e=this.editor.getElementAtCursor((0,O.getEntitySelector)(),n))&&(this.triggerEvent(e,1,t),td(this.editor))},x.prototype.handleKeyDownEvent=function(e){var t;!(0,O.isCharacterValue)(e)&&8!=e.which&&46!=e.which&&13!=e.which||(t=this.editor.getSelectionRange())&&!t.collapsed&&this.checkRemoveEntityForRange(e)},x.prototype.handleBeforePasteEvent=function(e){this.editor.getSelectionRange().collapsed||this.checkRemoveEntityForRange(null),(0,O.arrayPush)(e.additionalAllowedCssClasses,Jc)},x.prototype.handleBeforeSetContentEvent=function(){this.cacheShadowEntities(this.state.shadowEntityCache)},x.prototype.handleContentChangedEvent=function(e){for(var i=this,t=this.state.knownEntityElements.length-1;0<=t;t--){var n=this.state.knownEntityElements[t];this.editor.contains(n)||(this.setIsEntityKnown(n,!1),n.shadowRoot&&this.triggerEvent(n,10))}var a=this.state.knownEntityElements.map(function(e){return null==(e=(0,O.getEntityFromElement)(e))?void 0:e.id}).filter(function(e){return!!e});("InsertEntity"==(null==e?void 0:e.source)&&e.data?[e.data]:this.getExistingEntities().filter(function(e){e=e.wrapper;return!i.isEntityKnown(e)})).forEach(function(e){var t=e.wrapper,n=e.type,r=e.id,o=e.isReadonly;e.id=i.ensureUniqueId(n,r,a),(0,O.commitEntity)(t,n,o,e.id),i.handleNewEntity(e)}),Object.keys(this.state.shadowEntityCache).forEach(function(e){i.triggerEvent(i.state.shadowEntityCache[e],6),delete i.state.shadowEntityCache[e]})},x.prototype.handleEntityOperationEvent=function(e){var t=this;0<=ed.indexOf(e.operation)&&(null!=(e=this.cancelAsyncRun)&&e.call(this),this.cancelAsyncRun=this.editor.runAsync(function(){t.cancelAsyncRun=null,t.handleContentChangedEvent()}))},x.prototype.handleExtractContentWithDomEvent=function(e){var t=this;(0,O.toArray)(e.querySelectorAll((0,O.getEntitySelector)())).forEach(function(e){e.removeAttribute("contentEditable"),t.triggerEvent(e,8)})},x.prototype.checkRemoveEntityForRange=function(n){var r,o=this,t=[],e=(0,O.getEntitySelector)();this.editor.queryElements(e,1,function(e){e.isContentEditable?t.push(e):o.triggerEvent(e,6,n)}),0<t.length&&(r=this.editor.queryElements(e,2),t.forEach(function(e){var t=0<=r.indexOf(e);o.triggerEvent(e,t?6:7,n)}))},x.prototype.triggerEvent=function(e,t,n,r){e=e&&(0,O.getEntityFromElement)(e);e&&this.editor.triggerPluginEvent(15,{operation:t,rawEvent:n,entity:e,contentForShadowEntity:r})},x.prototype.handleNewEntity=function(e){var t=e.wrapper,n=this.editor.getDocument().createDocumentFragment(),r=this.state.shadowEntityCache[e.id];delete this.state.shadowEntityCache[e.id],null!=r&&r.shadowRoot&&(0,O.moveChildNodes)(n,r.shadowRoot),this.triggerEvent(t,0,void 0,n),n.firstChild?t.shadowRoot?(0,O.moveChildNodes)(t.shadowRoot,n):this.createShadowRoot(t,n):t.shadowRoot&&(this.triggerEvent(t,10),r=t.cloneNode(),(0,O.moveChildNodes)(r,t),this.editor.replaceNode(t,r),e.wrapper=r),this.setIsEntityKnown(e.wrapper,!0)},x.prototype.getExistingEntities=function(t){return this.editor.queryElements((0,O.getEntitySelector)()).map(O.getEntityFromElement).filter(function(e){return!(!e||t&&!e.wrapper.shadowRoot)})},x.prototype.createShadowRoot=function(e,t){var n;if(e.attachShadow)return n=e.attachShadow({mode:"open",delegatesFocus:!0}),e.contentEditable="false",this.triggerEvent(e,9),(0,O.moveChildNodes)(n,t),n},x.prototype.cacheShadowEntities=function(n){this.getExistingEntities(!0).forEach(function(e){var t=e.wrapper,e=e.id;n[e]=t})},x.prototype.ensureUniqueId=function(e,t,n){for(var r=Qc.exec(t),o=(r?t.substr(0,t.length-r[0].length):t)||e,i="",a=r&&parseInt(r[1])||0;;a++)if(n.indexOf(i=0<a?o+"_"+a:o)<0){n.push(i);break}return i},x.prototype.setIsEntityKnown=function(e,t){var n=this.state.knownEntityElements.indexOf(e);t&&n<0?this.state.knownEntityElements.push(e):!t&&0<=n&&this.state.knownEntityElements.splice(n,1)},x.prototype.isEntityKnown=function(e){return 0<=this.state.knownEntityElements.indexOf(e)},cr.default=x;var td=O.Browser.isIE?function(e){e.runAsync(function(t){var e=t.getCustomData("ENTITY_IE_FOCUS_BUTTON",function(){var e=(0,O.createElement)({tag:"button",style:"overflow:hidden;position:fixed;width:0;height:0;top:-1000px"},t.getDocument());return e.onblur=function(){e.style.display="none"},t.insertNode(e,{position:4}),e});(e.style.display="",O.addRangeToSelection)((0,O.createRange)(e,0))})}:function(){},ie={},nd=(Object.defineProperty(ie,"__esModule",{value:!0}),t),rd="contenteditable",od=nd.Browser.isFirefox?((gr={}).enableObjectResizing=!1,gr.enableInlineTableEditing=!1,gr):nd.Browser.isIE?((mr={}).defaultParagraphSeparator="div",mr.AutoUrlDetect=!1,mr):{},id={darkModeColor:"rgb(51,51,51)",lightModeColor:"rgb(255,255,255)"},ad={darkModeColor:"rgb(255,255,255)",lightModeColor:"rgb(0,0,0)"};function ld(e,n){var r=this;this.initialContent=e.initialContent||n.innerHTML||"",this.contentDivFormat=(0,nd.getComputedStyles)(n),null===n.getAttribute(rd)&&(this.initializer=function(){n.contentEditable="true",n.style.userSelect="text",n.style.webkitUserSelect="text"},this.disposer=function(){n.style.userSelect="",n.style.webkitUserSelect="",n.removeAttribute(rd)}),this.adjustColor=e.doNotAdjustEditorColor?function(){}:function(){var e=id,t=r.state.isDarkMode;(0,nd.setColor)(n,ad,!1,t),(0,nd.setColor)(n,e,!0,t)},this.state={customData:{},defaultFormat:e.defaultFormat||null,isDarkMode:!!e.inDarkMode,getDarkColor:e.getDarkColor||function(e){return e},onExternalContentTransform:e.onExternalContentTransform,experimentalFeatures:e.experimentalFeatures||[],shadowEditFragment:null,shadowEditSelectionPath:null,shadowEditTableSelectionPath:null}}ld.prototype.getName=function(){return"Lifecycle"},ld.prototype.initialize=function(e){this.editor=e,this.recalculateDefaultFormat(),this.editor.setContent(this.initialContent,!1),null!=(e=this.initializer)&&e.call(this),this.adjustColor(),this.adjustBrowserBehavior(),this.editor.triggerPluginEvent(11,{},!0)},ld.prototype.dispose=function(){var n=this;this.editor.triggerPluginEvent(12,{},!0),Object.keys(this.state.customData).forEach(function(e){var t=n.state.customData[e];t&&t.disposer&&t.disposer(t.value),delete n.state.customData[e]}),this.disposer&&(this.disposer(),this.disposer=null,this.initializer=null),this.editor=null},ld.prototype.getState=function(){return this.state},ld.prototype.onPluginEvent=function(e){7!=e.eventType||"SwitchToDarkMode"!=e.source&&"SwitchToLightMode"!=e.source||(this.state.isDarkMode="SwitchToDarkMode"==e.source,this.recalculateDefaultFormat(),this.adjustColor())},ld.prototype.adjustBrowserBehavior=function(){var t=this;Object.keys(od).forEach(function(e){try{t.editor.getDocument().execCommand(e,!1,od[e])}catch(e){}})},ld.prototype.recalculateDefaultFormat=function(){var e,t,n,r,o,i,a,l,s=this.state,c=s.defaultFormat,d=s.isDarkMode;d&&c&&(c.backgroundColors||(c.backgroundColors=id),c.textColors||(c.textColors=ad)),c&&0===Object.keys(c).length||(c=(s=c||{}).fontFamily,e=s.fontSize,t=s.textColor,n=s.textColors,r=s.backgroundColor,o=s.backgroundColors,i=s.bold,a=s.italic,s=s.underline,l=this.contentDivFormat,this.state.defaultFormat={fontFamily:c||l[0],fontSize:e||l[1],get textColor(){return n?d?n.darkModeColor:n.lightModeColor:t||l[2]},textColors:n,get backgroundColor(){return o?d?o.darkModeColor:o.lightModeColor:r||""},backgroundColors:o,bold:i,italic:a,underline:s})},ie.default=ld;i={};function sd(){var t=this;this.onMouseUp=function(e){t.editor&&(t.removeMouseUpEventListener(),t.editor.triggerPluginEvent(6,{rawEvent:e,isClicking:t.mouseDownX==e.pageX&&t.mouseDownY==e.pageY}))}}Object.defineProperty(i,"__esModule",{value:!0}),sd.prototype.getName=function(){return"MouseUp"},sd.prototype.initialize=function(e){this.editor=e},sd.prototype.dispose=function(){this.removeMouseUpEventListener(),this.editor=null},sd.prototype.onPluginEvent=function(e){5!=e.eventType||this.mouseUpEventListerAdded||(this.editor.getDocument().addEventListener("mouseup",this.onMouseUp,!0),this.mouseUpEventListerAdded=!0,this.mouseDownX=e.rawEvent.pageX,this.mouseDownY=e.rawEvent.pageY)},sd.prototype.removeMouseUpEventListener=function(){this.mouseUpEventListerAdded&&(this.mouseUpEventListerAdded=!1,this.editor.getDocument().removeEventListener("mouseup",this.onMouseUp,!0))},i.default=sd;var y={},cd=(Object.defineProperty(y,"__esModule",{value:!0}),t);function dd(){}dd.prototype.getName=function(){return"NormalizeTable"},dd.prototype.initialize=function(e){this.editor=e},dd.prototype.dispose=function(){this.editor=null},dd.prototype.onPluginEvent=function(e){switch(e.eventType){case 11:case 7:this.normalizeTables(this.editor.queryElements("table"));break;case 10:this.normalizeTables((0,cd.toArray)(e.fragment.querySelectorAll("table")));break;case 5:this.normalizeTableFromEvent(e.rawEvent);break;case 0:e.rawEvent.shiftKey&&this.normalizeTableFromEvent(e.rawEvent)}},dd.prototype.normalizeTableFromEvent=function(e){e=this.editor.getElementAtCursor("table",e.target);e&&this.normalizeTables([e])},dd.prototype.normalizeTables=function(e){var t,n,r,o,i,a;0<e.length&&(n=(i=0==(null==(t=this.editor.getSelectionRangeEx())?void 0:t.type)&&t.ranges[0]||{}).startContainer,r=i.endContainer,o=i.startOffset,i=i.endOffset,a=!1,e.forEach(function(e){for(var t=null,n=e.firstChild;n;n=n.nextSibling)switch((0,cd.getTagOfNode)(n)){case"TR":t||(t=e.ownerDocument.createElement("tbody"),e.insertBefore(t,n)),t.appendChild(n),n=t,a=!0;break;case"TBODY":t?((0,cd.moveChildNodes)(t,n,!0),n.parentNode.removeChild(n),n=t,a=!0):t=n;break;case"COLGROUP":e.tHead&&e.tHead.prepend(n);break;default:t=null}}),a&&(n&&r?this.editor.select(n,o,r,i):1==(null==t?void 0:t.type)&&this.editor.select(t.table,t.coordinates)))},y.default=dd;var Oe={},ud=(Object.defineProperty(Oe,"__esModule",{value:!0}),t);function fd(){this.state={pendableFormatPosition:null,pendableFormatState:null}}fd.prototype.getName=function(){return"PendingFormatState"},fd.prototype.initialize=function(e){this.editor=e},fd.prototype.dispose=function(){this.editor=null,this.clear()},fd.prototype.getState=function(){return this.state},fd.prototype.onPluginEvent=function(e){switch(e.eventType){case 13:this.state.pendableFormatPosition=this.getCurrentPosition(),this.state.pendableFormatState=e.formatState;break;case 0:case 5:case 7:this.state.pendableFormatPosition&&!this.state.pendableFormatPosition.equalTo(this.getCurrentPosition())&&this.clear()}},fd.prototype.clear=function(){this.state.pendableFormatPosition=null,this.state.pendableFormatState=null},fd.prototype.getCurrentPosition=function(){var e=this.editor.getSelectionRange();return e&&ud.Position.getStart(e).normalize()},Oe.default=fd;var p={},hd=(Object.defineProperty(p,"__esModule",{value:!0}),t);function pd(){}pd.prototype.getName=function(){return"TypeInContainer"},pd.prototype.initialize=function(e){this.editor=e},pd.prototype.dispose=function(){this.editor=null},pd.prototype.onPluginEvent=function(t){var e;1==t.eventType&&(e=this.editor.getSelectionRange())&&!this.editor.contains((0,hd.findClosestElementAncestor)(e.startContainer,null,"[style]"))&&(e.collapsed?this.editor.ensureTypeInContainer(hd.Position.getStart(e),t.rawEvent):this.editor.runAsync(function(e){e.ensureTypeInContainer(e.getFocusedPosition(),t.rawEvent)}))},p.default=pd;var Ht={},gd=(Object.defineProperty(Ht,"__esModule",{value:!0}),t);function md(e){var n,r;this.state={snapshotsService:e.undoMetadataSnapshotService||((r=e.undoSnapshotService)?{canMove:function(e){return r.canMove(e)},move:function(e){return{html:r.move(e),metadata:null}},addSnapshot:function(e,t){return r.addSnapshot(e.html+(e.metadata?"\x3c!--"+JSON.stringify(e.metadata)+"--\x3e":""),t)},clearRedo:function(){return r.clearRedo()},canUndoAutoComplete:function(){return r.canUndoAutoComplete()}}:void 0)||(n=(0,gd.createSnapshots)(1e7),{canMove:function(e){return(0,gd.canMoveCurrentSnapshot)(n,e)},move:function(e){return(0,gd.moveCurrentSnapshot)(n,e)},addSnapshot:function(e,t){return(0,gd.addSnapshotV2)(n,e,t)},clearRedo:function(){return(0,gd.clearProceedingSnapshotsV2)(n)},canUndoAutoComplete:function(){return(0,gd.canUndoAutoComplete)(n)}}),isRestoring:!1,hasNewContent:!1,isNested:!1,autoCompletePosition:null}}md.prototype.getName=function(){return"Undo"},md.prototype.initialize=function(e){this.editor=e},md.prototype.dispose=function(){this.editor=null},md.prototype.getState=function(){return this.state},md.prototype.willHandleEventExclusively=function(e){return 0==e.eventType&&8==e.rawEvent.which&&this.canUndoAutoComplete()},md.prototype.onPluginEvent=function(e){if(this.editor&&!this.editor.isInIME())switch(e.eventType){case 11:var t=this.editor.getUndoState();t.canUndo||t.canRedo||this.addUndoSnapshot();break;case 0:this.onKeyDown(e.rawEvent);break;case 1:this.onKeyPress(e.rawEvent);break;case 4:this.clearRedoForInput(),this.addUndoSnapshot();break;case 7:this.state.isRestoring||"SwitchToDarkMode"==e.source||"SwitchToLightMode"==e.source||this.clearRedoForInput()}},md.prototype.onKeyDown=function(e){var t;8==e.which||46==e.which?(8==e.which&&this.canUndoAutoComplete()?(e.preventDefault(),this.editor.undo(),this.state.autoCompletePosition=null):(!(t=this.editor.getSelectionRange())||t.collapsed&&this.lastKeyPress==e.which&&!(0,gd.isCtrlOrMetaPressed)(e)||this.addUndoSnapshot(),this.state.hasNewContent=!0),this.lastKeyPress=e.which):33<=e.which&&e.which<=40&&(this.state.hasNewContent&&this.addUndoSnapshot(),this.lastKeyPress=0)},md.prototype.onKeyPress=function(e){var t;e.metaKey||((t=this.editor.getSelectionRange())&&!t.collapsed||32==e.which&&32!=this.lastKeyPress||13==e.which?(this.addUndoSnapshot(),13==e.which&&(this.state.hasNewContent=!0)):this.clearRedoForInput(),this.lastKeyPress=e.which)},md.prototype.clearRedoForInput=function(){this.state.snapshotsService.clearRedo(),this.lastKeyPress=0,this.state.hasNewContent=!0},md.prototype.canUndoAutoComplete=function(){var e;return this.state.snapshotsService.canUndoAutoComplete()&&(null==(e=this.state.autoCompletePosition)?void 0:e.equalTo(this.editor.getFocusedPosition()))},md.prototype.addUndoSnapshot=function(){this.editor.addUndoSnapshot(),this.state.autoCompletePosition=null},Ht.default=md,Object.defineProperty(ot,"__esModule",{value:!0}),ot.getPluginState=void 0;var vd,yd=sr,bd=l,Ed=X,Cd=cr,wd=ie,Sd=i,Td=y,Pd=Oe,Od=p,xd=Ht,_d=(ot.default=function(e,t){var n=t.corePluginOverride||{};return{typeInContainer:n.typeInContainer||new Od.default,edit:n.edit||new Ed.default,pendingFormatState:n.pendingFormatState||new Pd.default,_placeholder:null,typeAfterLink:null,undo:n.undo||new xd.default(t),domEvent:n.domEvent||new bd.default(t,e),mouseUp:n.mouseUp||new Sd.default,copyPaste:n.copyPaste||new yd.default(t),entity:n.entity||new Cd.default,normalizeTable:n.normalizeTable||new Td.default,lifecycle:n.lifecycle||new wd.default(t,e)}},ot.getPluginState=function(e){return{domEvent:e.domEvent.getState(),pendingFormatState:e.pendingFormatState.getState(),edit:e.edit.getState(),lifecycle:e.lifecycle.getState(),undo:e.undo.getState(),entity:e.entity.getState(),copyPaste:e.copyPaste.getState()}},e&&e.__assign||function(){return(_d=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)}),Nd=(Object.defineProperty(B,"__esModule",{value:!0}),F),Rd=ot,_=t;function N(e,t){var n=this;if(void 0===t&&(t={}),"DIV"!=(0,_.getTagOfNode)(e))throw new Error("contentDiv must be an HTML DIV element");var r=(0,Rd.default)(e,t),o=[],i=(Object.keys(r).forEach(function(e){"_placeholder"==e?(0,_.arrayPush)(o,t.plugins):o.push(r[e])}),0<t.zoomScale?t.zoomScale:1);this.core=_d(_d({contentDiv:e,api:_d(_d({},Nd.coreApiMap),t.coreApiOverride||{}),originalApi:Nd.coreApiMap,plugins:o.filter(function(e){return!!e})},(0,Rd.getPluginState)(r)),{trustedHTMLHandler:t.trustedHTMLHandler||function(e){return e},zoomScale:i,sizeTransformer:t.sizeTransformer||function(e){return e/i}}),this.core.plugins.forEach(function(e){return e.initialize(n)}),this.ensureTypeInContainer(new _.Position(this.core.contentDiv,0).normalize())}N.prototype.dispose=function(){for(var e=this.core.plugins.length-1;0<=e;e--)this.core.plugins[e].dispose();this.core=null},N.prototype.isDisposed=function(){return!this.core},N.prototype.insertNode=function(e,t){return!!e&&this.core.api.insertNode(this.core,e,t)},N.prototype.deleteNode=function(e){return!(!e||!this.contains(e)||(e.parentNode.removeChild(e),0))},N.prototype.replaceNode=function(e,t,n){return!(!this.contains(e)||!t||(this.core.api.transformColor(this.core,n?t:null,!0,function(){return e.parentNode.replaceChild(t,e)},0),0))},N.prototype.getBlockElementAtNode=function(e){return(0,_.getBlockElementAtNode)(this.core.contentDiv,e)},N.prototype.contains=function(e){return(0,_.contains)(this.core.contentDiv,e)},N.prototype.queryElements=function(t,e,n){var r=this,o=[],i=(e=void 0===e?0:e)instanceof Function?0:e,e=(n=e instanceof Function?e:n,0==i?null:this.getSelectionRangeEx());return e?(e.ranges.forEach(function(e){o.push.apply(o,(0,_.queryElements)(r.core.contentDiv,t,n,i,e))}),o):(0,_.queryElements)(this.core.contentDiv,t,n,i,null)},N.prototype.collapseNodes=function(e,t,n){return(0,_.collapseNodes)(this.core.contentDiv,e,t,n)},N.prototype.isEmpty=function(e){return(0,_.isNodeEmpty)(this.core.contentDiv,e)},N.prototype.getContent=function(e){return this.core.api.getContent(this.core,e=void 0===e?0:e)},N.prototype.setContent=function(e,t){this.core.api.setContent(this.core,e,t=void 0===t?!0:t)},N.prototype.insertContent=function(e,t){var n,r;e&&(n=this.getDocument(),e=null!=(e=null==(e=(new DOMParser).parseFromString(this.core.trustedHTMLHandler(e),"text/html"))?void 0:e.body)&&e.childNodes?(0,_.toArray)(e.childNodes):[],t&&t.insertOnNewLine&&1<e.length&&(e=[(0,_.wrap)(e)]),r=n.createDocumentFragment(),e.forEach(function(e){return r.appendChild(e)}),this.insertNode(r,t))},N.prototype.deleteSelectedContent=function(){var e=this.getSelectionRange();return e&&!e.collapsed&&(0,_.deleteSelectedContent)(this.core.contentDiv,e)},N.prototype.paste=function(e,t,n){var r,o,i=this;e&&(e.snapshotBeforePaste?this.setContent(e.snapshotBeforePaste):e.snapshotBeforePaste=this.getContent(2),r=(r=this.getSelectionRange())&&_.Position.getStart(r),o=this.core.api.createPasteFragment(this.core,e,r,t,n),this.addUndoSnapshot(function(){return i.insertNode(o),e},"Paste"))},N.prototype.getSelectionRange=function(e){return this.core.api.getSelectionRange(this.core,e=void 0===e?!0:e)},N.prototype.getSelectionRangeEx=function(){return this.core.api.getSelectionRangeEx(this.core)},N.prototype.getSelectionPath=function(){var e=this.getSelectionRange();return e&&(0,_.getSelectionPath)(this.core.contentDiv,e)},N.prototype.hasFocus=function(){return this.core.api.hasFocus(this.core)},N.prototype.focus=function(){this.core.api.focus(this.core)},N.prototype.select=function(e,t,n,r){if(null!=(o=e)&&o.rows)return o=this.core.api.selectTable(this.core,e,t),!!(this.core.domEvent.tableSelectionRange=o);this.core.api.selectTable(this.core,null),this.core.domEvent.tableSelectionRange=null;var o=e?(0,_.safeInstanceOf)(e,"Range")?e:Array.isArray(e.start)&&Array.isArray(e.end)?(0,_.createRange)(this.core.contentDiv,e.start,e.end):(0,_.createRange)(e,t,n,r):null;return this.contains(o)&&this.core.api.selectRange(this.core,o)},N.prototype.getFocusedPosition=function(){var e=null==(e=this.getDocument().defaultView)?void 0:e.getSelection();if(this.contains(e&&e.focusNode))return new _.Position(e.focusNode,e.focusOffset);e=this.getSelectionRange();return e?_.Position.getStart(e):null},N.prototype.getElementAtCursor=function(t,n,e){var r=this;return e=n?null:e,(0,_.cacheGetEventData)(e,"GET_ELEMENT_AT_CURSOR_"+t,function(){var e;return n||(e=r.getFocusedPosition(),n=e&&e.node),n&&(0,_.findClosestElementAncestor)(n,r.core.contentDiv,t)})},N.prototype.isPositionAtBeginning=function(e){return(0,_.isPositionAtBeginningOf)(e,this.core.contentDiv)},N.prototype.getSelectedRegions=function(t){var n=this,e=(void 0===t&&(t=0),this.getSelectionRangeEx()),r=[];return e.ranges.forEach(function(e){r.push.apply(r,e?(0,_.getRegionsFromRange)(n.core.contentDiv,e,t):[])}),r.filter(function(e,t,n){return n.indexOf(e)===t})},N.prototype.addDomEventHandler=function(e,t){var n,t="string"==typeof e?((n={})[e]=t,n):e;return this.core.api.attachDomEvent(this.core,t)},N.prototype.triggerPluginEvent=function(e,t,n){e=_d({eventType:e},t);return this.core.api.triggerEvent(this.core,e,n),e},N.prototype.triggerContentChangedEvent=function(e,t){this.triggerPluginEvent(7,{source:e=void 0===e?"SetContent":e,data:t})},N.prototype.undo=function(){this.focus(),this.core.api.restoreUndoSnapshot(this.core,-1)},N.prototype.redo=function(){this.focus(),this.core.api.restoreUndoSnapshot(this.core,1)},N.prototype.addUndoSnapshot=function(e,t,n){this.core.api.addUndoSnapshot(this.core,e,t,n)},N.prototype.getUndoState=function(){var e=this.core.undo,t=e.hasNewContent,e=e.snapshotsService;return{canUndo:t||e.canMove(-1),canRedo:e.canMove(1)}},N.prototype.getDocument=function(){return this.core.contentDiv.ownerDocument},N.prototype.getScrollContainer=function(){return this.core.domEvent.scrollContainer},N.prototype.getCustomData=function(e,t,n){return(this.core.lifecycle.customData[e]=this.core.lifecycle.customData[e]||{value:t?t():void 0,disposer:n}).value},N.prototype.isInIME=function(){return this.core.domEvent.isInIME},N.prototype.getDefaultFormat=function(){return this.core.lifecycle.defaultFormat},N.prototype.getBodyTraverser=function(e){return _.ContentTraverser.createBodyTraverser(this.core.contentDiv,e)},N.prototype.getSelectionTraverser=function(e){return(e=null!=e?e:this.getSelectionRange())&&_.ContentTraverser.createSelectionTraverser(this.core.contentDiv,e)},N.prototype.getBlockTraverser=function(e){void 0===e&&(e=3);var t=this.getSelectionRange();return t&&_.ContentTraverser.createBlockTraverser(this.core.contentDiv,t,e)},N.prototype.getContentSearcherOfCursor=function(e){var t=this;return(0,_.cacheGetEventData)(e,"ContentSearcher",function(){var e=t.getSelectionRange();return e&&new _.PositionContentSearcher(t.core.contentDiv,_.Position.getStart(e))})},N.prototype.runAsync=function(e){var t=this,n=this.core.contentDiv.ownerDocument.defaultView||window,r=n.requestAnimationFrame(function(){!t.isDisposed()&&e&&e(t)});return function(){n.cancelAnimationFrame(r)}},N.prototype.setEditorDomAttribute=function(e,t){null===t?this.core.contentDiv.removeAttribute(e):this.core.contentDiv.setAttribute(e,t)},N.prototype.getEditorDomAttribute=function(e){return this.core.contentDiv.getAttribute(e)},N.prototype.getRelativeDistanceToEditor=function(e,t){if(this.contains(e)){var n,r=this.core.contentDiv,o=r.getBoundingClientRect(),e=e.getBoundingClientRect();if(o&&e)return n=e.left-(null==o?void 0:o.left),e=e.top-(null==o?void 0:o.top),t&&(n+=r.scrollLeft,e+=r.scrollTop),[n,e]}return null},N.prototype.addContentEditFeature=function(n){var r=this;null!=n&&n.keys.forEach(function(e){var t=r.core.edit.features[e]||[];t.push(n),r.core.edit.features[e]=t})},N.prototype.getStyleBasedFormatState=function(e){var t;return e||(e=(t=this.getSelectionRange())&&_.Position.getStart(t).normalize().node),this.core.api.getStyleBasedFormatState(this.core,e)},N.prototype.getPendableFormatState=function(e){return this.core.api.getPendableFormatState(this.core,e)},N.prototype.ensureTypeInContainer=function(e,t){this.core.api.ensureTypeInContainer(this.core,e,t)},N.prototype.setDarkModeState=function(e){this.isDarkMode()!=!!e&&(this.core.api.transformColor(this.core,this.core.contentDiv,!1,null,e?0:1,!0),this.triggerContentChangedEvent(e?"SwitchToDarkMode":"SwitchToLightMode"))},N.prototype.isDarkMode=function(){return this.core.lifecycle.isDarkMode},N.prototype.transformToDarkColor=function(e){this.core.api.transformColor(this.core,e,!0,null,0)},N.prototype.startShadowEdit=function(){this.core.api.switchShadowEdit(this.core,!0)},N.prototype.stopShadowEdit=function(){this.core.api.switchShadowEdit(this.core,!1)},N.prototype.isInShadowEdit=function(){return!!this.core.lifecycle.shadowEditFragment},N.prototype.isFeatureEnabled=function(e){return 0<=this.core.lifecycle.experimentalFeatures.indexOf(e)},N.prototype.getTrustedHTMLHandler=function(){return this.core.trustedHTMLHandler},N.prototype.getSizeTransformer=function(){return this.core.sizeTransformer},N.prototype.getZoomScale=function(){return this.core.zoomScale},N.prototype.setZoomScale=function(e){var t;0<e&&e<=10&&((t=this.core.zoomScale)!=(this.core.zoomScale=e)&&this.triggerPluginEvent(21,{oldZoomScale:t,newZoomScale:e},!0))},B.default=N,rt=j,Object.defineProperty(rt,"__esModule",{value:!0}),rt.Editor=void 0,vd=B,Object.defineProperty(rt,"Editor",{enumerable:!0,get:function(){return vd.default}});class kd{constructor(e){this.handleChange=e,this.handleChange=this.handleChange}getName(){return"OnChangePlugin"}initialize(e){this.editor=e}getContent(){return this.editor.getContent()}dispose(){this.editor=null}onPluginEvent(e){var t,n;switch(e.eventType){case 3:case 7:this.handleChange(this.getContent());break;case 10:null==(t=null==e?void 0:e.clipboardData)||!t.image||null!=(n=null==(t=null==e?void 0:e.fragment)?void 0:t.removeChild)&&n.call(t,e.fragment.firstChild)}}}var Ld,Id,Md,Er={},q={},o={},ln={},Cr={},Jn={},R={},ce={},u={},Ad=(Object.defineProperty(u,"__esModule",{value:!0}),t);function Dd(e,t,n){e=1==t?Math.floor(e):Math.ceil(e);var r=n[n.length-1];if(e<=n[0])e=Math.max(e+t,1);else if(r<e||e==r&&1==t)e/=10,e=1==t?Math.floor(e):Math.ceil(e),e=Math.min(Math.max(10*(e+t),r),1e3);else if(1==t){for(var o=0;o<n.length;o++)if(e<n[o]){e=n[o];break}}else for(o=n.length-1;0<=o;o--)if(e>n[o]){e=n[o];break}return e}u.default=function(a,l){a.focus();var e,t,n=a.getSelectionRangeEx();n&&n.areAllCollapsed?(t=(e=n.ranges[0]).startContainer,"SPAN"!=(0,Ad.getTagOfNode)(t)||t.firstChild&&("BR"!=(0,Ad.getTagOfNode)(t.firstChild)||t.firstChild.nextSibling)?(t&&3==t.nodeType&&"​"==t.nodeValue&&"SPAN"==(0,Ad.getTagOfNode)(t.parentNode)||(a.addUndoSnapshot(),t=a.getDocument().createTextNode("​"),e.insertNode(t)),(0,Ad.applyTextStyle)(t,l),a.select(t,-1)):(a.addUndoSnapshot(),l(t))):a.addUndoSnapshot(function(){var o,i;n.ranges.forEach(function(e){for(var t=a.getSelectionTraverser(e),n=t&&t.currentInlineElement;n;){var r=t.getNextInlineElement();n.applyStyle(function(e,t){l(e,t),o=o||e,i=e}),n=r}}),o&&i&&0==n.type&&a.select(o,-2,i,-3)},"Format")},Ld=ce,Object.defineProperty(Ld,"__esModule",{value:!0}),Ld.getNewFontSize=Ld.FONT_SIZES=void 0,Id=u,Md=t,Ld.FONT_SIZES=[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72],Ld.default=function(e,t,n){void 0===n&&(n=Ld.FONT_SIZES);var r=0==t?1:-1;(0,Id.default)(e,function(e){var t=parseFloat((0,Md.getComputedStyle)(e,"font-size"));e.style.fontSize=Dd(t,r,n)+"pt","normal"!=(0,Md.getComputedStyle)(e,"line-height")&&(e.style.lineHeight="normal")})},Ld.getNewFontSize=Dd;var or={},Sr={},Tr={},Nr={},jd=(Object.defineProperty(Nr,"__esModule",{value:!0}),t),Bd=(Nr.default=function(e,t){var n,r;0<(null==t?void 0:t.length)&&(n=(r=e.getSelectionRange())&&jd.Position.getStart(r),r=r&&jd.Position.getEnd(r),t.forEach(function(e){return e.commit()}),e.select(n,r))},Object.defineProperty(Tr,"__esModule",{value:!0}),Nr),Fd=t,Vr=(Tr.default=function(o,i,a){o.focus();var l=o.getSelectionRangeEx();o.addUndoSnapshot(function(t,n){var e,r;a&&!a()||(e=o.getSelectedRegions(),r=Fd.VListChain.createListChains(e,null==t?void 0:t.node),e.forEach(function(e){return i(e,t,n,r)}),(0,Bd.default)(o,r)),0==l.type?o.select(t,n):1==l.type&&o.select(l.table,l.coordinates)},"Format")},{}),Hd=(Object.defineProperty(Vr,"__esModule",{value:!0}),t),No=(Vr.default=function(n,t){n.focus();function r(){n.getDocument().execCommand(t,!1,null)}var e,o,i=n.getSelectionRangeEx();i&&i.areAllCollapsed?(n.addUndoSnapshot(),e=n.getPendableFormatState(!1),r(),(o=Object.keys(Hd.PendableFormatCommandMap).filter(function(e){return Hd.PendableFormatCommandMap[e]==t})[0])&&(e[o]=!e[o],n.triggerPluginEvent(13,{formatState:e}))):n.addUndoSnapshot(function(){var t;i.ranges.forEach(function(e){1==i.type&&n.select(e),r(),t=e}),t&&1==i.type&&n.select(i.table,i.coordinates)},"Format")},{}),zd=(Object.defineProperty(No,"__esModule",{value:!0}),u),Ud=t,g=(No.default=function(n,r){(0,zd.default)(n,function(e,t){(0,Ud.setColor)(e,t?"":r,!0,n.isDarkMode())})},{}),Wr={},Vd=(Object.defineProperty(Wr,"__esModule",{value:!0}),u),Wd=t,Kd=(Wr.default=function(n,e,r){var t,o=[];(0,Vd.default)(n,function(e,t){r(e,t);t=n.getElementAtCursor("LI",e);t&&-1===o.indexOf(t)&&o.push(t)}),t=[e],o.forEach(function(e){(0,Wd.safeInstanceOf)(e,"HTMLLIElement")&&(0,Wd.setListItemStyle)(e,t)})},Object.defineProperty(g,"__esModule",{value:!0}),Wr),C=(g.default=function(e,n){(0,Kd.default)(e,"font-family",function(e,t){e.style.fontFamily=t?"":n})},{}),qd=(Object.defineProperty(C,"__esModule",{value:!0}),Wr),Gd=t,Lo=(C.default=function(e,n){(0,qd.default)(e,"font-size",function(e,t){e.style.fontSize=t?"":n,"normal"!=(0,Gd.getComputedStyle)(e,"line-height")&&(e.style.lineHeight="normal")})},{}),Zd=(Object.defineProperty(Lo,"__esModule",{value:!0}),Wr),Yd=t,a=(Lo.default=function(n,r,o){(0,Zd.default)(n,"color",function(e,t){o&&!o(e)||(0,Yd.setColor)(e,t?"":r,!1,n.isDarkMode())})},{}),$d=(Object.defineProperty(a,"__esModule",{value:!0}),Vr),Uo=(a.default=function(e){(0,$d.default)(e,"bold")},{}),Xd=(Object.defineProperty(Uo,"__esModule",{value:!0}),Vr),Io=(Uo.default=function(e){(0,Xd.default)(e,"italic")},{}),Qd=(Object.defineProperty(Io,"__esModule",{value:!0}),Vr),Jd=(Io.default=function(e){(0,Qd.default)(e,"underline")},Object.defineProperty(Sr,"__esModule",{value:!0}),Tr),eu=Vr,tu=No,nu=g,ru=C,ou=Lo,iu=a,au=Uo,lu=Io,k=t,su=["font","text-decoration","color","background"],cu="B,I,U,STRONG,EM,SUB,SUP,STRIKE,FONT,CENTER,H1,H2,H3,H4,H5,H6,UL,OL,LI,SPAN,P,BLOCKQUOTE,CODE,S,PRE".split(","),du=["href","src","cellpadding","cellspacing"],uu=["TD","TH","TR","TABLE","TBODY","THEAD"];function fu(e){var t=(0,k.toArray)(e.childNodes).map(fu).every(function(e){return e}),n=(0,k.isBlockElement)(e),r=(0,k.getTagOfNode)(e);if(r)if(0<=cu.indexOf(r)||t&&!(0,k.isVoidHtmlElement)(e)&&uu.indexOf(r)<0)n&&!t&&(0,k.wrap)(e),(0,k.unwrap)(e);else for(var o=e,i=(0,k.safeInstanceOf)(o,"HTMLTableCellElement"),a=(0,k.safeInstanceOf)(o,"HTMLTableElement"),l=0,s=(0,k.toArray)(o.attributes);l<s.length;l++){var c=s[l];i&&"style"==c.name?pu(o):a&&"style"==c.name?hu(o,function(e,t,n){"border-collapse"!=e&&(n[e]=t[e],delete t[e])}):du.indexOf(c.name.toLowerCase())<0&&0!=c.name.indexOf("data-")&&o.removeAttribute(c.name)}return n}function hu(e,t){var n=(0,k.getStyles)(e),r={};return Object.keys(n).forEach(function(e){return t(e,n,r)}),(0,k.setStyles)(e,n),r}function pu(e){return hu(e,function(e,t,n){e.indexOf("border")<0&&(n[e]=t[e],delete t[e])})}function gu(o){o.addUndoSnapshot(function(){(0,Jd.default)(o,function(e){var t,n=(0,k.getSelectedBlockElementsInRegion)(e),r=(0,k.collapseNodesInRegion)(e,n);for(o.contains(e.rootNode)&&(n=pu(e.rootNode),0<Object.keys(n).length&&(t=(0,k.wrap)((0,k.toArray)(e.rootNode.childNodes)),(0,k.setStyles)(t,n)));0<r.length&&(0,k.isNodeInRegion)(e,r[0].parentNode);)r=[(0,k.splitBalancedNodeRange)(r)];r.forEach(fu)}),mu(o)},"Format")}function mu(e){var t,n,r=e.getDefaultFormat(),o=0===Object.keys(r).length;e.queryElements("[style]",2,function(e){var t=(0,k.getTagOfNode)(e);-1==uu.indexOf(t)?vu(t,e,o):e.childNodes.forEach(function(e){e.childNodes.forEach(function(e){var t=(0,k.getTagOfNode)(e);(0,k.safeInstanceOf)(e,"HTMLElement")&&vu(t,e,o)})})}),o||(r.fontFamily&&(0,nu.default)(e,r.fontFamily),r.fontSize&&(0,ru.default)(e,r.fontSize),r.textColor&&(n=0<(t=e.queryElements("a *, a",1)).length?function(e){return-1==t.indexOf(e)}:null,r.textColors?(0,ou.default)(e,r.textColors,n):(0,ou.default)(e,r.textColor,n)),r.backgroundColor&&(r.backgroundColors?(0,tu.default)(e,r.backgroundColors):(0,tu.default)(e,r.backgroundColor)),r.bold&&(0,iu.default)(e),r.italic&&(0,au.default)(e),r.underline&&(0,lu.default)(e))}function vu(e,t,n){-1==uu.indexOf(e)&&(su.forEach(function(e){return t.style.removeProperty(e)}),n&&""===t.getAttribute("style")&&t.removeAttribute("style"))}Sr.default=function e(t,n){switch(n=void 0===n?0:n){case 0:(i=t).focus(),i.addUndoSnapshot(function(){(0,eu.default)(i,"removeFormat"),i.queryElements("[class]",1,function(e){return e.removeAttribute("class")}),mu(i)},"Format");break;case 1:gu(t);break;default:((o=(r=t).getSelectionTraverser()).currentBlockElement&&o.getNextBlockElement()||!(r.getSelectionTraverser().currentInlineElement instanceof k.PartialInlineElement)?gu:e)(r)}var r,o,i},Object.defineProperty(or,"__esModule",{value:!0});var yu=Sr,Ro=(or.default=function(e){(0,yu.default)(e,1)},{}),bu=(Object.defineProperty(Ro,"__esModule",{value:!0}),t),Eu=/^[a-zA-Z]+:/i,Cu=/^[\w.%+-]+@/i,wu=/^ftp\./i;function Su(e){return e.queryElements("a[href]",1)[0]}function Tu(e,t){t&&e.textContent!=t&&(e.textContent=t)}Ro.default=function(a,e,l,s,c){a.focus();e=e,n=new bu.HtmlSanitizer,(t=document.createElement("a")).href=e||"",n.sanitize(t);var t,n,d,u,e=(t.getAttribute("href")||"").trim();e&&(n=(0,bu.matchLink)(e),d=n?n.normalizedUrl:function(e){if(!e)return e;var t="";return(t=e.search(Eu)<0?0==e.search(Cu)?"mailto:":0==e.search(wu)?"ftp://":"http://":t)+e}(e),u=n?n.originalUrl:e,a.addUndoSnapshot(function(){var e,t=a.getSelectionRange(),n=null;if(t&&t.collapsed)(n=Su(a))?(n.href=d,Tu(n,s)):((n=a.getDocument().createElement("A")).textContent=s||u,n.href=d,a.insertNode(n));else{a.getDocument().execCommand("createLink",!1,d);for(var r=a.getSelectionTraverser(),o=r.getNextInlineElement();o;){var i=o.getContainerNode();i.parentElement.removeChild(i),o=r.getNextInlineElement()}Tu(n=Su(a),s)}return l&&n&&(n.title=l),n&&(t=n,(e=c)?t.target=e:!e&&t.getAttribute("target")&&t.removeAttribute("target")),n},"CreateLink"))};var d={},Pu=e&&e.__assign||function(){return(Pu=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Ou=(Object.defineProperty(d,"__esModule",{value:!0}),d.getElementBasedFormatState=void 0,t);function xu(e,t){var n=(0,Ou.getTagOfNode)(e.getElementAtCursor("OL,UL",null,t)),t=(0,Ou.getTagOfNode)(e.getElementAtCursor("H1,H2,H3,H4,H5,H6",null,t));return{isBullet:"UL"==n,isNumbering:"OL"==n,headerLevel:t&&parseInt(t[1])||0,canUnlink:!!e.queryElements("a[href]",1)[0],canAddImageAltText:!!e.queryElements("img",1)[0],isBlockQuote:!!e.queryElements("blockquote",1)[0],isInTable:!!e.queryElements("table",1)[0]}}d.getElementBasedFormatState=xu,d.default=function(e,t){return Pu(Pu(Pu(Pu(Pu({},e.getPendableFormatState(!1)),xu(e,t)),e.getStyleBasedFormatState()),e.getUndoState()),{isDarkMode:e.isDarkMode(),zoomScale:e.getZoomScale()})};var oe={},_u=(Object.defineProperty(oe,"__esModule",{value:!0}),t),Ai=(oe.default=function(e,t,n,r,o,i){var a,n=(0,_u.wrap)(n,r?"DIV":"SPAN"),i=(!r&&o&&(n.style.display="inline-block"),(0,_u.commitEntity)(n,t,o),e.contains(n)||(o=t=void 0,o="number"==typeof i?i:(i?(t=e.getSelectionRange(),(a=(a=i.normalize().node)&&e.getElementAtCursor((0,_u.getEntitySelector)(),a))&&(i=new _u.Position(a,-3)),e.select(i)):e.focus(),3),e.insertNode(n,{updateCursor:!1,insertOnNewLine:r,replaceSelection:!0,position:o}),3==o&&(t?e.select(t):r||e.select(n,-3))),r&&(a=e.getDocument().createElement("BR"),n.parentNode.insertBefore(a,n.nextSibling)),(0,_u.getEntityFromElement)(n));return e.triggerContentChangedEvent("InsertEntity",i),i},{}),Nu=(Object.defineProperty(Ai,"__esModule",{value:!0}),t);function Ru(t,n){t.addUndoSnapshot(function(){var e=t.getDocument().createElement("img");e.src=n,e.style.maxWidth="100%",t.insertNode(e)},"Format")}Ai.default=function(t,e){"string"==typeof e?Ru(t,e):(0,Nu.readFile)(e,function(e){e&&!t.isDisposed()&&Ru(t,e)})};var Fi={},ku=(Object.defineProperty(Fi,"__esModule",{value:!0}),t);Fi.default=function(t,e,n,r){var o=t.getDocument(),i=o.createDocumentFragment(),a=o.createElement("table");i.appendChild(a),a.cellSpacing="0",a.cellPadding="1";for(var l=0;l<n;l++){var s=o.createElement("tr");a.appendChild(s);for(var c=0;c<e;c++){var d=o.createElement("td");s.appendChild(d),d.appendChild(o.createElement("br")),d.style.width=(d=e)<=4?"120px":d<=6?"100px":"70px"}}t.focus(),t.addUndoSnapshot(function(){var e=new ku.VTable(a);e.applyFormat(r),e.writeBack(),t.insertNode(i),t.runAsync(function(e){return e.select(new ku.Position(a,0).normalize())})},"Format")};var Vi={},Lu=(Object.defineProperty(Vi,"__esModule",{value:!0}),t),Gi=(Vi.default=function(r,o){var i=r.getElementAtCursor("TD,TH");i&&r.addUndoSnapshot(function(){var e,n=new Lu.VTable(i),t=(t=n,(e=r.getSelectionRangeEx())&&1===e.type&&(t.selection=e.coordinates),n.edit(o),n.writeBack(),r.transformToDarkColor(n.table),r.focus(),function(){var e=n.row,t=n.col;switch(o){case 0:t=0;break;case 1:e+=1,t=0;break;case 2:e=0;break;case 3:e=0,t+=1}return{newRow:e,newCol:t}}());r.select(n.getCell(t.newRow,t.newCol).td,0)},"Format")},{}),Iu=(Object.defineProperty(Gi,"__esModule",{value:!0}),t),S=(Gi.default=function(r,o,i){(i=i||r.getElementAtCursor("TABLE"))&&r.addUndoSnapshot(function(e,t){var n=new Iu.VTable(i);n.applyFormat(o),n.writeBack(),r.transformToDarkColor(n.table),r.focus(),r.select(e,t)},"Format")},{}),Mu=(Object.defineProperty(S,"__esModule",{value:!0}),t),T=(S.default=function(n){n.focus(),n.addUndoSnapshot(function(e,t){n.queryElements("a[href]",1,Mu.unwrap),n.select(e,t)},"Format")},{}),na=(Object.defineProperty(T,"__esModule",{value:!0}),T.default=function(e,t,n,r,o){return!(!t||!n)&&(!!(o="string"==typeof t?(o=o||e.getContentSearcherOfCursor())&&o.getRangeFromText(t,r):t)&&((t=e.getSelectionRange()).collapsed&&o.endContainer==t.startContainer&&o.endOffset==t.startOffset&&(r=!0),e.insertNode(n,{position:5,updateCursor:r,replaceSelection:!0,insertOnNewLine:!1,range:o}),!0))},{}),oa=(Object.defineProperty(na,"__esModule",{value:!0}),na.default=function(e,t,n){t&&e.addUndoSnapshot(function(){t.style.transform="rotate("+n+"deg)"},"Format")},{}),Au=(Object.defineProperty(oa,"__esModule",{value:!0}),Tr),Du=Vr,ju=t,ra=(oa.default=function(i,a){i.addUndoSnapshot(function(){var t,o,e=i.getSelectionRangeEx(),n=e&&1===e.type,r=i.getElementAtCursor();i.isFeatureEnabled("TableAlignment")&&n&&(0,ju.isWholeTableSelected)(new ju.VTable(e.table),e.coordinates)?(n=a,e=e.table,1==n?(e.style.marginLeft="auto",e.style.marginRight="auto"):2==n?(e.style.marginLeft="auto",e.style.marginRight=""):(e.style.marginLeft="",e.style.marginRight="auto")):-1<["LI","UL","OL"].indexOf((0,ju.getTagOfNode)(r))&&i.isFeatureEnabled("ListItemAlignment")?(o=a,(0,Au.default)(i,function(e,t,n){var r=(0,ju.getSelectedBlockElementsInRegion)(e)[0].getStartNode();(0,ju.createVListFromRegion)(e,!0,r).setAlignment(t,n,o)})):(n=i,t="left",e="justifyLeft",1==a?(e="justifyCenter",t="center"):2==a&&(e="justifyRight",t="right"),(0,Du.default)(n,e),n.queryElements("[align]",1,function(e){return e.style.textAlign=t}))},"Format")},{}),ua={},Bu=(Object.defineProperty(ua,"__esModule",{value:!0}),t);ua.default=function(e,t){for(var n,r,o=e.getSelectionTraverser(),i=o&&o.currentBlockElement,a=[];i;)r=void 0,(r=(n=i).getStartNode())==n.getEndNode()&&3==r.nodeType&&0<=["TR","TABLE"].indexOf((0,Bu.getTagOfNode)(r.parentNode))||a.push(i),i=o.getNextBlockElement();a.forEach(function(e){e=e.collapseToSingleElement();t(e)})},Object.defineProperty(ra,"__esModule",{value:!0});var Fu=ua,pa=(ra.default=function(n,r){n.focus(),n.addUndoSnapshot(function(e,t){(0,Fu.default)(n,function(e){e.setAttribute("dir",0==r?"ltr":"rtl"),e.style.textAlign=0==r?"left":"right"}),n.select(e,t)},"Format")},{}),ga=(Object.defineProperty(pa,"__esModule",{value:!0}),pa.default=function(e,t){e.focus(),e.addUndoSnapshot(function(){e.queryElements("img",1,function(e){return e.setAttribute("alt",t)})},"Format")},{}),Hu=(Object.defineProperty(ga,"__esModule",{value:!0}),Tr),zu=t;function Uu(e,t){e=(0,zu.collapseNodesInRegion)(e,t);(0,zu.wrap)(e,2)}function Vu(n,e){e.forEach(function(e){var t=e.collapseToSingleElement(),e=(0,zu.findClosestElementAncestor)(t,n.rootNode,"blockquote");if(e){for(t==e&&(t=(0,zu.wrap)((0,zu.toArray)(t.childNodes)));(0,zu.isNodeInRegion)(n,t)&&"BLOCKQUOTE"!=(0,zu.getTagOfNode)(t);)t=(0,zu.splitBalancedNodeRange)(t);(0,zu.isNodeInRegion)(n,t)&&(0,zu.unwrap)(t)}})}ga.default=function(f,h){var p=0==h?Uu:Vu;(0,Hu.default)(f,function(t,e,n){for(var r,o,i=(0,zu.getSelectedBlockElementsInRegion)(t,!0),a=[[]],l=0;l<i.length;l++){var s=i[l].getStartNode(),c=(0,zu.createVListFromRegion)(t,!0,s);if(c){for(;i[l+1]&&c.contains(i[l+1].getStartNode());)l++;var d,u=f.isFeatureEnabled("TabKeyTextFeatures");u&&(r=s,o=void 0,(null==(o=(d=c).items[0])?void 0:o.getNode())==r&&d.getListItemIndex(r)==(d.getStart()||1))&&(o=f,r=s,0==h||o.getElementAtCursor("blockquote",r))?(d=f.getBlockElementAtNode(c.rootList),a.push([d])):(1==h?c.setIndentation(e,n,h,!1,u):c.setIndentation(e,n,h),c.writeBack(),a.push([]))}else a[a.length-1].push(i[l])}a.forEach(function(e){return p(t,e)})},function(){var e,t=f.getSelectionRangeEx();return 1!=t.type||!(0,zu.isWholeTableSelected)(new zu.VTable(t.table),t.coordinates)||(1==h?(e=f.getElementAtCursor("blockquote",t.table),(0,zu.unwrap)(e)):0==h&&(0,zu.wrap)(t.table,2),!1)})};var Wu,Ku,qu,Gu,Zu,Yu,$u,Xu,Qu,Ju,ef,tf,nf,rf,of,af,lf,sf,cf,df,uf,ff,hf,pf,gf,mf,vf,yf,bf,Ef,Cf,wf,Sf,Tf,Pf,Of,xf,_f,ma={},Nf=(Object.defineProperty(ma,"__esModule",{value:!0}),u),Rf=t,va=(ma.default=function(e,i,n){function r(e,t){switch(i){case"lowercase":return e.toLocaleLowerCase(t);case"uppercase":return e.toLocaleUpperCase(t);case"capitalize":for(var n=e.toLocaleLowerCase(t).split(" "),r=0;r<n.length;r++)n[r]=n[r].charAt(0).toLocaleUpperCase(t)+n[r].slice(1);return n.join(" ");case"sentence":var o=new RegExp("^\\s*\\w|[\\.\\!\\?]\\s+\\w","g");return e.toLocaleLowerCase(t).replace(o,function(e){return e.toLocaleUpperCase(t)})}}(0,Nf.default)(e,function(e){for(var t=(0,Rf.getFirstLeafNode)(e);t;t=(0,Rf.getNextLeafSibling)(e,t))if(3==t.nodeType)try{t.textContent=r(t.textContent,n)}catch(e){t.textContent=r(t.textContent,void 0)}})},{}),wi={},kf=(Object.defineProperty(wi,"__esModule",{value:!0}),Tr),Lf=t,If=(wi.default=function(e,o,i,a){void 0===a&&(a=!0),(0,kf.default)(e,function(e,t,n,r){var r=0<i&&r.filter(function(e){return e.canAppendAtCursor(i)})[0],r=r&&t.equalTo(n)?r.createVListAtBlock(null==(r=(0,Lf.getBlockElementAtNode)(e.rootNode,t.node))?void 0:r.collapseToSingleElement(),i):(0,Lf.createVListFromRegion)(e,a);r&&(r.changeListType(t,n,o),r.writeBack())})},Object.defineProperty(va,"__esModule",{value:!0}),wi),ba=(va.default=function(e){(0,If.default)(e,2)},{}),Mf=(Object.defineProperty(ba,"__esModule",{value:!0}),wi),P=(ba.default=function(e,t){(0,Mf.default)(e,1,t)},{}),Af=(Object.defineProperty(P,"__esModule",{value:!0}),t),za=(P.default=function(t,n,r){void 0===r&&(r=1),t.addUndoSnapshot(function(){t.focus();var e=t.getSelectedRegions();e[0]&&(e=(0,Af.createVListFromRegion)(e[0],!1,n))&&(e.split(n,r),e.writeBack())},"Format")},{}),Ua={},Df=(Object.defineProperty(Ua,"__esModule",{value:!0}),Tr),jf=t,Bf=(Ua.default=function(e,r,t){(0,Df.default)(e,function(e){var t=(0,jf.getSelectedBlockElementsInRegion)(e,!0),n=(0,jf.collapseNodesInRegion)(e,t);if(0<n.length){for(1==n.length&&("BR"==(t=(0,jf.getTagOfNode)(n[0]))?n=[(0,jf.wrap)(n[0])]:"LI"!=t&&"TD"!=t||(n=(0,jf.toArray)(n[0].childNodes)));n[0]&&(0,jf.isNodeInRegion)(e,n[0].parentNode)&&n.some(function(e){return"LI"==(0,jf.getTagOfNode)(e)});)n=[(0,jf.splitBalancedNodeRange)(n)];r(n)}},t)},Object.defineProperty(za,"__esModule",{value:!0}),Ua),Ff=t,Va=(za.default=function(e,t){(0,Bf.default)(e,function(e){e=(0,Ff.wrap)(e,"blockquote");(t||function(e){e.style.borderLeft="3px solid",e.style.borderColor="#C8C8C8",e.style.paddingLeft="10px",e.style.color="#666666"})(e)},function(){return 0==e.queryElements("blockquote",1,Ff.unwrap).length})},{}),Hf=(Object.defineProperty(Va,"__esModule",{value:!0}),Ua),zf=t,Wa=(Va.default=function(e,t){(0,Hf.default)(e,function(e){e=(0,zf.wrap)(e,"code"),e=(0,zf.wrap)(e,"pre");null!=t&&t(e)},function(){return 0==e.queryElements("pre>code",1,function(e){var t;e.previousSibling||e.nextSibling||(t=e.parentNode,(0,zf.unwrap)(e),(0,zf.unwrap)(t))}).length})},{}),Uf=(Object.defineProperty(Wa,"__esModule",{value:!0}),Vr),Ka=(Wa.default=function(e){(0,Uf.default)(e,"strikeThrough")},{}),Vf=(Object.defineProperty(Ka,"__esModule",{value:!0}),Vr),qa=(Ka.default=function(e){(0,Vf.default)(e,"subscript")},{}),Wf=(Object.defineProperty(qa,"__esModule",{value:!0}),Vr),Za=(qa.default=function(e){(0,Wf.default)(e,"superscript")},{}),Kf=(Object.defineProperty(Za,"__esModule",{value:!0}),t),Kr=(Za.default=function(i,a){a=Math.min(Math.max(Math.round(a),0),6),i.addUndoSnapshot(function(){i.focus();var n=!1;if(i.queryElements("H1,H2,H3,H4,H5,H6",1,function(e){n||(i.getDocument().execCommand("formatBlock",!1,"<DIV>"),n=!0);var t=i.getDocument().createElement("div");(0,Kf.moveChildNodes)(t,e),i.replaceNode(e,t)}),0<a){for(var e=i.getSelectionTraverser(),t=e?e.currentBlockElement:null,r=new Kf.HtmlSanitizer({cssStyleCallbacks:{"font-size":function(){return!1}}});t;){var o=t.collapseToSingleElement();r.sanitize(o),t=e.getNextBlockElement()}i.getDocument().execCommand("formatBlock",!1,"<H"+a+">")}},"Format")},{}),qf=(Object.defineProperty(Kr,"__esModule",{value:!0}),t),Gf=(Kr.default=function(t,n){t.focus(),t.addUndoSnapshot(function(){t.getSelectedRegions().forEach(function(e){(0,qf.safeInstanceOf)(e.rootNode,"HTMLTableCellElement")&&((0,qf.setColor)(e.rootNode,n,!0,t.isDarkMode(),!0),e.rootNode.dataset.cellShade="true",e.rootNode.dataset.originalBackgroundColor=e.rootNode.style.backgroundColor)})})},w=R,Object.defineProperty(w,"__esModule",{value:!0}),w.experimentCommitListChains=w.blockFormat=w.toggleListType=w.applyCellShading=w.toggleHeader=w.toggleUnderline=w.toggleSuperscript=w.toggleSubscript=w.toggleStrikethrough=w.toggleCodeBlock=w.toggleBlockQuote=w.setOrderedListNumbering=w.toggleNumbering=w.toggleItalic=w.toggleBullet=w.toggleBold=w.changeCapitalization=w.setIndentation=w.setImageAltText=w.setFontSize=w.setFontName=w.setDirection=w.setTextColor=w.setBackgroundColor=w.setAlignment=w.rotateElement=w.replaceWithNode=w.removeLink=w.formatTable=w.editTable=w.insertTable=w.insertImage=w.insertEntity=w.getElementBasedFormatState=w.getFormatState=w.createLink=w.clearFormat=w.clearBlockFormat=w.FONT_SIZES=w.changeFontSize=void 0,Wu=ce,Object.defineProperty(w,"changeFontSize",{enumerable:!0,get:function(){return Wu.default}}),Object.defineProperty(w,"FONT_SIZES",{enumerable:!0,get:function(){return Wu.FONT_SIZES}}),Ku=or,Object.defineProperty(w,"clearBlockFormat",{enumerable:!0,get:function(){return Ku.default}}),qu=Sr,Object.defineProperty(w,"clearFormat",{enumerable:!0,get:function(){return qu.default}}),Gu=Ro,Object.defineProperty(w,"createLink",{enumerable:!0,get:function(){return Gu.default}}),Zu=d,Object.defineProperty(w,"getFormatState",{enumerable:!0,get:function(){return Zu.default}}),Object.defineProperty(w,"getElementBasedFormatState",{enumerable:!0,get:function(){return Zu.getElementBasedFormatState}}),Yu=oe,Object.defineProperty(w,"insertEntity",{enumerable:!0,get:function(){return Yu.default}}),$u=Ai,Object.defineProperty(w,"insertImage",{enumerable:!0,get:function(){return $u.default}}),Xu=Fi,Object.defineProperty(w,"insertTable",{enumerable:!0,get:function(){return Xu.default}}),Qu=Vi,Object.defineProperty(w,"editTable",{enumerable:!0,get:function(){return Qu.default}}),Ju=Gi,Object.defineProperty(w,"formatTable",{enumerable:!0,get:function(){return Ju.default}}),ef=S,Object.defineProperty(w,"removeLink",{enumerable:!0,get:function(){return ef.default}}),tf=T,Object.defineProperty(w,"replaceWithNode",{enumerable:!0,get:function(){return tf.default}}),nf=na,Object.defineProperty(w,"rotateElement",{enumerable:!0,get:function(){return nf.default}}),rf=oa,Object.defineProperty(w,"setAlignment",{enumerable:!0,get:function(){return rf.default}}),of=No,Object.defineProperty(w,"setBackgroundColor",{enumerable:!0,get:function(){return of.default}}),af=Lo,Object.defineProperty(w,"setTextColor",{enumerable:!0,get:function(){return af.default}}),lf=ra,Object.defineProperty(w,"setDirection",{enumerable:!0,get:function(){return lf.default}}),sf=g,Object.defineProperty(w,"setFontName",{enumerable:!0,get:function(){return sf.default}}),cf=C,Object.defineProperty(w,"setFontSize",{enumerable:!0,get:function(){return cf.default}}),df=pa,Object.defineProperty(w,"setImageAltText",{enumerable:!0,get:function(){return df.default}}),uf=ga,Object.defineProperty(w,"setIndentation",{enumerable:!0,get:function(){return uf.default}}),ff=ma,Object.defineProperty(w,"changeCapitalization",{enumerable:!0,get:function(){return ff.default}}),hf=a,Object.defineProperty(w,"toggleBold",{enumerable:!0,get:function(){return hf.default}}),pf=va,Object.defineProperty(w,"toggleBullet",{enumerable:!0,get:function(){return pf.default}}),gf=Uo,Object.defineProperty(w,"toggleItalic",{enumerable:!0,get:function(){return gf.default}}),mf=ba,Object.defineProperty(w,"toggleNumbering",{enumerable:!0,get:function(){return mf.default}}),vf=P,Object.defineProperty(w,"setOrderedListNumbering",{enumerable:!0,get:function(){return vf.default}}),yf=za,Object.defineProperty(w,"toggleBlockQuote",{enumerable:!0,get:function(){return yf.default}}),bf=Va,Object.defineProperty(w,"toggleCodeBlock",{enumerable:!0,get:function(){return bf.default}}),Ef=Wa,Object.defineProperty(w,"toggleStrikethrough",{enumerable:!0,get:function(){return Ef.default}}),Cf=Ka,Object.defineProperty(w,"toggleSubscript",{enumerable:!0,get:function(){return Cf.default}}),wf=qa,Object.defineProperty(w,"toggleSuperscript",{enumerable:!0,get:function(){return wf.default}}),Sf=Io,Object.defineProperty(w,"toggleUnderline",{enumerable:!0,get:function(){return Sf.default}}),Tf=Za,Object.defineProperty(w,"toggleHeader",{enumerable:!0,get:function(){return Tf.default}}),Pf=Kr,Object.defineProperty(w,"applyCellShading",{enumerable:!0,get:function(){return Pf.default}}),Of=wi,Object.defineProperty(w,"toggleListType",{enumerable:!0,get:function(){return Of.default}}),xf=Tr,Object.defineProperty(w,"blockFormat",{enumerable:!0,get:function(){return xf.default}}),_f=Nr,Object.defineProperty(w,"experimentCommitListChains",{enumerable:!0,get:function(){return _f.default}}),Object.defineProperty(Jn,"__esModule",{value:!0}),Jn.AutoLinkFeatures=void 0,R),Zf=t,Yf=/[.+=\s:;"',>]+$/i;function $f(r,o){return 0==r.eventType||7==r.eventType&&"Paste"==r.source?(0,Zf.cacheGetEventData)(r,"LINK_DATA",function(){var e=7==r.eventType&&"Paste"==r.source&&r.data,e=(0,Zf.matchLink)((e.text||"").trim()),t=o.getContentSearcherOfCursor(r);if(e&&t.getRangeFromText(e.originalUrl,!1))return e;var n,e=t&&t.getWordBefore();return e&&5<e.length?(t=(e.match(Yf)||[])[0]||"",n=e.substring(0,e.length-t.length),["()","{}","[]"].forEach(function(e){n[n.length-1]==e[1]&&n.indexOf(e[0])<0&&(n=n.substr(0,n.length-1))}),(0,Zf.matchLink)(n)):null}):null}Jn.AutoLinkFeatures={autoLink:{keys:[13,32,257],shouldHandleEvent:$f,handleEvent:function(t,e){var n=e.getDocument().createElement("a"),r=$f(t,e),o=e.getContentSearcherOfCursor();n.textContent=r.originalUrl,n.href=r.normalizedUrl,e.runAsync(function(e){e.addUndoSnapshot(function(){return(0,Gf.replaceWithNode)(e,r.originalUrl,n,!1,o),(0,Zf.clearEventDataCache)(t),n},"AutoLink",!0)})}},unlinkWhenBackspaceAfterLink:{keys:[8],shouldHandleEvent:function(e,t){return t.getContentSearcherOfCursor(e).getInlineElementBefore()instanceof Zf.LinkInlineElement},handleEvent:function(e,t){e.rawEvent.preventDefault(),(0,Gf.removeLink)(t)},defaultDisabled:!0}};var $a={},Xf=(Object.defineProperty($a,"__esModule",{value:!0}),$a.CursorFeatures=void 0,t),yl={keys:[37,39],allowFunctionKeys:!0,shouldHandleEvent:function(e,t,n){var r;if(!(n&&(n=t.getSelectionRange())&&n.collapsed&&(r=Xf.Position.getStart(n))&&t.isPositionAtBeginning(r)))return!1;n="rtl"==(0,Xf.getComputedStyle)(r.element,"direction"),t=e.rawEvent;return!n&&37==t.which||n&&39==t.which},handleEvent:function(e){e.rawEvent.preventDefault()},defaultDisabled:!Xf.Browser.isChrome},cc=($a.CursorFeatures={noCycleCursorMove:yl},{}),Qf=(Object.defineProperty(cc,"__esModule",{value:!0}),cc.EntityFeatures=void 0,t);function Jf(t,n,e){var r=(0,Qf.cacheGetEventData)(t,"READONLY_ENTITY_ELEMENT",function(){var e=t.rawEvent.target,e=e&&n.getElementAtCursor((0,Qf.getEntitySelector)(),e);return e&&!e.isContentEditable?e:null});return r&&void 0!==e&&n.triggerPluginEvent(15,{operation:e,rawEvent:t.rawEvent,entity:(0,Qf.getEntityFromElement)(r)}),r}function eh(e,r,o,i,t){var n=(0,Qf.cacheGetEventData)(e,"NEIGHBOR_ENTITY_ELEMENT_"+o+"_"+i,function(){var e=r.getSelectionRange();if(i&&!e.collapsed)return null;e.commonAncestorContainer.normalize();var t,e=Qf.Position.getEnd(e).normalize(),n=null;return 0!=e.offset&&!e.isAtEnd||(t=r.getBodyTraverser(e.node),t=(t=o?0==e.offset?t.currentInlineElement:t.getNextInlineElement():e.isAtEnd?t.currentInlineElement:t.getPreviousInlineElement())&&t.getContainerNode(),i||((e=r.getBlockElementAtNode(e.node))&&e.contains(t)||(t=null)),n=t&&r.getElementAtCursor((0,Qf.getEntitySelector)(),t)),n});return n&&void 0!==t&&r.triggerPluginEvent(15,{operation:t,rawEvent:e.rawEvent,entity:(0,Qf.getEntityFromElement)(n)}),n}cc.EntityFeatures={clickOnEntity:{keys:[13],shouldHandleEvent:function(e,t){return Jf(e,t)},handleEvent:function(e,t){Jf(e,t,1)}},escapeFromEntity:{keys:[27],shouldHandleEvent:function(e,t){return Jf(e,t)},handleEvent:function(e,t){Jf(e,t,3)}},enterBeforeReadonlyEntity:{keys:[13],shouldHandleEvent:function(e,t){return eh(e,t,!0,!1)},handleEvent:function(e,t){e.rawEvent.preventDefault();var e=t.getSelectionRange(),e=Qf.Position.getEnd(e).normalize().node,n=t.getDocument().createElement("BR");e.parentNode.insertBefore(n,e.nextSibling);var r,e=t.getBlockElementAtNode(e);e&&(r=e.collapseToSingleElement(),null!=(e=n.parentNode)&&e.removeChild(n)),t.getSelectionRange().deleteContents(),r.nextSibling&&t.select(r.nextSibling,0)}},backspaceAfterEntity:{keys:[8],shouldHandleEvent:function(e,t){return eh(e,t,!1,!0)},handleEvent:function(e,t){eh(e,t,!1,!0,5)}},deleteBeforeEntity:{keys:[46],shouldHandleEvent:function(e,t){return eh(e,t,!0,!0)},handleEvent:function(e,t){eh(e,t,!0,!0,4)}}};var L={},th=(Object.defineProperty(L,"__esModule",{value:!0}),L.ListFeatures=void 0,R),nh=t,z={keys:[13],shouldHandleEvent:function(e,t){t=t.getElementAtCursor("LI",null,e);return!e.rawEvent.shiftKey&&t&&(0,nh.isNodeEmpty)(t)},handleEvent:function(e,t){t.addUndoSnapshot(function(){return ah(e,t,!1)},null,!0)},defaultDisabled:!nh.Browser.isIE&&!nh.Browser.isChrome};function rh(e){return/^(\*|-|[0-9]{1,2}\.|[0-9]{1,2}\>|[0-9]{1,2}\)|[0-9]{1,2}\-|\([0-9]{1,2}\))$/.test(e)}function oh(e){return nh.VListChain.createListChains(e.getSelectedRegions())}function ih(e,t){var n,r=e.getBlockElementAtNode(t.startContainer),r=null==r?void 0:r.getEndNode();r&&"BR"!=(0,nh.getTagOfNode)(r)&&(n=e.getDocument().createElement("BR"),(0,nh.isBlockElement)(r)?r.appendChild(n):r.parentNode.insertBefore(n,r.nextSibling),e.select(t.startContainer,t.startOffset))}function ah(e,t,n){void 0===n&&(n=!0);var r=lh(e,t);r&&(r=r[0],"UL"!=(r=(0,nh.getTagOfNode)(r))&&"OL"!=r||(0,th.toggleListType)(t,"UL"==r?2:1,null,n),t.focus(),e.rawEvent.preventDefault())}function lh(e,t){e=t.getElementAtCursor("LI,TABLE",null,e),t=e&&"LI"==(0,nh.getTagOfNode)(e)&&t.getElementAtCursor("UL,OL",e);return t?[t,e]:null}L.ListFeatures={autoBullet:{keys:[32],shouldHandleEvent:function(e,t){return!lh(e,t)&&(rh((t=t.getContentSearcherOfCursor(e)).getSubStringBefore(4))&&!t.getNearestNonTextInlineElement())},handleEvent:function(e,o){o.insertContent("&nbsp;"),e.rawEvent.preventDefault(),o.addUndoSnapshot(function(){var e,t=o.getContentSearcherOfCursor(),n=t.getSubStringBefore(4),r=t.getRangeFromText(n,!0);r&&(0==n.indexOf("*")||0==n.indexOf("-")?(ih(o,r),(0,th.toggleBullet)(o)):rh(n)?(ih(o,r),(0,th.toggleNumbering)(o)):(e=o.getSelectedRegions())&&1==e.length&&(e=parseInt(n),ih(o,r),(0,th.toggleNumbering)(o,e))),null!=(r=t.getRangeFromText(n,!0))&&r.deleteContents()},null,!0)}},indentWhenTab:{keys:[9],shouldHandleEvent:function(e,t){return!e.rawEvent.shiftKey&&lh(e,t)},handleEvent:function(e,t){(0,th.setIndentation)(t,0),e.rawEvent.preventDefault()}},outdentWhenShiftTab:{keys:[9],shouldHandleEvent:function(e,t){return e.rawEvent.shiftKey&&lh(e,t)},handleEvent:function(e,t){(0,th.setIndentation)(t,1),e.rawEvent.preventDefault()}},outdentWhenBackspaceOnEmptyFirstLine:{keys:[8],shouldHandleEvent:function(e,t){t=t.getElementAtCursor("LI",null,e);return t&&(0,nh.isNodeEmpty)(t)&&!t.previousSibling},handleEvent:ah},outdentWhenEnterOnEmptyLine:z,mergeInNewLineWhenBackspaceOnFirstChar:{keys:[8],shouldHandleEvent:function(e,t){e=t.getElementAtCursor("LI",null,e),t=t.getSelectionRange();return e&&(null==t?void 0:t.collapsed)&&(0,nh.isPositionAtBeginningOf)(nh.Position.getStart(t),e)},handleEvent:function(r,e){var o=e.getElementAtCursor("LI",null,r);o.previousSibling?(0,th.blockFormat)(e,function(e,t,n){e=(0,nh.createVListFromRegion)(e,!1,o);e.setIndentation(t,n,1,!0),e.writeBack(),r.rawEvent.preventDefault()}):ah(r,e)},defaultDisabled:!0},maintainListChain:{keys:[13,9,46,8,258],shouldHandleEvent:function(e,t){return 0<t.queryElements("li",1).length},handleEvent:function(e,t){var n=oh(t);t.runAsync(function(e){return(0,th.experimentCommitListChains)(e,n)})}},maintainListChainWhenDelete:{keys:[46],shouldHandleEvent:function(e,t){if(t.getElementAtCursor("LI",null,e))return!1;var n,r=nh.Position.getEnd(t.getSelectionRange()).isAtEnd?(n=t,(0,nh.cacheGetEventData)(e,"nextSibling",function(){var e=n.getSelectionRange(),e=nh.Position.getEnd(e).normalize(),e=n.getBodyTraverser(e.node);return null==(e=null==e?void 0:e.getNextBlockElement())?void 0:e.getStartNode()})):null;return t.getElementAtCursor("LI",r,e)},handleEvent:function(e,t){var n=oh(t);t.runAsync(function(e){return(0,th.experimentCommitListChains)(e,n)})}}};var r={},sh=(Object.defineProperty(r,"__esModule",{value:!0}),r.MarkdownFeatures=void 0,t);function ch(e,n,l,r){return{keys:[e],shouldHandleEvent:function(e,t){return e.rawEvent.shiftKey===r&&!!dh(e,t,n)},handleEvent:function(t,e){e.runAsync(function(e){var r,o,i,a;r=t,i=n,a=l,(o=e).addUndoSnapshot(function(){var e,t,n=dh(r,o,i);n&&((t=n.cloneRange()).setStart(t.startContainer,t.startOffset+1),n.setEnd(n.endContainer,n.endOffset+1),(e=o.getDocument().createElement(a)).appendChild(t.extractContents()),n.deleteContents(),t=o.getDocument().createTextNode("​"),n.insertNode(t),n.insertNode(e),o.select(t,-1))},"Format",!0)})}}}function dh(e,t,i){return(0,sh.cacheGetEventData)(e,"MARKDOWN_RANGE",function(){var r,o;return t.getContentSearcherOfCursor(e).forEachTextInlineElement(function(e){if(o&&r)return!0;var t=e.getTextContent();if(0==t[t.length-1].trim().length)return!1;if(t[t.length-1]===i)return!1;if(o=o||e.getStartPosition().move(t.length),t[0]==i)r=e.getStartPosition();else for(var n=t.length-1;0<n;n--){if(r)return!0;if(t[n]==i&&0==t[n-1].trim().length)return r=e.getStartPosition().move(n),!0}}),!!r&&!!o&&(0,sh.createRange)(r,o)})}var H=ch(56,"*","b",!0),n=ch(189,"_","i",!0),Re=ch(192,"~","s",!0),f=ch(192,"`","code",!1),c=(r.MarkdownFeatures={markdownBold:H,markdownItalic:n,markdownStrikethru:Re,markdownInlineCode:f},{}),uh=(Object.defineProperty(c,"__esModule",{value:!0}),c.QuoteFeatures=void 0,R),fh=t,hh="BLOCKQUOTE",ph=[hh,"LI","TD","TH"].join(",");function gh(e,n){return(0,fh.cacheGetEventData)(e,"QUOTE_CHILD",function(){var e=n.getElementAtCursor(ph);if(e&&(0,fh.getTagOfNode)(e)==hh){var t=n.getFocusedPosition(),t=t&&n.getBlockElementAtNode(t.normalize().node);if(t)return e=t.getStartNode()==e?t.getStartNode():t.collapseToSingleElement(),(0,fh.isNodeEmpty)(e)?e:null}return null})}function mh(r,o){o.addUndoSnapshot(function(){var e,t,n=gh(r,o);(0,fh.getTagOfNode)(n)==hh&&(n=(0,fh.wrap)((0,fh.toArray)(n.childNodes))),e=(0,fh.splitBalancedNodeRange)(n),t=vh(e),(0,fh.unwrap)(e),o.select(n,0),t&&(0,uh.clearFormat)(o)}),r.rawEvent.preventDefault()}var vh=function(e){return!!(e&&(0,fh.safeInstanceOf)(e,"HTMLQuoteElement")&&e.style.borderLeft&&e.style.borderColor&&e.style.paddingLeft&&e.style.color)},m=(c.QuoteFeatures={unquoteWhenBackspaceOnEmptyFirstLine:{keys:[8],shouldHandleEvent:function(e,t){e=gh(e,t);return e&&(0,fh.isNodeEmpty)(e)&&!e.previousSibling},handleEvent:mh},unquoteWhenEnterOnEmptyLine:{keys:[13],shouldHandleEvent:function(e,t){t=gh(e,t);return!e.rawEvent.shiftKey&&t&&(0,fh.isNodeEmpty)(t)},handleEvent:function(e,t){return t.addUndoSnapshot(function(){return mh(e,t)},null,!0)}}},{}),yh=(Object.defineProperty(m,"__esModule",{value:!0}),m.ShortcutFeatures=void 0,t),bh=R;function Eh(e,t,n){return{winKey:e,macKey:t,action:n}}var Ch=[Eh(4162,8258,bh.toggleBold),Eh(4169,8265,bh.toggleItalic),Eh(4181,8277,bh.toggleUnderline),Eh(4186,8282,function(e){return e.undo()}),Eh(4185,24666,function(e){return e.redo()}),Eh(4286,8382,bh.toggleBullet),Eh(4287,8383,bh.toggleNumbering),Eh(20670,24766,function(e){return(0,bh.changeFontSize)(e,0)}),Eh(20668,24764,function(e){return(0,bh.changeFontSize)(e,1)})];function wh(n){return(0,yh.cacheGetEventData)(n,"DEFAULT_SHORT_COMMAND",function(){var e=n.rawEvent,t=0!=n.eventType||e.altKey?0:e.which|(e.metaKey&&8192)|(e.shiftKey&&16384)|(e.ctrlKey&&4096);return t&&Ch.filter(function(e){return(yh.Browser.isMac?e.macKey:e.winKey)==t})[0]})}m.ShortcutFeatures={defaultShortcut:{allowFunctionKeys:!0,keys:[66,73,85,89,90,188,190,191],shouldHandleEvent:wh,handleEvent:function(e,t){var n=wh(e);n&&(n.action(t),e.rawEvent.preventDefault(),e.rawEvent.stopPropagation())}}};var h={},Sh=(Object.defineProperty(h,"__esModule",{value:!0}),h.StructuredNodeFeatures=void 0,t),Th={TD:"TABLE",TH:"TABLE",LI:"OL,UL"},Ph=Object.keys(Th).join(",");function Oh(n,r){return(0,Sh.cacheGetEventData)(n,"FIRST_STRUCTURE",function(){var e=n.rawEvent.shiftKey?null:r.getElementAtCursor(Ph);if(e){var t=r.getSelectionRange();if(t&&t.collapsed&&(0,Sh.isPositionAtBeginningOf)(Sh.Position.getStart(t),e)&&!r.getBodyTraverser(e).getPreviousBlockElement())return r.getElementAtCursor(Th[(0,Sh.getTagOfNode)(e)])}return null})}h.StructuredNodeFeatures={insertLineBeforeStructuredNodeFeature:{keys:[13],shouldHandleEvent:Oh,handleEvent:function(e,t){var n=Oh(e,t),r=(0,Sh.createElement)(1,t.getDocument());t.addUndoSnapshot(function(){n.parentNode.insertBefore(r,n),"TABLE"==(0,Sh.getTagOfNode)(n)&&t.select(new Sh.Position(r,0).normalize())}),e.rawEvent.preventDefault()},defaultDisabled:!0}};var Nt={},xh=(Object.defineProperty(Nt,"__esModule",{value:!0}),Nt.TableFeatures=void 0,R),_h=t,tt={keys:[38,40],shouldHandleEvent:function(e,t){return Nh(e,t)&&!Rh(e,t)},handleEvent:function(e,t){var r=Nh(e,t),o=new _h.VTable(r),i=38==e.rawEvent.which,n=i?-1:1,a=e.rawEvent.shiftKey,e=null==(e=t.getDocument().defaultView)?void 0:e.getSelection(),l=null;if(e){for(var s=e.anchorNode,c=e.anchorOffset,d=o.row;0<=d&&d<o.cells.length;d+=n){var u=o.getCell(d,o.col);if(u.td&&u.td!=r){l=u.td;break}}t.runAsync(function(e){var t,n=e.getElementAtCursor();(0,_h.contains)(o.table,n)&&!(0,_h.contains)(r,n,!0)&&(n=l?new _h.Position(l,0):new _h.Position(o.table,i?-2:-3),a?(n=1==n.node.nodeType&&(0,_h.isVoidHtmlElement)(n.node)?new _h.Position(n.node,n.isAtEnd?-3:-2):n,null!=(t=null==(t=e.getDocument().defaultView)?void 0:t.getSelection())&&t.setBaseAndExtent(s,c,n.node,n.offset)):e.select(n))})}},defaultDisabled:!_h.Browser.isChrome&&!_h.Browser.isSafari};function Nh(e,t){return(0,_h.cacheGetEventData)(e,"TABLE_CELL_FOR_TABLE_FEATURES",function(){var e=t.getFocusedPosition(),e=e&&t.getElementAtCursor("TD,TH,LI",e.node);return e&&("LI"==(0,_h.getTagOfNode)(e)?null:e)})}function Rh(n,r){return(0,_h.cacheGetEventData)(n,"WHOLE_TABLE_SELECTED_FOR_FEATURES",function(){var e=Nh(n,r),e=kh(n,e),t=r.getSelectionRangeEx();return 1==t.type&&(0,_h.isWholeTableSelected)(e,t.coordinates)})}function kh(e,t){return(0,_h.cacheGetEventData)(e,"VTABLE_FOR_TABLE_FEATURES",function(){return new _h.VTable(t)})}Nt.TableFeatures={tabInTable:{keys:[9],shouldHandleEvent:function(e,t){return Nh(e,t)&&!Rh(e,t)},handleEvent:function(e,t){for(var n=e.rawEvent.shiftKey,r=kh(e,Nh(e,t)),o=n?-1:1,i=r.row,a=r.col+o;;a+=o){if(a<0||a>=r.cells[i].length){if((i+=o)<0){t.select(r.table,-2);break}if(i>=r.cells.length){(0,xh.editTable)(t,1);break}a=n?r.cells[i].length-1:0}var l=r.getCell(i,a);if(l.td){t.select(l.td,0);break}}e.rawEvent.preventDefault()}},upDownInTable:tt,indentTableOnTab:{keys:[9],shouldHandleEvent:function(e,t){return Nh(e,t)&&Rh(e,t)},handleEvent:function(r,o){r.rawEvent.preventDefault(),o.addUndoSnapshot(function(){var e=r.rawEvent.shiftKey,t=o.getSelectionRangeEx(),n=Nh(r,o),n=kh(r,n);e&&o.getElementAtCursor("blockquote",n.table,r)?(0,xh.setIndentation)(o,1):e||(0,xh.setIndentation)(o,0),o.select(t.table,t.coordinates)})}}};var en={},Lh=(Object.defineProperty(en,"__esModule",{value:!0}),en.TextFeatures=void 0,R),Ih=t;function Mh(e,t){var n=!1,r=Ih.Position.getStart(t),o=Ih.Position.getEnd(t),r=e.getBlockElementAtNode(r.node),e=e.getBlockElementAtNode(o.node);return!r.equals(e)||(o=new Ih.Position(r.getStartNode(),0),e=new Ih.Position(r.getEndNode(),-1),r=(0,Ih.createRange)(o,Ih.Position.getStart(t)),o=(0,Ih.createRange)(Ih.Position.getEnd(t),e),!(n||!Ah(r)||!Ah(o))||n)}function Ah(e){return""==e.toString()&&0==(0,Ih.queryElements)(e.commonAncestorContainer,"img,table,ul,ol",null,2,e).length}function Dh(e,t){for(var n,r=e.getDocument().createElement("span"),o=6-e.getContentSearcherOfCursor(t).getSubStringBefore(Number.MAX_SAFE_INTEGER).length%6,i="",a=0;a<o;a++)i+="&ensp;";e.insertNode(r),r.nextElementSibling&&"A"==(0,Ih.getTagOfNode)(r.nextElementSibling)&&((n=e.getDocument().createElement("span")).textContent=" ",e.insertNode(n),e.select((0,Ih.createRange)(n,-2))),e.insertContent(i,{position:5,range:(0,Ih.createRange)(r,0),updateCursor:!1}),e.select((0,Ih.createRange)(r,-3)),n&&e.deleteNode(n)}en.TextFeatures={indentWhenTabText:{keys:[9],shouldHandleEvent:function(e,t){var n,r;return!(!t.isFeatureEnabled("TabKeyTextFeatures")||e.rawEvent.shiftKey)&&(n=t.getDocument().activeElement,r=t.getElementAtCursor("LI,TABLE",null,e),t=t.getElementAtCursor((0,Ih.getEntitySelector)(),void 0,e),!r&&(t||n).isContentEditable)},handleEvent:function(n,r){var o=r.getSelectionRangeEx();0==o.type&&(r.addUndoSnapshot(function(){var e,t;o.areAllCollapsed?Dh(r,n):(t=(e=o.ranges)[0],Mh(r,t)?(0,Lh.setIndentation)(r,0):(t=(0,Ih.createRange)(t.startContainer,t.startOffset),e.forEach(function(e){return e.deleteContents()}),r.select(t),Dh(r,n)))}),n.rawEvent.preventDefault())}},outdentWhenTabText:{keys:[9],shouldHandleEvent:function(e,t){var n;return!(!e.rawEvent.shiftKey||!t.isFeatureEnabled("TabKeyTextFeatures"))&&(0==(n=t.getSelectionRangeEx()).type&&!n.areAllCollapsed&&t.getElementAtCursor("blockquote",null,e)&&!t.getElementAtCursor("LI,TABLE",null,e)&&Mh(t,n.ranges[0]))},handleEvent:function(e,t){t.addUndoSnapshot(function(){return(0,Lh.setIndentation)(t,1)}),e.rawEvent.preventDefault()}}};var jh,Bh,Fh,Hh=e&&e.__assign||function(){return(Hh=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},et=(Object.defineProperty(Cr,"__esModule",{value:!0}),Jn),nt=$a,Je=cc,Qt=r,v=c,xe=m,Qn=h,rr=Nt,se=en,zh=Hh(Hh(Hh(Hh(Hh(Hh(Hh(Hh(Hh(Hh({},L.ListFeatures),v.QuoteFeatures),rr.TableFeatures),Qn.StructuredNodeFeatures),et.AutoLinkFeatures),xe.ShortcutFeatures),nt.CursorFeatures),Qt.MarkdownFeatures),Je.EntityFeatures),se.TextFeatures),Uh=(Cr.default=function(){return zh},Object.defineProperty(ln,"__esModule",{value:!0}),Cr);function Vh(e,t){this.settingsOverride=e,this.additionalFeatures=t}Vh.prototype.getName=function(){return"ContentEdit"},Vh.prototype.initialize=function(t){var r=this,o=[],i=(0,Uh.default)();Object.keys(i).forEach(function(e){var t=i[e],n=r.settingsOverride&&void 0!==r.settingsOverride[e];(n&&r.settingsOverride[e]||!n&&!t.defaultDisabled)&&o.push(t)}),o.concat(this.additionalFeatures||[]).forEach(function(e){return t.addContentEditFeature(e)})},Vh.prototype.dispose=function(){},ln.default=Vh,s=o,Object.defineProperty(s,"__esModule",{value:!0}),s.getAllFeatures=s.ContentEdit=void 0,Bh=ln,Object.defineProperty(s,"ContentEdit",{enumerable:!0,get:function(){return Bh.default}}),Fh=Cr,Object.defineProperty(s,"getAllFeatures",{enumerable:!0,get:function(){return Fh.default}}),gr=q,jh=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),mr=e&&e.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||jh(t,e,n)},Object.defineProperty(gr,"__esModule",{value:!0}),mr(o,gr);var Wh,Kh,sr={},l={},X={},qh=(Object.defineProperty(X,"__esModule",{value:!0}),t);function Gh(e){var n=this;this.options=e,this.onDismiss=function(){var e,t;n.container&&n.isMenuShowing&&(null!=(t=(e=n.options).dismiss)&&t.call(e,n.container),n.isMenuShowing=!1)}}Gh.prototype.getName=function(){return"ContextMenu"},Gh.prototype.initialize=function(e){this.editor=e},Gh.prototype.dispose=function(){this.onDismiss(),this.container&&(this.container.parentNode.removeChild(this.container),this.container=null),this.editor=null},Gh.prototype.onPluginEvent=function(e){var t;16==e.eventType&&0<e.items.length&&(t=e.rawEvent,e=e.items,this.onDismiss(),this.options.allowDefaultMenu||t.preventDefault(),this.initContainer(t.pageX,t.pageY),this.options.render(this.container,e,this.onDismiss),this.isMenuShowing=!0)},Gh.prototype.initContainer=function(e,t){this.container||(this.container=(0,qh.createElement)(5,this.editor.getDocument()),this.editor.getDocument().body.appendChild(this.container)),this.container.style.left=e+"px",this.container.style.top=t+"px"},X.default=Gh,cr=l,Object.defineProperty(cr,"__esModule",{value:!0}),cr.ContextMenu=void 0,Kh=X,Object.defineProperty(cr,"ContextMenu",{enumerable:!0,get:function(){return Kh.default}}),ie=sr,Wh=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),i=e&&e.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||Wh(t,e,n)},Object.defineProperty(ie,"__esModule",{value:!0}),i(l,ie);function Zh(e,t,n,r){return{sourceString:e,replacementHTML:t,matchSourceCaseSensitive:n,shouldReplace:r}}var Yh,$h,y={},Oe={},p={},Xh=(Object.defineProperty(p,"__esModule",{value:!0}),[Zh(":)","🙂",!0),Zh(";)","😉",!0),Zh(":O","😲",!0),Zh(":o","😯",!0),Zh("<3","❤️",!0)]);function Qh(e){this.updateReplacements(e=void 0===e?Xh:e)}Qh.prototype.updateReplacements=function(e){this.replacements=e,this.longestReplacementLength=(e=this.replacements,Math.max.apply(null,e.map(function(e){return e.sourceString.length}))),this.replacementEndCharacters=function(e){for(var t=new Set,n=0,r=e;n<r.length;n++){var o=r[n],i=o.sourceString;0!=i.length&&(i=i[i.length-1],o.matchSourceCaseSensitive?t.add(i):(t.add(i.toLocaleLowerCase()),t.add(i.toLocaleUpperCase())))}return t}(this.replacements)},Qh.prototype.getName=function(){return"CustomReplace"},Qh.prototype.initialize=function(e){this.editor=e},Qh.prototype.dispose=function(){this.editor=null},Qh.prototype.onPluginEvent=function(e){var t,n,r,o,i=this;3==e.eventType&&!this.editor.isInIME()&&e.rawEvent.data&&this.replacementEndCharacters.has(e.rawEvent.data)&&null!=this.editor.getSelectionRange()&&(t=(e=this.editor.getContentSearcherOfCursor(e)).getSubStringBefore(this.longestReplacementLength),null==(t=this.getMatchingReplacement(t))||t.shouldReplace&&!t.shouldReplace(t,e.getWordBefore())||(n=e.getSubStringBefore(t.sourceString.length),r=e.getRangeFromText(n,!0),(e=this.editor.getDocument().createElement("span")).innerHTML=this.editor.getTrustedHTMLHandler()(t.replacementHTML),o=1==e.childNodes.length?e.childNodes[0]:e,this.editor.addUndoSnapshot(function(){r.deleteContents(),r.insertNode(o),i.editor.select(o,-1)},null,!0)))},Qh.prototype.getMatchingReplacement=function(e){if(0==e.length)return null;for(var t=e.replace(/\s/g," "),n=t.toLocaleLowerCase(),r=0,o=this.replacements;r<o.length;r++){var i=o[r],a=i.matchSourceCaseSensitive?[t,i.sourceString]:[n,i.sourceString.toLocaleLowerCase()],l=a[0],a=a[1];if(l.substring(l.length-a.length)==a)return i}return null},p.default=Qh,Ht=Oe,Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.CustomReplace=void 0,$h=p,Object.defineProperty(Ht,"CustomReplace",{enumerable:!0,get:function(){return $h.default}}),F=y,Yh=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),ot=e&&e.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||Yh(t,e,n)},Object.defineProperty(F,"__esModule",{value:!0}),ot(Oe,F);var Jh,e0,B={},rt={},Wr={},t0=(Object.defineProperty(Wr,"__esModule",{value:!0}),R),n0=t;function r0(){var e=this;this.onDrop=function(){e.cacheListChains("Drop")}}r0.prototype.getName=function(){return"CutPasteListChain"},r0.prototype.initialize=function(e){this.editor=e,this.disposer=this.editor.addDomEventHandler("drop",this.onDrop)},r0.prototype.dispose=function(){var e;null!=(e=this.disposer)&&e.call(this),this.disposer=null,this.editor=null},r0.prototype.onPluginEvent=function(e){var t;switch(e.eventType){case 9:e.isCut&&this.cacheListChains("Cut");break;case 10:this.cacheListChains("Paste");break;case 7:0<(null==(t=this.chains)?void 0:t.length)&&this.expectedChangeSource==e.source&&((0,t0.experimentCommitListChains)(this.editor,this.chains),this.chains=null,this.expectedChangeSource=null)}},r0.prototype.cacheListChains=function(e){this.chains=n0.VListChain.createListChains(this.editor.getSelectedRegions()),this.expectedChangeSource=e},Wr.default=r0,ua=rt,Object.defineProperty(ua,"__esModule",{value:!0}),ua.CutPasteListChain=void 0,e0=Wr,Object.defineProperty(ua,"CutPasteListChain",{enumerable:!0,get:function(){return e0.default}}),u=B,Jh=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),Ua=e&&e.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||Jh(t,e,n)},Object.defineProperty(u,"__esModule",{value:!0}),Ua(rt,u);var o0,i0,Vr={},ce={},or={},a0=(Object.defineProperty(or,"__esModule",{value:!0}),t);function l0(e,t,n){var r=this;this.getTooltipCallback=e=void 0===e?function(e){return e}:e,this.target=t,this.onLinkClick=n,this.trackedLink=null,this.onMouse=function(e){var t=r.editor.getElementAtCursor("a[href]",e.target),n=r.tryGetHref(t);n&&r.editor.setEditorDomAttribute("title","mouseover"==e.type?r.getTooltipCallback(n,t):null)},this.onBlur=function(e){r.trackedLink&&r.updateLinkHrefIfShouldUpdate(),r.resetLinkTracking()}}l0.prototype.getName=function(){return"Hyperlink"},l0.prototype.initialize=function(e){this.editor=e,this.disposer=this.getTooltipCallback&&e.addDomEventHandler({mouseover:this.onMouse,mouseout:this.onMouse,blur:this.onBlur})},l0.prototype.dispose=function(){this.disposer&&(this.disposer(),this.disposer=null),this.editor=null},l0.prototype.onPluginEvent=function(e){var t;if(6!=e.eventType&&(2!=e.eventType||this.isContentEditValue(e.rawEvent)&&32!=e.rawEvent.which)&&7!=e.eventType||(n=(t=this.editor.getElementAtCursor("A[href]",null,e))!==this.trackedLink||2==e.eventType||7==e.eventType,this.trackedLink&&(n||this.tryGetHref(this.trackedLink)!==this.originalHref)&&(n&&this.updateLinkHrefIfShouldUpdate(),this.resetLinkTracking()),!this.trackedLink&&this.doesLinkDisplayMatchHref(t)&&(this.trackedLink=t,this.originalHref=this.tryGetHref(t))),6==e.eventType&&(t=this.editor.getElementAtCursor("A",e.rawEvent.srcElement))&&(!this.onLinkClick||!1===this.onLinkClick(t,e.rawEvent))){var n=void 0;if(!a0.Browser.isFirefox&&(n=this.tryGetHref(t))&&(0,a0.isCtrlOrMetaPressed)(e.rawEvent)&&0===e.rawEvent.button)try{var r=this.target||"_blank";this.editor.getDocument().defaultView.open(n,r)}catch(e){}}},l0.prototype.tryGetHref=function(e){try{return e?e.href:null}catch(e){}},l0.prototype.isContentEditValue=function(e){return(0,a0.isCharacterValue)(e)||8==e.which||46==e.which},l0.prototype.updateLinkHrefIfShouldUpdate=function(){this.doesLinkDisplayMatchHref(this.trackedLink)||this.updateLinkHref()},l0.prototype.resetLinkTracking=function(){this.trackedLink=null,this.originalHref=""},l0.prototype.doesLinkDisplayMatchHref=function(e){if(e){var t=e.innerText.trim().replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),t=new RegExp("^(?:https?:\\/\\/)?"+t+"\\/?","i"),e=this.tryGetHref(e);if(null!==e)return t.test(e)}return!1},l0.prototype.updateLinkHref=function(){var e,t=this;this.trackedLink&&null!==(e=(0,a0.matchLink)(this.trackedLink.innerText.trim()))&&this.editor.addUndoSnapshot(function(){t.trackedLink.href=e.normalizedUrl})},or.default=l0,Sr=ce,Object.defineProperty(Sr,"__esModule",{value:!0}),Sr.HyperLink=void 0,i0=or,Object.defineProperty(Sr,"HyperLink",{enumerable:!0,get:function(){return i0.default}}),Ro=Vr,o0=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),d=e&&e.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o0(t,e,n)},Object.defineProperty(Ro,"__esModule",{value:!0}),d(ce,Ro);var s0,c0,d0,u0,oe={},Ai={},Fi={},Vi={},Gi={};function f0(e,t){return Math.abs(e-t)<.001}S=Gi,T=e&&e.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||((r=r||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},Object.defineProperty(S,"__esModule",{value:!0}),S.ImageEditInfoState=void 0,c0=["leftPercent","rightPercent","topPercent","bottomPercent"],d0=T(T([],s0=["angleRad"],!0),c0,!0),u0=T(T([],d0,!0),["widthPx","heightPx"],!0),(T=S.ImageEditInfoState||(S.ImageEditInfoState={}))[T.Invalid=0]="Invalid",T[T.ResizeOnly=1]="ResizeOnly",T[T.SameWithLast=2]="SameWithLast",T[T.FullyChanged=3]="FullyChanged",S.default=function(t,n){return t&&t.src&&!u0.some(function(e){return!("number"==typeof t[e])})?d0.every(function(e){return f0(t[e],0)})?1:n&&s0.every(function(e){return f0(t[e],0)})&&s0.every(function(e){return f0(n[e],0)})&&c0.every(function(e){return f0(t[e],n[e])})?2:3:0};var na={},oa={},h0=(Object.defineProperty(oa,"__esModule",{value:!0}),oa.default=function(e,t){var n=e.widthPx,r=e.heightPx,o=e.angleRad,i=n/(1-e.leftPercent-e.rightPercent),e=r/(1-e.topPercent-e.bottomPercent),n=t?i:n,t=t?e:r;return{targetWidth:Math.abs(n*Math.cos(o))+Math.abs(t*Math.sin(o)),targetHeight:Math.abs(n*Math.sin(o))+Math.abs(t*Math.cos(o)),originalWidth:i,originalHeight:e,visibleWidth:n,visibleHeight:t}},Object.defineProperty(na,"__esModule",{value:!0}),oa),No=(na.default=function(e,t){var n=t.angleRad,r=t.widthPx,o=t.heightPx,i=t.bottomPercent,a=t.leftPercent,l=t.rightPercent,s=t.topPercent,c=t.naturalWidth,d=t.naturalHeight,l=c*(1-a-l),i=d*(1-s-i),u=document.createElement("canvas"),t=(0,h0.default)(t),f=t.targetWidth,t=t.targetHeight,h=(u.width=f,u.height=t,u.getContext("2d"));return h.translate(f/2,t/2),h.rotate(n),h.drawImage(e,c*a,d*s,l,i,-r/2,-o/2,r,o),u.toDataURL("image/png",1)},{}),p0=(Object.defineProperty(No,"__esModule",{value:!0}),No.getEditInfoFromImage=No.deleteEditInfo=No.saveEditInfo=void 0,Gi),g0=(No.saveEditInfo=function(e,t){e&&(e.dataset.roosterEditInfo=JSON.stringify(t))},No.deleteEditInfo=function(e){e&&delete e.dataset.roosterEditInfo},No.getEditInfoFromImage=function(e){var t=function(e){try{return JSON.parse(e)}catch(e){return null}}(null==e?void 0:e.dataset.roosterEditInfo);return 0==(0,p0.default)(t)?{src:(e=e).getAttribute("src")||"",widthPx:e.clientWidth,heightPx:e.clientHeight,naturalWidth:e.naturalWidth,naturalHeight:e.naturalHeight,leftPercent:0,rightPercent:0,topPercent:0,bottomPercent:0,angleRad:0}:t},Object.defineProperty(Vi,"__esModule",{value:!0}),Gi),m0=na,v0=oa,y0=No,Lo=(Vi.default=function(e,t,n,r,o){var i="",a=(0,y0.getEditInfoFromImage)(t);switch((0,g0.default)(n,a)){case 1:i=n.src;break;case 2:i=r;break;case 3:i=(0,m0.default)(t,n)}var l,s=i!=r,e=((i=s?e.triggerPluginEvent(19,{image:t,originalSrc:n.src,previousSrc:r,newSrc:i}).newSrc:i)==n.src?(0,y0.deleteEditInfo)(t):(0,y0.saveEditInfo)(t,n),(0,v0.default)(n)),c=e.targetWidth,e=e.targetHeight;return t.src=i,l=t,c=c,e=e,o?(l.style.maxWidth="initial",l.width=c,l.height=e,l.style.width=c+"px",l.style.height=e+"px"):(l.style.maxWidth="100%",l.style.height="initial",l.style.width="initial",l.removeAttribute("height"),l.removeAttribute("width")),s||n.widthPx!=a.widthPx||n.heightPx!=a.heightPx},{}),ra=(Object.defineProperty(Lo,"__esModule",{value:!0}),Lo.default=function(e){if(!e)return!1;try{var t=e.ownerDocument.createElement("canvas"),n=(t.width=10,t.height=10,t.getContext("2d"));return n.drawImage(e,0,0),n.getImageData(0,0,1,1),!0}catch(e){return!1}},{});function b0(e,t,n,r,o){var i=this;this.trigger=e,this.context=t,this.onSubmit=n,this.handler=r,this.zoomScale=o,this.onMouseDown=function(e){var t,n;e.preventDefault(),e.stopPropagation(),i.addDocumentEvents(),i.initX=e.pageX,i.initY=e.pageY,i.initValue=null==(n=(t=i.handler).onDragStart)?void 0:n.call(t,i.context,e)},this.onMouseMove=function(e){e.preventDefault();var t,n,r=(e.pageX-i.initX)/i.zoomScale,o=(e.pageY-i.initY)/i.zoomScale;null!=(n=(t=i.handler).onDragging)&&n.call(t,i.context,e,i.initValue,r,o)&&null!=(n=i.onSubmit)&&n.call(i,i.context,i.trigger)},this.onMouseUp=function(e){var t,n;e.preventDefault(),i.removeDocumentEvents(),null!=(n=(t=i.handler).onDragEnd)&&n.call(t,i.context,e,i.initValue)&&null!=(n=i.onSubmit)&&n.call(i,i.context,i.trigger)},e.addEventListener("mousedown",this.onMouseDown)}Object.defineProperty(ra,"__esModule",{value:!0}),b0.prototype.dispose=function(){this.trigger.removeEventListener("mousedown",this.onMouseDown),this.removeDocumentEvents()},b0.prototype.addDocumentEvents=function(){var e=this.trigger.ownerDocument;e.addEventListener("mousemove",this.onMouseMove,!0),e.addEventListener("mouseup",this.onMouseUp,!0)},b0.prototype.removeDocumentEvents=function(){var e=this.trigger.ownerDocument;e.removeEventListener("mousemove",this.onMouseMove,!0),e.removeEventListener("mouseup",this.onMouseUp,!0)},ra.default=b0;var g={},C={},E0=e&&e.__assign||function(){return(E0=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},C0=(Object.defineProperty(C,"__esModule",{value:!0}),C.getResizeBordersHTML=C.getSideResizeHTML=C.getCornerResizeHTML=C.doubleCheckResize=C.rotateCoordinate=C.Resizer=void 0,0,["w","","e"]),w0=["s","","n"];function S0(e,t,n){if(0==e&&0==t)return[0,0];var r=Math.sqrt(e*e+t*t);return n=Math.atan2(t,e)-n,[r*Math.cos(n),r*Math.sin(n)]}function T0(e,t,n,r){var o="w"==e?"left":"right",i="n"==t?"top":"bottom";return""==e&&""==t?null:{tag:"div",style:"position:absolute;"+o+":"+(""==e?"50%":"0px")+";"+i+":"+(""==t?"50%":"0px"),children:[{tag:"div",style:P0[r](t+e,i,o,n),className:"r_resizeH",dataset:{x:e,y:t}}]}}C.Resizer={onDragStart:function(e){e=e.editInfo;return E0({},e)},onDragging:function(e,t,n,r,o){var i=e.x,a=e.y,l=e.editInfo,e=e.options,s=0<n.widthPx&&0<n.heightPx?+n.widthPx/n.heightPx:0,c=(r=(c=S0(r,o,l.angleRad))[0],o=c[1],""==i),d=""==a,t=!(c||d)&&(e.preserveRatio||t.shiftKey),c=c?n.widthPx:Math.max(n.widthPx+r*("w"==i?-1:1),e.minWidth),r=d?n.heightPx:Math.max(n.heightPx+o*("n"==a?-1:1),e.minHeight);return t&&0<s&&(r=Math.min(r,c/s),(c=Math.min(c,r*s))<r*s?c=r*s:r=c/s),l.widthPx=c,l.heightPx=r,!0}},C.rotateCoordinate=S0,C.doubleCheckResize=function(e,t,n,r){var o=e.widthPx,i=e.heightPx,a=0<i?o/i:0;n=Math.floor(n),r=Math.floor(r),o=Math.floor(o),i=Math.floor(i),e.widthPx=n,e.heightPx=r,t&&0<a&&(o!==n||i!==r)&&(n<o?e.heightPx=n/a:e.widthPx=r*a)},C.getCornerResizeHTML=function(e){var n=e.borderColor,r=e.handlesExperimentalFeatures,o=[];return C0.forEach(function(t){return w0.forEach(function(e){return o.push(""==t==(""==e)?T0(t,e,n,r?1:0):null)})}),o},C.getSideResizeHTML=function(e){var n=e.borderColor,t=e.isSmallImage,r=e.handlesExperimentalFeatures;if(t)return null;var o=[];return C0.forEach(function(t){return w0.forEach(function(e){return o.push(""==t!=(""==e)?T0(t,e,n,r?1:0):null)})}),o},C.getResizeBordersHTML=function(e){return{tag:"div",style:"position:absolute;left:0;right:0;top:0;bottom:0;border:solid 2px "+e.borderColor+";pointer-events:none;"}};var P0={0:function(e,t,n,r){return"position:relative;width:10px;height:10px;background-color: "+r+";cursor:"+e+"-resize;"+n+":-3px;"+t+":-3px;"},1:function(e,t,n){return"position:relative;width:10px;height:10px;background-color: #FFFFFF;cursor:"+e+"-resize;"+n+":-3px;"+t+":-3px;border-radius:100%;border: 2px solid #bfbfbf;box-shadow: 0px 0.36316px 1.36185px rgba(100, 100, 100, 0.25);"}},O0=e&&e.__assign||function(){return(O0=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},x0=(Object.defineProperty(g,"__esModule",{value:!0}),g.getCropHTML=g.Cropper=void 0,C),_0=["w","e"],N0=["s","n"],R0={sw:0,nw:90,ne:180,se:270};function k0(e,t,n,r,o){return Math.max(Math.min(n*e+t,n*(1-r)-o),0)/n}g.Cropper={onDragStart:function(e){e=e.editInfo;return O0({},e)},onDragging:function(e,t,n,r,o){var i=e.editInfo,a=e.x,l=e.y,e=e.options,s=(r=(s=(0,x0.rotateCoordinate)(r,o,i.angleRad))[0],o=s[1],i.widthPx),c=i.heightPx,d=i.leftPercent,u=i.rightPercent,f=i.topPercent,h=i.bottomPercent,p=e.minWidth,e=e.minHeight,g=1-d-u,m=1-f-h;return 0<g&&0<m&&(s=s/g,g=c/m,c="e"!=a?k0(n.leftPercent,r,s,u,p):d,m="w"!=a?k0(n.rightPercent,-r,s,d,p):u,a="s"!=l?k0(n.topPercent,o,g,h,e):f,r="n"!=l?k0(n.bottomPercent,-o,g,f,e):h,i.leftPercent=c,i.rightPercent=m,i.topPercent=a,i.bottomPercent=r,i.widthPx=s*(1-c-m),i.heightPx=g*(1-a-r),!0)}},g.getCropHTML=function(){var e={tag:"div",style:"position:absolute;background-color:rgb(0,0,0,0.5);pointer-events:none",className:"r_cropO"},r={tag:"div",style:"position:absolute;overflow:hidden",className:"r_cropC",children:[]};return _0.forEach(function(t){return N0.forEach(function(e){return r.children.push({tag:"div",className:"r_cropH",style:"position:absolute;pointer-events:auto;cursor:"+e+t+"-resize;"+("w"==t?"left":"right")+":0;"+("n"==e?"top":"bottom")+":0;width:22px;height:22px;transform:rotate("+R0[e+t]+"deg)",dataset:{x:t,y:e},children:(n=[],[0,1].forEach(function(t){return[0,1].forEach(function(e){n.push({tag:"div",style:"position:absolute;left:"+t+"px;bottom:"+t+"px;"+(0==e?"right:"+t+"px;height:"+(7-2*t)+"px;":"top:"+t+"px;width:"+(7-2*t)+"px;")+";background-color:"+(0==t?"white":"black")})})}),n)});var n})}),[r,e,e,e,e]};var pa={},L0=e&&e.__assign||function(){return(L0=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},I0=(Object.defineProperty(pa,"__esModule",{value:!0}),pa.getRotateHTML=pa.updateRotateHandlePosition=pa.Rotator=void 0,180/Math.PI);pa.Rotator={onDragStart:function(e){e=e.editInfo;return L0({},e)},onDragging:function(e,t,n,r,o){var i=e.editInfo,e=e.options,a=i.heightPx/2+31,r=a*Math.sin(n.angleRad)+r,a=a*Math.cos(n.angleRad)-o,n=Math.atan2(r,a);return t.altKey||(n=Math.round(n*I0/e.minRotateDeg)*e.minRotateDeg/I0),i.angleRad!=n&&(i.angleRad=n,!0)}},pa.updateRotateHandlePosition=function(e,t,n,r,o){var i;r&&o&&t&&(i=e.angleRad,e=e.heightPx,t=(i=Math.cos(i))<=0?Number.MAX_SAFE_INTEGER:(t[1]+e/2+n)/i-e/2,n=Math.max(Math.min(15,t),0),i=Math.max(Math.min(32,t-n),0),r.style.top=-n+"px",r.style.height=n+"px",o.style.top=-i+"px")},pa.getRotateHTML=function(e){var t=e.borderColor;return[{tag:"div",className:"r_rotateC",style:"position:absolute;left:50%;width:1px;background-color:"+t,children:[{tag:"div",className:"r_rotateH",style:"position:absolute;background-color:"+e.rotateHandleBackColor+";border:solid 1px "+t+";border-radius:50%;width:32px;height:32px;left:-16px;cursor:move",children:[(e=t,{tag:"svg",namespace:"http://www.w3.org/2000/svg",style:"width:16px;height:16px;margin: 8px 8px",children:[{tag:"path",namespace:"http://www.w3.org/2000/svg",attributes:((t={d:"M 10.5,10.0 A 3.8,3.8 0 1 1 6.7,6.3",transform:"matrix(1.1 1.1 -1.1 1.1 11.6 -10.8)"})["fill-opacity"]="0",t.stroke=e,t)},{tag:"path",namespace:"http://www.w3.org/2000/svg",attributes:{d:"M12.0 3.648l.884-.884.53 2.298-2.298-.53z",stroke:e}}]})]}]}]};var M0=e&&e.__assign||function(){return(M0=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},A0=e&&e.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||((r=r||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},D0=(Object.defineProperty(Fi,"__esModule",{value:!0}),Vi),j0=Lo,B0=ra,F0=oa,H0=g,z0=No,U0=pa,V0=R,W0=t,K0=C,q0=2*Math.PI/8,G0=["nw","n","ne","e","se","s","sw","w"],Z0=((ga={}).SingleDirectionResize=2,ga.ImageRotate=4,ga.ImageCrop=8,ga),Y0={borderColor:"#DB626C",minWidth:10,minHeight:10,preserveRatio:!1,minRotateDeg:5,imageSelector:"img",rotateIconHTML:null},$0=((ma={})[1]=K0.getCornerResizeHTML,ma[2]=K0.getSideResizeHTML,ma[4]=U0.getRotateHTML,ma[8]=H0.getCropHTML,ma),X0="IMAGE_EDIT_WRAPPER";function Q0(e){var E=this;this.allowedOperations=1,this.onBlur=function(){E.setEditingImage(null)},this.removeWrapper=function(e){var t=null==e?void 0:e.parentNode,n=null==e?void 0:e.querySelector("img");n&&t&&(n.style.position="",n.style.margin=null,n.style.textAlign=null,t.insertBefore(n,e),t.removeChild(e))},this.updateWrapper=function(e){var t,n,r,o,i,a,l,s,c,d,u,f,h,p,g,m,v,y,b=E.getImageWrapper(E.image);b&&(t=tp(b,"r_cropC"),n=tp(b,"r_cropO"),r=tp(b,"r_rotateC")[0],o=tp(b,"r_rotateH")[0],i=tp(b,"r_resizeH"),a=tp(b,"r_cropH"),l=1==t.length&&4==n.length,s=(g=E.editInfo).angleRad,m=g.bottomPercent,h=g.leftPercent,p=g.rightPercent,g=g.topPercent,u=(f=(0,F0.default)(E.editInfo,l)).targetWidth,v=f.targetHeight,c=f.originalWidth,d=f.originalHeight,y=(u-(u=f.visibleWidth))/2,f=(v-(v=f.visibleHeight))/2,h=c*h,p=c*p,g=d*g,m=d*m,b.style.width=ep(u),b.style.height=ep(v),b.style.margin=f+"px "+y+"px",b.style.transform="rotate("+s+"rad)",b.style.textAlign=(u=b.parentNode,(0,W0.safeInstanceOf)(u,"HTMLElement")&&"rtl"==(0,W0.getComputedStyle)(u,"direction")?"right":"left"),E.image.style.width=ep(c),E.image.style.height=ep(d),l?(J0(t[0],h,g,p,m,void 0,void 0),J0(n[0],0,0,p,void 0,void 0,g),J0(n[1],void 0,0,0,m,p,void 0),J0(n[2],h,void 0,0,0,void 0,m),J0(n[3],0,g,void 0,0,h,void 0),np(a,s)):(E.image.style.margin=-g+"px 0 0 "+-h+"px","r_resizeH"==(null==e?void 0:e.elementClass)&&(v=b.clientWidth,y=b.clientHeight,E.wasResized=!0,(0,K0.doubleCheckResize)(E.editInfo,E.options.preserveRatio,v,y),E.updateWrapper()),(0,U0.updateRotateHandlePosition)(E.editInfo,E.editor.getRelativeDistanceToEditor(b,!0),f,r,o),np(i,s)))},this.options=M0(M0({},Y0),e||{})}function J0(e,t,n,r,o,i,a){e.style.left=ep(t),e.style.top=ep(n),e.style.right=ep(r),e.style.bottom=ep(o),e.style.width=ep(i),e.style.height=ep(a)}function ep(e){return void 0===e?null:e+"px"}function tp(e,t){return(0,W0.toArray)(e.querySelectorAll("."+t))}function np(e,n){e.map(function(e){var t;e.style.cursor=(e=e,t=n,t=(t=Math.round(t/q0)%8)<0?8+t:t,e=e.dataset.y+e.dataset.x,e=G0.indexOf(e),G0[(0<=e&&e+t)%8]+"-resize")})}function rp(e){e="string"==typeof e?parseInt(e):e;return!isNaN(e)}Q0.prototype.getName=function(){return"ImageEdit"},Q0.prototype.initialize=function(e){var t=this;this.editor=e,this.disposer=e.addDomEventHandler("blur",this.onBlur),Object.keys(Z0).forEach(function(e){t.allowedOperations|=t.editor.isFeatureEnabled(e)?Z0[e]:0})},Q0.prototype.dispose=function(){this.clearDndHelpers(),this.disposer(),this.disposer=null,this.editor=null},Q0.prototype.onPluginEvent=function(e){switch(e.eventType){case 5:this.setEditingImage(null);break;case 6:var t=e.rawEvent.target;e.isClicking&&0==e.rawEvent.button&&(0,W0.safeInstanceOf)(t,"HTMLImageElement")&&t.isContentEditable&&(0,W0.matchesSelector)(t,this.options.imageSelector)&&this.setEditingImage(t,7);break;case 0:t=e.rawEvent.which;46==t||8==t?this.setEditingImage(null,!0):27==t&&this.image?(this.editInfo=(0,z0.getEditInfoFromImage)(this.image),this.setEditingImage(null),e.rawEvent.preventDefault()):16!=t&&17!=t&&18!=t&&this.setEditingImage(null,!0);break;case 7:"InsertEntity"==e.source&&e.data.type==X0||this.editor.queryElements((0,W0.getEntitySelector)(X0),this.removeWrapper);break;case 15:e.entity.type==X0&&(8==e.operation?this.removeWrapper(e.entity.wrapper):1==e.operation&&e.rawEvent.preventDefault());break;case 8:(0,W0.toArray)(e.clonedRoot.querySelectorAll(this.options.imageSelector)).forEach(function(e){(0,z0.deleteEditInfo)(e)})}},Q0.prototype.setEditingImage=function(e,t){var n,r,o,i=this,a="number"==typeof t?t:0,t="number"!=typeof t&&!!t;this.image&&(this.clearDndHelpers(),(0,D0.default)(this.editor,this.image,this.editInfo,this.lastSrc,this.wasResized)&&this.editor.addUndoSnapshot(function(){return i.image},"ImageResize"),(n=this.getImageWrapper(this.image))&&this.removeWrapper(n),t&&this.editor.select(this.image),this.image=null,this.editInfo=null,this.lastSrc=null),!this.image&&null!=e&&e.isContentEditable&&(this.editor.addUndoSnapshot(),this.image=e,this.editInfo=(0,z0.getEditInfoFromImage)(e),this.wasResized=(t=this.image,r=t.width,o=t.height,!(""!==(t=t.style).maxWidth&&"initial"!==t.maxWidth&&"auto"!==t.maxWidth||!(rp(t.height)||rp(t.width)||rp(r)||rp(o)))),a=((0,j0.default)(e)?a:3)&this.allowedOperations,n=this.createWrapper(a),this.updateWrapper(),this.dndHelpers=A0(A0(A0(A0([],this.createDndHelpers("r_resizeH",K0.Resizer),!0),this.createDndHelpers("r_rotateH",U0.Rotator),!0),this.createDndHelpers("r_cropH",H0.Cropper),!0),this.createDndHelpers("r_cropC",H0.Cropper),!0),this.editor.select(n,-3))},Q0.prototype.createWrapper=function(t){var e,n,r,o=this,i=(0,V0.insertEntity)(this.editor,X0,(0,W0.wrap)(this.image,6),!1,!0).wrapper,a=(i.style.position="relative",i.style.maxWidth="100%",i.style.verticalAlign="bottom",i.style.display=W0.Browser.isSafari?"inline-block":"inline-flex",this.lastSrc=this.image.getAttribute("src"),this.image.src=this.editInfo.src,this.image.style.position="absolute",this.image.style.maxWidth=null,this.editor.isFeatureEnabled("AdaptiveHandlesResizer")),l={borderColor:this.options.borderColor,rotateIconHTML:this.options.rotateIconHTML,rotateHandleBackColor:this.editor.isDarkMode()?"#333":"white",isSmallImage:(e=this.editInfo,n=a,r=e.widthPx,e=e.heightPx,r&&e&&r*r<1e4&&n),handlesExperimentalFeatures:a},s=[(0,K0.getResizeBordersHTML)(l)];return Object.keys($0).forEach(function(e){(t&e)==e&&(0,W0.arrayPush)(s,$0[e](l))}),s.forEach(function(e){e=(0,W0.createElement)(e,o.image.ownerDocument);e&&i.appendChild(e)}),i},Q0.prototype.getImageWrapper=function(e){e=(0,W0.getEntityFromElement)(null==(e=null==e?void 0:e.parentNode)?void 0:e.parentNode);return(null==e?void 0:e.type)==X0?e.wrapper:null},Q0.prototype.createDndHelpers=function(e,t){var n=this,r={editInfo:this.editInfo,options:this.options,elementClass:e},o=this.getImageWrapper(this.image);return o?tp(o,e).map(function(e){return new B0.default(e,M0(M0({},r),{x:e.dataset.x,y:e.dataset.y}),n.updateWrapper,t,n.editor.getZoomScale())}):[]},Q0.prototype.clearDndHelpers=function(){var e;null!=(e=this.dndHelpers)&&e.forEach(function(e){return e.dispose()}),this.dndHelpers=null},Fi.default=Q0;var op,ip,ap,lp,sp,cp,dp,up,fp,hp,a={},va={},Uo=(Object.defineProperty(va,"__esModule",{value:!0}),va.default=function(e,t){var n=e.naturalWidth,r=e.naturalHeight,o=e.leftPercent,i=e.topPercent;return{width:n*(1-o-e.rightPercent)*t,height:r*(1-i-e.bottomPercent)*t}},{}),pp=(Object.defineProperty(Uo,"__esModule",{value:!0}),va),gp=No,mp=(Uo.default=function(e,t){var e=(0,gp.getEditInfoFromImage)(e),t=(0,pp.default)(e,t),n=t.width,t=t.height;return Math.round(n)==Math.round(e.widthPx)&&Math.round(t)==Math.round(e.heightPx)},Object.defineProperty(a,"__esModule",{value:!0}),Vi),vp=va,yp=Uo,bp=No,ba=(a.default=function(r,o,i,a,l){var e,t,n,s=(0,bp.getEditInfoFromImage)(o);(0,yp.default)(o,i)||(e=o,t=s.src,n=function(){var e,t,n;!r.isDisposed()&&r.contains(o)&&(e=o.getAttribute("src"),t=(n=(0,vp.default)(s,i)).width,n=n.height,s.widthPx=Math.max(t,a),s.heightPx=Math.max(n,l),r.addUndoSnapshot(function(){(0,mp.default)(r,o,s,e,!0)},"ImageResize"))},e.onload=function(){e.onload=null,e.onerror=null,n()},e.onerror=function(){e.onload=null,e.onerror=null,n()},e.src=t)},{}),Ep=(Object.defineProperty(ba,"__esModule",{value:!0}),No),Wa=(ba.default=function(e,t){e.addUndoSnapshot(function(){t.style.width="",t.style.height="",t.style.maxWidth="100%",t.removeAttribute("width"),t.removeAttribute("height"),(0,Ep.deleteEditInfo)(t)},"ImageResize")},P=Ai,Object.defineProperty(P,"__esModule",{value:!0}),P.resetImage=P.isResizedTo=P.resizeByPercentage=P.canRegenerateImage=P.ImageEdit=void 0,ip=Fi,Object.defineProperty(P,"ImageEdit",{enumerable:!0,get:function(){return ip.default}}),ap=Lo,Object.defineProperty(P,"canRegenerateImage",{enumerable:!0,get:function(){return ap.default}}),lp=a,Object.defineProperty(P,"resizeByPercentage",{enumerable:!0,get:function(){return lp.default}}),sp=Uo,Object.defineProperty(P,"isResizedTo",{enumerable:!0,get:function(){return sp.default}}),cp=ba,Object.defineProperty(P,"resetImage",{enumerable:!0,get:function(){return cp.default}}),za=oe,op=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),Va=e&&e.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||op(t,e,n)},Object.defineProperty(za,"__esModule",{value:!0}),Va(Ai,za),{}),Ka={},qa={},Io=e&&e.__extends||(dp=function(e,t){return(dp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}dp(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),Za=(Object.defineProperty(qa,"__esModule",{value:!0}),up=Fi.default,Io(Cp,up),Cp.prototype.showResizeHandle=function(e){this.setEditingImage(e,3)},Cp.prototype.hideResizeHandle=function(e){this.setEditingImage(null,e)},Cp);function Cp(e,t,n,r,o){return up.call(this,{minHeight:t=void 0===t?10:t,minWidth:e=void 0===e?10:e,borderColor:n=void 0===n?"#DB626C":n,preserveRatio:r=void 0===r?!1:r,imageSelector:o=void 0===o?"img":o})||this}qa.default=Za,Kr=Ka,Object.defineProperty(Kr,"__esModule",{value:!0}),Kr.ImageResize=void 0,hp=qa,Object.defineProperty(Kr,"ImageResize",{enumerable:!0,get:function(){return hp.default}}),wi=Wa,fp=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),Tr=e&&e.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||fp(t,e,n)},Object.defineProperty(wi,"__esModule",{value:!0}),Tr(Ka,wi);var Nr={},w={},yl={},z={},wp=(Object.defineProperty(z,"__esModule",{value:!0}),t),H=(z.default=function(e,t){var n=e.fragment,e=e.clipboardData,r=e.html,e=e.image;r&&e&&(e=(new DOMParser).parseFromString(t(r),"text/html"),(0,wp.moveChildNodes)(n,null==e?void 0:e.body))},{}),Sp=(Object.defineProperty(H,"__esModule",{value:!0}),t);function Tp(e){if(e&&!e.nextSibling&&["OL","UL","MENU"].indexOf((0,Sp.getTagOfNode)(e))<0){var n=!1;if((0,Sp.toArray)(e.childNodes).every(function(e){var t;return!(!(0,Sp.safeInstanceOf)(e,"Text")||null!=(t=e.nodeValue)&&t.trim())||"LI"==(0,Sp.getTagOfNode)(e)&&(n=!0)})&&n)return 1}}H.default=function(e){Tp(e)?(0,Sp.wrap)((0,Sp.toArray)(e.childNodes),"UL"):(0,Sp.safeInstanceOf)(e.firstChild,"HTMLElement")&&Tp(e.firstChild)&&(0,Sp.changeElementTag)(e.firstChild,"UL")};var n={},Pp=(Object.defineProperty(n,"__esModule",{value:!0}),n.excelHandler=void 0,t),Op=/<\/\s*td\s*>((?!<\/\s*tr\s*>)[\s\S])*$/i,xp=/<\/\s*tr\s*>((?!<\/\s*table\s*>)[\s\S])*$/i,_p=/<tr[^>]*>[^<]*/i,Np=/<table[^>]*>[^<]*/i;function Rp(e,t){var n;return e=(e=e.match(Op)?((n=t.match(_p))?n[0]:"<TR>")+e+"</TR>":e).match(xp)?((n=t.match(Np))?n[0]:"<TABLE>")+e+"</TABLE>":e}n.default=function(e,t){var n=e.fragment,r=e.sanitizingOption,o=e.htmlBefore,e=e.clipboardData,o=Rp(e.html,o);e.html!=o&&(e=(new DOMParser).parseFromString(t(o),"text/html"),(0,Pp.moveChildNodes)(n,null==e?void 0:e.body)),(0,Pp.chainSanitizerCallback)(r.elementCallbacks,"TD",function(e){return"none"==e.style.borderStyle&&(e.style.border="solid 1px #d4d4d4"),!0})},n.excelHandler=Rp;var Re={},kp=(Object.defineProperty(Re,"__esModule",{value:!0}),t),f=(Re.default=function(e,t){var n=e.fragment,e=e.clipboardData;e.html&&!e.text&&e.image&&(t=(new DOMParser).parseFromString(t(e.html),"text/html"),(0,kp.moveChildNodes)(n,null==t?void 0:t.body))},{}),tt={},Lp=(Object.defineProperty(tt,"__esModule",{value:!0}),t),Ip=/#_msocom_/,Jn=(tt.default=function(e){(0,Lp.chainSanitizerCallback)(e,"SPAN",function(e){var t=(0,Lp.getStyles)(e);return"comment"!=t["mso-special-character"]&&!t["mso-comment-continuation"]||null!=(t=e.parentElement)&&t.removeChild(e),!0}),(0,Lp.chainSanitizerCallback)(e,"A",function(e){var t;return(0,Lp.getStyles)(e)["mso-comment-reference"]?(0,Lp.changeElementTag)(e,"span"):(0,Lp.safeInstanceOf)(e,"HTMLAnchorElement")&&Ip.test(e.href)&&(null!=(t=e.parentElement)&&t.removeChild(e)),!0}),(0,Lp.chainSanitizerCallback)(e,"DIV",function(e){return"comment-list"==(0,Lp.getStyles)(e)["mso-element"]&&(0,Lp.moveChildNodes)(e),!0})},{}),$a={};Object.defineProperty($a,"__esModule",{value:!0}),$a.getObject=$a.setObject=$a.createCustomData=void 0;function Mp(e,t){var n=t.getAttribute("NodeId");return n||(n=e.nextNodeId.toString(),e.nextNodeId++,t.setAttribute("NodeId",n)),n}$a.createCustomData=function(){return{dict:{},nextNodeId:1}},$a.setObject=function(e,t,n,r){1==t.nodeType&&""!=(t=Mp(e,t))&&(e.dict[t]||(e.dict[t]={}),e.dict[t][n]=r)},$a.getObject=function(e,t,n){if(1==t.nodeType){t=Mp(e,t);if(""!=t)return e.dict[t]&&e.dict[t][n]}return null},Object.defineProperty(Jn,"__esModule",{value:!0}),Jn.createWordConverter=void 0;var Ap=$a,cc=(Jn.createWordConverter=function(){return{nextUniqueId:1,numBulletsConverted:0,numNumberedConverted:0,wordConverterArgs:null,wordCustomData:(0,Ap.createCustomData)()}},{}),r={},Dp=(Object.defineProperty(r,"__esModule",{value:!0}),r.createLevelLists=void 0,r.createLevelLists=function(){return{listsMetadata:{},currentUniqueListId:-1}},Object.defineProperty(cc,"__esModule",{value:!0}),cc.createWordConverterArguments=void 0,r),c=(cc.createWordConverterArguments=function(e){return{nodes:e,currentIndex:0,lists:{},listItems:[],currentListIdsByLevels:[(0,Dp.createLevelLists)()],lastProcessedItem:null}},{}),jp=(Object.defineProperty(c,"__esModule",{value:!0}),c.processNodeConvert=c.processNodesDiscovery=void 0,r),Bp=$a,Fp=t,Hp="UniqueListId",zp="mso-list",Up=/[\n|\r]/gi;function Vp(e,t,n,r){var o=function e(t,n,r){var o,i=null;if((o=1==n?Gp(t):(i=e(t,n-1,null)).lastChild)&&1==o.nodeType){var a=(0,Fp.getTagOfNode)(o);if("UL"==a||"OL"==a)return o}a=t.ownerDocument.createElement(r?r.tagName:"UL");return 1==n?t.parentNode.insertBefore(a,t):i.appendChild(a),a}(t,n.level,r),i=(0,Bp.getObject)(e.wordCustomData,o,Hp);return(i&&i!=n.uniqueListId||!i&&o.firstChild)&&(i=t.ownerDocument.createElement(r.tagName),o.parentNode.insertBefore(i,o.nextSibling),o=i),(0,Bp.setObject)(e.wordCustomData,o,Hp,n.uniqueListId),t=e,i=o,(n=r).tagName!=(0,Fp.getTagOfNode)(i)&&(n=i.ownerDocument.createElement(n.tagName),(0,Bp.setObject)(t.wordCustomData,n,Hp,(0,Bp.getObject)(t.wordCustomData,i,Hp)),(0,Fp.moveChildNodes)(n,i),i.parentNode.insertBefore(n,i),i.parentNode.removeChild(i),i=n),i}function Wp(t,e){for(var n,r=[],o=t.firstChild;o;o=o.nextSibling)1==o.nodeType&&1<e&&Wp(o,e-1),n=o=qp(o,!0),("SPAN"==(0,Fp.getTagOfNode)(n)&&!n.firstChild||Yp(o))&&r.push(o);r.forEach(function(e){return t.removeChild(e)})}function Kp(e,t){for(var n=null,r=e.firstChild;!n&&r;)Yp(r=qp(r,!0))?0==(n=r.textContent.trim()).length&&(n="o"):1==r.nodeType&&1<t&&(n=Kp(r,t-1)),r=r.nextSibling;return n}function qp(e,t){if(8==e.nodeType){var n=e.data;if(n&&"[if !supportlists]"==n.trim().toLowerCase()){for(var r=e,o=null,i=0;i<4&&(r=Zp(r));i++)if(8==r.nodeType&&(n=r.data)&&"[endif]"==n.trim().toLowerCase()){o=r;break}if(o){var a=e.ownerDocument.createElement("span");for(a.setAttribute("style","mso-list: ignore"),r=Zp(e);r!=o;)r=r.nextSibling,a.appendChild(r.previousSibling);o.parentNode.insertBefore(a,o),t&&(e.parentNode.removeChild(e),o.parentNode.removeChild(o)),e=a}}}return e}function Gp(e){for(var t=e;(t=t.previousSibling)&&Xp(t););return t}function Zp(e){for(var t=e;(t=t.nextSibling)&&Xp(t););return t}function Yp(e){if(1==e.nodeType){e=$p(e,zp);if(e&&0<e.length&&"ignore"==e.trim().toLowerCase())return 1}}function $p(e,t){return(0,Fp.getStyles)(e)[t]||null}function Xp(e){if(!e)return!0;if(3==e.nodeType)return 0==e.nodeValue.replace(Up,"").trim().length;var t=(0,Fp.getTagOfNode)(e);return e.firstChild==e.lastChild&&("SPAN"==t||"FONT"==t)&&Xp(e.firstChild)}c.processNodesDiscovery=function(e){for(var t=e.wordConverterArgs;t.currentIndex<t.nodes.length;){var n=t.nodes.item(t.currentIndex),r=function(e){if(1==e.nodeType){var t=$p(e,zp);if(t&&0<t.length)try{var n=t.split(" ");if(3==n.length)return{level:parseInt(n[1].substr("level".length)),wordListId:t,originalNode:e,uniqueListId:0}}catch(e){}}return null}(n);if(r){var o=t.currentListIdsByLevels[r.level-1]||(0,jp.createLevelLists)();if(t.currentListIdsByLevels[r.level-1]=o,t.lastProcessedItem&&Gp(n)!=t.lastProcessedItem){i=void 0;a=void 0;l=void 0;var i=t;for(var a=0;a<i.currentListIdsByLevels.length;a++){var l=i.currentListIdsByLevels[a];l&&(l.currentUniqueListId=-1)}}var s,c=o.listsMetadata[r.wordListId];c?c.ignore||1!=c.numberOfItems||(s=Kp(n,5),c.tagName=c.firstFakeBullet==s?"UL":"OL"):(s=Kp(n,5),c={numberOfItems:0,uniqueListId:e.nextUniqueId++,firstFakeBullet:s,ignore:!s||0==s.length,tagName:0<=["o","·","§","-"].indexOf(s)?"UL":"OL"},o.listsMetadata[r.wordListId]=c,t.lists[c.uniqueListId.toString()]=c),r.uniqueListId=c.uniqueListId,c.ignore||"OL"==c.tagName&&0<c.numberOfItems&&o.currentUniqueListId!=r.uniqueListId?(c.ignore=!0,t.currentListIdsByLevels[0].currentUniqueListId=-1,t.currentListIdsByLevels=t.currentListIdsByLevels.slice(0,1)):(t.currentListIdsByLevels.length>r.level&&(t.currentListIdsByLevels=t.currentListIdsByLevels.slice(0,r.level)),o.currentUniqueListId=r.uniqueListId,t.listItems.push(r),c.numberOfItems++),t.lastProcessedItem=n}else{o=t.lastProcessedItem;o&&Gp(n)==o&&n.tagName==o.tagName&&n.className==o.className&&(o.appendChild(o.ownerDocument.createElement("br")),o.appendChild(o.ownerDocument.createElement("br")),(0,Fp.moveChildNodes)(o,n,!0),n.parentNode.removeChild(n))}t.currentIndex++}return 0<t.listItems.length},c.processNodeConvert=function(e){var t=e.wordConverterArgs;for(t.currentIndex=0;t.currentIndex<t.listItems.length;){var n,r=t.listItems[t.currentIndex],o=r.originalNode,i=t.lists[r.uniqueListId.toString()];i.ignore||(r=Vp(e,o,r,i))&&(Wp(o,5),n=o.ownerDocument.createElement("LI"),(0,Fp.moveChildNodes)(n,o),r.appendChild(n),o.parentNode.removeChild(o),"UL"==i.tagName?e.numBulletsConverted++:e.numNumberedConverted++),t.currentIndex++}return 0<e.numBulletsConverted||0<e.numNumberedConverted},Object.defineProperty(f,"__esModule",{value:!0});var Qp=tt,Jp=t,eg=Jn,tg=cc,ng=c,rg=/%/,m=(f.default=function(e){var t=e.sanitizingOption,e=e.fragment,n=((0,Jp.chainSanitizerCallback)(t.elementCallbacks,"O:P",function(e){return(0,Jp.moveChildNodes)(e),e.appendChild(e.ownerDocument.createTextNode(" ")),!0}),(0,eg.createWordConverter)()),e=e.querySelectorAll("p");0<e.length&&(n.wordConverterArgs=(0,tg.createWordConverterArguments)(e),(0,ng.processNodesDiscovery)(n)&&(0,ng.processNodeConvert)(n)),["OL","UL"].forEach(function(e){(0,Jp.chainSanitizerCallback)(t.elementCallbacks,e,function(e){return"0in"==e.style.marginBottom&&(e.style.marginBottom=""),!0})}),(0,Jp.chainSanitizerCallback)(t.cssStyleCallbacks,"line-height",function(e){return!(rg.test(e)&&!isNaN(e=parseInt(e))&&e<120)}),(0,Qp.default)(t.elementCallbacks)},{}),og=(Object.defineProperty(m,"__esModule",{value:!0}),t);function ig(e){var t,n=e.start,r=e.end;n==r&&"DIV"==(0,og.getTagOfNode)(n)?(t=(0,og.changeElementTag)(n,"SPAN"),e.start=t,e.end=t,"BR"==(0,og.getTagOfNode)(t.lastChild)&&t.removeChild(t.lastChild)):"BR"==(0,og.getTagOfNode)(r)&&(t=r.ownerDocument.createTextNode(""),null!=(n=r.parentNode)&&n.insertBefore(t,r),e.end=t,null!=(n=r.parentNode)&&n.removeChild(r))}function ag(e,t,n){var r=(0,og.getBlockElementAtNode)(e,t.start),e=n?(0,og.getNextLeafSibling)(e,t.end):(0,og.getPreviousLeafSibling)(e,t.start);null!=r&&r.contains(e)&&null!=(r=(n?t.end:t.start).parentNode)&&r.insertBefore(t.start.ownerDocument.createElement("br"),n?t.end.nextSibling:t.start)}m.default=function(e){for(var t=og.ContentTraverser.createBodyTraverser(e),n=[],r=null==t?void 0:t.currentBlockElement;r;r=t.getNextBlockElement())n.push({start:r.getStartNode(),end:r.getEndNode()});0<n.length&&(ig(n[0]),ig(n[n.length-1]),ag(e,n[0],!0),ag(e,n[n.length-1],!1))};var h={},Nt={},lg=(Object.defineProperty(Nt,"__esModule",{value:!0}),Nt.createListItemBlock=void 0,Nt.createListItemBlock=function(e){return{startElement:e=void 0===e?null:e,endElement:e,insertPositionNode:null,listItemContainers:e?[e]:[]}},Object.defineProperty(h,"__esModule",{value:!0}),h.isWordOnlineWithList=void 0,Nt),sg=t,cg='div.ListContainerWrapper>ul[class^="BulletListStyle"],div.ListContainerWrapper>ol[class^="NumberListStyle"],span.WACImageContainer > img';function dg(e,t,n){var r,o;e&&((o=n.insertPositionNode)?(r=o.parentNode)&&r.insertBefore(e,o):((r=n.startElement.parentNode)?r:t).appendChild(e))}h.isWordOnlineWithList=function(e){return!(!e||!e.querySelector(cg))},h.default=function(f){(0,sg.toArray)(f.querySelectorAll(cg)).forEach(function(e){var t,n=new RegExp("\\bListContainerWrapper\\b","g");e.previousSibling&&((t=(0,sg.splitParentNode)(e,!0)).className=t.className.replace(n,"")),e.nextSibling&&((t=(0,sg.splitParentNode)(e,!1)).className=t.className.replace(n,""))}),function(){for(var e,t=f.querySelectorAll(".ListContainerWrapper"),n=[],r=0;r<t.length;r++){var o,i,a=t[r];e?a==(i=(o=e.listItemContainers)[o.length-1]).nextSibling||(0,sg.getFirstLeafNode)(a)==(0,sg.getNextLeafSibling)(i.parentNode,i)?(o.push(a),e.endElement=a):(e.endElement=i,n.push(e),e=(0,lg.createListItemBlock)(a)):e=(0,lg.createListItemBlock)(a)}return 0<(null==e?void 0:e.listItemContainers.length)&&n.push(e),n}().forEach(function(c){(0,sg.collapseNodes)(f,c.startElement,c.endElement,!0).forEach(function(e){"DIV"==(0,sg.getTagOfNode)(e.firstChild)&&(0,sg.unwrap)(e)}),c.insertPositionNode=c.endElement.nextSibling;var d,u=f.ownerDocument,t=(c.listItemContainers.forEach(function(e){var t,s="UL"==(t=(0,sg.getTagOfNode)(e.firstChild))||"OL"==t?t:null;d=d||u.createElement(s),(0,sg.toArray)(e.querySelectorAll("li")).forEach(function(e){var t=parseInt(e.getAttribute("data-aria-level")),t=((0,sg.getTagOfNode)(d)!=s&&1==t&&(dg(d,f,c),d=u.createElement(s)),d),n=s,r=u;if(n){for(var o,i,a=parseInt(e.getAttribute("data-aria-level")),l=t;1<a;)l=l.firstChild?(o=l.lastElementChild,"UL"==(i=(0,sg.getTagOfNode)(o))||"OL"==i?o:(l.appendChild(r.createElement(n)),l.lastElementChild)):(l.appendChild(r.createElement(n)),l.firstElementChild),a--;l.appendChild(e)}})}),dg(d,f,c),c.startElement.parentNode);t&&c.listItemContainers.forEach(function(e){t.removeChild(e)})}),f.querySelectorAll(".WACImageContainer").forEach(function(e){(0,sg.safeInstanceOf)(e,"HTMLSpanElement")&&e.childNodes.forEach(function(e){"IMG"!=(0,sg.getTagOfNode)(e)&&e.parentElement.removeChild(e)})})},Object.defineProperty(yl,"__esModule",{value:!0});var ug,fg,hg=z,pg=H,gg=n,mg=Re,vg=f,yg=m,bg=t,Eg=h,Cg="google-sheets-html-origin";function wg(e){this.unknownTagReplacement=e=void 0===e?"SPAN":e}wg.prototype.getName=function(){return"Paste"},wg.prototype.initialize=function(e){this.editor=e},wg.prototype.dispose=function(){this.editor=null},wg.prototype.onPluginEvent=function(e){var t,n,r,o,i,a;10==e.eventType&&(t=e.htmlAttributes,n=e.fragment,r=e.sanitizingOption,o=e.clipboardData,i=this.editor.getTrustedHTMLHandler(),a=void 0,"urn:schemas-microsoft-com:office:word"!=t["xmlns:w"]&&"Word.Document"!=t.ProgId?"urn:schemas-microsoft-com:office:excel"==t["xmlns:x"]||"Excel.Sheet"==t.ProgId?(0,gg.default)(e,i):"PowerPoint.Slide"==t.ProgId?(0,mg.default)(e,i):(a=(0,bg.toArray)(n.querySelectorAll('ul[class^="BulletListStyle"]>.OutlineElement,ol[class^="NumberListStyle"]>.OutlineElement,span.WACImageContainer')))&&0<a.length?(a.forEach(function(e){e.style.display=null,e.style.margin=null}),(0,Eg.isWordOnlineWithList)(n)&&(0,Eg.default)(n)):n.querySelector(Cg)?r.additionalTagReplacements[Cg]="*":this.editor.isFeatureEnabled("ConvertSingleImageBody")&&1==(null==(t=o.htmlFirstLevelChildTags)?void 0:t.length)&&"IMG"==o.htmlFirstLevelChildTags[0]?(0,hg.default)(e,i):((0,pg.default)(n),(0,yg.default)(n)):(0,vg.default)(e),r.unknownTagReplacement=this.unknownTagReplacement)},yl.default=wg,en=w,Object.defineProperty(en,"__esModule",{value:!0}),en.Paste=void 0,fg=yl,Object.defineProperty(en,"Paste",{enumerable:!0,get:function(){return fg.default}}),L=Nr,ug=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),v=e&&e.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||ug(t,e,n)},Object.defineProperty(L,"__esModule",{value:!0}),v(w,L);var Sg,Tg,rr={},Qn={},et={},Pg=(Object.defineProperty(et,"__esModule",{value:!0}),R),Og=t,xg="Backspace",_g=Og.Browser.isIE?"Esc":"Escape",Ng=Og.Browser.isIE?"Left":"ArrowLeft",Rg=Og.Browser.isIE?"Up":"ArrowUp",kg=Og.Browser.isIE?"Right":"ArrowRight",Lg=Og.Browser.isIE?"Down":"ArrowDown",Ig=Og.Browser.isIE?"Del":"Delete",Mg=[0,229];function I(e,t){this.dataProvider=e,this.pickerOptions=t,this.isPendingInputEventHandling=!1}I.prototype.getName=function(){return"Picker"},I.prototype.initialize=function(e){var n=this;this.editor=e,this.dataProvider.onInitalize(function(e){n.editor.focus();var t=n.getWord(null);t&&0!=t.length||!n.lastKnownRange||(n.editor.select(n.lastKnownRange),t=n.getWord(null)),n.editor.addUndoSnapshot(function(){t?(0,Pg.replaceWithNode)(n.editor,t,e,!0):n.editor.insertNode(e),n.setIsSuggesting(!1)},n.pickerOptions.changeSource,n.pickerOptions.handleAutoComplete)},function(e){n.setIsSuggesting(e)},e)},I.prototype.dispose=function(){this.editor=null,this.dataProvider.onDispose()},I.prototype.willHandleEventExclusively=function(e){return this.isSuggesting&&(0==e.eventType||2==e.eventType||3==e.eventType)},I.prototype.onPluginEvent=function(e){switch(e.eventType){case 7:var t;"SetContent"==e.source&&this.dataProvider.onContentChanged&&(this.isSuggesting&&this.setIsSuggesting(!1),t=[],this.editor.queryElements("[id^='"+this.pickerOptions.elementIdPrefix+"']",function(e){e.id&&t.push(e.id)}),this.dataProvider.onContentChanged(t));break;case 0:this.eventHandledOnKeyDown=!1,this.isAndroidKeyboardEvent(e)?(this.currentInputLength=this.calcInputLength(e),this.isPendingInputEventHandling=!0):(this.onKeyDownEvent(e),this.isPendingInputEventHandling=!1);break;case 3:this.isPendingInputEventHandling&&this.onAndroidInputEvent(e);break;case 2:!this.eventHandledOnKeyDown&&this.shouldHandleKeyUpEvent(e)&&(this.onKeyUpDomEvent(e),this.isPendingInputEventHandling=!1);break;case 6:this.isSuggesting&&this.setIsSuggesting(!1);break;case 14:this.dataProvider.onScroll&&this.dataProvider.onScroll(e.scrollContainer)}},I.prototype.setLastKnownRange=function(e){this.lastKnownRange=e},I.prototype.setIsSuggesting=function(e){(this.isSuggesting=e)||this.setLastKnownRange(null),this.dataProvider.onIsSuggestingChanged(e),this.setAriaOwns(e),this.setAriaActiveDescendant(e?0:null)},I.prototype.cancelDefaultKeyDownEvent=function(e){this.eventHandledOnKeyDown=!0,e.rawEvent.preventDefault(),e.rawEvent.stopImmediatePropagation()},I.prototype.getIdValue=function(e){return e.attributes&&e.attributes.getNamedItem("id")?e.attributes.getNamedItem("id").value:null},I.prototype.getWordBeforeCursor=function(e){e=this.editor.getContentSearcherOfCursor(e);return e?e.getWordBefore():null},I.prototype.replaceNode=function(e,t){e&&this.editor.deleteNode(e),t&&this.editor.insertNode(t)},I.prototype.getRangeUntilAt=function(e){var o,i,a=this;return this.editor.getContentSearcherOfCursor(e).forEachTextInlineElement(function(e){for(var t=!1,n=e.getTextContent(),r=n?n.length:-1;0<=r;){if(n[r]==a.pickerOptions.triggerCharacter){o=e.getStartPosition().move(r),t=!0;break}r--}return t&&(i=e.getEndPosition()),t}),(0,Og.createRange)(o,i)||this.editor.getDocument().createRange()},I.prototype.shouldHandleKeyUpEvent=function(e){return this.isAndroidKeyboardEvent(e)||(0,Og.isCharacterValue)(e.rawEvent)||this.isSuggesting&&!(0,Og.isModifierKey)(e.rawEvent)},I.prototype.onKeyUpDomEvent=function(e){var t,n,r;this.isSuggesting?(t=(r=(n=this.getWord(e)).substring(1)).trim(),n==this.pickerOptions.triggerCharacter||t&&0<t.length&&t.split(" ").length<=4?(this.dataProvider.queryStringUpdated(t,r==t),this.setLastKnownRange(this.editor.getSelectionRange())):this.setIsSuggesting(!1)):(n=this.getWordBeforeCursor(e),this.blockSuggestions?null!=n&&n[0]!=this.pickerOptions.triggerCharacter&&(this.blockSuggestions=!1):null!=n&&n.split(" ").length<=4&&n[0]==this.pickerOptions.triggerCharacter&&(this.setIsSuggesting(!0),t=(r=n.substring(1)).trim(),this.dataProvider.queryStringUpdated(t,r==t),this.setLastKnownRange(this.editor.getSelectionRange()),this.dataProvider.setCursorPoint&&(r=this.editor.getContentSearcherOfCursor(e),t=this.editor.getDocument().createRange(),e=r.getInlineElementBefore().getContainerNode(),this.setRangeStart(t,e,n)||(r=e.previousSibling,this.setRangeStart(t,r,this.pickerOptions.triggerCharacter)),(n=0==(n=t.getBoundingClientRect()).left&&0==n.bottom&&0==n.top?t.getClientRects()[0]:n)&&(t.detach(),e={x:n.left,y:(n.bottom+n.top)/2},r=(n.bottom-n.top)/2,this.dataProvider.setCursorPoint(e,r)))))},I.prototype.onKeyDownEvent=function(e){var t,n=e.rawEvent;this.isSuggesting?n.key==_g?(this.setIsSuggesting(!1),this.blockSuggestions=!0,this.cancelDefaultKeyDownEvent(e)):n.key==xg?this.getWord(e)==this.pickerOptions.triggerCharacter&&this.setIsSuggesting(!1):this.dataProvider.shiftHighlight&&(this.pickerOptions.isHorizontal?n.key==Ng||n.key==kg:n.key==Rg||n.key==Lg)?(this.dataProvider.shiftHighlight(this.pickerOptions.isHorizontal?n.key==kg:n.key==Lg),this.dataProvider.getSelectedIndex&&this.setAriaActiveDescendant(this.dataProvider.getSelectedIndex()),this.cancelDefaultKeyDownEvent(e)):!this.dataProvider.selectOption||"Enter"!=n.key&&"Tab"!=n.key||(this.dataProvider.selectOption(),this.cancelDefaultKeyDownEvent(e)):n.key==xg?this.tryRemoveNode(e)&&this.cancelDefaultKeyDownEvent(e):n.key==Ig&&(t=(n=(n=this.editor.getContentSearcherOfCursor(e)).getInlineElementAfter()?n.getInlineElementAfter().getContainerNode():null)?this.getIdValue(n):null)&&0==t.indexOf(this.pickerOptions.elementIdPrefix)&&(t=this.dataProvider.onRemove(n,!1),this.replaceNode(n,t),this.cancelDefaultKeyDownEvent(e))},I.prototype.onAndroidInputEvent=function(e){this.newInputLength=this.calcInputLength(e),(this.newInputLength<this.currentInputLength||"deleteContentBackwards"===e.rawEvent.inputType)&&this.tryRemoveNode(e)&&(this.eventHandledOnKeyDown=!0)},I.prototype.calcInputLength=function(e){e=this.getInlineElementBeforeCursor(e);return e?e.length:0},I.prototype.tryRemoveNode=function(e){var t,e=this.editor.getContentSearcherOfCursor(e),n=e.getInlineElementBefore(),n=n?n.getContainerNode():null,r=n?this.getIdValue(n):null,e=e.getInlineElementAfter();return!(!r||0!=r.indexOf(this.pickerOptions.elementIdPrefix)||null!=e&&e instanceof Og.PartialInlineElement)&&((t=this.dataProvider.onRemove(n,!0))?(this.replaceNode(n,t),this.isPendingInputEventHandling?this.editor.runAsync(function(e){e.select(t,-3)}):this.editor.select(t,-3)):this.editor.deleteNode(n),!0)},I.prototype.getWord=function(e){var t=this.getRangeUntilAt(e).toString(),e=this.getWordBeforeCursor(e);return t==this.pickerOptions.triggerCharacter&&t!=e?e:t},I.prototype.setRangeStart=function(e,t,n){n=t?t.textContent.lastIndexOf(n):-1;return-1<n&&(e.setStart(t,n),!0)},I.prototype.setAriaOwns=function(e){this.editor.setEditorDomAttribute("aria-owns",e&&this.pickerOptions.suggestionsLabel?this.pickerOptions.suggestionsLabel:null)},I.prototype.setAriaActiveDescendant=function(e){this.editor.setEditorDomAttribute("aria-activedescendant",null!=e&&this.pickerOptions.suggestionLabelPrefix?this.pickerOptions.suggestionLabelPrefix+e.toString():null)},I.prototype.getInlineElementBeforeCursor=function(e){e=this.editor.getContentSearcherOfCursor(e),e=e?e.getInlineElementBefore():null;return e?e.getTextContent():null},I.prototype.isAndroidKeyboardEvent=function(e){return"Unidentified"==e.rawEvent.key||null==e.rawEvent.key&&-1<Mg.indexOf(e.rawEvent.charCode)},et.default=I,xe=Qn,Object.defineProperty(xe,"__esModule",{value:!0}),xe.PickerPlugin=void 0,Tg=et,Object.defineProperty(xe,"PickerPlugin",{enumerable:!0,get:function(){return Tg.default}}),nt=rr,Sg=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),Qt=e&&e.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||Sg(t,e,n)},Object.defineProperty(nt,"__esModule",{value:!0}),Qt(Qn,nt);var Je={},se={},ln={},Cr={},s={},Ag=(Object.defineProperty(s,"__esModule",{value:!0}),ra),Dg=t;function jg(e){var t=e.td,n=e.isRTL,r=e.zoomScale,e=e.onStart,r=new Dg.VTable(t,!0,r),t=(0,Dg.normalizeRect)(t.getBoundingClientRect());return t?(e(),e=r.getCellsWithBorder(n?t.left:t.right,!n),t=r.getCellsWithBorder(n?t.left:t.right,n),{vTable:r,currentCells:e,nextCells:t}):{vTable:r,currentCells:[],nextCells:[]}}function Bg(e,t,n,r,o){var i=e.td,a=e.zoomScale,e=n.vTable;return e.table.removeAttribute("height"),e.table.style.height=null,e.forEachCellOfCurrentRow(function(e){e.td&&(e.td.style.height=e.td==i?e.height/a+o+"px":null)}),e.writeBack(!0),!0}function Fg(e,n,t){var r=e.isRTL,o=e.zoomScale,e=t.vTable,i=t.nextCells,t=t.currentCells;if(!function(e,t,n,r,o){for(var i=0;i<t.length;i++){var a=t[i];if((l=(0,Dg.normalizeRect)(a.getBoundingClientRect()))&&(s=Hg(l,e,!r)/o)<30)return}for(i=0;i<n.length;i++){var l,a=n[i],s=Number.MAX_SAFE_INTEGER;if((s=a&&(l=(0,Dg.normalizeRect)(a.getBoundingClientRect()))?Hg(l,e,r)/o:s)<30)return}return 1}(n.pageX,t,i,r,o))return!1;var a=0==i.length,l=n.shiftKey,s=((a||l)&&(e.table.style.width=null),new Map);return t.forEach(function(e){var t=(0,Dg.normalizeRect)(e.getBoundingClientRect());t&&(e.style.wordBreak="break-word",e.style.whiteSpace="normal",e.style.boxSizing="border-box",t=Hg(t,n.pageX,!r)/o,s.set(e,t))}),s.forEach(function(e,t){t.style.width=e+"px"}),l||i.forEach(function(e){e.style.wordBreak="break-word",e.style.whiteSpace="normal",e.style.boxSizing="border-box",e.style.width=null}),e.writeBack(!0),!0}function Hg(e,t,n){return n?t-e.left:e.right-t}function zg(e,t){e=e.td,e=(0,Dg.normalizeRect)(e.getBoundingClientRect());e&&(t.style.top=e.bottom-4+"px",t.style.left=e.left+"px",t.style.width=e.right-e.left+"px",t.style.height="4px")}function Ug(e,t){var n=e.td,e=e.isRTL,n=(0,Dg.normalizeRect)(n.getBoundingClientRect());n&&(t.style.top=n.top+"px",t.style.left=(e?n.left:n.right)-4+1+"px",t.style.width="4px",t.style.height=n.bottom-n.top+"px")}s.default=function(e,t,n,r,o,i,a){var l=e.ownerDocument,s={tag:"div",style:"position: fixed; cursor: "+(r?"row":"col")+"-resize; user-select: none"},a=(null!=a&&a(s,"CellResizer"),(0,Dg.createElement)(s,l)),s=(l.body.appendChild(a),{td:e,isRTL:n,zoomScale:t,onStart:o}),l=r?zg:Ug,n=(l(s,a),{onDragStart:jg,onDragging:r?Bg:Fg,onDragEnd:i});return{node:e,div:a,featureHandler:new Ag.default(a,s,l,n,t)}};var mr={},Vg=(Object.defineProperty(mr,"__esModule",{value:!0}),t),Wg=(mr.default=function(e,t,n,r,o,i){var a,l,s=e.getElementAtCursor("table",t),c=(0,Vg.normalizeRect)(t.getBoundingClientRect()),s=s?(0,Vg.normalizeRect)(s.getBoundingClientRect()):null;if(c&&s)return a=t.ownerDocument,l=function(e,t,n,r){t=t?"white":"#4A4A4A";return{tag:"div",style:"position: fixed; width: 12px; height: 12px; font-size: 16px; color: "+t+"; line-height: 10px; vertical-align: middle; text-align: center; cursor: pointer; border: solid 1px "+t+"; border-radius: 50%; background-color: "+r,children:[{tag:"div",style:"position: absolute; box-sizing: border-box; background-color: "+r+";"+(e?(n?"right":"left")+": 12px; top: 5px; height: 3px; border-top: 1px solid "+t+"; border-bottom: 1px solid "+t+"; border-right: 1px solid "+t+"; border-left: 0px;":"left: 5px; top: 12px; width: 3px; border-left: 1px solid "+t+"; border-right: 1px solid "+t+"; border-bottom: 1px solid "+t+"; border-top: 0px;")},"+"]}}(r,e.isDarkMode(),n,e.getDefaultFormat().backgroundColor||"white"),null!=i&&i(l,"TableInserter"),i=(0,Vg.createElement)(l,a),r?(i.style.left=(n?c.right:c.left-13)+"px",i.style.top=c.bottom-8+"px",i.firstChild.style.width=s.right-s.left+"px"):(i.style.left=(n?c.left:c.right-8)+"px",i.style.top=c.top-13+"px",i.firstChild.style.height=s.bottom-s.top+"px"),a.body.appendChild(i),{div:i,featureHandler:new Wg(i,t,r,e,o),node:t}},Kg.prototype.dispose=function(){this.div.removeEventListener("click",this.insertTd),this.div=null,this.editor=null},Kg);function Kg(e,t,n,r,o){var i=this;this.div=e,this.td=t,this.isHorizontal=n,this.editor=r,this.onInsert=o,this.insertTd=function(){var e=new Vg.VTable(i.td);i.isHorizontal||(e.normalizeTableCellSize(i.editor.getZoomScale()),e.table.removeAttribute("width"),e.table.style.width=null),e.edit(i.isHorizontal?1:3),e.writeBack(),i.onInsert(e.table)},this.div.addEventListener("click",this.insertTd)}var o={},qg=(Object.defineProperty(o,"__esModule",{value:!0}),ra),Gg=t;function Zg(e){return e.onStart(),{originalRect:e.table.getBoundingClientRect(),vTable:new Gg.VTable(e.table,!0,e.zoomScale)}}function Yg(e,t,n,r,o){var i=e.isRTL,a=e.zoomScale,e=n.originalRect,l=n.vTable,s=1+r/e.width*a*(i?-1:1),c=1+o/e.height*a,d=.001<Math.abs(s-1),u=.001<Math.abs(c-1);if(d||u){for(var f=0;f<l.cells.length;f++)for(var h=0;h<l.cells[f].length;h++){var p,g=l.cells[f][h];g.td&&(d&&(l.table.style.width=null,p=g.width*s/a,g.td.style.boxSizing="border-box",30<=p&&(g.td.style.wordBreak="break-word",g.td.style.whiteSpace="normal",g.td.style.width=p+"px")),u&&(l.table.style.height=null,0==h?20<=(p=g.height*c/a)&&(g.td.style.height=p+"px"):g.td.style.height=null))}return l.writeBack(!0),!0}return!1}function $g(e,t){var n=e.table,e=e.isRTL,n=(0,Gg.normalizeRect)(n.getBoundingClientRect());n&&(t.style.top=n.bottom+"px",t.style.left=e?n.left-12-2+"px":n.right+"px")}o.default=function(e,t,n,r,o,i){var a=e.ownerDocument,l={tag:"div",style:"position: fixed; cursor: "+(n?"ne":"nw")+"-resize; user-select: none; border: 1px solid #808080"},i=(null!=i&&i(l,"TableResizer"),(0,Gg.createElement)(l,a)),l=(i.style.width="12px",i.style.height="12px",a.body.appendChild(i),{isRTL:n,table:e,zoomScale:t,onStart:r});return $g(l,i),{node:e,div:i,featureHandler:new qg.default(i,l,$g,{onDragStart:Zg,onDragging:Yg,onDragEnd:o},t)}};var gr={},Xg=(Object.defineProperty(gr,"__esModule",{value:!0}),ra),Qg=t;function Jg(e,t){e=e.table,e=(0,Qg.normalizeRect)(e.getBoundingClientRect());e&&(t.style.top=e.top-12+"px",t.style.left=e.left-12-2+"px")}gr.default=function(e,t,n,r){var o=e.ownerDocument,i={tag:"div",style:"position: fixed; cursor: all-scroll; user-select: none; border: 1px solid #808080"},a=(null!=r&&r(i,"TableSelector"),(0,Qg.createElement)(i,o)),r=(a.id="_Table_Selector",a.style.width="12px",a.style.height="12px",o.body.appendChild(a),{table:e,zoomScale:t}),i=(Jg(r,a),new Xg.default(a,r,Jg,{onDragEnd:function(e,t){return t.target==a&&n(e.table),!1}},t));return{div:a,featureHandler:i,node:e}};var X={},e2=(Object.defineProperty(X,"__esModule",{value:!0}),X.disposeTableEditFeature=void 0,X.disposeTableEditFeature=function(e){var t;null!=(t=e.div.parentNode)&&t.removeChild(e.div),e.div=null,e.featureHandler.dispose(),e.featureHandler=null},Object.defineProperty(Cr,"__esModule",{value:!0}),s),t2=mr,n2=o,r2=gr,o2=X,i2=t;function a2(e,t,n,r){var o=this;this.editor=e,this.table=t,this.onChanged=n,this.onShowHelperElement=r,this.onFinishEditing=function(){return o.editor.focus(),o.editor.select(o.start,o.end),o.editor.addUndoSnapshot(null,"Format"),o.onChanged(),!1},this.onStartTableResize=function(){o.onStartResize()},this.onStartCellResize=function(){o.disposeTableResizer(),o.onStartResize()},this.onInserted=function(e){o.editor.transformToDarkColor(e),o.disposeTableResizer(),o.onFinishEditing()},this.onSelect=function(e){var t,n,r;o.editor.focus(),e&&(t=(r=new i2.VTable(e)).cells.length-1,n=0,r.cells[t].forEach(function(e,t){e.td&&(n=t)}),r={firstCell:{x:0,y:0},lastCell:{y:t,x:n}},o.editor.select(e,r))},this.isRTL="rtl"==(0,i2.getComputedStyle)(t,"direction"),this.tableResizer=(0,n2.default)(t,e.getZoomScale(),this.isRTL,this.onStartTableResize,this.onFinishEditing,this.onShowHelperElement),this.tableSelector=(0,r2.default)(t,e.getZoomScale(),this.onSelect,this.onShowHelperElement)}a2.prototype.dispose=function(){this.disposeTableResizer(),this.disposeCellResizers(),this.disposeTableInserter(),this.disposeTableSelector()},a2.prototype.onMouseMove=function(e,t){for(var n=0;n<this.table.rows.length;n++){for(var r=this.table.rows[n],o=0;o<r.cells.length;o++){var i=r.cells[o],a=(0,i2.normalizeRect)(i.getBoundingClientRect());if(a){var l=t<=a.bottom;if((this.isRTL?e>=a.right:e<=a.right)&&l){0==n&&t<=a.top+5?(l=(a.left+a.right)/2,l=this.isRTL?e<l:l<e,this.setInserterTd(l?i:r.cells[o-1],!1)):0==o&&(this.isRTL?e>=a.right-5:e<=a.left+5)?this.setInserterTd(t>(a.top+a.bottom)/2?i:null==(l=this.table.rows[n-1])?void 0:l.cells[0],!0):this.setInserterTd(null),this.setResizingTd(i);break}}}if(o<r.cells.length)break}},a2.prototype.setResizingTd=function(e){var t;this.horizontalResizer&&this.horizontalResizer.node!=e&&this.disposeCellResizers(),!this.horizontalResizer&&e&&(t=this.editor.getZoomScale(),this.horizontalResizer=(0,e2.default)(e,t,this.isRTL,!0,this.onStartCellResize,this.onFinishEditing,this.onShowHelperElement),this.verticalResizer=(0,e2.default)(e,t,this.isRTL,!1,this.onStartCellResize,this.onFinishEditing,this.onShowHelperElement))},a2.prototype.setInserterTd=function(e,t){var n=t?this.horizontalInserter:this.verticalInserter;n&&n.node!=e&&this.disposeTableInserter(),this.horizontalInserter||this.verticalInserter||!e||(n=(0,t2.default)(this.editor,e,this.isRTL,t,this.onInserted,this.onShowHelperElement),t?this.horizontalInserter=n:this.verticalInserter=n)},a2.prototype.disposeTableResizer=function(){this.tableResizer&&((0,o2.disposeTableEditFeature)(this.tableResizer),this.tableResizer=null)},a2.prototype.disposeTableInserter=function(){this.horizontalInserter&&((0,o2.disposeTableEditFeature)(this.horizontalInserter),this.horizontalInserter=null),this.verticalInserter&&((0,o2.disposeTableEditFeature)(this.verticalInserter),this.verticalInserter=null)},a2.prototype.disposeCellResizers=function(){this.horizontalResizer&&((0,o2.disposeTableEditFeature)(this.horizontalResizer),this.horizontalResizer=null),this.verticalResizer&&((0,o2.disposeTableEditFeature)(this.verticalResizer),this.verticalResizer=null)},a2.prototype.disposeTableSelector=function(){this.tableSelector&&((0,o2.disposeTableEditFeature)(this.tableSelector),this.tableSelector=null)},a2.prototype.onStartResize=function(){var e=this.editor.getSelectionRange();e&&(this.start=i2.Position.getStart(e),this.end=i2.Position.getEnd(e)),this.editor.addUndoSnapshot()},Cr.default=a2,Object.defineProperty(ln,"__esModule",{value:!0});var l2,s2,c2=Cr,d2=t;function u2(e){var s=this;this.onShowHelperElement=e,this.tableRectMap=null,this.onMouseMove=function(e){if(!(0<e.buttons)){s.ensureTableRects();for(var t=s.editor.getDocument().defaultView,n=e.pageX-t.scrollX,r=e.pageY-t.scrollY,o=null,i=s.tableRectMap.length-1;0<=i;i--){var a=s.tableRectMap[i],l=a.table,a=a.rect;if(n>=a.left-12&&n<=a.right+12&&r>=a.top-12&&r<=a.bottom+12){o=l;break}}s.setTableEditor(o),null!=(e=s.tableEditor)&&e.onMouseMove(n,r)}},this.invalidateTableRects=function(){s.tableRectMap=null}}u2.prototype.getName=function(){return"TableResize"},u2.prototype.initialize=function(e){this.editor=e,this.onMouseMoveDisposer=this.editor.addDomEventHandler({mousemove:this.onMouseMove})},u2.prototype.dispose=function(){this.onMouseMoveDisposer(),this.invalidateTableRects(),this.setTableEditor(null),this.editor=null},u2.prototype.onPluginEvent=function(e){switch(e.eventType){case 3:case 7:case 14:case 21:this.setTableEditor(null),this.invalidateTableRects()}},u2.prototype.setTableEditor=function(e){this.tableEditor&&e!=this.tableEditor.table&&(this.tableEditor.dispose(),this.tableEditor=null),!this.tableEditor&&e&&(this.tableEditor=new c2.default(this.editor,e,this.invalidateTableRects,this.onShowHelperElement))},u2.prototype.ensureTableRects=function(){var n=this;this.tableRectMap||(this.tableRectMap=[],this.editor.queryElements("table",function(e){var t;e.isContentEditable&&(t=(0,d2.normalizeRect)(e.getBoundingClientRect()))&&n.tableRectMap.push({table:e,rect:t})}))},ln.default=u2,cr=se,Object.defineProperty(cr,"__esModule",{value:!0}),cr.TableResize=void 0,s2=ln,Object.defineProperty(cr,"TableResize",{enumerable:!0,get:function(){return s2.default}}),i=Je,l2=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),l=e&&e.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||l2(t,e,n)},Object.defineProperty(i,"__esModule",{value:!0}),l(se,i);var f2,h2,ie={},p={},Ht={},p2=(Object.defineProperty(Ht,"__esModule",{value:!0}),t),g2=R,m2="WATERMARK_WRAPPER";function v2(e,t){var r=this;this.watermark=e,this.format=t,this.showHideWatermark=function(){var e=r.editor.hasFocus(),t=r.editor.queryElements((0,p2.getEntitySelector)(m2)),n=0<t.length;e&&n?(t.forEach(r.removeWatermark),r.editor.focus()):e||n||!r.editor.isEmpty()||(0,g2.insertEntity)(r.editor,m2,r.editor.getDocument().createTextNode(r.watermark),!1,!1,0)},this.removeWatermark=function(e){var t=e.parentNode;null!=t&&t.removeChild(e),r.editor.contains(t)&&"DIV"==(0,p2.getTagOfNode)(t)&&!t.firstChild&&t.appendChild(r.editor.getDocument().createElement("BR"))},this.format=this.format||{fontSize:"14px",textColors:{lightModeColor:"#AAAAAA",darkModeColor:"#6B6B6B"}}}v2.prototype.getName=function(){return"Watermark"},v2.prototype.initialize=function(e){this.editor=e,this.disposer=this.editor.addDomEventHandler({focus:this.showHideWatermark,blur:this.showHideWatermark})},v2.prototype.dispose=function(){this.disposer(),this.disposer=null,this.editor=null},v2.prototype.onPluginEvent=function(e){var t,n;11==e.eventType||7==e.eventType&&(null==(t=e.data)?void 0:t.type)!=m2?this.showHideWatermark():15==e.eventType&&e.entity.type==m2&&(t=e.operation,n=e.entity.wrapper,8==t?this.removeWatermark(n):0==e.operation&&((0,p2.applyFormat)(n,this.format,this.editor.isDarkMode()),n.spellcheck=!1))},Ht.default=v2,ot=p,Object.defineProperty(ot,"__esModule",{value:!0}),ot.Watermark=void 0,h2=Ht,Object.defineProperty(ot,"Watermark",{enumerable:!0,get:function(){return h2.default}}),Oe=ie,f2=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),F=e&&e.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||f2(t,e,n)},Object.defineProperty(Oe,"__esModule",{value:!0}),F(p,Oe);var y2,b2,E2,Wr={},ua={},Ua={},rt={},u=(Object.defineProperty(rt,"__esModule",{value:!0}),rt.default=function(e){var t=(null==e?void 0:e.selection)||{},n=t.firstCell,t=t.lastCell;if(!(e&&e.selection&&n&&t))return null;function r(e){e.x<0&&(e.x=0),e.y<0&&(e.y=0),e.y>=o.length&&(e.y=o.length-1);var t=o[e.y].length;e.x>=t&&(e.x=t-1)}var o=e.cells,e={x:Math.min(n.x,t.x),y:Math.min(n.y,t.y)},n={x:Math.max(n.x,t.x),y:Math.max(n.y,t.y)};return r(e),r(n),{firstCell:e,lastCell:n}},{}),or=(Object.defineProperty(u,"__esModule",{value:!0}),u.forEachSelectedCell=void 0,u.forEachSelectedCell=function(e,t){for(var n,r=e.selection,o=r.lastCell,i=r.firstCell,a=i.y;a<=o.y;a++)for(var l=i.x;l<=o.x;l++)null!=(n=e.cells[a][l])&&n.td&&t(e.cells[a][l])},{}),Sr=(Object.defineProperty(or,"__esModule",{value:!0}),or.getCellCoordinates=void 0,or.getCellCoordinates=function(e,t){var n;if(null!=e&&e.cells)for(var r=0;r<e.cells.length;r++)for(var o=0;o<e.cells[r].length;o++)t==e.cells[r][o].td&&(n={x:o,y:r});return n},{}),C2=(Object.defineProperty(Sr,"__esModule",{value:!0}),Sr.removeCellsOutsideSelection=void 0,t),w2=(Sr.removeCellsOutsideSelection=function(e){var t,n,r,o,i,a,l;(0,C2.isWholeTableSelected)(e,e.selection)||(t=(n=e.selection).firstCell,n=n.lastCell,r=[],o=t.x,i=t.y,a=n.x,l=n.y,e.cells.forEach(function(e,n){0<(e=e.filter(function(e,t){return i<=n&&n<=l&&o<=t&&t<=a})).length&&r.push(e)}),e.cells=r)},Object.defineProperty(Ua,"__esModule",{value:!0}),rt),S2=u,T2=or,P2=Sr,M=t,O2="td,th",x2=[16,18,91,17,44];function A(){var n=this;this.onMouseMove=function(e){if(n.editor.contains(e.target)){if(n.tableSelection&&(0,M.contains)(n.lastTarget,e.target,!0))return N2(n.editor,n.firstTarget,0),void e.preventDefault();var t;"TABLE"!=(0,M.getTagOfNode)(e.target)?(n.setData(e.target),n.firstTarget&&!n.firstTable||(n.lastTarget.lastChild==n.lastTarget.firstChild&&"TABLE"==(0,M.getTagOfNode)(n.lastTarget.lastChild)&&"DIV"==(0,M.getTagOfNode)(n.lastTarget)||!n.editor.contains(n.lastTarget)?e.preventDefault():(n.prepareSelection(),t=!!(0,M.safeInstanceOf)(n.lastTarget,"HTMLTableCellElement")&&(0,M.contains)(n.lastTarget,n.firstTable),n.firstTable&&n.firstTable==n.targetTable||t?n.selectionInsideTableMouseMove(e):n.tableSelection&&n.restoreSelection(),n.tableSelection&&(N2(n.editor,n.firstTarget,0),e.preventDefault())))):e.preventDefault()}},this.onMouseUp=function(){n.editor&&n.removeMouseUpEventListener()},this.DeleteTableContents={keys:[46,8],shouldHandleEvent:function(e,t){return 1==t.getSelectionRangeEx().type},handleEvent:function(e,t){1==t.getSelectionRangeEx().type&&t.addUndoSnapshot(function(){t.getSelectedRegions().forEach(function(e){(0,M.safeInstanceOf)(e.rootNode,"HTMLTableCellElement")&&_2(e.rootNode,t)})})}},this.lastTarget=null,this.firstTarget=null,this.tableSelection=!1,this.tableRange={firstCell:null,lastCell:null},this.startedSelection=!1}function _2(e,t){var n=new Range;n.selectNodeContents(e),n.deleteContents(),e.appendChild(t.getDocument().createElement("br"))}function N2(e,t,n,r,o){r=r||t,o=o||n,e.getDocument().defaultView.getSelection().setBaseAndExtent(t,n,r,o)}function R2(e,t){return e&&e.getElementAtCursor(O2,t)||t}function k2(e,t){return e?e.getElementAtCursor("table",t):null}A.prototype.getName=function(){return"TableCellSelection"},A.prototype.initialize=function(e){this.editor=e,this.editor.addContentEditFeature(this.DeleteTableContents)},A.prototype.dispose=function(){this.editor.select(null),this.removeMouseUpEventListener(),this.editor=null},A.prototype.onPluginEvent=function(e){if(this.editor)switch(e.eventType){case 17:var t=this.editor.getSelectionRangeEx();1==t.type&&(this.tableRange=t.coordinates,this.firstTable=t.table,this.tableSelection=!0,this.editor.select(t.table,null));break;case 18:this.firstTable&&this.tableSelection&&this.tableRange&&(1==(t=this.editor.queryElements("#"+this.firstTable.id)).length&&(this.firstTable=t[0],this.editor.select(this.firstTable,this.tableRange)));break;case 9:this.handleBeforeCutCopy(e);break;case 5:this.startedSelection||this.handleMouseDownEvent(e);break;case 0:this.startedSelection?e.rawEvent.preventDefault():this.handleKeyDownEvent(e);break;case 2:this.startedSelection?e.rawEvent.preventDefault():this.handleKeyUpEvent(e);break;case 14:this.startedSelection&&this.handleScrollEvent();break;case 20:this.tableRange&&(this.tableRange=null,this.firstTable=null,this.tableSelection=!1,this.editor.select(null))}},A.prototype.handleScrollEvent=function(){this.setData(this.editor.getElementAtCursor()),this.firstTable==this.targetTable?this.tableSelection&&(this.vTable.selection.lastCell=(0,T2.getCellCoordinates)(this.vTable,this.lastTarget),this.selectTable(),this.tableRange.lastCell=this.vTable.selection.lastCell,N2(this.editor,this.firstTarget,0)):this.tableSelection&&this.restoreSelection()},A.prototype.handleBeforeCutCopy=function(e){var t,n=this,r=this.editor.getSelectionRangeEx();1==r.type&&(t=e.clonedRoot.querySelector("table#"+r.table.id))&&(this.tableRange=r.coordinates,(r=new M.VTable(t)).selection=this.tableRange,(0,P2.removeCellsOutsideSelection)(r),r.writeBack(),e.range.selectNode(t),e.isCut&&(0,S2.forEachSelectedCell)(this.vTable,function(e){null!=e&&e.td&&_2(e.td,n.editor)}))},A.prototype.handleKeyDownEvent=function(t){var n=this,e=t.rawEvent,r=e.shiftKey,o=e.ctrlKey,i=e.metaKey,a=e.which,e=e.defaultPrevented;r&&(o||i)||16==a||e?this.preventKeyUp=e:r&&(this.firstTarget||(o=this.editor.getFocusedPosition(),i=R2(this.editor,o.node),this.firstTarget=this.firstTarget||i),(0,M.safeInstanceOf)(this.firstTarget,"HTMLTableCellElement")&&this.editor.runAsync(function(e){e=e.getFocusedPosition();n.setData(n.tableSelection?n.lastTarget:e.node),n.firstTable==n.targetTable?(n.shouldConvertToTableSelection()||n.tableSelection)&&n.handleKeySelectionInsideTable(t):n.tableSelection&&(n.firstTable&&n.editor.select(n.firstTable,null),n.tableSelection=!1)}))},A.prototype.handleKeyUpEvent=function(e){var e=e.rawEvent,t=e.shiftKey,n=e.which,e=e.ctrlKey;t||e||!this.firstTarget||this.preventKeyUp||-1!=x2.indexOf(n)||this.clearState(),this.preventKeyUp=!1},A.prototype.handleKeySelectionInsideTable=function(e){if(this.firstTarget=R2(this.editor,this.firstTarget),this.lastTarget=R2(this.editor,this.lastTarget),N2(this.editor,this.firstTarget,0),this.vTable=this.vTable||new M.VTable(this.firstTable),this.tableRange={firstCell:(0,T2.getCellCoordinates)(this.vTable,this.firstTarget),lastCell:this.getNextTD(e)},!this.tableRange.lastCell||this.tableRange.lastCell.y>this.vTable.cells.length-1||-1==this.tableRange.lastCell.y){var t,n;if(this.lastTarget=this.editor.getElementAtCursor("td,th,div",this.firstTable),!(0,M.safeInstanceOf)(this.lastTarget,"HTMLTableCellElement"))return t=new M.Position(this.targetTable,null==this.tableRange.lastCell.y||-1==this.tableRange.lastCell.y?-2:-3),o=(r=this.editor.getDocument().defaultView.getSelection()).anchorNode,n=r.anchorOffset,this.editor.select(r.getRangeAt(0)),r.setBaseAndExtent(o,n,t.node,t.offset),this.lastTarget=t.node,void e.rawEvent.preventDefault();this.prepareSelection()}this.vTable.selection=this.tableRange,this.selectTable();var r=this.isAfter(this.firstTarget,this.lastTarget),o=new M.Position(this.lastTarget,r?0:-1);N2(this.editor,o.node,o.offset),this.tableSelection=!0,e.rawEvent.preventDefault()},A.prototype.handleMouseDownEvent=function(e){var l=this,t=e.rawEvent,n=t.which,t=t.shiftKey;if(3==n&&this.tableSelection){var r=this.editor.getElementAtCursor(O2),r=(0,T2.getCellCoordinates)(this.vTable,r);if(r){var o=(0,w2.default)(this.vTable),i=o.firstCell,o=o.lastCell;if(r.y>=i.y&&r.y<=o.y&&r.x>=i.x&&r.x<=o.x)return this.firstTarget=this.vTable.getCell(i.y,i.x).td,this.lastTarget=this.vTable.getCell(o.y,o.x).td,void(this.firstTarget&&this.lastTarget&&(this.editor.getDocument().defaultView.getSelection().setBaseAndExtent(this.firstTarget,0,this.lastTarget,0),this.selectTable()))}}1!=n||t||(this.clearState(),k2(this.editor,e.rawEvent.target)&&(this.editor.getDocument().addEventListener("mouseup",this.onMouseUp,!0),this.editor.getDocument().addEventListener("mousemove",this.onMouseMove,!0),this.startedSelection=!0)),1==n&&t&&this.editor.runAsync(function(e){var t,n,r=e.getDocument().defaultView.getSelection(),o=R2(e,r.anchorNode),r=R2(e,r.focusNode),i=k2(e,o),a=k2(e,o);i==a&&(0,M.safeInstanceOf)(o,"HTMLTableCellElement")&&(0,M.safeInstanceOf)(r,"HTMLTableCellElement")&&(l.vTable=new M.VTable(o),t=(0,T2.getCellCoordinates)(l.vTable,o),n=(0,T2.getCellCoordinates)(l.vTable,r),l.vTable.selection={firstCell:t,lastCell:n},l.firstTarget=o,l.lastTarget=r,l.selectTable(),l.tableRange=l.vTable.selection,l.tableSelection=!0,l.firstTable=i,l.targetTable=a,N2(e,o,0))})},A.prototype.restoreSelection=function(){this.firstTable&&this.editor.select(this.firstTable,null),this.tableSelection=!1;var e=this.isAfter(this.firstTarget,this.lastTarget),t=new M.Position(this.lastTarget,e?-1:0),n=new Range;this.firstTarget&&n.selectNodeContents(this.firstTarget),N2(this.editor,this.firstTarget,(e?M.Position.getEnd(n):M.Position.getStart(n)).offset,t.element,t.offset)},A.prototype.selectionInsideTableMouseMove=function(e){var t;this.lastTarget!=this.firstTarget?(N2(this.editor,this.firstTarget,0),this.firstTable!=this.targetTable&&null!=(t=this.targetTable)&&t.contains(this.firstTable)&&(this.firstTarget=this.editor.getElementAtCursor(O2,this.lastTarget)),this.firstTable&&(this.tableSelection=!0,this.vTable=this.vTable||new M.VTable(this.firstTable),this.tableRange={firstCell:(0,T2.getCellCoordinates)(this.vTable,this.firstTarget),lastCell:(0,T2.getCellCoordinates)(this.vTable,this.lastTarget)},this.vTable.selection=this.tableRange,this.selectTable()),e.preventDefault()):this.lastTarget==this.firstTarget&&this.tableSelection&&(this.vTable=new M.VTable(this.firstTable),t=(0,T2.getCellCoordinates)(this.vTable,this.firstTarget),this.tableRange={firstCell:t,lastCell:t},this.vTable.selection=this.tableRange,this.selectTable())},A.prototype.removeMouseUpEventListener=function(){this.startedSelection&&(this.startedSelection=!1,this.editor.getDocument().removeEventListener("mouseup",this.onMouseUp,!0),this.editor.getDocument().removeEventListener("mousemove",this.onMouseMove,!0))},A.prototype.clearState=function(){this.editor.select(null),this.vTable=null,this.firstTarget=null,this.lastTarget=null,this.tableRange={firstCell:null,lastCell:null},this.tableSelection=!1,this.firstTable=null,this.targetTable=null},A.prototype.getNextTD=function(e){if(this.lastTarget=this.editor.getElementAtCursor(O2,this.lastTarget),(0,M.safeInstanceOf)(this.lastTarget,"HTMLTableCellElement")){var t=(0,T2.getCellCoordinates)(this.vTable,this.lastTarget);if(this.tableSelection)switch(e.rawEvent.which){case 39:t.x+=this.lastTarget.colSpan,null==this.vTable.cells[t.y][t.x]&&(t.x=this.vTable.cells[t.y].length-1,t.y++);break;case 37:0==t.x?t.y--:t.x--;break;case 38:t.y--;break;case 40:t.y++}return 0<=t.y&&0<=t.x&&(this.lastTarget=this.vTable.getTd(t.y,t.x)),t}return null},A.prototype.prepareSelection=function(){var e,t,n,r=this.lastTarget!=this.firstTarget&&(null==(t=this.firstTable)?void 0:t.contains((0,M.findClosestElementAncestor)(this.targetTable,this.firstTable,O2)));if(r&&this.tableSelection)for(;r;)this.lastTarget=(0,M.findClosestElementAncestor)(this.targetTable,this.firstTable,O2),this.targetTable=k2(this.editor,this.lastTarget),r=this.lastTarget!=this.firstTarget&&(null==(e=this.firstTable)?void 0:e.contains((0,M.findClosestElementAncestor)(this.targetTable,this.firstTable,O2)));var o=this.lastTarget!=this.firstTarget&&(null==(t=this.targetTable)?void 0:t.contains((0,M.findClosestElementAncestor)(this.firstTable,this.targetTable,O2)));if(o&&this.tableSelection)for(;o;)this.firstTarget=(0,M.findClosestElementAncestor)(this.firstTable,this.targetTable,O2),this.firstTable=this.editor.getElementAtCursor("table",this.firstTarget),o=this.lastTarget!=this.firstTarget&&(null==(n=this.targetTable)?void 0:n.contains((0,M.findClosestElementAncestor)(this.firstTable,this.targetTable,O2)))},A.prototype.setData=function(e){var t=this.editor.getFocusedPosition();t&&(this.firstTarget=this.firstTarget||R2(this.editor,t.node),this.firstTarget.nodeType==Node.TEXT_NODE&&(this.firstTarget=this.editor.getElementAtCursor(O2,this.firstTarget)),!this.editor.contains(this.firstTarget)&&this.lastTarget&&(this.firstTarget=this.lastTarget)),this.firstTable=k2(this.editor,this.firstTarget),this.lastTarget=R2(this.editor,e),this.targetTable=k2(this.editor,this.lastTarget)},A.prototype.isAfter=function(e,t){if(e&&t){if(t.contains(e)){var n=null==(n=e.getBoundingClientRect)?void 0:n.call(e),r=null==(r=t.getBoundingClientRect)?void 0:r.call(t);if(n&&r)return n.top>r.top&&n.bottom<r.bottom}return new M.Position(e,-1).isAfter(new M.Position(t,-1))}return!1},A.prototype.shouldConvertToTableSelection=function(){var t=this;if(!this.firstTable||!this.editor)return!1;var e=this.editor.getSelectedRegions();if(1==e.length)return!1;var n=!0;return e.forEach(function(e){(0,M.contains)(t.firstTable,e.rootNode)||(n=!1)}),n},A.prototype.selectTable=function(){var e;this.editor&&this.vTable&&null!=(e=this.editor)&&e.select(this.vTable.table,(0,w2.default)(this.vTable))},Ua.default=A,d=ua,Object.defineProperty(d,"__esModule",{value:!0}),d.TableCellSelection=void 0,E2=Ua,Object.defineProperty(d,"TableCellSelection",{enumerable:!0,get:function(){return E2.default}}),ce=Wr,b2=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),Ro=e&&e.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||b2(t,e,n)},Object.defineProperty(ce,"__esModule",{value:!0}),Ro(ua,ce),T=Er,y2=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),S=e&&e.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||y2(t,e,n)},Object.defineProperty(T,"__esModule",{value:!0}),S(q,T),S(sr,T),S(y,T),S(B,T),S(Vr,T),S(oe,T),S(Wa,T),S(Nr,T),S(rr,T),S(Je,T),S(ie,T),S(Wr,T);const L2=[new q.ContentEdit,new B.CutPasteListChain,new Vr.HyperLink,new Nr.Paste,new Wr.TableCellSelection,new Je.TableResize,new Er.ImageEdit];function I2(e,t,...n){const r=document.createElement(e);if(t)for(const e in t)r.setAttribute(e,t[e]);for(const e of n)"string"==typeof e?r.appendChild(document.createTextNode(e)):r.appendChild(e);return r}function M2(e,t){var n,r,t=(t=void 0===t?{}:t).insertAt;e&&"undefined"!=typeof document&&(n=document.head||document.getElementsByTagName("head")[0],(r=document.createElement("style")).type="text/css","top"===t&&n.firstChild?n.insertBefore(r,n.firstChild):n.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e)))}M2(":root {\r\n    --border-color: #f1f3f4;\r\n    --active-color: #e8f0fe;\r\n}\r\n\r\n.toolbar {\r\n    display: flex;\r\n    flex: 0 0 auto;\r\n    /* border: 2px solid var(--border-color); */\r\n    width: 100%;\r\n    box-sizing: border-box;\r\n    gap: 4px;\r\n    flex-wrap: wrap;\r\n    padding: 4px;\r\n    padding-bottom: 0px;\r\n    margin-bottom: 2px;\r\n}\r\n\r\n.toolbar-button {\r\n    border-width: 0;\r\n    border-radius: 4px;\r\n    margin: 2px;\r\n    padding: 0;\r\n    background-color: #fff;\r\n    cursor: pointer;\r\n    height: 30px;\r\n}\r\n\r\n.toolbar-button:hover,\r\n.toolbar-button:focus {\r\n    background-color: var(--border-color);\r\n    /* outline: none; */\r\n}\r\n\r\n.active {\r\n    background-color: var(--active-color);\r\n}\r\n");const A2={bold:{title:"Bold",image:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-6255 -8740 32 32'%3e %3cdefs%3e %3cstyle%3e .cls-1 %7b fill: none%3b %7d .cls-2 %7b fill: %23666%3b %7d %3c/style%3e %3c/defs%3e %3cg id='FB:_Bold' data-name='FB: Bold' transform='translate(-6999 -9195.999)'%3e %3crect id='Rectangle_2297' data-name='Rectangle 2297' class='cls-1' width='32' height='32' rx='2' transform='translate(744 455.999)'/%3e %3cpath id='Path_1536' data-name='Path 1536' class='cls-2' d='M9.828-9.031a3.888%2c3.888%2c0%2c0%2c1%2c1.548.311%2c4.012%2c4.012%2c0%2c0%2c1%2c1.27.855%2c4.012%2c4.012%2c0%2c0%2c1%2c.855%2c1.27%2c3.888%2c3.888%2c0%2c0%2c1%2c.311%2c1.548A3.888%2c3.888%2c0%2c0%2c1%2c13.5-3.5a4.012%2c4.012%2c0%2c0%2c1-.855%2c1.27%2c4.012%2c4.012%2c0%2c0%2c1-1.27.855%2c3.888%2c3.888%2c0%2c0%2c1-1.548.311H3.188V-15.937H9.828a3.384%2c3.384%2c0%2c0%2c1%2c1.345.27%2c3.465%2c3.465%2c0%2c0%2c1%2c1.1.739%2c3.465%2c3.465%2c0%2c0%2c1%2c.739%2c1.1%2c3.384%2c3.384%2c0%2c0%2c1%2c.27%2c1.345%2c3.384%2c3.384%2c0%2c0%2c1-.27%2c1.345%2c3.465%2c3.465%2c0%2c0%2c1-.739%2c1.1%2c3.465%2c3.465%2c0%2c0%2c1-1.1.739A3.384%2c3.384%2c0%2c0%2c1%2c9.828-9.031ZM6.375-9.562H7.969a2.034%2c2.034%2c0%2c0%2c0%2c.822-.17%2c2.176%2c2.176%2c0%2c0%2c0%2c.677-.457%2c2.19%2c2.19%2c0%2c0%2c0%2c.457-.672%2c2.024%2c2.024%2c0%2c0%2c0%2c.17-.826%2c2.034%2c2.034%2c0%2c0%2c0-.17-.822%2c2.176%2c2.176%2c0%2c0%2c0-.457-.677%2c2.176%2c2.176%2c0%2c0%2c0-.677-.457%2c2.034%2c2.034%2c0%2c0%2c0-.822-.17H6.375ZM8.5-3.187a2.034%2c2.034%2c0%2c0%2c0%2c.822-.17A2.176%2c2.176%2c0%2c0%2c0%2c10-3.814a2.19%2c2.19%2c0%2c0%2c0%2c.457-.672%2c2.024%2c2.024%2c0%2c0%2c0%2c.17-.826%2c2.034%2c2.034%2c0%2c0%2c0-.17-.822A2.176%2c2.176%2c0%2c0%2c0%2c10-6.811a2.176%2c2.176%2c0%2c0%2c0-.677-.457%2c2.034%2c2.034%2c0%2c0%2c0-.822-.17H6.375v4.25Z' transform='translate(752 479.999)'/%3e %3c/g%3e%3c/svg%3e",onClick:R.toggleBold,checked:e=>!!e.isBold},italic:{title:"Italic",image:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-6219 -8740 32 32'%3e %3cdefs%3e %3cstyle%3e .cls-1 %7b fill: none%3b %7d .cls-2 %7b fill: %23666%3b %7d %3c/style%3e %3c/defs%3e %3cg id='FB:_Italics' data-name='FB: Italics' transform='translate(-6999 -9195.999)'%3e %3crect id='Rectangle_2298' data-name='Rectangle 2298' class='cls-1' width='32' height='32' rx='2' transform='translate(780 455.999)'/%3e %3cpath id='Path_1552' data-name='Path 1552' class='cls-2' d='M10.808-17H11.92L6.259%2c0H5.138Z' transform='translate(788 479.999)'/%3e %3c/g%3e%3c/svg%3e",onClick:R.toggleItalic,checked:e=>!!e.isItalic},underline:{title:"Underline",image:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-6183 -8740 32 32'%3e %3cdefs%3e %3cstyle%3e .cls-1 %7b fill: none%3b %7d .cls-2 %7b fill: %23666%3b %7d %3c/style%3e %3c/defs%3e %3cg id='FB:_Underline' data-name='FB: Underline' transform='translate(-6999 -9196)'%3e %3crect id='Rectangle_2299' data-name='Rectangle 2299' class='cls-1' width='32' height='32' rx='2' transform='translate(816 456)'/%3e %3cpath id='Path_1568' data-name='Path 1568' class='cls-2' d='M13.813-17v9.563A5.2%2c5.2%2c0%2c0%2c1%2c13.4-5.366%2c5.344%2c5.344%2c0%2c0%2c1%2c12.26-3.677%2c5.344%2c5.344%2c0%2c0%2c1%2c10.571-2.54%2c5.2%2c5.2%2c0%2c0%2c1%2c8.5-2.125%2c5.2%2c5.2%2c0%2c0%2c1%2c6.429-2.54%2c5.344%2c5.344%2c0%2c0%2c1%2c4.74-3.677%2c5.344%2c5.344%2c0%2c0%2c1%2c3.6-5.366a5.2%2c5.2%2c0%2c0%2c1-.415-2.071V-17H4.25v9.563a4.092%2c4.092%2c0%2c0%2c0%2c.336%2c1.652A4.336%2c4.336%2c0%2c0%2c0%2c5.5-4.437a4.336%2c4.336%2c0%2c0%2c0%2c1.349.913A4.092%2c4.092%2c0%2c0%2c0%2c8.5-3.187a4.092%2c4.092%2c0%2c0%2c0%2c1.652-.336A4.336%2c4.336%2c0%2c0%2c0%2c11.5-4.437a4.336%2c4.336%2c0%2c0%2c0%2c.913-1.349%2c4.092%2c4.092%2c0%2c0%2c0%2c.336-1.652V-17ZM3.188-1.062H13.813V0H3.188Z' transform='translate(824 480)'/%3e %3c/g%3e%3c/svg%3e",onClick:R.toggleUnderline,checked:e=>!!e.isUnderline},strikeThrough:{title:"Strike through",image:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-5860 -8860 32 32'%3e %3cdefs%3e %3cstyle%3e .cls-1 %7b fill: none%3b %7d .cls-2 %7b fill: %23666%3b %7d %3c/style%3e %3c/defs%3e %3cg id='FB:_Strikeout' data-name='FB: Strikeout' transform='translate(-6880 -9195.999)'%3e %3crect id='Rectangle_2295' data-name='Rectangle 2295' class='cls-1' width='32' height='32' rx='2' transform='translate(1020 335.999)'/%3e %3cpath id='Path_1745' data-name='Path 1745' class='cls-2' d='M8.5-7.437H4.292a2.083%2c2.083%2c0%2c0%2c0%2c.145.643%2c1.589%2c1.589%2c0%2c0%2c0%2c.324.506%2c1.391%2c1.391%2c0%2c0%2c0%2c.494.328%2c1.753%2c1.753%2c0%2c0%2c0%2c.656.116%2c1.725%2c1.725%2c0%2c0%2c0%2c.618-.112%2c2.287%2c2.287%2c0%2c0%2c0%2c.552-.3v.73a2.183%2c2.183%2c0%2c0%2c1-.623.253%2c2.936%2c2.936%2c0%2c0%2c1-.681.079%2c2.4%2c2.4%2c0%2c0%2c1-.909-.166%2c2.108%2c2.108%2c0%2c0%2c1-.71-.465%2c2.16%2c2.16%2c0%2c0%2c1-.469-.71%2c2.562%2c2.562%2c0%2c0%2c1-.187-.9H2.582a3.234%2c3.234%2c0%2c0%2c1-.2.876%2c2.347%2c2.347%2c0%2c0%2c1-.423.714%2c1.886%2c1.886%2c0%2c0%2c1-.652.477A2.127%2c2.127%2c0%2c0%2c1%2c.423-5.2%2c1.58%2c1.58%2c0%2c0%2c1-1.013-6h-.017v.689h-.764V-7.437H-3.237v2.125h-.772V-6.06h-.017A1.6%2c1.6%2c0%2c0%2c1-5.5-5.2a2%2c2%2c0%2c0%2c1-.6-.087%2c1.35%2c1.35%2c0%2c0%2c1-.481-.261%2c1.213%2c1.213%2c0%2c0%2c1-.32-.436%2c1.469%2c1.469%2c0%2c0%2c1-.116-.6%2c2%2c2%2c0%2c0%2c1%2c.05-.444%2c1.253%2c1.253%2c0%2c0%2c1%2c.174-.411H-8.5V-8.5h4.491a1.357%2c1.357%2c0%2c0%2c0-.249-.768.859.859%2c0%2c0%2c0-.73-.295%2c2.236%2c2.236%2c0%2c0%2c0-.834.154%2c2.7%2c2.7%2c0%2c0%2c0-.726.436v-.789a2.635%2c2.635%2c0%2c0%2c1%2c.78-.336%2c3.478%2c3.478%2c0%2c0%2c1%2c.847-.1%2c1.638%2c1.638%2c0%2c0%2c1%2c1.253.436A1.847%2c1.847%2c0%2c0%2c1-3.246-8.5h1.453v-3.893h.764v3.138h.017A1.8%2c1.8%2c0%2c0%2c1%2c.639-10.2a2.059%2c2.059%2c0%2c0%2c1%2c.722.12%2c1.675%2c1.675%2c0%2c0%2c1%2c.564.344%2c1.873%2c1.873%2c0%2c0%2c1%2c.4.54%2c2.513%2c2.513%2c0%2c0%2c1%2c.224.7H3.619a2.274%2c2.274%2c0%2c0%2c1%2c.344-.739A2.269%2c2.269%2c0%2c0%2c1%2c4.5-9.77a2.262%2c2.262%2c0%2c0%2c1%2c.685-.324%2c2.9%2c2.9%2c0%2c0%2c1%2c.8-.108%2c3.219%2c3.219%2c0%2c0%2c1%2c.569.05%2c1.887%2c1.887%2c0%2c0%2c1%2c.535.183v.78a1.892%2c1.892%2c0%2c0%2c0-1.137-.374%2c1.539%2c1.539%2c0%2c0%2c0-.934.282%2c1.794%2c1.794%2c0%2c0%2c0-.594.78H8.5Zm-12.509%2c0h-1.7a.825.825%2c0%2c0%2c0-.407.3.921.921%2c0%2c0%2c0-.116.5.77.77%2c0%2c0%2c0%2c.075.349.735.735%2c0%2c0%2c0%2c.2.249.851.851%2c0%2c0%2c0%2c.291.149%2c1.207%2c1.207%2c0%2c0%2c0%2c.349.05%2c1.284%2c1.284%2c0%2c0%2c0%2c.548-.112%2c1.25%2c1.25%2c0%2c0%2c0%2c.411-.3A1.338%2c1.338%2c0%2c0%2c0-4.1-6.707a1.626%2c1.626%2c0%2c0%2c0%2c.091-.548ZM.448-9.562A1.431%2c1.431%2c0%2c0%2c0-.44-9.28a1.434%2c1.434%2c0%2c0%2c0-.515.78h2.7a1.422%2c1.422%2c0%2c0%2c0-.457-.772A1.247%2c1.247%2c0%2c0%2c0%2c.448-9.562ZM.332-5.844a1.366%2c1.366%2c0%2c0%2c0%2c.61-.129%2c1.3%2c1.3%2c0%2c0%2c0%2c.44-.349%2c1.653%2c1.653%2c0%2c0%2c0%2c.278-.51%2c2.75%2c2.75%2c0%2c0%2c0%2c.133-.606H-1.029v.174a1.527%2c1.527%2c0%2c0%2c0%2c.1.556%2c1.376%2c1.376%2c0%2c0%2c0%2c.278.448%2c1.307%2c1.307%2c0%2c0%2c0%2c.432.3A1.348%2c1.348%2c0%2c0%2c0%2c.332-5.844Z' transform='translate(1036 359.999)'/%3e %3c/g%3e%3c/svg%3e",onClick:R.toggleStrikethrough,checked:e=>!!e.isStrikeThrough},bullet:{title:"Bullet",image:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-10568 -10457 32 32'%3e %3cdefs%3e %3cstyle%3e .cls-1 %7b fill: none%3b %7d .cls-2 %7b fill: %23666%3b %7d .cls-3 %7b fill: %232E77D0%3b %7d %3c/style%3e %3c/defs%3e %3cg id='_00-UL' data-name='00-UL' transform='translate(-11635 -10912.999)'%3e %3crect id='Rectangle_2306' data-name='Rectangle 2306' class='cls-1' width='32' height='32' rx='2' transform='translate(1067 455.999)'/%3e %3crect id='Rectangle_3057' data-name='Rectangle 3057' class='cls-2' width='13' height='1' transform='translate(1078 466.999)'/%3e %3crect id='Rectangle_3058' data-name='Rectangle 3058' class='cls-2' width='13' height='1' transform='translate(1078 469.999)'/%3e %3crect id='Rectangle_3059' data-name='Rectangle 3059' class='cls-2' width='13' height='1' transform='translate(1078 472.999)'/%3e %3crect id='Rectangle_3060' data-name='Rectangle 3060' class='cls-2' width='13' height='1' transform='translate(1078 475.999)'/%3e %3crect id='Rectangle_3062' data-name='Rectangle 3062' class='cls-3' width='1' height='1' transform='translate(1075 466.999)'/%3e %3crect id='Rectangle_3065' data-name='Rectangle 3065' class='cls-3' width='1' height='1' transform='translate(1075 469.999)'/%3e %3crect id='Rectangle_3064' data-name='Rectangle 3064' class='cls-3' width='1' height='1' transform='translate(1075 472.999)'/%3e %3crect id='Rectangle_3063' data-name='Rectangle 3063' class='cls-3' width='1' height='1' transform='translate(1075 475.999)'/%3e %3c/g%3e%3c/svg%3e",onClick:R.toggleBullet,checked:e=>!!e.isBullet},numbering:{title:"Numbering",image:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-10536 -10457 32 32'%3e %3cdefs%3e %3cstyle%3e .cls-1 %7b fill: none%3b %7d .cls-2 %7b fill: %23666%3b %7d .cls-3 %7b fill: %232E77D0%3b %7d %3c/style%3e %3c/defs%3e %3cg id='_01-OL' data-name='01-OL' transform='translate(-11603 -10912.999)'%3e %3crect id='Rectangle_2306' data-name='Rectangle 2306' class='cls-1' width='32' height='32' rx='2' transform='translate(1067 455.999)'/%3e %3crect id='Rectangle_3057' data-name='Rectangle 3057' class='cls-2' width='12' height='1' transform='translate(1079 466.999)'/%3e %3crect id='Rectangle_3058' data-name='Rectangle 3058' class='cls-2' width='12' height='1' transform='translate(1079 470.999)'/%3e %3crect id='Rectangle_3059' data-name='Rectangle 3059' class='cls-2' width='12' height='1' transform='translate(1079 474.999)'/%3e %3cpath id='Path_1833' data-name='Path 1833' class='cls-3' d='M1.121-14.1a1.5%2c1.5%2c0%2c0%2c1-.311.178.877.877%2c0%2c0%2c1-.353.087v-.573q.257-.091.49-.2a2.376%2c2.376%2c0%2c0%2c0%2c.448-.274H1.8v3.2H1.121Zm-.008%2c3.486a1.414%2c1.414%2c0%2c0%2c1%2c.394.054.9.9%2c0%2c0%2c1%2c.324.166.794.794%2c0%2c0%2c1%2c.216.278.9.9%2c0%2c0%2c1%2c.079.39.982.982%2c0%2c0%2c1-.1.452%2c1.49%2c1.49%2c0%2c0%2c1-.245.349%2c2.013%2c2.013%2c0%2c0%2c1-.32.274q-.174.12-.32.224A1.744%2c1.744%2c0%2c0%2c0%2c.9-8.222a.307.307%2c0%2c0%2c0-.1.212H2.125v.573H.042q0-.191%2c0-.34A.89.89%2c0%2c0%2c1%2c.125-8.1a1.39%2c1.39%2c0%2c0%2c1%2c.34-.477q.216-.2.427-.361a3.419%2c3.419%2c0%2c0%2c0%2c.369-.332.548.548%2c0%2c0%2c0%2c.158-.39.366.366%2c0%2c0%2c0-.125-.315.549.549%2c0%2c0%2c0-.332-.091.958.958%2c0%2c0%2c0-.411.091%2c1.608%2c1.608%2c0%2c0%2c0-.361.232v-.606A1.674%2c1.674%2c0%2c0%2c1%2c1.112-10.617Zm.3%2c5.8a.944.944%2c0%2c0%2c1%2c.506.224.639.639%2c0%2c0%2c1%2c.208.506.877.877%2c0%2c0%2c1-.1.44.865.865%2c0%2c0%2c1-.27.295%2c1.19%2c1.19%2c0%2c0%2c1-.386.166%2c1.858%2c1.858%2c0%2c0%2c1-.444.054%2c2.5%2c2.5%2c0%2c0%2c1-.4-.033%2c1.341%2c1.341%2c0%2c0%2c1-.386-.125v-.606a1.155%2c1.155%2c0%2c0%2c0%2c.344.174%2c1.292%2c1.292%2c0%2c0%2c0%2c.386.058.8.8%2c0%2c0%2c0%2c.386-.091.351.351%2c0%2c0%2c0%2c.17-.34.326.326%2c0%2c0%2c0-.108-.27.657.657%2c0%2c0%2c0-.261-.125%2c1.347%2c1.347%2c0%2c0%2c0-.32-.037H.448v-.531H.714A1.377%2c1.377%2c0%2c0%2c0%2c1-5.084.508.508%2c0%2c0%2c0%2c1.233-5.2a.323.323%2c0%2c0%2c0%2c.1-.257.32.32%2c0%2c0%2c0-.137-.3.621.621%2c0%2c0%2c0-.328-.083%2c1.068%2c1.068%2c0%2c0%2c0-.614.2V-6.2a1.452%2c1.452%2c0%2c0%2c1%2c.378-.129%2c2.092%2c2.092%2c0%2c0%2c1%2c.394-.037%2c1.643%2c1.643%2c0%2c0%2c1%2c.365.042.946.946%2c0%2c0%2c1%2c.324.137.787.787%2c0%2c0%2c1%2c.232.245.671.671%2c0%2c0%2c1%2c.091.357.74.74%2c0%2c0%2c1-.162.5.868.868%2c0%2c0%2c1-.461.261Z' transform='translate(1075 480.999)'/%3e %3c/g%3e%3c/svg%3e",onClick:e=>R.toggleNumbering(e),checked:e=>!!e.isNumbering},outdent:{title:"Decrease indent",image:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-10408 -10457 32 32'%3e %3cdefs%3e %3cstyle%3e .cls-1 %7b fill: none%3b %7d .cls-2 %7b fill: %23666%3b %7d .cls-3 %7b fill: %232E77D0%3b %7d %3c/style%3e %3c/defs%3e %3cg id='_05-IndentLeft' data-name='05-IndentLeft' transform='translate(-11475 -10912.999)'%3e %3crect id='Rectangle_2306' data-name='Rectangle 2306' class='cls-1' width='32' height='32' rx='2' transform='translate(1067 455.999)'/%3e %3crect id='Rectangle_3057' data-name='Rectangle 3057' class='cls-2' width='9' height='1' transform='translate(1082 466.999)'/%3e %3crect id='Rectangle_3058' data-name='Rectangle 3058' class='cls-2' width='6' height='1' transform='translate(1082 468.999)'/%3e %3crect id='Rectangle_3059' data-name='Rectangle 3059' class='cls-2' width='9' height='1' transform='translate(1082 470.999)'/%3e %3crect id='Rectangle_3060' data-name='Rectangle 3060' class='cls-2' width='6' height='1' transform='translate(1082 472.999)'/%3e %3crect id='Rectangle_3061' data-name='Rectangle 3061' class='cls-2' width='9' height='1' transform='translate(1082 474.999)'/%3e %3cg id='Group_3989' data-name='Group 3989' transform='translate(-11)'%3e %3crect id='Rectangle_3062' data-name='Rectangle 3062' class='cls-3' width='6' height='1' transform='translate(1086 470.999)'/%3e %3cpath id='Arrow' class='cls-3' d='M11395%2c10917v-4h4v1h-3v3Z' transform='translate(-14689.138 812.326) rotate(-45)'/%3e %3c/g%3e %3c/g%3e%3c/svg%3e",onClick:e=>R.setIndentation(e,1)},indent:{title:"Increase indent",image:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-10376 -10457 32 32'%3e %3cdefs%3e %3cstyle%3e .cls-1 %7b fill: none%3b %7d .cls-2 %7b fill: %23666%3b %7d .cls-3 %7b fill: %232E77D0%3b %7d %3c/style%3e %3c/defs%3e %3cg id='_06-IndentRight' data-name='06-IndentRight' transform='translate(-11443 -10912.999)'%3e %3crect id='Rectangle_2306' data-name='Rectangle 2306' class='cls-1' width='32' height='32' rx='2' transform='translate(1067 455.999)'/%3e %3crect id='Rectangle_3057' data-name='Rectangle 3057' class='cls-2' width='9' height='1' transform='translate(1082 466.999)'/%3e %3crect id='Rectangle_3058' data-name='Rectangle 3058' class='cls-2' width='6' height='1' transform='translate(1082 468.999)'/%3e %3crect id='Rectangle_3059' data-name='Rectangle 3059' class='cls-2' width='9' height='1' transform='translate(1082 470.999)'/%3e %3crect id='Rectangle_3060' data-name='Rectangle 3060' class='cls-2' width='6' height='1' transform='translate(1082 472.999)'/%3e %3crect id='Rectangle_3061' data-name='Rectangle 3061' class='cls-2' width='9' height='1' transform='translate(1082 474.999)'/%3e %3cg id='Group_3988' data-name='Group 3988' transform='translate(2165.999 942.998) rotate(180)'%3e %3crect id='Rectangle_3062' data-name='Rectangle 3062' class='cls-3' width='6' height='1' transform='translate(1086 470.999)'/%3e %3cpath id='Arrow' class='cls-3' d='M11395%2c10917v-4h4v1h-3v3Z' transform='translate(-14689.138 812.326) rotate(-45)'/%3e %3c/g%3e %3c/g%3e%3c/svg%3e",onClick:e=>R.setIndentation(e,0)},alignLeft:{title:"Align left",image:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-10504 -10457 32 32'%3e %3cdefs%3e %3cstyle%3e .cls-1 %7b fill: none%3b %7d .cls-2 %7b fill: %23666%3b %7d %3c/style%3e %3c/defs%3e %3cg id='_02-Left' data-name='02-Left' transform='translate(-11571 -10912.999)'%3e %3crect id='Rectangle_2306' data-name='Rectangle 2306' class='cls-1' width='32' height='32' rx='2' transform='translate(1067 455.999)'/%3e %3crect id='Rectangle_3057' data-name='Rectangle 3057' class='cls-2' width='17' height='1' transform='translate(1075 464.999)'/%3e %3crect id='Rectangle_3058' data-name='Rectangle 3058' class='cls-2' width='13' height='1' transform='translate(1075 467.999)'/%3e %3crect id='Rectangle_3059' data-name='Rectangle 3059' class='cls-2' width='17' height='1' transform='translate(1075 470.999)'/%3e %3crect id='Rectangle_3060' data-name='Rectangle 3060' class='cls-2' width='13' height='1' transform='translate(1075 473.999)'/%3e %3crect id='Rectangle_3061' data-name='Rectangle 3061' class='cls-2' width='17' height='1' transform='translate(1075 476.999)'/%3e %3c/g%3e%3c/svg%3e",onClick:e=>R.setAlignment(e,0)},alignCenter:{title:"Align center",image:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-10472 -10457 32 32'%3e %3cdefs%3e %3cstyle%3e .cls-1 %7b fill: none%3b %7d .cls-2 %7b fill: %23666%3b %7d %3c/style%3e %3c/defs%3e %3cg id='_03-Center' data-name='03-Center' transform='translate(-11539 -10912.999)'%3e %3crect id='Rectangle_2306' data-name='Rectangle 2306' class='cls-1' width='32' height='32' rx='2' transform='translate(1067 455.999)'/%3e %3crect id='Rectangle_3057' data-name='Rectangle 3057' class='cls-2' width='17' height='1' transform='translate(1075 464.999)'/%3e %3crect id='Rectangle_3058' data-name='Rectangle 3058' class='cls-2' width='13' height='1' transform='translate(1077 467.999)'/%3e %3crect id='Rectangle_3059' data-name='Rectangle 3059' class='cls-2' width='17' height='1' transform='translate(1075 470.999)'/%3e %3crect id='Rectangle_3060' data-name='Rectangle 3060' class='cls-2' width='13' height='1' transform='translate(1077 473.999)'/%3e %3crect id='Rectangle_3061' data-name='Rectangle 3061' class='cls-2' width='17' height='1' transform='translate(1075 476.999)'/%3e %3c/g%3e%3c/svg%3e",onClick:e=>R.setAlignment(e,1)},alignRight:{title:"Align right",image:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-10440 -10457 32 32'%3e %3cdefs%3e %3cstyle%3e .cls-1 %7b fill: none%3b %7d .cls-2 %7b fill: %23666%3b %7d %3c/style%3e %3c/defs%3e %3cg id='_04-Right' data-name='04-Right' transform='translate(-11507 -10912.999)'%3e %3crect id='Rectangle_2306' data-name='Rectangle 2306' class='cls-1' width='32' height='32' rx='2' transform='translate(1067 455.999)'/%3e %3crect id='Rectangle_3057' data-name='Rectangle 3057' class='cls-2' width='17' height='1' transform='translate(1075 464.999)'/%3e %3crect id='Rectangle_3058' data-name='Rectangle 3058' class='cls-2' width='13' height='1' transform='translate(1079 467.999)'/%3e %3crect id='Rectangle_3059' data-name='Rectangle 3059' class='cls-2' width='17' height='1' transform='translate(1075 470.999)'/%3e %3crect id='Rectangle_3060' data-name='Rectangle 3060' class='cls-2' width='13' height='1' transform='translate(1079 473.999)'/%3e %3crect id='Rectangle_3061' data-name='Rectangle 3061' class='cls-2' width='17' height='1' transform='translate(1075 476.999)'/%3e %3c/g%3e%3c/svg%3e",onClick:e=>R.setAlignment(e,2)},unlink:{title:"Remove hyperlink",image:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-5860 -8896 32 32'%3e %3cdefs%3e %3cstyle%3e .cls-1 %7b fill: none%3b %7d .cls-2 %7b fill: %23666%3b %7d .cls-3 %7b fill: %23D82300%3b %7d %3c/style%3e %3c/defs%3e %3cg id='FB:_Unlink' data-name='FB: Unlink' transform='translate(-6880 -9199.999)'%3e %3crect id='Rectangle_2295' data-name='Rectangle 2295' class='cls-1' width='32' height='32' rx='2' transform='translate(1020 303.999)'/%3e %3cg id='Group_3910' data-name='Group 3910'%3e %3cpath id='Path_1712' data-name='Path 1712' class='cls-2' d='M-.531-13.812a3.558%2c3.558%2c0%2c0%2c1%2c1.444.295%2c3.854%2c3.854%2c0%2c0%2c1%2c1.179.8%2c3.7%2c3.7%2c0%2c0%2c1%2c.8%2c1.179%2c3.632%2c3.632%2c0%2c0%2c1%2c.291%2c1.448%2c3.632%2c3.632%2c0%2c0%2c1-.291%2c1.448%2c3.7%2c3.7%2c0%2c0%2c1-.8%2c1.179%2c3.854%2c3.854%2c0%2c0%2c1-1.179.8%2c3.558%2c3.558%2c0%2c0%2c1-1.444.295h-.531V-7.437h.531A2.572%2c2.572%2c0%2c0%2c0%2c.5-7.645a2.679%2c2.679%2c0%2c0%2c0%2c.843-.569%2c2.724%2c2.724%2c0%2c0%2c0%2c.573-.847%2c2.558%2c2.558%2c0%2c0%2c0%2c.212-1.033%2c2.529%2c2.529%2c0%2c0%2c0-.212-1.029%2c2.737%2c2.737%2c0%2c0%2c0-.573-.843A2.737%2c2.737%2c0%2c0%2c0%2c.5-12.538%2c2.529%2c2.529%2c0%2c0%2c0-.531-12.75h-4.25a2.558%2c2.558%2c0%2c0%2c0-1.033.212%2c2.724%2c2.724%2c0%2c0%2c0-.847.573%2c2.679%2c2.679%2c0%2c0%2c0-.569.843%2c2.572%2c2.572%2c0%2c0%2c0-.208%2c1.029A2.6%2c2.6%2c0%2c0%2c0-7.23-9.06a2.666%2c2.666%2c0%2c0%2c0%2c.569.847%2c2.666%2c2.666%2c0%2c0%2c0%2c.847.569%2c2.6%2c2.6%2c0%2c0%2c0%2c1.033.208h.531v1.063h-.531A3.587%2c3.587%2c0%2c0%2c1-6.23-6.67a3.788%2c3.788%2c0%2c0%2c1-1.179-.8%2c3.788%2c3.788%2c0%2c0%2c1-.8-1.179A3.587%2c3.587%2c0%2c0%2c1-8.5-10.094a3.587%2c3.587%2c0%2c0%2c1%2c.295-1.448%2c3.788%2c3.788%2c0%2c0%2c1%2c.8-1.179%2c3.788%2c3.788%2c0%2c0%2c1%2c1.179-.8%2c3.587%2c3.587%2c0%2c0%2c1%2c1.448-.295ZM7.421-7.1a2.661%2c2.661%2c0%2c0%2c0-.261-.971%2c2.686%2c2.686%2c0%2c0%2c0-.573-.78%2c2.65%2c2.65%2c0%2c0%2c0-.818-.523%2c2.574%2c2.574%2c0%2c0%2c0-.988-.191H4.25v-1.062h.531a3.587%2c3.587%2c0%2c0%2c1%2c1.448.295%2c3.788%2c3.788%2c0%2c0%2c1%2c1.179.8%2c3.788%2c3.788%2c0%2c0%2c1%2c.8%2c1.179A3.587%2c3.587%2c0%2c0%2c1%2c8.5-6.906a3.632%2c3.632%2c0%2c0%2c1-.091.8Zm-9.546.191a2.6%2c2.6%2c0%2c0%2c0%2c.208%2c1.033%2c2.666%2c2.666%2c0%2c0%2c0%2c.569.847A2.666%2c2.666%2c0%2c0%2c0-.5-4.458%2c2.6%2c2.6%2c0%2c0%2c0%2c.531-4.25H1.992L3.055-3.187H.531A3.587%2c3.587%2c0%2c0%2c1-.917-3.482a3.788%2c3.788%2c0%2c0%2c1-1.179-.8%2c3.788%2c3.788%2c0%2c0%2c1-.8-1.179%2c3.587%2c3.587%2c0%2c0%2c1-.295-1.448%2c3.587%2c3.587%2c0%2c0%2c1%2c.295-1.448%2c3.788%2c3.788%2c0%2c0%2c1%2c.8-1.179%2c3.788%2c3.788%2c0%2c0%2c1%2c1.179-.8%2c3.587%2c3.587%2c0%2c0%2c1%2c1.448-.295h.531v1.063H.531A2.558%2c2.558%2c0%2c0%2c0-.5-9.351a2.724%2c2.724%2c0%2c0%2c0-.847.573%2c2.679%2c2.679%2c0%2c0%2c0-.569.843A2.572%2c2.572%2c0%2c0%2c0-2.125-6.906Zm10.6%2c2.374L6.6-2.656%2c8.475-.772l-.747.747L5.844-1.9%2c3.959-.017%2c3.212-.772%2c5.1-2.656%2c3.212-4.541l.747-.747L5.844-3.4%2c7.728-5.288Z' transform='translate(1036 327.999)'/%3e %3cpath id='Path_1391' data-name='Path 1391' class='cls-3' d='M8.475-4.532%2c6.6-2.656%2c8.475-.772l-.747.747L5.844-1.9%2c3.959-.017%2c3.212-.772%2c5.1-2.656%2c3.212-4.541l.747-.747L5.844-3.4%2c7.728-5.288Z' transform='translate(1036 327.999)'/%3e %3c/g%3e %3c/g%3e%3c/svg%3e",onClick:R.removeLink},code:{title:"Code block",image:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32'%3e %3cg%3e %3cline id='svg_1' y2='16.5' x2='7' y1='10' x1='13' stroke-width='1' stroke='black' fill='none'/%3e %3cline id='svg_2' y2='16.5' x2='7' y1='23' x1='13' stroke-width='1' stroke='black' fill='none'/%3e %3cline id='svg_3' y2='16.5' x2='26' y1='10' x1='20' stroke-width='1' stroke='black' fill='none'/%3e %3cline id='svg_4' y2='16.5' x2='26' y1='23' x1='20' stroke-width='1' stroke='black' fill='none'/%3e %3c/g%3e%3c/svg%3e",onClick:e=>R.toggleCodeBlock(e)},ltr:{title:"Left-to-right",image:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-5896 -8824 32 32'%3e %3cdefs%3e %3cstyle%3e .cls-1 %7b fill: none%3b %7d .cls-2 %7b fill: %23666%3b %7d .cls-3 %7b fill: %232E77D0%3b %7d %3c/style%3e %3c/defs%3e %3cg id='FB:_Paragraph_In' data-name='FB: Paragraph In' transform='translate(-6884 -9191.999)'%3e %3crect id='Rectangle_2295' data-name='Rectangle 2295' class='cls-1' width='32' height='32' rx='2' transform='translate(988 367.999)'/%3e %3cg id='Group_3954' data-name='Group 3954'%3e %3cpath id='Path_1756' data-name='Path 1756' class='cls-2' d='M-7.437-12.966l5.528%2c5.528L-7.437-1.909Zm1.063%2c8.5L-3.4-7.437l-2.972-2.972ZM6.375-14.875v12.75H7.438v1.063H2.125V-2.125H3.188V-8.5H1.594A3.632%2c3.632%2c0%2c0%2c1%2c.145-8.791a3.745%2c3.745%2c0%2c0%2c1-1.183-.8%2c3.745%2c3.745%2c0%2c0%2c1-.8-1.183%2c3.632%2c3.632%2c0%2c0%2c1-.291-1.448%2c3.632%2c3.632%2c0%2c0%2c1%2c.291-1.448%2c3.745%2c3.745%2c0%2c0%2c1%2c.8-1.183%2c3.745%2c3.745%2c0%2c0%2c1%2c1.183-.8%2c3.632%2c3.632%2c0%2c0%2c1%2c1.448-.291H7.438v1.063ZM3.188-9.562v-5.312H1.594a2.558%2c2.558%2c0%2c0%2c0-1.033.212%2c2.724%2c2.724%2c0%2c0%2c0-.847.573%2c2.679%2c2.679%2c0%2c0%2c0-.569.843%2c2.572%2c2.572%2c0%2c0%2c0-.208%2c1.029%2c2.6%2c2.6%2c0%2c0%2c0%2c.208%2c1.033%2c2.666%2c2.666%2c0%2c0%2c0%2c.569.847A2.666%2c2.666%2c0%2c0%2c0%2c.56-9.77a2.6%2c2.6%2c0%2c0%2c0%2c1.033.208ZM5.313-2.125v-12.75H4.25v12.75Z' transform='translate(1004 391.999)'/%3e %3cpath id='Path_1404' data-name='Path 1404' class='cls-3' d='M-7.437-12.966l5.528%2c5.528L-7.437-1.909Zm1.063%2c8.5L-3.4-7.437l-2.972-2.972Z' transform='translate(1004 391.999)'/%3e %3c/g%3e %3c/g%3e%3c/svg%3e",onClick:e=>R.setDirection(e,0)},rtl:{title:"Right-to-left",image:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-5860 -8824 32 32'%3e %3cdefs%3e %3cstyle%3e .cls-1 %7b fill: none%3b %7d .cls-2 %7b fill: %23666%3b %7d .cls-3 %7b fill: %232E77D0%3b %7d %3c/style%3e %3c/defs%3e %3cg id='FB:_Paragraph_Out' data-name='FB: Paragraph Out' transform='translate(-6880 -9191.999)'%3e %3crect id='Rectangle_2295' data-name='Rectangle 2295' class='cls-1' width='32' height='32' rx='2' transform='translate(1020 367.999)'/%3e %3cg id='Group_3965' data-name='Group 3965'%3e %3cpath id='Path_1767' data-name='Path 1767' class='cls-2' d='M1.063-15.937v1.063H0v12.75H1.063v1.063H-4.25V-2.125h1.063V-8.5H-4.781A3.632%2c3.632%2c0%2c0%2c1-6.23-8.791a3.745%2c3.745%2c0%2c0%2c1-1.183-.8%2c3.745%2c3.745%2c0%2c0%2c1-.8-1.183A3.632%2c3.632%2c0%2c0%2c1-8.5-12.219a3.632%2c3.632%2c0%2c0%2c1%2c.291-1.448%2c3.745%2c3.745%2c0%2c0%2c1%2c.8-1.183%2c3.745%2c3.745%2c0%2c0%2c1%2c1.183-.8%2c3.632%2c3.632%2c0%2c0%2c1%2c1.448-.291Zm-4.25%2c6.375v-5.312H-4.781a2.558%2c2.558%2c0%2c0%2c0-1.033.212%2c2.724%2c2.724%2c0%2c0%2c0-.847.573%2c2.679%2c2.679%2c0%2c0%2c0-.569.843%2c2.572%2c2.572%2c0%2c0%2c0-.208%2c1.029%2c2.6%2c2.6%2c0%2c0%2c0%2c.208%2c1.033%2c2.666%2c2.666%2c0%2c0%2c0%2c.569.847%2c2.666%2c2.666%2c0%2c0%2c0%2c.847.569%2c2.6%2c2.6%2c0%2c0%2c0%2c1.033.208Zm2.125%2c7.438v-12.75H-2.125v12.75Zm8.5-10.841V-1.909L1.909-7.437ZM6.375-10.409%2c3.4-7.437%2c6.375-4.466Z' transform='translate(1036 391.999)'/%3e %3cpath id='Path_1401' data-name='Path 1401' class='cls-3' d='M7.438-12.966V-1.909L1.909-7.437ZM6.375-10.409%2c3.4-7.437%2c6.375-4.466Z' transform='translate(1036 391.999)'/%3e %3c/g%3e %3c/g%3e%3c/svg%3e",onClick:e=>R.setDirection(e,1)},undo:{title:"Undo",image:"data:image/svg+xml,%3c%3fxml version='1.0' encoding='UTF-8'%3f%3e%3csvg viewBox='-8 -8 32 32' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e %3cdefs%3e %3cpath d='M8.5%2c0.03125 C9.0000025%2c0.03125 9.48176852%2c0.0963535156 9.9453125%2c0.2265625 C10.4088565%2c0.356771484 10.843748%2c0.541665469 11.25%2c0.78125 C11.656252%2c1.02083453 12.02604%2c1.30729 12.359375%2c1.640625 C12.69271%2c1.97396 12.9791655%2c2.34374797 13.21875%2c2.75 C13.4583345%2c3.15625203 13.6432285%2c3.59114352 13.7734375%2c4.0546875 C13.9036465%2c4.51823148 13.96875%2c4.9999975 13.96875%2c5.5 C13.96875%2c6.21354523 13.8320326%2c6.90234043 13.5585938%2c7.56640625 C13.2851549%2c8.23047207 12.8958359%2c8.81510164 12.390625%2c9.3203125 L5.8515625%2c15.8515625 L5.1484375%2c15.1484375 L11.6796875%2c8.609375 C12.0911479%2c8.19791461 12.408853%2c7.72265895 12.6328125%2c7.18359375 C12.856772%2c6.64452855 12.96875%2c6.08333625 12.96875%2c5.5 C12.96875%2c4.89062195 12.8502616%2c4.31510687 12.6132812%2c3.7734375 C12.3763009%2c3.23176813 12.0546895%2c2.75781453 11.6484375%2c2.3515625 C11.2421855%2c1.94531047 10.7682319%2c1.6236991 10.2265625%2c1.38671875 C9.68489312%2c1.1497384 9.10937805%2c1.03125 8.5%2c1.03125 C7.93749719%2c1.03125 7.4414084%2c1.11588457 7.01171875%2c1.28515625 C6.5820291%2c1.45442793 6.18489766%2c1.67838402 5.8203125%2c1.95703125 C5.45572734%2c2.23567848 5.10547043%2c2.55208156 4.76953125%2c2.90625 C4.43359207%2c3.26041844 4.08073102%2c3.62499813 3.7109375%2c4 L7%2c4 L7%2c5 L2%2c5 L2%2c0 L3%2c0 L3%2c3.2890625 C3.28645977%2c2.99739438 3.5611966%2c2.71484512 3.82421875%2c2.44140625 C4.0872409%2c2.16796738 4.3502591%2c1.91015746 4.61328125%2c1.66796875 C4.8763034%2c1.42578004 5.14452988%2c1.20442809 5.41796875%2c1.00390625 C5.69140762%2c0.803384414 5.98307137%2c0.631511133 6.29296875%2c0.48828125 C6.60286613%2c0.345051367 6.93880027%2c0.23307332 7.30078125%2c0.15234375 C7.66276223%2c0.0716141797 8.06249781%2c0.03125 8.5%2c0.03125 Z' id='path-1'%3e%3c/path%3e %3c/defs%3e %3cg id='Undo_16x16' stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'%3e %3cg id='undo'%3e %3cuse id='Mask' fill='%23666666' fill-rule='evenodd' xlink:href='%23path-1'%3e%3c/use%3e %3c/g%3e %3c/g%3e%3c/svg%3e",onClick:e=>e.undo()},redo:{title:"Redo",image:"data:image/svg+xml,%3c%3fxml version='1.0' encoding='UTF-8'%3f%3e%3csvg viewBox='-8 -8 32 32' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e %3cdefs%3e %3cpath d='M8.5%2c0.03125 C9.0000025%2c0.03125 9.48176852%2c0.0963535156 9.9453125%2c0.2265625 C10.4088565%2c0.356771484 10.843748%2c0.541665469 11.25%2c0.78125 C11.656252%2c1.02083453 12.02604%2c1.30729 12.359375%2c1.640625 C12.69271%2c1.97396 12.9791655%2c2.34374797 13.21875%2c2.75 C13.4583345%2c3.15625203 13.6432285%2c3.59114352 13.7734375%2c4.0546875 C13.9036465%2c4.51823148 13.96875%2c4.9999975 13.96875%2c5.5 C13.96875%2c6.21354523 13.8320326%2c6.90234043 13.5585938%2c7.56640625 C13.2851549%2c8.23047207 12.8958359%2c8.81510164 12.390625%2c9.3203125 L5.8515625%2c15.8515625 L5.1484375%2c15.1484375 L11.6796875%2c8.609375 C12.0911479%2c8.19791461 12.408853%2c7.72265895 12.6328125%2c7.18359375 C12.856772%2c6.64452855 12.96875%2c6.08333625 12.96875%2c5.5 C12.96875%2c4.89062195 12.8502616%2c4.31510687 12.6132812%2c3.7734375 C12.3763009%2c3.23176813 12.0546895%2c2.75781453 11.6484375%2c2.3515625 C11.2421855%2c1.94531047 10.7682319%2c1.6236991 10.2265625%2c1.38671875 C9.68489312%2c1.1497384 9.10937805%2c1.03125 8.5%2c1.03125 C7.93749719%2c1.03125 7.4414084%2c1.11588457 7.01171875%2c1.28515625 C6.5820291%2c1.45442793 6.18489766%2c1.67838402 5.8203125%2c1.95703125 C5.45572734%2c2.23567848 5.10547043%2c2.55208156 4.76953125%2c2.90625 C4.43359207%2c3.26041844 4.08073102%2c3.62499813 3.7109375%2c4 L7%2c4 L7%2c5 L2%2c5 L2%2c0 L3%2c0 L3%2c3.2890625 C3.28645977%2c2.99739438 3.5611966%2c2.71484512 3.82421875%2c2.44140625 C4.0872409%2c2.16796738 4.3502591%2c1.91015746 4.61328125%2c1.66796875 C4.8763034%2c1.42578004 5.14452988%2c1.20442809 5.41796875%2c1.00390625 C5.69140762%2c0.803384414 5.98307137%2c0.631511133 6.29296875%2c0.48828125 C6.60286613%2c0.345051367 6.93880027%2c0.23307332 7.30078125%2c0.15234375 C7.66276223%2c0.0716141797 8.06249781%2c0.03125 8.5%2c0.03125 Z' id='path-1'%3e%3c/path%3e %3c/defs%3e %3cg id='Redo_16x16' stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'%3e %3cg id='undo' transform='translate(8.000000%2c 8.000000) scale(-1%2c 1) translate(-8.000000%2c -8.000000) '%3e %3cuse id='Mask' fill='%23666666' fill-rule='evenodd' xlink:href='%23path-1'%3e%3c/use%3e %3c/g%3e %3c/g%3e%3c/svg%3e",onClick:e=>e.redo()},insertImage:{title:"Insert inline image",image:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-6111 -8692 32 32'%3e %3cdefs%3e %3cstyle%3e .cls-1 %7b fill: none%3b %7d .cls-2 %7b fill: %232E77D0%3b stroke: white%3b stroke-width: 1.5px%3b %7d .cls-3 %7b fill: %23666%3b %7d %3c/style%3e %3c/defs%3e %3cg id='TB:_Insert' data-name='TB: Insert' transform='translate(-6366 -9160.999)'%3e %3crect id='Rectangle_2291' data-name='Rectangle 2291' class='cls-1' width='32' height='32' rx='2' transform='translate(255 468.999)'/%3e %3cg id='Group_3880' data-name='Group 3880'%3e %3cpath id='Path_990' data-name='Path 990' class='cls-2' d='M1.063-3.187H11.995L4.781-10.409%2c1.063-6.682Zm14.875%2c0v-.307L12.219-7.222%2c10.841-5.844l2.665%2c2.656Z' transform='translate(263 492.999)'/%3e %3cpath id='Path_1452' data-name='Path 1452' class='cls-3' d='M17-14.875v12.75H0v-12.75ZM1.063-13.812v5.62L4.781-11.9l5.313%2c5.313%2c2.125-2.125%2c3.719%2c3.71v-8.807Zm0%2c10.625H11.995L4.781-10.409%2c1.063-6.682Zm14.875%2c0v-.307L12.219-7.222%2c10.841-5.844l2.665%2c2.656Zm-2.656-7.437a.511.511%2c0%2c0%2c1-.374-.158.511.511%2c0%2c0%2c1-.158-.374.511.511%2c0%2c0%2c1%2c.158-.374.511.511%2c0%2c0%2c1%2c.374-.158.511.511%2c0%2c0%2c1%2c.374.158.511.511%2c0%2c0%2c1%2c.158.374.511.511%2c0%2c0%2c1-.158.374A.511.511%2c0%2c0%2c1%2c13.281-10.625Z' transform='translate(263 492.999)'/%3e %3c/g%3e %3c/g%3e%3c/svg%3e",onClick:(n,r)=>{const e=n.getDocument(),o=e.createElement("input");o.type="file",o.accept="image/*",o.style.display="none",o.addEventListener("change",()=>{var e=void 0,a=void 0,l=void 0,s=function*(){var e,[t]=null!=(e=null==o?void 0:o.files)?e:[];if(t&&r){const e=yield r(t);"string"==typeof e?R.insertImage(n,e):R.insertImage(n,t)}};return new(l=l||Promise)(function(n,t){function r(e){try{i(s.next(e))}catch(e){t(e)}}function o(e){try{i(s.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?n(e.value):((t=e.value)instanceof l?t:new l(function(e){e(t)})).then(r,o)}i((s=s.apply(e,a||[])).next())})}),e.body.appendChild(o),o.click(),e.body.removeChild(o)}}};function D2(e,t,n){var r;const o=I2("div",{class:"toolbar"}),i=R.getFormatState(n),a=null==e?void 0:e.parentNode,l=Object.keys(t);for(const[e,s]of l.entries())if(A2[s]){const{image:l="",onClick:c,checked:d=null,title:u}=A2[s],f="function"==typeof d,h=!!f&&d(i),p=I2("button",{class:"toolbar-button",id:s,title:u,"aria-label":u,type:"button",tabindex:0===e?"0":"-1"},I2("img",{src:l,alt:u,width:"30",height:"30"}));p.onclick=()=>{f&&p.classList.toggle("active"),p.setAttribute("tabindex","0"),null!=t&&t.insertImage?c(n,null==t?void 0:t.insertImage):c(n)},null!=(r=null==a?void 0:a.querySelector("#"+s))&&r.classList.toggle("active",h),o.appendChild(p)}return o.onkeydown=e=>{var t;if("ArrowLeft"===e.key||"ArrowRight"===e.key){const n=document.querySelector(".toolbar"),r=null==n?void 0:n.querySelector('button[tabindex="0"]');"ArrowRight"===e.key&&r.nextSibling?(r.setAttribute("tabindex","-1"),r.classList.remove("active"),null!=(t=r.nextElementSibling)&&t.setAttribute("tabindex","0"),null!=(t=r.nextElementSibling)&&t.focus()):"ArrowLeft"===e.key&&r.previousSibling&&(r.setAttribute("tabindex","-1"),r.classList.remove("active"),null!=(t=r.previousElementSibling)&&t.setAttribute("tabindex","0"),null!=(e=r.previousElementSibling)&&e.focus())}},o}class j2{constructor(e,t){this.rootElement=e,this.toolbarConfig=t}getName(){return"Toolbar"}initialize(e){this.editor=e}dispose(){this.editor=null}getEditor(){return this.editor}updateToolbarOptions(){this.editor&&D2(this.rootElement,this.toolbarConfig,this.editor)}onPluginEvent(e){if(this.editor)if(0==e.eventType||6==e.eventType)this.updateToolbarOptions();else if(7==e.eventType){const t=this.editor.getCustomData("LAST_CLIPBOARD_DATA")||{data:null};"Paste"==e.source?t.data=e.data:t.data=null}else 11==e.eventType&&this.updateToolbarOptions()}}return M2('.editor-container {\r\n    display: flex;\r\n    flex-direction: column;\r\n}\r\n\r\n.editor-textarea {\r\n    flex: 1 1 auto;\r\n    min-height: 100px;\r\n    border: 2px solid #ddd;\r\n    overflow: auto;\r\n    padding: 10px;\r\n}\r\n\r\n\r\ndiv[contenteditable="false"].editor-textarea {\r\n    overflow-wrap: anywhere;\r\n}\r\n'),D.PiTextEditor=class{constructor(e,t){this.rootElement=e,this.config=Object.assign(Object.assign({},t),{width:(null==t?void 0:t.width)||"100%",height:(null==t?void 0:t.height)||"100%"})}mount(){var e;this.createWrapperDiv(),this.editor=new j.Editor(this.rootElement,{plugins:[...L2,...null!=(e=this.config)&&e.onChange?[new kd(this.config.onChange)]:[],new j2(this.rootElement,null==(e=this.config)?void 0:e.toolbar)]}),this.rootElement.classList.add("editor-textarea"),this.config.readonly?(this.rootElement.contentEditable="false",this.rootElement.style.cssText=`height:${this.config.height}; width:${this.config.width};`):this.mountWithToolbar()}unmount(){var e;null!=(e=this.editor)&&e.dispose(),this.replaceWrapperDiv()}getContent(e){return this.editor.getContent(e)}setContent(e){return this.editor.setContent(e)}createWrapperDiv(){const e=I2("div",{class:"editor-container"});e.style.cssText=`height:${this.config.height}; width:${this.config.width};`,this.container=e}replaceWrapperDiv(){var e,t;this.rootElement&&null!=(e=null==(t=this.rootElement.parentNode)?void 0:t.parentNode)&&e.replaceChild(this.rootElement,t)}mountWithToolbar(){var e,t;if(!this.config.toolbar)throw new Error("Toolbar options are not passed in config.");this.container&&(t=D2(this.rootElement,null==(t=this.config)?void 0:t.toolbar,this.editor),null!=(e=null==(e=this.rootElement)?void 0:e.parentElement)&&e.replaceChild(this.container,this.rootElement),null!=(e=this.container)&&e.appendChild(this.rootElement),null!=(e=this.container)&&e.prepend(t))}},Object.defineProperty(D,"__esModule",{value:!0}),D}({});
