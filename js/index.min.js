var PiTextEditor=function(c){"use strict";var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},d={},u={},f={},h={},t={},g={},v={},m={},y={};function b(e){e=e&&(e.commonAncestorContainer||e),e=e&&(e.ownerDocument||("[object HTMLDocument]"==Object.prototype.toString.apply(e)?e:null));return e&&(e.defaultView||window)}Object.defineProperty(y,"__esModule",{value:!0}),y.getTargetWindow=void 0,y.getTargetWindow=b,y.default=function(e,t){var n=b(e),n=n&&n[t],r=window,r=r&&r[t];return r&&e instanceof r||n&&e instanceof n},Object.defineProperty(m,"__esModule",{value:!0});var E=y,C=(m.default=function(e,t,n){return!(!e||!t)&&(!(!n||e!=t)||((0,E.default)(t,"Range")&&(t=t&&t.commonAncestorContainer,n=!0),t&&3==t.nodeType&&(t=t.parentNode,n=!0),1!=e.nodeType&&11!=e.nodeType?!!n&&e==t:!(!n&&e==t)&&function(e,t){if(e.contains)return e.contains(t);for(;t;){if(t==e)return!0;t=t.parentNode}return!1}(e,t)))},{}),w={},S=(Object.defineProperty(w,"__esModule",{value:!0}),w.default=function(e,t){return!(!e||!t||4!=(4&t.compareDocumentPosition(e)))},Object.defineProperty(C,"__esModule",{value:!0}),C.splitBalancedNodeRange=void 0,w);function P(e,t){var n;if(!e||!e.parentNode)return null;var r=e.parentNode,o=r.cloneNode(!1);if(o.removeAttribute("id"),t)for(;r.firstChild&&r.firstChild!=e;)o.appendChild(r.firstChild);else for(;e.nextSibling;)o.appendChild(e.nextSibling);return o.firstChild&&""!=o.innerHTML?null===(n=r.parentNode)||void 0===n||n.insertBefore(o,t?r:r.nextSibling):o=null,o}C.default=P,C.splitBalancedNodeRange=function(e){var t,n=Array.isArray(e)?e[0]:e,e=Array.isArray(e)?e[e.length-1]:e,r=n&&e&&n.parentNode==e.parentNode?n.parentNode:null;return r&&((0,S.default)(n,e)&&(t=e,e=n,n=t),P(n,!0),P(e,!1)),r};var T={},O=(Object.defineProperty(T,"__esModule",{value:!0}),T.default=function(e){return[].slice.call(e)},Object.defineProperty(v,"__esModule",{value:!0}),v.collapse=void 0,m),_=C,x=T;function N(e,t,n,r,o){for(;t.parentNode!=e&&!(0,O.default)(t.parentNode,n);){if(r&&t.previousSibling||!r&&t.nextSibling){if(!o)break;(0,_.default)(t,r)}if(!t.parentNode)break;t=t.parentNode}return t}v.default=function(e,t,n,r){var o;return(0,O.default)(e,t)&&(0,O.default)(e,n)?(t=N(e,t,n,!0,r),n=N(e,n,t,!1,r),(0,O.default)(t,n,!0)?[t]:(0,O.default)(n,t)?[n]:t.parentNode==n.parentNode?(e=(r=t.parentNode?(0,x.default)(null===(e=t.parentNode)||void 0===e?void 0:e.childNodes):[]).indexOf(t),o=r.indexOf(n),r.slice(e,o+1)):[t,n]):[]},v.collapse=N;var n={},R=(Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){return e&&1==e.nodeType?e.tagName.toUpperCase():""},{}),L=(Object.defineProperty(R,"__esModule",{value:!0}),n),k="ADDRESS,ARTICLE,ASIDE,BLOCKQUOTE,CANVAS,DD,DIV,DL,DT,FIELDSET,FIGCAPTION,FIGURE,FOOTER,FORM,H1,H2,H3,H4,H5,H6,HEADER,HR,LI,MAIN,NAV,NOSCRIPT,OL,OUTPUT,P,PRE,SECTION,TABLE,TD,TH,TFOOT,UL,VIDEO".split(","),I=["block","list-item","table-cell"],M=(R.default=function(e){var t=(0,L.default)(e);return!(!t||!(0<=I.indexOf(e.style.display)||0<=k.indexOf(t)))},{}),A=(Object.defineProperty(M,"__esModule",{value:!0}),m),D=w;function j(e){this.element=e}j.prototype.collapseToSingleElement=function(){return this.element},j.prototype.getStartNode=function(){return this.element},j.prototype.getEndNode=function(){return this.element},j.prototype.equals=function(e){return this.element==e.getStartNode()},j.prototype.isAfter=function(e){return(0,D.default)(this.element,e.getEndNode())},j.prototype.contains=function(e){return(0,A.default)(this.element,e,!0)},j.prototype.getTextContent=function(){return this.element?this.element.textContent:""},M.default=j;var B={},F={},H={},z=(Object.defineProperty(H,"__esModule",{value:!0}),n),U="AREA,BASE,BR,COL,COMMAND,EMBED,HR,IMG,INPUT,KEYGEN,LINK,META,PARAM,SOURCE,TRACK,WBR".split(","),V=(H.default=function(e){return!!e&&0<=U.indexOf((0,z.default)(e))},{}),W={},q={},K=(Object.defineProperty(q,"__esModule",{value:!0}),y),G=(q.default=function(e,t){return(0,K.default)(e,"HTMLElement")&&(e.matches||e.msMatchesSelector).call(e,t)},Object.defineProperty(W,"__esModule",{value:!0}),m),Z=q,Y=(W.default=function(e,t,n){var r=(e=e?1==e.nodeType?e:e.parentNode:null)&&1==e.nodeType?e:null;if(r&&n)if(r.closest)r=r.closest(n);else for(;r&&r!=t&&!(0,Z.default)(r,n);)r=r.parentElement;return!t||(0,G.default)(t,r)?r:null},Object.defineProperty(V,"__esModule",{value:!0}),W),X=w;function $(e,t,n){switch(void 0===t&&(t=0),this.isFromEndOfRange=n,e.node?(this.node=e.node,t=e.offset):this.node=e,t){case-2:this.offset=Q(this.node),this.node=this.node.parentNode,this.isAtEnd=!1;break;case-3:this.offset=Q(this.node)+1,this.isAtEnd=!this.node.nextSibling,this.node=this.node.parentNode;break;case-1:this.offset=J(this.node),this.isAtEnd=!0;break;default:var r=J(this.node);this.offset=Math.max(0,Math.min(t,r)),this.isAtEnd=0<t&&r<=t}this.element=(0,Y.default)(this.node)}function Q(e){for(var t=0;e=(null==e?void 0:e.previousSibling)||null;)t++;return t}function J(e){var t;return 3==e.nodeType?(null===(t=e.nodeValue)||void 0===t?void 0:t.length)||0:1==e.nodeType?e.childNodes.length:1}$.prototype.normalize=function(){if(3==this.node.nodeType||!this.node.firstChild)return this;for(var e=this.node,t=this.isAtEnd?-1:this.offset;1==e.nodeType||11==e.nodeType;){var n=this.isFromEndOfRange?-1==t?e.lastChild:e.childNodes[t-1]:0==t?e.firstChild:-1==t?e.lastChild:e.childNodes[t];if(!n)break;e=n,t=this.isAtEnd||this.isFromEndOfRange?-1:0}return new $(e,t,this.isFromEndOfRange)},$.prototype.equalTo=function(e){return e&&(this==e||this.node==e.node&&this.offset==e.offset&&this.isAtEnd==e.isAtEnd)},$.prototype.isAfter=function(e){return this.node==e.node?this.isAtEnd&&!e.isAtEnd||this.offset>e.offset:(0,X.default)(this.node,e.node)},$.prototype.move=function(e){return new $(this.node,Math.max(this.offset+e,0))},$.getStart=function(e){return new $(e.startContainer,e.startOffset)},$.getEnd=function(e){return e.collapsed?$.getStart(e):new $(e.endContainer,e.endOffset,!0)},V.default=$,Object.defineProperty(F,"__esModule",{value:!0});var ee=H,te=V,ne=y;function re(e){return 1==e.node.nodeType&&(0,ee.default)(e.node)?new te.default(e.node,e.isAtEnd?-3:-2):e}function oe(e){return e&&e.node}function ie(e,t){if(!e||!t)return null;for(var n=0,r=0;r<t.length&&(n=t[r],r<t.length-1&&e&&1==e.nodeType&&e.childNodes.length>n);r++)e=e.childNodes[n];return new te.default(e,n)}F.default=function(e,t,n,r){var o=null,i=null;return oe(e)?(o=e,i=oe(t)?t:null):(0,ne.default)(e,"Node")&&(Array.isArray(t)?(o=ie(e,t),i=Array.isArray(n)?ie(e,n):null):"number"==typeof t?(o=new te.default(e,t),i=(0,ne.default)(n,"Node")?new te.default(n,r):null):!(0,ne.default)(t,"Node")&&t||(o=new te.default(e,-2),i=new te.default(t||e,-3))),null!==(n=null==o?void 0:o.node)&&void 0!==n&&n.ownerDocument?(r=o.node.ownerDocument.createRange(),o=re(o),i=re(i||o),r.setStart(o.node,o.offset),r.setEnd(i.node,i.offset),r):null};var ae,le,se={},ce={},de={},ue=(Object.defineProperty(de,"__esModule",{value:!0}),de.Browser=de.getBrowserInfo=void 0,/android/i);function fe(e,t){var n=-1!=e.indexOf("rv:")&&-1!=e.indexOf("Trident"),r=-1!=e.indexOf("MSIE")||n,o=!1,i=!1,a=!1,l=!1,s=-1!=e.indexOf("WebKit");return r||(o=-1!=e.indexOf("Chrome"),i=-1!=e.indexOf("Firefox"),-1!=e.indexOf("Safari")&&(a=-1==e.indexOf("Chrome")&&-1==e.indexOf("Android")),(l=-1!=e.indexOf("Edge"))&&(s=o=i=!1)),{isMac:-1!=t.indexOf("Mac"),isWin:-1!=t.indexOf("Win")||-1!=t.indexOf("NT"),isWebKit:s,isIE:r,isIE11OrGreater:n,isSafari:a,isChrome:o,isFirefox:i,isEdge:l,isIEOrEdge:r||l,isAndroid:ue.test(e)}}de.getBrowserInfo=fe,de.Browser=window?fe(window.navigator.userAgent,window.navigator.appVersion):{},ae=ce,Object.defineProperty(ae,"__esModule",{value:!0}),ae.KnownCreateElementData=void 0,le=y,he=de,ae.KnownCreateElementData=((Ae={})[0]={tag:""},Ae[1]=he.Browser.isEdge?{tag:"div",children:[{tag:"span",children:[{tag:"br"}]}]}:{tag:"div",children:[{tag:"br"}]},Ae[2]={tag:"blockquote",style:"margin-top:0;margin-bottom:0"},Ae[3]={tag:"div",style:"width: 1px; height: 1px; overflow: hidden; position: fixed; top: 0; left; 0; -webkit-user-select: text",attributes:{contenteditable:"true"}},Ae[4]={tag:"li",style:"display:block"},Ae[5]={tag:"div",style:"position: fixed; width: 0; height: 0"},Ae[6]={tag:"div",style:"width:100%;height:100%;position:relative;overflow:hidden"},Ae[7]={tag:"div",style:"position: fixed; cursor: row-resize; user-select: none"},Ae[8]={tag:"div",style:"position: fixed; cursor: col-resize; user-select: none"},Ae[9]={tag:"div",style:"position: fixed; cursor: nw-resize; user-select: none; border: 1px solid #808080"},Ae[10]={tag:"div",style:"position: fixed; cursor: ne-resize; user-select: none; border: 1px solid #808080"},Ae[11]={tag:"div",style:"position: fixed; cursor: all-scroll; user-select: none; border: 1px solid #808080"},Ae),ae.default=function t(e,n){if(!(e="number"==typeof e?ae.KnownCreateElementData[e]:e)||!e.tag)return null;var r=e.tag,o=e.namespace,i=e.className,a=e.style,l=e.dataset,s=e.attributes,e=e.children,c=o?n.createElementNS(o,r):n.createElement(r);return a&&c.setAttribute("style",a),i&&(c.className=i),l&&(0,le.default)(c,"HTMLElement")&&Object.keys(l).forEach(function(e){c.dataset[e]=l[e]}),s&&Object.keys(s).forEach(function(e){c.setAttribute(e,s[e])}),e&&e.forEach(function(e){"string"==typeof e?c.appendChild(n.createTextNode(e)):!e||(e=t(e,n))&&c.appendChild(e)}),c};var he={},pe=(Object.defineProperty(he,"__esModule",{value:!0}),T),ge=(he.default=function(e,t){t=t.createElement("DIV");return t.innerHTML=e,(0,pe.default)(t.childNodes)},Object.defineProperty(se,"__esModule",{value:!0}),ce),ve=he,me=y,ye=(se.default=function(e,t){if(0==(e=e?(0,me.default)(e,"Node")?[e]:e:[]).length||!e[0]||!e[0].ownerDocument)return null;(0,me.default)(t=t||"div","HTMLElement")||(n=e[0].ownerDocument,t="string"==typeof t?/^\w+$/.test(t)?n.createElement(t):(0,ve.default)(t,n)[0]:(0,ge.default)(t,n));var n=e[0].parentNode;n&&n.insertBefore(t,e[0]);for(var r=0,o=e;r<o.length;r++){var i=o[r];t.appendChild(i)}return t},Object.defineProperty(B,"__esModule",{value:!0}),v),be=m,Ee=F,Ce=n,we=R,Se=w,Pe=se,Te=C,Oe=["TD","TH","LI","BLOCKQUOTE"];function _e(e,t,n){this.rootNode=e,this.startNode=t,this.endNode=n}_e.getBlockContext=function(e){for(;e&&!(0,we.default)(e);)e=e.parentNode;return e},_e.prototype.collapseToSingleElement=function(){for(var e=(0,ye.default)(_e.getBlockContext(this.startNode),this.startNode,this.endNode,!0),t=_e.getBlockContext(this.startNode);e[0]&&e[0]!=t&&e[0].parentNode!=this.rootNode&&Oe.indexOf((0,Ce.default)(e[0].parentNode))<0;)e=[(0,Te.splitBalancedNodeRange)(e)];return 1==e.length&&(0,we.default)(e[0])?e[0]:(0,Pe.default)(e)},_e.prototype.getStartNode=function(){return this.startNode},_e.prototype.getEndNode=function(){return this.endNode},_e.prototype.equals=function(e){return this.startNode==e.getStartNode()&&this.endNode==e.getEndNode()},_e.prototype.isAfter=function(e){return(0,Se.default)(this.getStartNode(),e.getEndNode())},_e.prototype.contains=function(e){return(0,be.default)(this.startNode,e,!0)||(0,be.default)(this.endNode,e,!0)||(0,Se.default)(e,this.startNode)&&(0,Se.default)(this.endNode,e)},_e.prototype.getTextContent=function(){var e=(0,Ee.default)(this.getStartNode(),this.getEndNode());return e?e.toString():""},B.default=_e,Object.defineProperty(g,"__esModule",{value:!0});var xe=v,Ne=m,Re=n,Le=R,ke=M,Ie=B;function Me(e,t,n){var r=e;if("BR"==(0,Re.default)(r)&&n)return r;for(;r;){for(var o=e;!(o=n?e.nextSibling:e.previousSibling);)if((e=e.parentNode)==t)return r;for(;o;){if((0,Le.default)(o))return r;if("BR"==(0,Re.default)(o))return n?o:r;e=o,o=n?e.firstChild:e.lastChild}r=e}return r}g.default=function(e,t){if(!(0,Ne.default)(e,t))return null;var n=Ie.default.getBlockContext(t);if(n==t)return new ke.default(n);var r=Me(t,n,!1),o=Me(t,n,!0),t=(0,xe.default)(e,r,o,!1),r=t[0],o=t[t.length-1];if(r.parentNode!=o.parentNode)return new Ie.default(e,r,o);for(;!r.previousSibling&&!o.nextSibling;){var i=r.parentNode;if(i==n){n!=e&&(r=o=i);break}if(i==e)break;r=o=i}return r==o&&(0,Le.default)(r)?new ke.default(r):new Ie.default(e,r,o)};var Ae={},De=(Object.defineProperty(Ae,"__esModule",{value:!0}),g),B=(Ae.default=function(e,t){for(var n=e;(n=n&&(t?n.firstChild:n.lastChild))&&n.firstChild;);return n&&(0,De.default)(e,n)},{}),je={},Be={},Fe={},He={},ze={},Ue={},Ve=(Object.defineProperty(Ue,"__esModule",{value:!0}),Ue.default=function(e,t,n){var r=(null===(r=e.nodeValue)||void 0===r?void 0:r.substring(0,t))||"",o=(null===(o=e.nodeValue)||void 0===o?void 0:o.substring(t))||"",t=e.ownerDocument.createTextNode(n?r:o);return e.nodeValue=n?o:r,null===(o=e.parentNode)||void 0===o||o.insertBefore(t,n?e:e.nextSibling),t},{}),We={},qe={},Ke=(Object.defineProperty(qe,"__esModule",{value:!0}),qe.getComputedStyle=void 0,W);function Ge(e,t){void 0===t&&(t=["font-family","font-size","color","background-color"]);var e=(0,Ke.default)(e),n=[];if(t=Array.isArray(t)?t:[t],e){var r=(e.ownerDocument.defaultView||window).getComputedStyle(e);if(r)for(var o=0,i=t;o<i.length;o++){var a=i[o],l=r.getPropertyValue(a)||"",l="font-family"!=a?l.toLowerCase():l;l="font-size"==a?(a=l)&&a.indexOf("px")==a.length-2?Math.round(75*parseFloat(a)+.05)/100+"pt":a:l,n.push(l)}}return n}qe.default=Ge,qe.getComputedStyle=function(e,t){return Ge(e,t)[0]||""},Object.defineProperty(We,"__esModule",{value:!0});var Ze=n,Ye=qe,Xe=/^[\r\n]+$/gm,$e=/[\t\r\n\u0020\u200B]/gm,Qe=(We.default=function e(t,n){if(3==t.nodeType)return!(t.nodeValue&&""!=t.textContent&&!Xe.test(t.nodeValue)&&(!n||""!=t.nodeValue.replace($e,"")));if(1!=t.nodeType)return!0;if("none"==(0,Ye.getComputedStyle)(t,"display"))return!0;var r=(0,Ze.default)(t);if("DIV"!=r&&"SPAN"!=r)return!1;for(var o=t.firstChild;o;o=o.nextSibling)if(!e(o,n))return!1;return!0},Object.defineProperty(Ve,"__esModule",{value:!0}),Ve.getPreviousLeafSibling=Ve.getNextLeafSibling=Ve.getLeafSibling=void 0,m),Je=n,et=We;function tt(e,t,n,r,d){var o=null,i=n?function(e){return(null==e?void 0:e.nextSibling)||null}:function(e){return(null==e?void 0:e.previousSibling)||null},a=n?function(e){return e.firstChild}:function(e){return e.lastChild};if((0,Qe.default)(e,t))for(var l=t,s=!0;s;){for(var c=(null==l?void 0:l.parentNode)||null,l=i(l);!l&&c!=e;)l=i(c),c=(null==c?void 0:c.parentNode)||null;for(;l&&(!r||r.indexOf((0,Je.default)(l))<0)&&a(l);)l=a(l);if(!(s=!!l&&(0,et.default)(l,d))){o=l;break}}return o}Ve.getLeafSibling=tt,Ve.getNextLeafSibling=function(e,t,n){return tt(e,t,!0,n)},Ve.getPreviousLeafSibling=function(e,t,n){return tt(e,t,!1,n)},Object.defineProperty(ze,"__esModule",{value:!0});var nt=n,rt=V,ot=Ue,it=se,at=Ve,lt=C,st="SPAN,B,I,U,EM,STRONG,STRIKE,S,SMALL".split(",");function ct(e,t){e&&1==e.nodeType&&t(e,!0)}ze.default=function(e,t,n,r){void 0===n&&(n=new rt.default(e,0).normalize()),void 0===r&&(r=new rt.default(e,-1).normalize());for(var o,i=[];n&&r&&r.isAfter(n);){var a=n.node,l=(0,nt.default)(a.parentNode),s=(0,at.getNextLeafSibling)(e,a);3==a.nodeType&&["TR","TABLE"].indexOf(l)<0&&(a!=r.node||r.isAtEnd||(a=(0,ot.default)(a,r.offset,!0)),0<n.offset&&(a=(0,ot.default)(a,n.offset,!1)),i.push(a)),n=s&&new rt.default(s,0)}0<i.length&&(i.every(function(e){return e.parentNode==i[0].parentNode})&&(o=i.shift(),i.forEach(function(e){o.nodeValue+=e.nodeValue,e.parentNode.removeChild(e)}),i=[o]),i.forEach(function(e){for(;"SPAN"!=(0,nt.default)(e)&&0<=st.indexOf((0,nt.default)(e.parentNode));)ct(e,t),e=(0,lt.splitBalancedNodeRange)(e);"SPAN"!=(0,nt.default)(e)&&(ct(e,t),e=(0,it.default)(e,"SPAN")),t(e)}))},Object.defineProperty(He,"__esModule",{value:!0});var dt=ze,ut=w,ft=V;function ht(e,t){this.containerNode=e,this.parentBlock=t}ht.prototype.getTextContent=function(){return 3==this.containerNode.nodeType?this.containerNode.nodeValue:this.containerNode.textContent},ht.prototype.getContainerNode=function(){return this.containerNode},ht.prototype.getParentBlock=function(){return this.parentBlock},ht.prototype.getStartPosition=function(){return new ft.default(this.containerNode,0).normalize()},ht.prototype.getEndPosition=function(){return new ft.default(this.containerNode,-1).normalize()},ht.prototype.isTextualInlineElement=function(){return this.containerNode&&3==this.containerNode.nodeType},ht.prototype.isAfter=function(e){return e&&(0,ut.default)(this.containerNode,e.getContainerNode())},ht.prototype.contains=function(e){var t=this.getStartPosition(),n=this.getEndPosition();return e&&e.isAfter(t)&&n.isAfter(e)},ht.prototype.applyStyle=function(e){(0,dt.default)(this.containerNode,e)},He.default=ht;var pt,gt,vt=e&&e.__extends||(pt=function(e,t){return(pt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}pt(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),vt=(Object.defineProperty(Fe,"__esModule",{value:!0}),gt=He.default,vt(mt,gt),mt);function mt(e,t){return gt.call(this,e,t)||this}Fe.default=vt;var yt,bt,vt={},Et=e&&e.__extends||(yt=function(e,t){return(yt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}yt(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),Et=(Object.defineProperty(vt,"__esModule",{value:!0}),bt=He.default,Et(Ct,bt),Ct);function Ct(e,t){return bt.call(this,e,t)||this}vt.default=Et,Object.defineProperty(Be,"__esModule",{value:!0});var wt=g,St=n,Pt=Fe,Tt=vt,Ot=He,_t=y,Et=(Be.default=function(e,t){e=(0,_t.default)(e,"Node")?(0,wt.default)(e,t):e;return t&&e&&function(e,t){for(var n,r=[e],o=e.parentNode;o&&t.contains(o);o=o.parentNode)r.push(o);for(var i=r.length-1;0<=i&&!n;i--){var a=r[i],l=(0,St.default)(a);"A"==l?n=new Tt.default(a,t):"IMG"==l&&(n=new Pt.default(a,t))}return n||new Ot.default(e,t)}(t,e)},{}),xt={},Nt=(Object.defineProperty(xt,"__esModule",{value:!0}),xt.getLastLeafNode=xt.getFirstLeafNode=void 0,We),Rt=Ve;function Lt(e,t){for(var n=function(e){return t?e.firstChild:e.lastChild},r=n(e);r&&n(r);)r=n(r);return r=r&&(0,Nt.default)(r)?(0,Rt.getLeafSibling)(e,r,t):r}xt.getFirstLeafNode=function(e){return Lt(e,!0)},xt.getLastLeafNode=function(e){return Lt(e,!1)},Object.defineProperty(Et,"__esModule",{value:!0}),Et.getLastInlineElement=Et.getFirstInlineElement=void 0;var kt=Be,It=xt,Mt=(Et.getFirstInlineElement=function(e){var t=(0,It.getFirstLeafNode)(e);return t?(0,kt.default)(e,t):null},Et.getLastInlineElement=function(e){var t=(0,It.getLastLeafNode)(e);return t?(0,kt.default)(e,t):null},Object.defineProperty(je,"__esModule",{value:!0}),m),At=g,Dt=Ae,jt=Be,Bt=Et;function Ft(e,t){this.rootNode=e,this.startNode=(0,Mt.default)(e,t)?t:null}Ft.prototype.getStartBlockElement=function(){return this.startNode?(0,At.default)(this.rootNode,this.startNode):(0,Dt.default)(this.rootNode,!0)},Ft.prototype.getStartInlineElement=function(){return this.startNode?(0,jt.default)(this.rootNode,this.startNode):(0,Bt.getFirstInlineElement)(this.rootNode)},Ft.prototype.isBlockInScope=function(e){return(0,Mt.default)(this.rootNode,e.getStartNode())},Ft.prototype.trimInlineElement=function(e){return e},je.default=Ft;var Ht={};function zt(e,t){this.position=e,this.parentBlock=t}Object.defineProperty(Ht,"__esModule",{value:!0}),zt.prototype.getTextContent=function(){return""},zt.prototype.getContainerNode=function(){return this.position.node},zt.prototype.getParentBlock=function(){return this.parentBlock},zt.prototype.getStartPosition=function(){return this.position},zt.prototype.getEndPosition=function(){return this.position},zt.prototype.isAfter=function(e){return e&&this.position.isAfter(e.getEndPosition())},zt.prototype.isTextualInlineElement=function(){return!1},zt.prototype.contains=function(e){return!1},zt.prototype.applyStyle=function(e){},Ht.default=zt;var Ut={},Vt=(Object.defineProperty(Ut,"__esModule",{value:!0}),ze),Wt=F,qt=V,Kt=Ve;function Gt(e,t,n){this.inlineElement=e,this.start=t,this.end=n}Gt.prototype.getDecoratedInline=function(){return this.inlineElement},Gt.prototype.getContainerNode=function(){return this.inlineElement.getContainerNode()},Gt.prototype.getParentBlock=function(){return this.inlineElement.getParentBlock()},Gt.prototype.getTextContent=function(){return(0,Wt.default)(this.getStartPosition(),this.getEndPosition()).toString()},Gt.prototype.getStartPosition=function(){return this.start||this.inlineElement.getStartPosition()},Gt.prototype.getEndPosition=function(){return this.end||this.inlineElement.getEndPosition()},Object.defineProperty(Gt.prototype,"nextInlineElement",{get:function(){return this.end&&new Gt(this.inlineElement,this.end,null)},enumerable:!1,configurable:!0}),Object.defineProperty(Gt.prototype,"previousInlineElement",{get:function(){return this.start&&new Gt(this.inlineElement,null,this.start)},enumerable:!1,configurable:!0}),Gt.prototype.contains=function(e){return e&&e.isAfter(this.getStartPosition())&&this.getEndPosition().isAfter(e)},Gt.prototype.isTextualInlineElement=function(){return this.inlineElement&&this.inlineElement.isTextualInlineElement()},Gt.prototype.isAfter=function(e){var t=this.getStartPosition(),e=e&&e.getEndPosition();return e&&(t.isAfter(e)||t.equalTo(e))},Gt.prototype.applyStyle=function(e){var t,n=this.getStartPosition().normalize(),r=this.getEndPosition().normalize(),o=this.getContainerNode();n.isAtEnd&&(n=(t=(0,Kt.getNextLeafSibling)(o,n.node))?new qt.default(t,0):null),0==r.offset&&(r=(t=(0,Kt.getPreviousLeafSibling)(o,r.node))?new qt.default(t,-1):null),(0,Vt.default)(o,e,n,r)},Ut.default=Gt;var Zt={},Yt={},Xt=(Object.defineProperty(Yt,"__esModule",{value:!0}),Yt.getInlineElementBeforeAfter=Yt.getInlineElementAfter=Yt.getInlineElementBefore=void 0,Be),$t=Ut,Qt=We,Jt=Ve;function en(e,t,n){if(!e||!t||!t.node)return null;var r=(t=t.normalize()).node,o=t.offset,i=t.isAtEnd,a=!1,i=(!n&&0==o&&!i||n&&i?r=(0,Jt.getLeafSibling)(e,r,n):3==r.nodeType&&(!n&&!i||n&&0<o)&&(a=!0),r&&(0,Qt.default)(r)&&(r=(0,Jt.getLeafSibling)(e,r,n)),(0,Xt.default)(e,r));return i=i&&(a||i.contains(t))?n?new $t.default(i,t,null):new $t.default(i,null,t):i}Yt.getInlineElementBefore=function(e,t){return en(e,t,!1)},Yt.getInlineElementAfter=function(e,t){return en(e,t,!0)},Yt.getInlineElementBeforeAfter=en,Object.defineProperty(Zt,"__esModule",{value:!0});var tn=Ht,nn=g,rn=Be,on=M,an=V,ln=y,sn=Yt,cn=Et;function dn(e,t,n){this.rootNode=e,this.startFrom=n,t=(0,ln.default)(t,"Range")?an.default.getStart(t):t,this.position=t.normalize(),this.block=(0,nn.default)(this.rootNode,this.position.node)}dn.prototype.getStartBlockElement=function(){return this.block},dn.prototype.getStartInlineElement=function(){if(this.block)switch(this.startFrom){case 0:case 1:case 2:return e=this.block,t=0==this.startFrom,e instanceof on.default?(n=e.getStartNode(),(t?(0,cn.getFirstInlineElement):(0,cn.getLastInlineElement))(n)):(0,rn.default)(e,t?e.getStartNode():e.getEndNode());case 3:n=(0,sn.getInlineElementAfter)(this.rootNode,this.position);return n&&this.block.contains(n.getContainerNode())?n:new tn.default(this.position,this.block)}var e,t,n;return null},dn.prototype.isBlockInScope=function(e){return!(!this.block||!e)&&this.block.equals(e)},dn.prototype.trimInlineElement=function(e){return this.block&&e&&this.block.contains(e.getContainerNode())?e:null},Zt.default=dn;var M={},un=(Object.defineProperty(M,"__esModule",{value:!0}),g),fn=Ut,hn=V,pn=Yt;function gn(e,t){this.rootNode=e,this.start=hn.default.getStart(t).normalize(),this.end=hn.default.getEnd(t).normalize()}gn.prototype.getStartBlockElement=function(){return this.startBlock||(this.startBlock=(0,un.default)(this.rootNode,this.start.node)),this.startBlock},gn.prototype.getStartInlineElement=function(){return this.startInline||(this.startInline=this.trimInlineElement((0,pn.getInlineElementAfter)(this.rootNode,this.start))),this.startInline},gn.prototype.isBlockInScope=function(e){if(!e)return!1;var t,n=this.getStartBlockElement();return this.start.equalTo(this.end)?n&&n.equals(e):(t=(0,un.default)(this.rootNode,this.end.node),n&&t&&(e.equals(n)||e.equals(t)||e.isAfter(n)&&t.isAfter(e)))},gn.prototype.trimInlineElement=function(e){if(!e||this.start.equalTo(this.end))return null;var t=e.getStartPosition(),n=e.getEndPosition();if(t.isAfter(this.end)||this.start.isAfter(n))return null;var r=!1,o=!1;return this.start.isAfter(t)&&(t=this.start,r=!0),n.isAfter(this.end)&&(n=this.end,o=!0),t.isAfter(n)||t.equalTo(n)?null:r||o?new fn.default(e,r&&t,o&&n):e},M.default=gn,Object.defineProperty(B,"__esModule",{value:!0});var vn=je,mn=Ht,yn=g,bn=Be,En=Ut,Cn=Zt,wn=M,Sn=Yt,Pn=Ve;function Tn(e,t){this.scoper=e,this.skipTags=t}Tn.createBodyTraverser=function(e,t,n){return new Tn(new vn.default(e,t))},Tn.createSelectionTraverser=function(e,t,n){return new Tn(new wn.default(e,t),n)},Tn.createBlockTraverser=function(e,t,n,r){return new Tn(new Cn.default(e,t,n=void 0===n?3:n))},Object.defineProperty(Tn.prototype,"currentBlockElement",{get:function(){return this.currentBlock||(this.currentBlock=this.scoper.getStartBlockElement()),this.currentBlock},enumerable:!1,configurable:!0}),Tn.prototype.getNextBlockElement=function(){return this.getPreviousNextBlockElement(!0)},Tn.prototype.getPreviousBlockElement=function(){return this.getPreviousNextBlockElement(!1)},Tn.prototype.getPreviousNextBlockElement=function(e){var t=this.currentBlockElement;if(!t)return null;var n=(0,Pn.getLeafSibling)(this.scoper.rootNode,e?t.getEndNode():t.getStartNode(),e,this.skipTags),n=n?(0,yn.default)(this.scoper.rootNode,n):null;return n&&this.scoper.isBlockInScope(n)&&(e&&n.isAfter(t)||!e&&t.isAfter(n))?(this.currentBlock=n,this.currentBlock):null},Object.defineProperty(Tn.prototype,"currentInlineElement",{get:function(){return this.currentInline||(this.currentInline=this.scoper.getStartInlineElement()),this.currentInline instanceof mn.default?null:this.currentInline},enumerable:!1,configurable:!0}),Tn.prototype.getNextInlineElement=function(){return this.getPreviousNextInlineElement(!0)},Tn.prototype.getPreviousInlineElement=function(){return this.getPreviousNextInlineElement(!1)},Tn.prototype.getPreviousNextInlineElement=function(e){var t,n=this.currentInlineElement||this.currentInline;return n?(n instanceof mn.default?(t=(0,Sn.getInlineElementBeforeAfter)(this.scoper.rootNode,n.getStartPosition(),e))&&!n.getParentBlock().contains(t.getContainerNode())&&(t=null):t=(t=function(e,t,n){if(!t)return null;if(t instanceof En.default){var r=n?t.nextInlineElement:t.previousInlineElement;if(r)return r}r=t.getContainerNode(),r=(0,Pn.getLeafSibling)(e,r,n);return(0,bn.default)(e,r)}(this.scoper.rootNode,n,e))&&n&&(e&&t.isAfter(n)||!e&&n.isAfter(t))?t:null,(t=t&&this.scoper.trimInlineElement(t))?(this.currentInline=t,this.currentInline):null):null},B.default=Tn;var Et={},On=(Object.defineProperty(Et,"__esModule",{value:!0}),B),_n=F,xn=/[\s\u00A0\u200B\u3000]+([^\s\u00A0\u200B\u3000]*)$/i;function Nn(e,t){this.rootNode=e,this.position=t,this.text="",this.inlineElements=[]}Nn.prototype.getWordBefore=function(){var e=this;return this.word||this.traverse(function(){return e.word}),this.word},Nn.prototype.getInlineElementBefore=function(){return this.inlineBefore||this.traverse(null),this.inlineBefore},Nn.prototype.getInlineElementAfter=function(){return this.inlineAfter||(this.inlineAfter=On.default.createBlockTraverser(this.rootNode,this.position).currentInlineElement),this.inlineAfter},Nn.prototype.getSubStringBefore=function(e){var t=this;return this.text.length<e&&this.traverse(function(){return t.text.length>=e}),this.text.substr(Math.max(0,this.text.length-e))},Nn.prototype.getRangeFromText=function(r,o){if(!r)return null;var i,a,l=r.length-1;return this.forEachTextInlineElement(function(e){for(var t=e.getTextContent()||"",n=t.length-1;0<=n&&0<=l;n--)if(r.charCodeAt(l)==t.charCodeAt(n))l--,a=a||e.getStartPosition().move(n+1);else if(o||a)return!0;return-1==l&&(i=e.getStartPosition().move(n+1),!0)}),i&&a&&(0,_n.default)(i,a)},Nn.prototype.forEachTextInlineElement=function(e){this.inlineElements.some(e)||this.traverse(e)},Nn.prototype.getNearestNonTextInlineElement=function(){var e=this;return this.nearestNonTextInlineElement||this.traverse(function(){return e.nearestNonTextInlineElement}),this.nearestNonTextInlineElement},Nn.prototype.traverse=function(e){if(this.traverser=this.traverser||On.default.createBlockTraverser(this.rootNode,this.position),this.traverser&&!this.traversingComplete)for(var t=this.traverser.getPreviousInlineElement();!this.traversingComplete;){if(this.inlineBefore=this.inlineBefore||t,!t||!t.isTextualInlineElement()){this.nearestNonTextInlineElement=t,this.traversingComplete=!0,this.word||(this.word=this.text);break}var n,r=t.getTextContent();if(this.word||(n=xn.exec(r))&&2==n.length&&(this.word=n[1]+this.text),this.text=r+this.text,this.inlineElements.push(t),e&&e(t))break;t=this.traverser.getPreviousInlineElement()}},Et.default=Nn;je={},Ht={},Zt={};Object.defineProperty(Zt,"__esModule",{value:!0}),Zt.default=function(e,t){var n;e&&((n=new FileReader).onload=function(){t(n.result)},n.onerror=function(){t(null)},n.readAsDataURL(e))};var Rn=e&&e.__assign||function(){return(Rn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Ln=(Object.defineProperty(Ht,"__esModule",{value:!0}),Zt),kn=de,In=/^Version:[0-9\.]+\s+StartHTML:\s*([0-9]+)\s+EndHTML:\s*([0-9]+)\s+/i,Mn=((M={})["text/html"]=function(e,t){return e.rawHtml=kn.Browser.isEdge?(e=t,3==(null==(r=In.exec(e))?void 0:r.length)&&(n=parseInt(r[1]),r=parseInt(r[2]),0<n&&n<r&&(e=e.substring(n,r))),e):t;var n,r},M["text/plain"]=function(e,t){return e.text=t},M["text/*"]=function(e,t,n){return e.customValues[n]=t},M);function An(e,t){try{e.customValues["link-preview"]=t,e.linkPreview=JSON.parse(t)}catch(e){}}Ht.default=function(e,t){var i={types:[],text:"",image:null,rawHtml:null,customValues:{}},a=Rn({},Mn);return null!=t&&t.allowLinkPreview&&(a["text/link-preview"]=An),Promise.all((e||[]).map(function(e){var n,r,o=e.type;return 0!=o.indexOf("image/")||i.image||"file"!=e.kind?(n=function(e,t){e=0==e.indexOf("text/")?e.substr("text/".length):null;return e&&0<=(null==t?void 0:t.indexOf(e))?e:null}(o,null==t?void 0:t.allowedCustomPasteType),r=a[o]||(n?a["text/*"]:null),new Promise(function(t){return r?e.getAsString(function(e){i.types.push(o),r(i,e,n),t()}):t()})):(i.types.push(o),i.image=e.getAsFile(),new Promise(function(t){(0,Ln.default)(i.image,function(e){i.imageDataUri=e,t()})}))})).then(function(){return i})};var Dn,Yt={},jn=(Object.defineProperty(Yt,"__esModule",{value:!0}),Zt),Bn=T,Fn=(Yt.default=function(e,t,n){for(var r,o={types:e.types?(0,Bn.default)(e.types):[],text:e.getData("text"),image:null,rawHtml:null,customValues:{}},i=0;i<(e.files?e.files.length:0);i++){var a=e.files.item(i);if(0==(null===(r=a.type)||void 0===r?void 0:r.indexOf("image/"))){o.image=a;break}}function l(){o.image?(0,jn.default)(o.image,function(e){o.imageDataUri=e,t(o)}):t(o)}var s;null!=n&&n.getTempDiv&&null!=n&&n.removeTempDiv?((s=n.getTempDiv()).contentEditable="true",s.innerHTML="",s.focus(),s.ownerDocument.defaultView.setTimeout(function(){o.rawHtml=s.innerHTML,n.removeTempDiv(s),l()},0)):(o.rawHtml=void 0,l())},Object.defineProperty(je,"__esModule",{value:!0}),Ht),Hn=Yt,zn=T,M=(je.default=function(e,t,n){var r=e.clipboardData||e.target.ownerDocument.defaultView.clipboardData;r.items?(e.preventDefault(),(0,Fn.default)((0,zn.default)(r.items),n).then(t)):(0,Hn.default)(r,t,n)},{}),Un=(Object.defineProperty(M,"__esModule",{value:!0}),M.default=function(e,t){Array.prototype.push.apply(e,t)},{}),Vn={},Wn=(Object.defineProperty(Vn,"__esModule",{value:!0}),Vn.default=function(e,t,n,r){var o="string"==typeof t?t.trim():"",t="string"==typeof t?null:t;(o||t)&&(e.style.setProperty(n?"background-color":"color",(r?null==t?void 0:t.darkModeColor:null==t?void 0:t.lightModeColor)||o),e.dataset)&&(o=n?"ogsb":"ogsc",r?t&&(e.dataset[o]=t.lightModeColor):delete e.dataset[o])},Object.defineProperty(Un,"__esModule",{value:!0}),Vn),qn=(Un.default=function(e,t,n){var r,o,i,a,l,s,c,d,u;t&&(r=e.style,o=t.fontFamily,i=t.fontSize,a=t.textColor,l=t.textColors,s=t.backgroundColor,c=t.backgroundColors,d=t.bold,u=t.italic,t=t.underline,o&&(r.fontFamily=o),i&&(r.fontSize=i),l?(0,Wn.default)(e,l,!1,n):a&&(0,Wn.default)(e,a,!1,n),c?(0,Wn.default)(e,c,!0,n):s&&(0,Wn.default)(e,s,!0,n),d&&(r.fontWeight="bold"),u&&(r.fontStyle="italic"),t&&(r.textDecoration="underline"))},{}),Kn={},Gn=(Object.defineProperty(Kn,"__esModule",{value:!0}),Kn.default=function(e,t,n){if(e){for(;!n&&e.firstChild;)e.removeChild(e.firstChild);for(;null!=t&&t.firstChild;)e.appendChild(t.firstChild)}},Object.defineProperty(qn,"__esModule",{value:!0}),qe),Zn=n,Yn=Kn,Xn=(qn.default=function(e,t){if(!e||!t)return null;var n=(0,Zn.default)(e);if(n==t.toUpperCase())return e;for(var r=e.ownerDocument.createElement(t),o=0;o<e.attributes.length;o++){var i=e.attributes[o];r.setAttribute(i.name,i.value)}return(0,Yn.default)(r,e),"P"!=n&&"P"!=(0,Zn.default)(r)||(t=(0,Gn.default)(e,["margin-top","margin-bottom"]),r.style.marginTop=t[0],r.style.marginBottom=t[1]),e.parentNode&&e.parentNode.replaceChild(r,e),r},{}),$n=(Dn=Xn,Object.defineProperty(Dn,"__esModule",{value:!0}),Dn.PendableFormatCommandMap=void 0,Dn.PendableFormatCommandMap={isBold:"bold",isItalic:"italic",isUnderline:"underline",isStrikeThrough:"strikeThrough",isSubscript:"subscript",isSuperscript:"superscript"},Dn.default=function(n){return Object.keys(Dn.PendableFormatCommandMap).reduce(function(e,t){return e[t]=n.queryCommandState(Dn.PendableFormatCommandMap[t]),e},{})},{}),Qn=(Object.defineProperty($n,"__esModule",{value:!0}),n),Jn=["IMG"],er=["TABLE","IMG","LI"].join(","),tr=/\u200b/g;function nr(e,t){return e=e.replace(tr,""),t?e.trim():e}$n.default=function(e,t){if(!e)return!1;if(3==e.nodeType)return""==nr(e.nodeValue||"",t);if(1==e.nodeType)if(""!=nr(e.textContent||"",t)||0<=Jn.indexOf((0,Qn.default)(e))||e.querySelectorAll(er)[0])return!1;return!0};var rr={},or=(Object.defineProperty(rr,"__esModule",{value:!0}),/^[^?]+%[^0-9a-f]+|^[^?]+%[0-9a-f][^0-9a-f]+|^[^?]+%00|^[^?]+%$|^https?:\/\/[^?\/]+@|^www\.[^?\/]+@/i),ir="(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)*[a-z0-9](?:[a-z0-9-]*[a-z0-9])?(?:\\:[0-9]+)?(?:[\\/\\?]\\S*)?",ar={http:{match:new RegExp("^(?:microsoft-edge:)?http:\\/\\/"+ir+"|www\\."+ir,"i"),except:or,normalizeUrl:function(e){return new RegExp("^(?:microsoft-edge:)?http:\\/\\/","i").test(e)?e:"http://"+e}},https:{match:new RegExp("^(?:microsoft-edge:)?https:\\/\\/"+ir,"i"),except:or},mailto:{match:new RegExp("^mailto:\\S+@\\S+\\.\\S+","i")},notes:{match:new RegExp("^notes:\\/\\/\\S+","i")},file:{match:new RegExp("^file:\\/\\/\\/?\\S+","i")},unc:{match:new RegExp("^\\\\\\\\\\S+","i")},ftp:{match:new RegExp("^ftp:\\/\\/"+ir+"|ftp\\."+ir,"i"),normalizeUrl:function(e){return new RegExp("^ftp:\\/\\/","i").test(e)?e:"ftp://"+e}},news:{match:new RegExp("^news:(\\/\\/)?"+ir,"i")},telnet:{match:new RegExp("^telnet:(\\/\\/)?"+ir,"i")},gopher:{match:new RegExp("^gopher:\\/\\/"+ir,"i")},wais:{match:new RegExp("^wais:(\\/\\/)?"+ir,"i")}},or=(rr.default=function(e){if(e)for(var t=0,n=Object.keys(ar);t<n.length;t++){var r=n[t],o=ar[r],i=e.match(o.match);if(i&&i[0]==e&&(!o.except||!o.except.test(e)))return{scheme:r,originalUrl:e,normalizedUrl:o.normalizeUrl?o.normalizeUrl(e):e}}return null},{}),lr=(Object.defineProperty(or,"__esModule",{value:!0}),T);function sr(t,e){return e.some(function(e){return 0==e?0==t:(t&e)==e})}or.default=function(e,t,n,o,r){if(void 0===o&&(o=0),!e||!t)return[];var i,a,e=(0,lr.default)(e.querySelectorAll(t));return 0!=o&&r&&(a=r.startContainer,t=r.startOffset,i=r.endContainer,r=r.endOffset,1==a.nodeType&&a.firstChild&&(a=a.childNodes[t]||a.lastChild),i=1==i.nodeType&&i.firstChild&&0<r?i.childNodes[r-1]:i,e=e.filter(function(e){var t=a,n=i,r=2==o;return t=e.compareDocumentPosition(t),e=e.compareDocumentPosition(n),n=[0,8],r||n.push(16),sr(t,n)||sr(e,n)||sr(t,[2])&&sr(e,[4])&&!sr(e,[16])})),n&&e.forEach(n),e};var ir={},cr=(Object.defineProperty(ir,"__esModule",{value:!0}),ir.default=function(e){var t=e?e.parentNode:null;if(!t)return null;for(;e.firstChild;)t.insertBefore(e.firstChild,e);return t.removeChild(e),t},{}),dr=(Object.defineProperty(cr,"__esModule",{value:!0}),cr.default=function(e){var e=e||{left:0,right:0,top:0,bottom:0},t=e.left,n=e.right,r=e.top,e=e.bottom;return 0<t+n+r+e?{left:Math.round(t),right:Math.round(n),top:Math.round(r),bottom:Math.round(e)}:null},{}),ur=(Object.defineProperty(dr,"__esModule",{value:!0}),y),fr=(dr.default=function(e){return(0,ur.default)(e,"HTMLElement")?e.innerHTML:e?((t=e.ownerDocument.createElement("span")).appendChild(e.cloneNode(!0)),t.innerHTML):"";var t},{}),hr={},pr=(Object.defineProperty(hr,"__esModule",{value:!0}),qn),p="transparent";function gr(e){return e.td&&e.td.dataset.cellShade}function vr(e){return"solid 1px "+(e||"transparent")}hr.default=function(e,t,n){var r,o,i,a,l,s,c,d,u,f;function h(e){return e%2==0?i.bgColorEven:i.bgColorOdd}n&&(e.style.borderCollapse="collapse",f=n,(u=t).forEach(function(s,c){s.forEach(function(e,t){if(e.td){var n=f,r=e.td,o=0===c,i=c===u.length-1,a=0===t,l=t===s.length-1;switch(e=n,(t=r).style.borderTop=vr(e.topBorderColor),t.style.borderLeft=vr(e.verticalBorderColor),t.style.borderRight=vr(e.verticalBorderColor),t.style.borderBottom=vr(e.bottomBorderColor),n.tableBorderFormat){case 0:return;case 1:a||(r.style.borderLeftColor=p),l||(r.style.borderRightColor=p);break;case 4:o||(r.style.borderTopColor=p),i||o||(r.style.borderBottomColor=p),a||(r.style.borderLeftColor=p),l||a||(r.style.borderRightColor=p),a&&o&&(r.style.borderRightColor=p);break;case 2:o&&(r.style.borderTopColor=p,r.style.borderRightColor=p,r.style.borderLeftColor=p),a&&(r.style.borderLeftColor=p),l&&(r.style.borderRightColor=p);break;case 3:a&&(r.style.borderLeftColor=p),l&&(r.style.borderRightColor=p);break;case 5:o&&(r.style.borderRightColor=p,r.style.borderLeftColor=p),a&&(r.style.borderBottomColor=p,r.style.borderTopColor=p),o&&a&&(r.style.borderLeftColor=n.verticalBorderColor||p,r.style.borderBottomColor=n.bottomBorderColor||p,r.style.borderTopColor=n.topBorderColor||p);break;case 6:o&&(r.style.borderRightColor=p,r.style.borderLeftColor=p),a&&(r.style.borderBottomColor=p,r.style.borderTopColor=p),o&&a&&(r.style.borderLeftColor=n.verticalBorderColor||p,r.style.borderBottomColor=n.bottomBorderColor||p,r.style.borderTopColor=n.topBorderColor||p),o||a||(r.style.borderLeftColor=p,r.style.borderBottomColor=p,r.style.borderTopColor=p,r.style.borderRightColor=p);break;case 7:o&&(r.style.borderLeftColor=p,r.style.borderTopColor=p,r.style.borderRightColor=p),a&&(r.style.borderLeftColor=p,r.style.borderTopColor=p,r.style.borderBottomColor=p),o||a||(r.style.borderLeftColor=p,r.style.borderBottomColor=p,r.style.borderTopColor=p,r.style.borderRightColor=p),o&&a&&(r.style.borderBottomColor=n.bottomBorderColor||p)}}else;})}),e=t,a=(i=n).hasBandedRows,l=i.hasBandedColumns,s=i.bgColorOdd,c=i.bgColorEven,d=!a&&s===c,e.forEach(function(e,n){e.forEach(function(e){var t;e.td&&!gr(e)&&(a?(t=h(n),e.td.style.backgroundColor=t||p):e.td.style.backgroundColor=d&&i.bgColorOdd||p)})}),l&&e.forEach(function(e){e.forEach(function(e,t){t=h(t);e.td&&t&&!gr(e)&&(e.td.style.backgroundColor=t)})}),o=t,n.hasFirstColumn?o.forEach(function(e,n){e.forEach(function(e,t){e.td&&0===t&&(0!==n&&(e.td.style.borderTopColor=p,e.td.style.backgroundColor=p),n!==o.length-1&&0!==n&&(e.td.style.borderBottomColor=p),e.td=(0,pr.default)(e.td,"TH"),e.td.scope="col")})}):o.forEach(function(e){e.forEach(function(e,t){e.td&&0===t&&(e.td=(0,pr.default)(e.td,"TD"),e.td.scope="")})}),s=t,(r=n).hasHeaderRow?s[0].forEach(function(e){e.td&&r.headerRowColor&&(e.td.style.backgroundColor=r.headerRowColor,e.td.style.borderRightColor=r.headerRowColor,e.td.style.borderLeftColor=r.headerRowColor,e.td.style.borderTopColor=r.headerRowColor,e.td=(0,pr.default)(e.td,"TH"),e.td.scope="row")}):s[0].forEach(function(e){e.td&&(e.td=(0,pr.default)(e.td,"TD"),e.td.scope="")}))};var r={},mr=(Object.defineProperty(r,"__esModule",{value:!0}),r.saveTableInfo=r.getTableFormatInfo=void 0,r.getTableFormatInfo=function(e){e=function(e){if(!e)return null;try{return JSON.parse(e)}catch(e){return null}}(null==e?void 0:e.dataset.roosterTableInfo);return function(e){var t,n,r,o,i,a,l,s,c;if(e)return t=e.topBorderColor,n=e.verticalBorderColor,r=e.bottomBorderColor,o=e.bgColorOdd,i=e.bgColorEven,c=e.hasBandedColumns,a=e.hasBandedRows,l=e.hasFirstColumn,s=e.hasHeaderRow,e=e.tableBorderFormat,c=[c,a,l,s],![t,n,r,o,i].some(function(e){return!(null==e||"string"==typeof e)})&&!c.some(function(e){return!("boolean"==typeof e)})&&-1<e&&e<8?1:void 0}(e)?e:null},r.saveTableInfo=function(e,t){e&&t&&(e.dataset.roosterTableInfo=JSON.stringify(t))},e&&e.__assign||function(){return(mr=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)}),yr=(Object.defineProperty(fr,"__esModule",{value:!0}),hr),br=Kn,Er=cr,Cr=y,wr=T,Sr=r,Pr={topBorderColor:"#ABABAB",bottomBorderColor:"#ABABAB",verticalBorderColor:"#ABABAB",hasHeaderRow:!1,hasFirstColumn:!1,hasBandedRows:!1,hasBandedColumns:!1,bgColorEven:null,bgColorOdd:"#ABABAB20",headerRowColor:"#ABABAB",tableBorderFormat:0};function Tr(t,e,n){var c,r,d=this;this.trs=[],this.table=(0,Cr.default)(t,"HTMLTableElement")?t:function(){for(var e=t;e&&"TABLE"!=e.tagName;e=e.parentElement);return e}(),this.table&&(c=(0,Cr.default)(t,"HTMLTableElement")?null:t,r=(0,wr.default)(this.table.rows),this.cells=r.map(function(e){return[]}),r.forEach(function(e,t){d.trs[t%2]=e;for(var n=0,r=0;n<e.cells.length;n++){for(;d.cells[t][r];r++);var o=e.cells[n];o==c&&(d.col=r,d.row=t);for(var i=0;i<o.colSpan;i++,r++)for(var a=0;a<o.rowSpan;a++){var l=i+a==0,s=o.getBoundingClientRect();d.cells[t+a][r]={td:l?o:null,spanLeft:0<i,spanAbove:0<a,width:l?s.width:void 0,height:l?s.height:void 0}}}}),this.formatInfo=(0,Sr.getTableFormatInfo)(this.table),e&&this.normalizeSize(n))}function Or(e,t,n){e&&(e.removeAttribute("width"),e.removeAttribute("height"),e.style.boxSizing="border-box",e.style.width=t+"px",e.style.height=n+"px")}function _r(e){return{td:xr(e.td),spanAbove:e.spanAbove,spanLeft:e.spanLeft}}function xr(e){var t=e?e.cloneNode(!1):null;return(0,Cr.default)(t,"HTMLTableCellElement")&&(t.removeAttribute("id"),t.firstChild||t.appendChild(e.ownerDocument.createElement("br"))),t}Tr.prototype.writeBack=function(){var o=this;this.cells?((0,br.default)(this.table),this.cells.forEach(function(e,n){var r=xr(o.trs[n%2]||o.trs[0]);o.table.appendChild(r),e.forEach(function(e,t){e.td&&(o.recalculateSpans(n,t),r.appendChild(e.td))})}),this.formatInfo&&((0,Sr.saveTableInfo)(this.table,this.formatInfo),(0,yr.default)(this.table,this.cells,this.formatInfo))):this.table&&this.table.parentNode.removeChild(this.table)},Tr.prototype.applyFormat=function(e){this.table&&(this.formatInfo=mr(mr(mr({},Pr),this.formatInfo||{}),e||{}),this.deleteCellShadeDataset(this.cells))},Tr.prototype.deleteCellShadeDataset=function(e){e.forEach(function(e){e.forEach(function(e){e.td&&e.td.dataset.cellShade&&delete e.td.dataset.cellShade})})},Tr.prototype.edit=function(e){var i=this;if(this.table){var d,n=this.cells[this.row],t=n[this.col],r=t.td.style;switch(e){case 0:this.cells.splice(this.row,0,n.map(_r));break;case 1:var u=this.row+this.countSpanAbove(this.row,this.col);this.cells.splice(u,0,this.cells[u-1].map(function(e,t){var n=i.getCell(u,t);return n.spanAbove?_r(n):e.spanLeft?((n=_r(e)).spanAbove=!1,n):{td:xr(i.getTd(i.row,t))}}));break;case 2:this.forEachCellOfCurrentColumn(function(e,t){t.splice(i.col,0,_r(e))});break;case 3:var f=this.col+this.countSpanLeft(this.row,this.col);this.forEachCellOfColumn(f-1,function(e,t,n){var r,o=i.getCell(n,f);o.spanLeft?r=_r(o):e.spanAbove?(r=_r(e)).spanLeft=!1:r={td:xr(i.getTd(n,i.col))},t.splice(f,0,r)});break;case 6:this.forEachCellOfCurrentRow(function(e,t){t=i.getCell(i.row+1,t);e.td&&1<e.td.rowSpan&&t.spanAbove&&(t.td=e.td)}),this.cells.splice(this.row,1);break;case 5:this.forEachCellOfCurrentColumn(function(e,t,n){n=i.getCell(n,i.col+1);e.td&&1<e.td.colSpan&&n.spanLeft&&(n.td=e.td),t.splice(i.col,1)});break;case 7:case 8:for(var h=7==e?-1:1,o=this.row+h;0<=o&&o<this.cells.length;o+=h)if((l=this.getCell(o,this.col)).td&&!l.spanAbove){var p=o<this.row?l:t,a=o<this.row?t:l;p.td.colSpan==a.td.colSpan&&((0,br.default)(p.td,a.td,!0),a.td=null,a.spanAbove=!0);break}break;case 9:case 10:for(var l,g=9==e?-1:1,s=this.col+g;0<=s&&s<this.cells[this.row].length;s+=g)if((l=this.getCell(this.row,s)).td&&!l.spanLeft){var v=s<this.col?l:t,c=s<this.col?t:l;v.td.rowSpan==c.td.rowSpan&&((0,br.default)(v.td,c.td,!0),c.td=null,c.spanLeft=!0);break}break;case 4:this.cells=null;break;case 12:1<t.td.rowSpan?this.getCell(this.row+1,this.col).td=xr(t.td):(d=n.map(function(e){return{td:e==t?xr(e.td):null,spanAbove:e!=t,spanLeft:e.spanLeft}}),this.cells.splice(this.row+1,0,d));break;case 11:1<t.td.colSpan?this.getCell(this.row,this.col+1).td=xr(t.td):this.forEachCellOfCurrentColumn(function(e,t){t.splice(i.col+1,0,{td:t==n?xr(e.td):null,spanAbove:e.spanAbove,spanLeft:t!=n})});break;case 13:this.table.style.marginLeft="auto",this.table.style.marginRight="auto";break;case 14:this.table.style.marginLeft="",this.table.style.marginRight="auto";break;case 15:this.table.style.marginLeft="auto",this.table.style.marginRight="";break;case 17:r.textAlign="center";break;case 16:r.textAlign="left";break;case 18:r.textAlign="right";break;case 19:r.verticalAlign="top";break;case 20:r.verticalAlign="middle";break;case 21:r.verticalAlign="bottom"}}},Tr.prototype.forEachCellOfCurrentColumn=function(e){this.forEachCellOfColumn(this.col,e)},Tr.prototype.getCellsWithBorder=function(e,t){for(var n=[],r=0;r<this.cells.length;r++)for(var o=0;o<this.cells[r].length;o++){var i=this.getCell(r,o);if(i.td){var a=(0,Er.default)(i.td.getBoundingClientRect());if(a){var l=!1;if(t){if(a.right==e)l=!0,n.push(i.td);else if(l)break}else if(a.left==e)l=!0,n.push(i.td);else if(l)break}}}return n},Tr.prototype.forEachCellOfCurrentRow=function(e){this.forEachCellOfRow(this.row,e)},Tr.prototype.getCell=function(e,t){return this.cells&&this.cells[e]&&this.cells[e][t]||{}},Tr.prototype.getCurrentTd=function(){return this.getTd(this.row,this.col)},Tr.prototype.getTd=function(e,t){if(this.cells&&(e=Math.min(this.cells.length-1,e),t=this.cells[e]?Math.min(this.cells[e].length-1,t):t,!isNaN(e)&&!isNaN(t)))for(;0<=e&&0<=t;){var n=this.getCell(e,t);if(n.td)return n.td;if(n.spanLeft)t--;else{if(!n.spanAbove)break;e--}}return null},Tr.prototype.forEachCellOfColumn=function(e,t){for(var n=0;n<this.cells.length;n++)t(this.getCell(n,e),this.cells[n],n)},Tr.prototype.forEachCellOfRow=function(e,t){for(var n=0;n<this.cells[e].length;n++)t(this.getCell(e,n),n)},Tr.prototype.recalculateSpans=function(e,t){var n=this.getCell(e,t).td;n&&(n.colSpan=this.countSpanLeft(e,t),n.rowSpan=this.countSpanAbove(e,t),1==n.colSpan&&n.removeAttribute("colSpan"),1==n.rowSpan&&n.removeAttribute("rowSpan"))},Tr.prototype.countSpanLeft=function(e,t){for(var n=1,r=t+1;r<this.cells[e].length;r++){var o=this.getCell(e,r);if(o.td||!o.spanLeft)break;n++}return n},Tr.prototype.countSpanAbove=function(e,t){for(var n=1,r=e+1;r<this.cells.length;r++){var o=this.getCell(r,t);if(o.td||!o.spanAbove)break;n++}return n},Tr.prototype.normalizeEmptyTableCells=function(){for(var e,t=0;e=this.table.rows[t];t++)for(var n=0,r=void 0;r=e.cells[n];n++)r&&(r.innerHTML&&r.innerHTML.trim()||r.appendChild(document.createElement("br")))},Tr.prototype.normalizeTableCellSize=function(e){for(var t=0,n=void 0;n=this.table.rows[t];t++)n.removeAttribute("width"),n.style.width=null,n.removeAttribute("height"),n.style.height=null;for(t=0;t<this.cells.length;t++)for(var r=0;r<this.cells[t].length;r++){var o=this.cells[t][r];o&&Or(o.td,(null==e?void 0:e(o.width))||o.width,(null==e?void 0:e(o.height))||o.height)}},Tr.prototype.normalizeSize=function(e){this.normalizeEmptyTableCells(),this.normalizeTableCellSize(e);var t=this.table.getBoundingClientRect();Or(this.table,(null==e?void 0:e(t.width))||t.width,(null==e?void 0:e(t.height))||t.height)},fr.default=Tr;var hr={},r={},Nr=(Object.defineProperty(r,"__esModule",{value:!0}),r.isListElement=void 0,n);function Rr(e){switch((0,Nr.default)(e)){case"OL":return 1;case"UL":return 2;default:return 0}}r.default=Rr,r.isListElement=function(e){return 0!=Rr(e)};var Lr={},kr={},Ir={},o=(Object.defineProperty(Ir,"__esModule",{value:!0}),Ir.default=function(e){var r={};return((null==e?void 0:e.getAttribute("style"))||"").split(";").forEach(function(e){var t=e.indexOf(":"),n=e.slice(0,t),e=e.slice(t+1);n&&e&&(r[n.trim()]=e.trim())}),r},{}),Mr=(Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(e,n){var t;e&&((t=Object.keys(n||{}).map(function(e){var t=n[e],e=e?e.trim():null,t=t?t.trim():null;return e&&t?e+":"+t:null}).filter(function(e){return e}).join(";"))?e.setAttribute("style",t):e.removeAttribute("style"))},Object.defineProperty(kr,"__esModule",{value:!0}),B),Ar=W,Dr=Ir,jr=y,Br=o,Fr=(kr.default=function(i,e){var n=function(){for(var e,t=[],n=Mr.default.createBodyTraverser(i);n.currentInlineElement!=e;){var r,o=(e=n.currentInlineElement).getContainerNode(),o=(0,Ar.default)(o);(0,jr.default)(o,"HTMLElement")&&(r=(0,Dr.default)(o))&&t.push(r),n.getNextInlineElement()}return t}(),r=(0,Dr.default)(i);e.forEach(function(t){var e=n.map(function(e){return void 0!==e[t]?e[t]:""});e&&(1==e.length||1==new Set(e).size)&&e[0]&&(r[t]=e[0])}),(0,Br.default)(i,r)},e&&e.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||((r=r||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}),Hr=(Object.defineProperty(Lr,"__esModule",{value:!0}),m),zr=r,Ur=n,Vr=R,Wr=Kn,qr=y,Kr=kr,Gr=T,Zr=ir,Yr=se,Xr=[null,"lower-alpha","lower-roman"];function $r(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(this.newListStart=void 0,!e)throw new Error("node must not be null");this.node=(0,qr.default)(e,"HTMLLIElement")?e:(0,Yr.default)(e,4);e=this.node.style.display;this.dummy="list-item"!=e&&""!=e,this.listTypes=Fr([0],t,!0)}function Qr(e,t,n){return e=!(0<e.length)||t&&(0,Vr.default)(e[0])||n&&(0,Vr.default)(e[e.length])?e:[(0,Yr.default)(e)]}$r.prototype.getListType=function(){return this.listTypes[this.listTypes.length-1]},$r.prototype.getLevel=function(){return this.listTypes.length-1},$r.prototype.getNode=function(){return this.node},$r.prototype.getNewListStart=function(){return this.newListStart},$r.prototype.contains=function(e){return(0,Hr.default)(this.node,e,!0)},$r.prototype.isDummy=function(){return this.dummy},$r.prototype.isOrphanItem=function(){return!1},$r.prototype.canMerge=function(n){return!(null==n||!n.isOrphanItem()||this.listTypes.length!=n.listTypes.length)&&this.listTypes.every(function(e,t){return n.listTypes[t]==e})},$r.prototype.mergeItems=function(e){var t=this;Qr((null==e?void 0:e.map(function(e){return e.node}))||[],!0,!1).forEach(function(e){return t.node.appendChild(e)})},$r.prototype.indent=function(){var e=this.getListType();0!=e&&this.listTypes.push(e)},$r.prototype.outdent=function(){1<this.listTypes.length&&this.listTypes.pop()},$r.prototype.changeListType=function(e){0==e?this.listTypes=[e]:(this.outdent(),this.listTypes.push(e))},$r.prototype.setIsDummy=function(e){this.dummy=e},$r.prototype.setNewListStart=function(e){this.newListStart=e},$r.prototype.writeBack=function(e,d){for(var t,n,r,o,i,a,l,s=1;s<e.length;s++)if((0,zr.default)(e[s])!==this.listTypes[s]){e.splice(s);break}for(;s<this.listTypes.length;s++){c=e[0],r=this.listTypes[s],o=s,i=d,l=a=void 0,l=c.ownerDocument,1==o&&i&&r==(0,zr.default)(i)?(0,Hr.default)(c,i)?(a=i.cloneNode(!1)).removeAttribute("id"):((0,Wr.default)(i),a=i):a=l.createElement(1==r?"ol":"ul"),1==r&&1<o&&(a.style.listStyleType=Xr[(o-1)%Xr.length]);var c=a;e[e.length-1].appendChild(c),e.push(c)}e[e.length-1].appendChild(this.node),this.node.style.display=this.dummy?"block":null,1<this.listTypes.length&&!(this.node.style.fontSize||this.node.style.color||this.node.style.fontFamily)&&(0,Kr.default)(this.node,["font-size","font-family","color"]),this.listTypes.length<=1&&Qr("LI"==(0,Ur.default)(this.node)?(t=this.node,n=(0,Gr.default)(t.childNodes),(0,Zr.default)(t),n):[this.node],!0,!0)},Lr.default=$r;var Jr=e&&e.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||((r=r||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},eo=(Object.defineProperty(hr,"__esModule",{value:!0}),qn),to=r,no=n,ro=R,oo=$n,io=V,ao=or,lo=y,so=C,co=T,uo=ir,fo=Lr,ho=se;function po(e){if(this.rootList=e,this.items=[],!e)throw new Error("rootList must not be null");go(this.rootList),(0,ao.default)(this.rootList,"ol,ul",go),(0,ao.default)(this.rootList,"li",vo),this.populateItems(this.rootList)}function go(e){var t=null;(0,co.default)(e.childNodes).forEach(function(e){"LI"==(0,no.default)(e)?t=e:(0,to.isListElement)(e)?t=null:t&&!(0,oo.default)(e,!0)&&t.appendChild((0,ro.default)(e)?e:(0,ho.default)(e))})}function vo(t){for(;!(0,to.isListElement)(t.parentNode);){(0,so.default)(t,!0);var e=(0,co.default)(t.parentNode.childNodes).slice(1);0<e.length&&(e=(0,ro.default)(e[0])?e:[(0,ho.default)(e)]).forEach(function(e){return t.appendChild(e)}),(0,uo.default)(t.parentNode)}}function mo(e){return(0,lo.default)(e,"HTMLOListElement")?e.start:void 0}po.prototype.contains=function(t){return this.items.some(function(e){return e.contains(t)})},po.prototype.getLastItemNumber=function(){var e=mo(this.rootList);return void 0===e?e:e-1+this.items.filter(function(e){return 1==e.getListType()&&1==e.getLevel()&&!e.isDummy()}).length},po.prototype.writeBack=function(){var n=this;if(!this.rootList)throw new Error("rootList must not be null");var r,e=this.rootList.ownerDocument,o=[e.createDocumentFragment()],e=e.createTextNode(""),i=mo(this.rootList)||1;this.rootList.parentNode.replaceChild(e,this.rootList),this.items.forEach(function(e){e.getNewListStart()&&e.getNewListStart()!=i&&(o.splice(1,o.length-1),i=e.getNewListStart()),e.writeBack(o,n.rootList);var t=o[1];(0,lo.default)(t,"HTMLOListElement")&&(r!=t&&(1==i?t.removeAttribute("start"):t.start=i),1==e.getLevel()&&i++),r=t}),e.parentNode.replaceChild(o[0],e),this.rootList=null},po.prototype.split=function(e,t){if(!this.rootList)throw new Error("rootList must not be null");for(var n=0;n<this.items.length;n++)if(this.items[n].getNode()==e)return void this.items[n].setNewListStart(t)},po.prototype.setIndentation=function(e,t,n,r){this.findListItems(e,t,function(e){return 1==n?r&&!e.isDummy()?e.setIsDummy(!0):e.outdent():e.indent()})},po.prototype.changeListType=function(e,t,n){var r=!1;this.findListItems(e,t,function(e){r=r||e.getListType()!=n}),this.findListItems(e,t,function(e){return r?e.changeListType(n):e.outdent()})},po.prototype.appendItem=function(e,t){var n=(0,no.default)(e);"DIV"==n?e=(0,eo.default)(e,"LI"):"LI"!=n&&(e=(0,ho.default)(e,"LI")),this.items.push(0==t?new fo.default(e):new fo.default(e,t))},po.prototype.mergeVList=function(e){var t,n=this;e&&e!=this&&(e.items.forEach(function(e){return n.items.push(e)}),e.items.splice(0,e.items.length),null===(t=e.rootList.parentNode)||void 0===t||t.removeChild(e.rootList))},po.prototype.findListItems=function(n,r,e){if(0==this.items.length)return[];var t=new io.default(this.items[0].getNode(),0),o=new io.default(this.items[this.items.length-1].getNode(),-1),i=t.isAfter(n)?0:-1,a=this.items.length-(r.isAfter(o)?1:0),t=(this.items.forEach(function(e,t){i=e.contains(n.node)?t:i,a=e.contains(r.node)?t:a}),i=a<this.items.length?Math.max(0,i):i,a=0<=i?Math.min(this.items.length-1,a):a,i<=a?this.items.slice(i,a+1):[]);return e&&t.forEach(e),t},po.prototype.populateItems=function(e,n){var r=this,o=(void 0===n&&(n=[]),(0,to.default)(e));(0,co.default)(e.childNodes).forEach(function(e){var t=Jr(Jr([],n,!0),[o],!1);(0,to.isListElement)(e)?r.populateItems(e,t):3==e.nodeType&&""==e.nodeValue.trim()||r.items.push(new(fo.default.bind.apply(fo.default,Jr([void 0,e],t,!1))))})},hr.default=po;var yo={},bo={},Eo=(Object.defineProperty(bo,"__esModule",{value:!0}),W),Co=(bo.default=function(e,t,n){var r=e&&(0,Eo.default)(n,e.rootNode,t);if(r)for(var o;o=(0,Eo.default)(r.parentNode,e.rootNode,t);)r=o;return r},{}),wo={},So=(Object.defineProperty(wo,"__esModule",{value:!0}),F),Po=V,To=Ve,Oo=(wo.default=function(e){if(!e)return null;var t=e.nodeBefore,n=e.nodeAfter,r=e.rootNode,o=e.skipTags,t=t?(0,To.getNextLeafSibling)(e.rootNode,t,e.skipTags):r.firstChild,n=n?(0,To.getPreviousLeafSibling)(r,n,o):r.lastChild,o=t&&n&&(0,So.default)(t,n);if(!e.fullSelectionEnd||!e.fullSelectionStart)return o;if(o){r=Po.default.getStart(o).normalize(),t=Po.default.getEnd(o).normalize(),n=e.fullSelectionEnd,o=e.fullSelectionStart;if(o.isAfter(t)||r.isAfter(n))return null;e=o.isAfter(r)?o:r,o=n.isAfter(t)?t:n;return(0,So.default)(e,o)}},Object.defineProperty(Co,"__esModule",{value:!0}),B),_o=ce,xo=g,No=wo,Ro=We,Lo=(Co.default=function(e,t){var n=(0,No.default)(e),r=[];if(n){for(var o=e.rootNode,i=e.skipTags,a=Oo.default.createSelectionTraverser(o,n,i),l=null==a?void 0:a.currentBlockElement;l;l=a.getNextBlockElement())r.push(l);r=r.filter(function(e){var t=e.getStartNode();return t!=e.getEndNode()||!(0,Ro.default)(t,!0)||(null===(e=t.parentNode)||void 0===e||e.removeChild(t),!1)})}return 0==r.length&&e&&!e.rootNode.firstChild&&t&&(o=(0,_o.default)(1,e.rootNode.ownerDocument),e.rootNode.appendChild(o),r.push((0,xo.default)(e.rootNode,o))),r},{}),ko=(Object.defineProperty(Lo,"__esModule",{value:!0}),m),Io=(Lo.default=function(e,t){return!(!e||!(0,ko.default)(e.rootNode,t)||e.nodeBefore&&4!=e.nodeBefore.compareDocumentPosition(t)||e.nodeAfter&&2!=e.nodeAfter.compareDocumentPosition(t))},Object.defineProperty(yo,"__esModule",{value:!0}),ce),Mo=bo,Ao=Co,Do=Lo,jo=V,Bo=y,Fo=We,Ho=T,zo=hr,Uo=se,Vo=Ve,Wo=r,qo="ol,ul";function Ko(e,t,n){var r=t[n?t.length-1:0],r=(0,Vo.getLeafSibling)(e.rootNode,r,n,e.skipTags,!0);r=(0,Mo.default)(e,qo,r),(0,Do.default)(e,r)&&(0,Wo.isListElement)(r)&&(n?(0,Bo.default)(r,"HTMLOListElement")&&1!=r.start||t.push(r):t.unshift(r))}yo.default=function(n,r,e){if(!n)return null;var t,o,i=[],a=(e?(e=(0,Mo.default)(n,qo,e))&&i.push(e):((0,Ao.default)(n).forEach(function(e){var t=(0,Mo.default)(n,qo,e.getStartNode());t?(i[i.length-1]!=t&&i.push(t),1==i.length&&(0,Bo.default)(t,"HTMLOListElement")&&1<t.start&&(r=!1)):i.push(e.collapseToSingleElement())}),0!=i.length||n.rootNode.firstChild||(e=(0,Io.default)(1,n.rootNode.ownerDocument),n.rootNode.appendChild(e),i.push(e),n.fullSelectionStart=new jo.default(e,0),n.fullSelectionEnd=new jo.default(e,-1)),r&&(Ko(n,i,!1),Ko(n,i,!0)),i=i.filter(function(e){return!(0,Fo.default)(e,!0)})),null);return 0<i.length&&(e=i.shift(),a=(0,Wo.isListElement)(e)?new zo.default(e):(e=e,t=1==(t=(0,Ho.default)(e.childNodes)).length?t[0]:(0,Uo.default)(t,"SPAN"),o=e.ownerDocument.createElement("ol"),e.appendChild(o),(e=new zo.default(o)).appendItem(t,0),e),i.forEach(function(e){(0,Wo.isListElement)(e)?a.mergeVList(new zo.default(e)):a.appendItem(e,0)})),a};var We={},Go=(Object.defineProperty(We,"__esModule",{value:!0}),M),Zo=bo,Yo=w,Xo=Lo,$o=or,Qo=hr,Jo=0;function ei(e,t){this.region=e,this.name=t,this.lastNumber=0,this.lastNumberBeforeCursor=0}ei.createListChains=function(e,l,s){var e=Array.isArray(e)?e:e?[e]:[],t=[];return e.forEach(function(o){var i,a=[];(0,$o.default)(o.rootNode,"ol",function(e){var t,n,r=(0,Zo.default)(o,"ol",e);i!=r&&(e=a.filter(function(e){return e.canAppendToTail(r)})[0]||new ei(o,(s||function(){return"__List_Chain_"+Jo++})()),t=a.indexOf(e),(n=l&&(0,Yo.default)(r,l))?t<0&&a.push(e):(0<=t&&a.splice(t,1),a.unshift(e)),e.append(r,n),i=r)}),(0,Go.default)(t,a)}),t},ei.prototype.canAppendAtCursor=function(e){return 1<e&&this.lastNumberBeforeCursor+1==e},ei.prototype.createVListAtBlock=function(e,t){var n;return e?((n=e.ownerDocument.createElement("ol")).start=t,this.applyChainName(n),e.parentNode.insertBefore(n,e),(t=new Qo.default(n)).appendItem(e,0),t):null},ei.prototype.commit=function(){for(var e=this.getLists(),t=0,n=0;n<e.length;n++){var r=e[n],o=(r.start=t+1,new Qo.default(r)),t=o.getLastItemNumber();delete r.dataset.listchain,delete r.dataset.listchainafter,o.writeBack()}},ei.prototype.canAppendToTail=function(e){return this.lastNumber+1==e.start},ei.prototype.append=function(e,t){this.applyChainName(e),this.lastNumber=new Qo.default(e).getLastItemNumber(),t?e.dataset.listchainafter="true":this.lastNumberBeforeCursor=this.lastNumber},ei.prototype.applyChainName=function(e){e.dataset.listchain=this.name},ei.prototype.getLists=function(){var t=this;return(0,$o.default)(this.region.rootNode,"ol[data-listchain="+this.name+"]").filter(function(e){return(0,Xo.default)(t.region,e)})},We.default=ei;var r={},ti=(Object.defineProperty(r,"__esModule",{value:!0}),r.getRegionCreator=void 0,m),ni=W,ri=V,oi=or,ii=Ve,ai=((bo={})[0]={skipTags:["TABLE"],outerSelector:"table",innerSelector:"td,th"},bo);function li(e,r){var o=ri.default.getStart(e).normalize(),i=ri.default.getEnd(e).normalize();return function(e,t,n){return function(e,t,n,r){var o,i;if(e)return o=t&&(0,ii.getNextLeafSibling)(e,t,r),r=n&&(0,ii.getPreviousLeafSibling)(e,n,r),i=!t||(0,ti.default)(e,t)&&(0,ti.default)(e,o),e=!n||(0,ti.default)(e,n)&&(0,ti.default)(e,r),r=!(t&&n&&((0,ti.default)(t,n,!0)||(0,ti.default)(t,r,!0)||(0,ti.default)(n,t,!0)||(0,ti.default)(n,o,!0))),i&&e&&r}(e,t,n,r)?{rootNode:e,nodeBefore:t,nodeAfter:n,skipTags:r,fullSelectionStart:o,fullSelectionEnd:i}:null}}r.default=function(e,t,n){var r,o,a,i,l,s,c,d=[];return e&&t&&(o=(r=ai[n]).innerSelector,r=r.skipTags,i=t,l=[{innerNode:a=e,children:[]}],n=ai[n],s=n.outerSelector,n=n.innerSelector,c=(0,oi.default)(a,s,null,2,i),(0,oi.default)(a,n,function(e){var t=(0,ni.default)(e,a,s);if(t&&c.indexOf(t)<0){for(var n={innerNode:e,children:[]},r=l.length-1;0<=r;r--){var o=l[r],i=o.innerNode,o=o.children;if((0,ti.default)(i,t)){i=o.filter(function(e){return e.outerNode==t})[0];i||o.push(i={outerNode:t,boundaries:[]}),i.boundaries.push(n);break}}l.push(n)}},1,i),n=l[0],i=(0,ni.default)(t.startContainer,e,o)||e,o=(0,ni.default)(t.endContainer,e,o)||e,d=function d(n,e,u,f,r){r=r||e.innerNode==u;var o=!1,t=e.children,i=e.innerNode,a=[];if(0==t.length)a.push(n(i));else for(var l=0;l<=t.length&&!o;l++){var h=(s=t[l]||{}).outerNode,s=s.boundaries,c=null===(c=t[l-1])||void 0===c?void 0:c.outerNode;r&&a.push(n(i,c,h)),null==s||s.forEach(function(e){var t=(e=d(n,e,u,f,r))[0];r=e[1],o=e[2],a=a.concat(t)})}return[a,r,o||i==f]}(li(t,r),n,i,o)[0]),d.filter(function(e){return!!e})},r.getRegionCreator=li;var w={},si=(Object.defineProperty(w,"__esModule",{value:!0}),v),ci=Lo,di=y,bo=(w.default=function(t,e){if(!e||0==e.length)return[];var e=(0,di.default)(e[0],"Node")?e:[e[0].getStartNode(),e[e.length-1].getEndNode()],n=(e=e&&e.filter(function(e){return(0,ci.default)(t,e)}))[0],e=e[e.length-1];return(0,ci.default)(t,n)&&(0,ci.default)(t,e)?(0,si.default)(t.rootNode,n,e,!0):[]},{}),ui={},fi=(Object.defineProperty(ui,"__esModule",{value:!0}),n),hi={B:{"font-weight":"bold"},EM:{"font-style":"italic"},I:{"font-style":"italic"},U:{"text-decoration":"underline"},P:{"margin-top":"1em","margin-bottom":"1em"},PRE:{"white-space":"pre"},S:{"text-decoration":"line-through"},STRIKE:{"text-decoration":"line-through"},SUB:{"vertical-align":"sub","font-size":"smaller"},SUP:{"vertical-align":"super","font-size":"smaller"}},pi=(ui.default=function(e,t){e=(0,fi.default)(e);return hi[e]||(t||{})[e]},e&&e.__assign||function(){return(pi=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)}),gi=(Object.defineProperty(bo,"__esModule",{value:!0}),qn),vi=m,mi=g,yi=ui,bi=Ir,Ei=Lo,Ci=y,wi=o,Si=v,Pi=(bo.default=function(e,t,n){var r;if((0,Ei.default)(e,t)&&(0,Ei.default)(e,n)&&(r=(0,mi.default)(e.rootNode,n))&&!r.contains(t)){for(var o=r.collapseToSingleElement(),i=(0,Si.collapse)(e.rootNode,o,t,!1,!0),a=o;(0,vi.default)(i,a);){var l,s=a.parentNode;(0,Ci.default)(s,"HTMLElement")&&(l=pi(pi(pi({},(0,yi.default)(s)||{}),(0,bi.default)(s)),(0,bi.default)(o)),(0,wi.default)(o,l)),a=s}for(var c=null,n=1==o.childNodes.length&&0==o.attributes.length?o.firstChild:(0,gi.default)(o,"SPAN"),a=n;(0,vi.default)(i,a)&&1==a.parentNode.childNodes.length;a=a.parentNode)c=a.parentNode;null===(r=t.parentNode)||void 0===r||r.insertBefore(n,t.nextSibling),null===(e=null==c?void 0:c.parentNode)||void 0===e||e.removeChild(c)}},{}),Ti=(Object.defineProperty(Pi,"__esModule",{value:!0}),ce),Oi=F,_i=cr,xi=(Pi.default=function(e){if(!e)return null;var t=(0,Oi.default)(e),n=t.getBoundingClientRect&&(0,_i.default)(t.getBoundingClientRect());if(n)return n;e=e.normalize();var r=t.getClientRects&&t.getClientRects();if(n=r&&1==r.length?(0,_i.default)(r[0]):null)return n;if(3==e.node.nodeType&&e.node.ownerDocument){r=(0,Ti.default)({tag:"span",children:["​"]},e.node.ownerDocument);if((t=(0,Oi.default)(e)).insertNode(r),n=r.getBoundingClientRect&&(0,_i.default)(r.getBoundingClientRect()),null===(t=r.parentNode)||void 0===t||t.removeChild(r),n)return n}t=e.element;return t&&t.getBoundingClientRect&&(n=(0,_i.default)(t.getBoundingClientRect()))?n:null},{}),Ni=(Object.defineProperty(xi,"__esModule",{value:!0}),m),Ri=n,Li=$n;xi.default=function(e,t){if(e){var n=(e=e.normalize()).node;if(0==e.offset){for(;n&&(0,Ni.default)(t,n)&&function(e){for(;e.previousSibling;)if(e=e.previousSibling,"BR"==(0,Ri.default)(e)||!(0,Li.default)(e))return;return 1}(n);)n=(null==n?void 0:n.parentNode)||null;return n==t}}return!1};var ki={},Ii=(Object.defineProperty(ki,"__esModule",{value:!0}),m),Mi=V;function Ai(e,t){var n,r;if(!e||!t)return[];var o,i=e.node,a=e.offset,l=[];if(!(0,Ii.default)(t,i,!0))return[];if(3==i.nodeType){for(o=i.parentNode;i.previousSibling&&3==i.previousSibling.nodeType;)a+=(null===(n=i.previousSibling.nodeValue)||void 0===n?void 0:n.length)||0,i=i.previousSibling;l.unshift(a)}else i=(o=i).childNodes[a];do{for(var a=0,s=!1,c=(null==o?void 0:o.firstChild)||null;c&&c!=i;c=c.nextSibling){if(3==c.nodeType){if(0===(null===(r=c.nodeValue)||void 0===r?void 0:r.length)||s)continue;s=!0}else s=!1;a++}}while(l.unshift(a),o=(null==(i=o)?void 0:o.parentNode)||null,i&&i!=t);return l}ki.default=function(e,t){return t?{start:Ai(Mi.default.getStart(t),e),end:Ai(Mi.default.getEnd(t),e)}:null};var Di={},ji=(Object.defineProperty(Di,"__esModule",{value:!0}),dr),Bi=ki,Fi=n,Hi=or,zi=(Di.default=function(e,t){if(!e)return"";var n=t||{},r=n.startContainer,o=n.endContainer,i=n.startOffset,n=n.endOffset,a=!1;if((0,Hi.default)(e,"table",function(e){for(var t=null,n=e.firstChild;n;n=n.nextSibling)"TR"==(0,Fi.default)(n)?(t||(t=e.ownerDocument.createElement("tbody"),e.insertBefore(t,n)),t.appendChild(n),n=t,a=!0):t=null}),t&&a)try{t.setStart(r,i),t.setEnd(o,n)}catch(e){}r=(0,ji.default)(e),i=t&&(0,Bi.default)(e,t);return i?r+"\x3c!--"+JSON.stringify(i)+"--\x3e":r},{}),Ui=(Object.defineProperty(zi,"__esModule",{value:!0}),F),Vi=/<!--([^-]+)-->$/,Wi=(zi.default=function(e,t,n){if(!e)return null;var r=Vi.exec(t=t||""),n=(e.innerHTML=(null==n?void 0:n(t))||t,function(e,t){var n,r,o,i=null,a=null;if(o=8==(null===(o=e.lastChild)||void 0===o?void 0:o.nodeType)?(i=e.lastChild).nodeValue||"":t)try{(a=JSON.parse(o))&&0<(null===(n=a.start)||void 0===n?void 0:n.length)&&0<(null===(r=a.end)||void 0===r?void 0:r.length)?i&&e.removeChild(i):a=null}catch(e){}return a}(e,(null==r?void 0:r[1])||""));return n&&(0,Ui.default)(e,n.start,n.end)},{}),qi=(Object.defineProperty(Wi,"__esModule",{value:!0}),de),Ki=(Wi.default=function(e,t){var n=null===(n=null===(n=null===(n=null==e?void 0:e.commonAncestorContainer)||void 0===n?void 0:n.ownerDocument)||void 0===n?void 0:n.defaultView)||void 0===n?void 0:n.getSelection();if(n){var r=!0;if(0<n.rangeCount)try{var o=null;(t||qi.Browser.isEdge)&&(o=1==n.rangeCount?n.getRangeAt(0):null)&&o.startContainer==e.startContainer&&o.startOffset==e.startOffset&&o.endContainer==e.endContainer&&o.endOffset==e.endOffset?r=!1:n.removeAllRanges()}catch(e){}r&&n.addRange(e)}},{}),Gi={},Zi={},Yi=(Object.defineProperty(Zi,"__esModule",{value:!0}),Zi.default=function(e,t){t=e.currentIndex+t;return 0<=t&&t<e.snapshots.length},Object.defineProperty(Gi,"__esModule",{value:!0}),Zi),Xi=(Gi.default=function(e){if((0,Yi.default)(e,1)){for(var t=0,n=e.currentIndex+1;n<e.snapshots.length;n++)t+=e.snapshots[n].length;e.snapshots.splice(e.currentIndex+1),e.totalSize-=t,e.autoCompleteIndex=-1}},Object.defineProperty(Ki,"__esModule",{value:!0}),Gi),$i=(Ki.default=function(e,t,n){if(e.currentIndex<0||t!=e.snapshots[e.currentIndex]){(0,Xi.default)(e),e.snapshots.push(t),e.currentIndex++,e.totalSize+=t.length;for(var r=0;r<e.snapshots.length&&e.totalSize>e.maxSize;)e.totalSize-=e.snapshots[r].length,r++;0<r&&(e.snapshots.splice(0,r),e.currentIndex-=r,e.autoCompleteIndex-=r),n&&(e.autoCompleteIndex=e.currentIndex)}},{}),Qi=(Object.defineProperty($i,"__esModule",{value:!0}),$i.moveCurrentSnapsnot=void 0,Zi);function Ji(e,t){return(0,Qi.default)(e,t)?(e.currentIndex+=t,e.autoCompleteIndex=-1,e.snapshots[e.currentIndex]):null}$i.default=Ji,$i.moveCurrentSnapsnot=Ji;var ea={},ta=(Object.defineProperty(ea,"__esModule",{value:!0}),ea.default=function(e){return{snapshots:[],totalSize:0,currentIndex:-1,autoCompleteIndex:-1,maxSize:e}},{}),na=(Object.defineProperty(ta,"__esModule",{value:!0}),ta.default=function(e){return 0<=e.autoCompleteIndex&&e.currentIndex-e.autoCompleteIndex==1},{}),ra={},oa=(Object.defineProperty(ra,"__esModule",{value:!0}),"border-spacing,caption-side,color,cursor,direction,empty-cells,font-family,font-size,font-style,font-variant,font-weight,font,letter-spacing,line-height,list-style-image,list-style-position,list-style-type,list-style,orphans,quotes,text-align,text-indent,text-transform,visibility,white-space,widows,word-spacing".split(",")),ia=(ra.default=function(e){var t=e&&e.ownerDocument&&e.ownerDocument.defaultView,n=t&&t.getComputedStyle(e),r={};return oa.forEach(function(e){return r[e]=n&&n.getPropertyValue(e)||""}),r},{}),aa=(Object.defineProperty(ia,"__esModule",{value:!0}),ia.cloneObject=void 0,Object.assign?function(e,t){return Object.assign(t||{},e)}:function(e,t){var n=t||{};if(e)for(var r=0,o=Object.keys(e);r<o.length;r++){var i=o[r];n[i]=e[i]}return n}),la=(ia.cloneObject=function(e,t){return aa(e,t)},{}),sa=e&&e.__assign||function(){return(sa=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},ca=(Object.defineProperty(la,"__esModule",{value:!0}),la.getStyleCallbacks=la.getDefaultStyleValues=la.getAllowedCssClassesRegex=la.getAllowedAttributes=la.getTagReplacement=void 0,ia),da={a:"*",abbr:"*",address:"*",area:"*",article:"*",aside:"*",b:"*",bdi:"*",bdo:"*",blockquote:"*",body:"*",br:"*",button:"*",canvas:"*",caption:"*",center:"*",cite:"*",code:"*",col:"*",colgroup:"*",data:"*",datalist:"*",dd:"*",del:"*",details:"*",dfn:"*",dialog:"*",dir:"*",div:"*",dl:"*",dt:"*",em:"*",fieldset:"*",figcaption:"*",figure:"*",font:"*",footer:"*",h1:"*",h2:"*",h3:"*",h4:"*",h5:"*",h6:"*",head:"*",header:"*",hgroup:"*",hr:"*",html:"*",i:"*",img:"*",input:"*",ins:"*",kbd:"*",label:"*",legend:"*",li:"*",main:"*",map:"*",mark:"*",menu:"*",menuitem:"*",meter:"*",nav:"*",ol:"*",optgroup:"*",option:"*",output:"*",p:"*",picture:"*",pre:"*",progress:"*",q:"*",rp:"*",rt:"*",ruby:"*",s:"*",samp:"*",section:"*",select:"*",small:"*",span:"*",strike:"*",strong:"*",sub:"*",summary:"*",sup:"*",table:"*",tbody:"*",td:"*",template:"*",textarea:"*",tfoot:"*",th:"*",thead:"*",time:"*",tr:"*",tt:"*",u:"*",ul:"*",var:"*",wbr:"*",xmp:"*",form:"SPAN",applet:null,audio:null,base:null,basefont:null,embed:null,frame:null,frameset:null,iframe:null,link:null,meta:null,noscript:null,object:null,param:null,script:null,slot:null,source:null,style:null,title:null,track:null,video:null},ua="accept,align,alt,checked,cite,color,cols,colspan,contextmenu,coords,datetime,default,dir,dirname,disabled,download,face,headers,height,hidden,high,href,hreflang,ismap,kind,label,lang,list,low,max,maxlength,media,min,multiple,open,optimum,pattern,placeholder,readonly,rel,required,reversed,rows,rowspan,scope,selected,shape,size,sizes,span,spellcheck,src,srclang,srcset,start,step,style,tabindex,target,title,translate,type,usemap,valign,value,width,wrap".split(","),fa={"background-color":"transparent","border-bottom-color":"rgb(0, 0, 0)","border-bottom-style":"none","border-bottom-width":"0px","border-image-outset":"0","border-image-repeat":"stretch","border-image-slice":"100%","border-image-source":"none","border-image-width":"1","border-left-color":"rgb(0, 0, 0)","border-left-style":"none","border-left-width":"0px","border-right-color":"rgb(0, 0, 0)","border-right-style":"none","border-right-width":"0px","border-top-color":"rgb(0, 0, 0)","border-top-style":"none","border-top-width":"0px","outline-color":"transparent","outline-style":"none","outline-width":"0px",overflow:"visible","text-decoration":"none","-webkit-text-stroke-width":"0px","word-wrap":"break-word","margin-left":"0px","margin-right":"0px",padding:"0px","padding-top":"0px","padding-left":"0px","padding-right":"0px","padding-bottom":"0px",border:"0px","border-top":"0px","border-left":"0px","border-right":"0px","border-bottom":"0px","vertical-align":"baseline",float:"none"},ha=[];function pa(){return null}function ga(e,t){t=t.tagName;return!("LI"==t||"DIV"==t)}la.getTagReplacement=function(e){var t=sa({},da),n=e||{};return Object.keys(n).forEach(function(e){e&&(t[e.toLowerCase()]=n[e])}),t},la.getAllowedAttributes=function(e){return ua.concat(e||[]).filter(function(e,t,n){return n.indexOf(e)==t}).map(function(e){return e.toLocaleLowerCase()})},la.getAllowedCssClassesRegex=function(e){e=ha.concat(e||[]);return 0<e.length?new RegExp(e.join("|")):null},la.getDefaultStyleValues=function(n){var r=(0,ca.cloneObject)(fa);return n&&Object.keys(n).forEach(function(e){var t=n[e];null!=t?r[e]=t:delete r[e]}),r},la.getStyleCallbacks=function(e){e=(0,ca.cloneObject)(e);return e.position=e.position||pa,e.width=e.width||ga,e},Object.defineProperty(na,"__esModule",{value:!0});var va=qn,ma=ra,ya=ui,ba=Ir,Ea=n,Ca=y,wa=o,Sa=T,Pa=ia,Ta=la;function Oa(e){this.elementCallbacks=(0,Pa.cloneObject)((e=e||{}).elementCallbacks),this.styleCallbacks=(0,Ta.getStyleCallbacks)(e.cssStyleCallbacks),this.attributeCallbacks=(0,Pa.cloneObject)(e.attributeCallbacks),this.tagReplacements=(0,Ta.getTagReplacement)(e.additionalTagReplacements),this.allowedAttributes=(0,Ta.getAllowedAttributes)(e.additionalAllowedAttributes),this.allowedCssClassesRegex=(0,Ta.getAllowedCssClassesRegex)(e.additionalAllowedCssClasses),this.defaultStyleValues=(0,Ta.getDefaultStyleValues)(e.additionalDefaultStyleValues),this.additionalPredefinedCssForElement=e.additionalPredefinedCssForElement,this.additionalGlobalStyleNodes=e.additionalGlobalStyleNodes||[],this.preserveHtmlComments=e.preserveHtmlComments,this.unknownTagReplacement=e.unknownTagReplacement}Oa.convertInlineCss=function(e,t){return new Oa({additionalGlobalStyleNodes:t}).exec(e,!0)},Oa.sanitizeHtml=function(e,t){var n=new Oa(t=t||{}),r=(0,Ca.default)(t.currentElementOrStyle,"HTMLElement")?(0,ma.default)(t.currentElementOrStyle):t.currentElementOrStyle;return n.exec(e,t.convertCssOnly,r)},Oa.prototype.exec=function(e,t,n){e=(new DOMParser).parseFromString(e||"","text/html");return e&&e.body&&e.body.firstChild&&(this.convertGlobalCssToInlineCss(e),t||this.sanitize(e.body,n)),e&&e.body&&e.body.innerHTML||""},Oa.prototype.sanitize=function(e,t){if(!e)return"";t=(0,Pa.cloneObject)(t,(0,ma.default)(null)),this.processNode(e,t,{})},Oa.prototype.convertGlobalCssToInlineCss=function(i){for(var e=(0,Sa.default)(i.querySelectorAll("style")),t=0,n=this.additionalGlobalStyleNodes.reverse().map(function(e){return e.sheet}).concat(e.map(function(e){return e.sheet}).reverse()).filter(function(e){return e});t<n.length;t++)for(var a=n[t],r=a.cssRules.length-1;0<=r;r--)!function(e){var e=a.cssRules[e],t=e&&e.style?e.style.cssText:null;if(e.type!=CSSRule.STYLE_RULE||!t||!e.selectorText)return;for(var n=0,r=e.selectorText.split(",");n<r.length;n++){var o=r[n];!o||!o.trim()||0<=o.indexOf(":")||(0,Sa.default)(i.querySelectorAll(o)).forEach(function(e){return e.setAttribute("style",t+(e.getAttribute("style")||""))})}}(r);e.forEach(function(e){e.parentNode&&e.parentNode.removeChild(e)})},Oa.prototype.processNode=function(e,t,n){var r,o,i=e.nodeType,a=1==i,d=3==i,u=11==i,i=8==i,l=!1;if(a?(s=(0,Ea.default)(e),o=this.elementCallbacks[s],void 0===(r=this.tagReplacements[s.toLowerCase()])&&(r=this.unknownTagReplacement),o?l=o(e,n):0<s.indexOf(":")||s==r||"*"==r?l=!0:r&&/^[a-zA-Z][\w\-]*$/.test(r)&&(e=(0,va.default)(e,r),l=!0)):l=d?"pre"==(o=t["white-space"])||"pre-line"==o||"pre-wrap"==o||!/^[\r\n]*$/g.test(e.nodeValue):!!u||!!i&&this.preserveHtmlComments,l)if(!d||"pre"!=t["white-space"]&&"pre-wrap"!=t["white-space"]){if(a||u){var f=(0,Pa.cloneObject)(t),s=e;a&&(this.processAttributes(s,n),this.preprocessCss(s,f),this.processCss(s,f,n));for(var h,c=s.firstChild;c;c=h)h=c.nextSibling,this.processNode(c,f,n)}}else e.nodeValue=e.nodeValue.replace(/^ /gm," ").replace(/ {2}/g,"  ");else e.parentNode.removeChild(e)},Oa.prototype.preprocessCss=function(e,t){var n=(0,ya.default)(e,this.additionalPredefinedCssForElement);n&&Object.keys(n).forEach(function(e){t[e]=n[e]})},Oa.prototype.processCss=function(o,i,a){var l=this,s=(0,ba.default)(o);Object.keys(s).forEach(function(e){var t=s[e],n=l.styleCallbacks[e],r=null!=i[e],n=(!n||n(t,o,i,a))&&"inherit"!=t&&t.indexOf("expression")<0&&"-"!=e.substr(0,1)&&l.defaultStyleValues[e]!=t&&(r&&t!=i[e]||!r&&"initial"!=t&&"normal"!=t);n&&r&&(i[e]=t),n||delete s[e]}),(0,wa.default)(o,s)},Oa.prototype.processAttributes=function(e,t){for(var n=e.attributes.length-1;0<=n;n--){var r=e.attributes[n],o=r.name.toLowerCase().trim(),i=r.value,a=this.attributeCallbacks[o],a=a?a(i,e,t):0<=this.allowedAttributes.indexOf(o)||0==o.indexOf("data-")?i:null;null==(a="class"==o&&this.allowedCssClassesRegex?this.processCssClass(i,a):a)||a.match(/s\n*c\n*r\n*i\n*p\n*t\n*:/i)?e.removeAttribute(o):r.value=a}},Oa.prototype.processCssClass=function(e,t){var n=this,e=e?e.split(" "):[],r=t?t.split(" "):[];return e.forEach(function(e){n.allowedCssClassesRegex.test(e)&&r.indexOf(e)<0&&r.push(e)}),0<r.length?r.join(" "):null},na.default=Oa;var ui={},ia=(Object.defineProperty(ui,"__esModule",{value:!0}),ui.default=function(){return{elementCallbacks:{},attributeCallbacks:{},cssStyleCallbacks:{},additionalTagReplacements:{},additionalAllowedAttributes:[],additionalAllowedCssClasses:[],additionalDefaultStyleValues:{},additionalGlobalStyleNodes:[],additionalPredefinedCssForElement:{},preserveHtmlComments:!1,unknownTagReplacement:null}},{}),la=(Object.defineProperty(ia,"__esModule",{value:!0}),ia.default=function(e,t,n){var r;e[t]?(r=e[t],e[t]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.apply(void 0,e),n.apply(void 0,e)}):e[t]=n},{}),_a=(Object.defineProperty(la,"__esModule",{value:!0}),"contenteditable"),xa=(la.default=function(e,t,n,r){e&&(e.className="_Entity _EType_"+t+" "+(r?"_EId_"+r+" ":"")+"_EReadonly_"+(n?"1":"0"),n?e.contentEditable="false":e.getAttribute(_a)&&e.removeAttribute(_a))},{}),Na=(Object.defineProperty(xa,"__esModule",{value:!0}),xa.default=function(e){var t,n=!1,r="",o="",i=!1;return null===(t=null==e?void 0:e.className)||void 0===t||t.split(" ").forEach(function(e){"_Entity"==e?n=!0:0==e.indexOf("_EType_")?r=e.substr("_EType_".length):0==e.indexOf("_EId_")?o=e.substr("_EId_".length):0==e.indexOf("_EReadonly_")&&(i="1"==e.substr("_EReadonly_".length))}),n?{wrapper:e,id:o,type:r,isReadonly:i}:null},{}),Ra=(Object.defineProperty(Na,"__esModule",{value:!0}),Na.default=function(e,t){return"._Entity"+(e?"._EType_"+e:"")+(t?"._EId_"+t:"")},{}),La=(Object.defineProperty(Ra,"__esModule",{value:!0}),Ra.default=function(e,t,n){n=e&&e.eventDataCache&&e.eventDataCache.hasOwnProperty(t)?e.eventDataCache[t]:n();return e&&(e.eventDataCache=e.eventDataCache||{},e.eventDataCache[t]=n),n},{}),ka=(Object.defineProperty(La,"__esModule",{value:!0}),La.default=function(e,t){e&&e.eventDataCache&&(t&&e.eventDataCache.hasOwnProperty(t)?delete e.eventDataCache[t]:t||(e.eventDataCache={}))},{}),Ia=(Object.defineProperty(ka,"__esModule",{value:!0}),ka.default=function(e){var t=e.ctrlKey||"Control"===e.key,n=e.altKey||"Alt"===e.key,e=e.metaKey||"Meta"===e.key;return t||n||e},{}),Ma=(Object.defineProperty(Ia,"__esModule",{value:!0}),ka),Aa=(Ia.default=function(e){return!(0,Ma.default)(e)&&e.key&&1==e.key.length},{}),Da=(Object.defineProperty(Aa,"__esModule",{value:!0}),de.Browser.isMac?function(e){return e.metaKey}:function(e){return e.ctrlKey}),ja=(Aa.default=function(e){return Da(e)},{}),Ba=(Object.defineProperty(ja,"__esModule",{value:!0}),qn),Fa=m,Ha=F,za=W,Ua=g,Va=n,Wa=$n,qa=xi,Ka=H,Ga=vt,Za=V,Ya=Et,Xa=or,$a=Ue,Qa=T,Ja=ir,el=fr,tl=se,nl=C,rl=[function(e,t,n,r){var o=(0,Ua.default)(e,n.node);if(o){var i=(0,Xa.default)(e,"a[href]",null,1,(0,Ha.default)(n)).filter(function(e){return o.contains(e)})[0];if(i&&(0,Wa.default)(i)&&(n=new Za.default(i,-2),ol(i),i=null),i&&null!==t&&void 0!==t&&t.querySelector&&null!==t&&void 0!==t&&t.querySelector("a[href]")){var t=n.normalize(),a=t.node.parentNode,t=3==t.node.nodeType?(0,$a.default)(t.node,t.offset,!1):t.isAtEnd?t.node.nextSibling:t.node,l=e.ownerDocument.createTextNode("");for(a.insertBefore(l,t);(0,Fa.default)(i,l);)l=(0,nl.splitBalancedNodeRange)(l);n=new Za.default(l,-2),ol(l)}}return n},function(e,t,n,d){11==t.nodeType&&(t=1==(i=(0,Qa.default)(t.childNodes).filter(function(e){return"BR"!=(0,Va.default)(e)})).length?i[0]:null);var r,o,i=(0,Va.default)(t),a=i&&"BR"==(0,Va.default)(t.nextSibling),l=(0,za.default)(n.node,e,"LI"),s=l&&(0,za.default)(l,e,"OL,UL"),c=(0,za.default)(n.node,e,"TD,TH"),e=c&&(0,za.default)(c,e,"TR");return"LI"==i&&(i=s?(0,Va.default)(s):"UL",t=(0,tl.default)(t,i)),"OL"!=i&&"UL"!=i||"LI"!=(0,Va.default)(t.firstChild)?"TABLE"==i&&e&&(o=new el.default(t),0==(r=new el.default(c)).col&&c==r.getCell(r.row,0).td&&o.cells[0]&&o.cells[0].length==r.cells[0].length&&(0,qa.default)(n,c)&&("TBODY"!=(0,Va.default)(t.firstChild)||t.firstChild.nextSibling||(0,Ja.default)(t.firstChild),(0,Ja.default)(t),n=new Za.default(e,-3))):(o=!t.firstChild.nextSibling&&!a,a&&t.parentNode&&ol(t.nextSibling),o?((0,Ja.default)(t.firstChild),(0,Ja.default)(t)):(0,Va.default)(s)==i&&((0,Ja.default)(t),n=new Za.default(l,(0,qa.default)(n,l)?-2:-3))),n},function(e,t,n,r){var o,i;return"P"==(0,Va.default)(n.node)&&(o=n.normalize(),i=(0,Ba.default)(n.node,"div"),o.node!=i&&(n=o)),n},function(e,t,n,r){return n=(0,Ka.default)(n.node)?new Za.default(n.node,n.isAtEnd?-3:-2):n},function(e,t,n,r){return r&&r.collapsed&&(r=(e=new Ya.default(e,Za.default.getStart(r))).getInlineElementBefore(),e=e.getInlineElementAfter(),r instanceof Ga.default?n=new Za.default(r.getContainerNode(),-3):e instanceof Ga.default&&(n=new Za.default(e.getContainerNode(),-2))),n}];function ol(e){var t;null===(t=null==e?void 0:e.parentNode)||void 0===t||t.removeChild(e)}ja.default=function(t,n,r,o){return rl.forEach(function(e){r=e(t,n,r,o)}),r};var il={},al=(Object.defineProperty(il,"__esModule",{value:!0}),M),ll=w,sl=r,cl=wo,dl=bo,ul=V,fl=or,hl=y,pl=Ue;function gl(e,t,n){if((0,hl.default)(e,"Text"))return r=(0,pl.default)(e,t,n),n?[r,e]:[e,r];var r=e.childNodes[t-1],t=e.childNodes[t];return r||t||(n?r=(t=e).previousSibling:t=(r=e).nextSibling),!r&&!t||r&&t||(n=e.ownerDocument.createTextNode(""),null===(e=(r||t).parentNode)||void 0===e||e.insertBefore(n,t),r?t=n:r=n),[r,t]}il.default=function(e,t){var i=null,a=(0,fl.default)(e,"table,tr",null,2,t),e=(0,sl.default)(e,t,0).map(function(e){var t=(0,cl.default)(e);if(!t)return null;var n=t.startContainer,r=t.endContainer,o=t.startOffset,r=gl(r,t.endOffset,!1),t=r[0],r=r[1],n=gl(n,o,!0),o=n[0],n=n[1],n=(i=i||o,(0,ll.default)(e,[n,t]));return(0,al.default)(a,n),{region:e,beforeStart:o,afterEnd:r}}).filter(function(e){return!!e});return a.forEach(function(e){var t;return null===(t=e.parentNode)||void 0===t?void 0:t.removeChild(e)}),e.forEach(function(e){return(0,dl.default)(e.region,e.beforeStart,e.afterEnd)}),i&&new ul.default(i,-1)};var vl,ml,yl,bl,El,Cl,wl,Sl,Pl,Tl,Ol,_l,xl,Nl,Rl,Ll,kl,Il,Ml,Al,Dl,jl,Bl,Fl,Hl,zl,Ul,Vl,Wl,ql,Kl,Gl,Zl,Yl,Xl,$l,Ql,Jl,es,ts,ns,rs,os,is,as,ls,ss,cs,ds,us,fs,hs,ps,gs,vs,ms,ys,bs,Es,Cs,ws,Ss,Ps,Ts,Os,_s,xs,Ns,Rs,Ls,ks,Is,Ms,As,Ds,js,Bs,Fs,Hs,zs,Us,Vs,Ws,qs,Ks,Gs,Zs,Ys={},Xs=(Object.defineProperty(Ys,"__esModule",{value:!0}),B),$s=(Ys.default=function(e){for(var t=Xs.default.createBodyTraverser(e),n=t&&t.currentBlockElement,r=[];n;)r.push(n.getTextContent()),n=t.getNextBlockElement();return r.join("\n")},l=t,Object.defineProperty(l,"__esModule",{value:!0}),l.KnownCreateElementData=l.createElement=l.matchesSelector=l.setColor=l.getInnerHTML=l.readFile=l.safeInstanceOf=l.toArray=l.normalizeRect=l.splitTextNode=l.getLastLeafNode=l.getFirstLeafNode=l.getPreviousLeafSibling=l.getNextLeafSibling=l.wrap=l.unwrap=l.splitBalancedNodeRange=l.splitParentNode=l.queryElements=l.matchLink=l.isVoidHtmlElement=l.isNodeEmpty=l.isBlockElement=l.getTagOfNode=l.PendableFormatCommandMap=l.getPendableFormatState=l.getComputedStyle=l.getComputedStyles=l.fromHtml=l.findClosestElementAncestor=l.contains=l.collapseNodes=l.changeElementTag=l.applyFormat=l.getBrowserInfo=l.Browser=l.arrayPush=l.extractClipboardItemsForIE=l.extractClipboardItems=l.extractClipboardEvent=l.applyTextStyle=l.PartialInlineElement=l.NodeInlineElement=l.LinkInlineElement=l.ImageInlineElement=l.getInlineElementAtNode=l.PositionContentSearcher=l.ContentTraverser=l.getFirstLastBlockElement=l.getBlockElementAtNode=void 0,l.getTextContent=l.deleteSelectedContent=l.adjustInsertPosition=l.setStyles=l.getStyles=l.isCtrlOrMetaPressed=l.isCharacterValue=l.isModifierKey=l.clearEventDataCache=l.cacheGetEventData=l.getEntitySelector=l.getEntityFromElement=l.commitEntity=l.chainSanitizerCallback=l.createDefaultHtmlSanitizerOptions=l.getInheritableStyles=l.HtmlSanitizer=l.canUndoAutoComplete=l.createSnapshots=l.moveCurrentSnapsnot=l.moveCurrentSnapshot=l.clearProceedingSnapshots=l.canMoveCurrentSnapshot=l.addSnapshot=l.addRangeToSelection=l.setHtmlWithSelectionPath=l.getHtmlWithSelectionPath=l.getSelectionPath=l.isPositionAtBeginningOf=l.getPositionRect=l.createRange=l.Position=l.mergeBlocksInRegion=l.getSelectionRangeInRegion=l.isNodeInRegion=l.collapseNodesInRegion=l.getSelectedBlockElementsInRegion=l.getRegionsFromRange=l.setListItemStyle=l.VListChain=l.createVListFromRegion=l.VListItem=l.VList=l.VTable=l.moveChildNodes=void 0,vl=g,Object.defineProperty(l,"getBlockElementAtNode",{enumerable:!0,get:function(){return vl.default}}),ml=Ae,Object.defineProperty(l,"getFirstLastBlockElement",{enumerable:!0,get:function(){return ml.default}}),yl=B,Object.defineProperty(l,"ContentTraverser",{enumerable:!0,get:function(){return yl.default}}),bl=Et,Object.defineProperty(l,"PositionContentSearcher",{enumerable:!0,get:function(){return bl.default}}),El=Be,Object.defineProperty(l,"getInlineElementAtNode",{enumerable:!0,get:function(){return El.default}}),Cl=Fe,Object.defineProperty(l,"ImageInlineElement",{enumerable:!0,get:function(){return Cl.default}}),wl=vt,Object.defineProperty(l,"LinkInlineElement",{enumerable:!0,get:function(){return wl.default}}),Sl=He,Object.defineProperty(l,"NodeInlineElement",{enumerable:!0,get:function(){return Sl.default}}),Pl=Ut,Object.defineProperty(l,"PartialInlineElement",{enumerable:!0,get:function(){return Pl.default}}),Tl=ze,Object.defineProperty(l,"applyTextStyle",{enumerable:!0,get:function(){return Tl.default}}),Ol=je,Object.defineProperty(l,"extractClipboardEvent",{enumerable:!0,get:function(){return Ol.default}}),_l=Ht,Object.defineProperty(l,"extractClipboardItems",{enumerable:!0,get:function(){return _l.default}}),xl=Yt,Object.defineProperty(l,"extractClipboardItemsForIE",{enumerable:!0,get:function(){return xl.default}}),Nl=M,Object.defineProperty(l,"arrayPush",{enumerable:!0,get:function(){return Nl.default}}),Rl=de,Object.defineProperty(l,"Browser",{enumerable:!0,get:function(){return Rl.Browser}}),Object.defineProperty(l,"getBrowserInfo",{enumerable:!0,get:function(){return Rl.getBrowserInfo}}),Ll=Un,Object.defineProperty(l,"applyFormat",{enumerable:!0,get:function(){return Ll.default}}),kl=qn,Object.defineProperty(l,"changeElementTag",{enumerable:!0,get:function(){return kl.default}}),Il=v,Object.defineProperty(l,"collapseNodes",{enumerable:!0,get:function(){return Il.default}}),Ml=m,Object.defineProperty(l,"contains",{enumerable:!0,get:function(){return Ml.default}}),Al=W,Object.defineProperty(l,"findClosestElementAncestor",{enumerable:!0,get:function(){return Al.default}}),Dl=he,Object.defineProperty(l,"fromHtml",{enumerable:!0,get:function(){return Dl.default}}),jl=qe,Object.defineProperty(l,"getComputedStyles",{enumerable:!0,get:function(){return jl.default}}),Object.defineProperty(l,"getComputedStyle",{enumerable:!0,get:function(){return jl.getComputedStyle}}),Bl=Xn,Object.defineProperty(l,"getPendableFormatState",{enumerable:!0,get:function(){return Bl.default}}),Object.defineProperty(l,"PendableFormatCommandMap",{enumerable:!0,get:function(){return Bl.PendableFormatCommandMap}}),Fl=n,Object.defineProperty(l,"getTagOfNode",{enumerable:!0,get:function(){return Fl.default}}),Hl=R,Object.defineProperty(l,"isBlockElement",{enumerable:!0,get:function(){return Hl.default}}),zl=$n,Object.defineProperty(l,"isNodeEmpty",{enumerable:!0,get:function(){return zl.default}}),Ul=H,Object.defineProperty(l,"isVoidHtmlElement",{enumerable:!0,get:function(){return Ul.default}}),Vl=rr,Object.defineProperty(l,"matchLink",{enumerable:!0,get:function(){return Vl.default}}),Wl=or,Object.defineProperty(l,"queryElements",{enumerable:!0,get:function(){return Wl.default}}),ql=C,Object.defineProperty(l,"splitParentNode",{enumerable:!0,get:function(){return ql.default}}),Object.defineProperty(l,"splitBalancedNodeRange",{enumerable:!0,get:function(){return ql.splitBalancedNodeRange}}),Kl=ir,Object.defineProperty(l,"unwrap",{enumerable:!0,get:function(){return Kl.default}}),Gl=se,Object.defineProperty(l,"wrap",{enumerable:!0,get:function(){return Gl.default}}),Zl=Ve,Object.defineProperty(l,"getNextLeafSibling",{enumerable:!0,get:function(){return Zl.getNextLeafSibling}}),Object.defineProperty(l,"getPreviousLeafSibling",{enumerable:!0,get:function(){return Zl.getPreviousLeafSibling}}),Yl=xt,Object.defineProperty(l,"getFirstLeafNode",{enumerable:!0,get:function(){return Yl.getFirstLeafNode}}),Object.defineProperty(l,"getLastLeafNode",{enumerable:!0,get:function(){return Yl.getLastLeafNode}}),Xl=Ue,Object.defineProperty(l,"splitTextNode",{enumerable:!0,get:function(){return Xl.default}}),$l=cr,Object.defineProperty(l,"normalizeRect",{enumerable:!0,get:function(){return $l.default}}),Ql=T,Object.defineProperty(l,"toArray",{enumerable:!0,get:function(){return Ql.default}}),Jl=y,Object.defineProperty(l,"safeInstanceOf",{enumerable:!0,get:function(){return Jl.default}}),es=Zt,Object.defineProperty(l,"readFile",{enumerable:!0,get:function(){return es.default}}),ts=dr,Object.defineProperty(l,"getInnerHTML",{enumerable:!0,get:function(){return ts.default}}),ns=Vn,Object.defineProperty(l,"setColor",{enumerable:!0,get:function(){return ns.default}}),rs=q,Object.defineProperty(l,"matchesSelector",{enumerable:!0,get:function(){return rs.default}}),os=ce,Object.defineProperty(l,"createElement",{enumerable:!0,get:function(){return os.default}}),Object.defineProperty(l,"KnownCreateElementData",{enumerable:!0,get:function(){return os.KnownCreateElementData}}),is=Kn,Object.defineProperty(l,"moveChildNodes",{enumerable:!0,get:function(){return is.default}}),as=fr,Object.defineProperty(l,"VTable",{enumerable:!0,get:function(){return as.default}}),ls=hr,Object.defineProperty(l,"VList",{enumerable:!0,get:function(){return ls.default}}),ss=Lr,Object.defineProperty(l,"VListItem",{enumerable:!0,get:function(){return ss.default}}),cs=yo,Object.defineProperty(l,"createVListFromRegion",{enumerable:!0,get:function(){return cs.default}}),ds=We,Object.defineProperty(l,"VListChain",{enumerable:!0,get:function(){return ds.default}}),us=kr,Object.defineProperty(l,"setListItemStyle",{enumerable:!0,get:function(){return us.default}}),fs=r,Object.defineProperty(l,"getRegionsFromRange",{enumerable:!0,get:function(){return fs.default}}),hs=Co,Object.defineProperty(l,"getSelectedBlockElementsInRegion",{enumerable:!0,get:function(){return hs.default}}),ps=w,Object.defineProperty(l,"collapseNodesInRegion",{enumerable:!0,get:function(){return ps.default}}),gs=Lo,Object.defineProperty(l,"isNodeInRegion",{enumerable:!0,get:function(){return gs.default}}),vs=wo,Object.defineProperty(l,"getSelectionRangeInRegion",{enumerable:!0,get:function(){return vs.default}}),ms=bo,Object.defineProperty(l,"mergeBlocksInRegion",{enumerable:!0,get:function(){return ms.default}}),ys=V,Object.defineProperty(l,"Position",{enumerable:!0,get:function(){return ys.default}}),bs=F,Object.defineProperty(l,"createRange",{enumerable:!0,get:function(){return bs.default}}),Es=Pi,Object.defineProperty(l,"getPositionRect",{enumerable:!0,get:function(){return Es.default}}),Cs=xi,Object.defineProperty(l,"isPositionAtBeginningOf",{enumerable:!0,get:function(){return Cs.default}}),ws=ki,Object.defineProperty(l,"getSelectionPath",{enumerable:!0,get:function(){return ws.default}}),Ss=Di,Object.defineProperty(l,"getHtmlWithSelectionPath",{enumerable:!0,get:function(){return Ss.default}}),Ps=zi,Object.defineProperty(l,"setHtmlWithSelectionPath",{enumerable:!0,get:function(){return Ps.default}}),Ts=Wi,Object.defineProperty(l,"addRangeToSelection",{enumerable:!0,get:function(){return Ts.default}}),Os=Ki,Object.defineProperty(l,"addSnapshot",{enumerable:!0,get:function(){return Os.default}}),_s=Zi,Object.defineProperty(l,"canMoveCurrentSnapshot",{enumerable:!0,get:function(){return _s.default}}),xs=Gi,Object.defineProperty(l,"clearProceedingSnapshots",{enumerable:!0,get:function(){return xs.default}}),Ns=$i,Object.defineProperty(l,"moveCurrentSnapshot",{enumerable:!0,get:function(){return Ns.default}}),Object.defineProperty(l,"moveCurrentSnapsnot",{enumerable:!0,get:function(){return Ns.moveCurrentSnapsnot}}),Rs=ea,Object.defineProperty(l,"createSnapshots",{enumerable:!0,get:function(){return Rs.default}}),Ls=ta,Object.defineProperty(l,"canUndoAutoComplete",{enumerable:!0,get:function(){return Ls.default}}),ks=na,Object.defineProperty(l,"HtmlSanitizer",{enumerable:!0,get:function(){return ks.default}}),Is=ra,Object.defineProperty(l,"getInheritableStyles",{enumerable:!0,get:function(){return Is.default}}),Ms=ui,Object.defineProperty(l,"createDefaultHtmlSanitizerOptions",{enumerable:!0,get:function(){return Ms.default}}),As=ia,Object.defineProperty(l,"chainSanitizerCallback",{enumerable:!0,get:function(){return As.default}}),Ds=la,Object.defineProperty(l,"commitEntity",{enumerable:!0,get:function(){return Ds.default}}),js=xa,Object.defineProperty(l,"getEntityFromElement",{enumerable:!0,get:function(){return js.default}}),Bs=Na,Object.defineProperty(l,"getEntitySelector",{enumerable:!0,get:function(){return Bs.default}}),Fs=Ra,Object.defineProperty(l,"cacheGetEventData",{enumerable:!0,get:function(){return Fs.default}}),Hs=La,Object.defineProperty(l,"clearEventDataCache",{enumerable:!0,get:function(){return Hs.default}}),zs=ka,Object.defineProperty(l,"isModifierKey",{enumerable:!0,get:function(){return zs.default}}),Us=Ia,Object.defineProperty(l,"isCharacterValue",{enumerable:!0,get:function(){return Us.default}}),Vs=Aa,Object.defineProperty(l,"isCtrlOrMetaPressed",{enumerable:!0,get:function(){return Vs.default}}),Ws=Ir,Object.defineProperty(l,"getStyles",{enumerable:!0,get:function(){return Ws.default}}),qs=o,Object.defineProperty(l,"setStyles",{enumerable:!0,get:function(){return qs.default}}),Ks=ja,Object.defineProperty(l,"adjustInsertPosition",{enumerable:!0,get:function(){return Ks.default}}),Gs=il,Object.defineProperty(l,"deleteSelectedContent",{enumerable:!0,get:function(){return Gs.default}}),Zs=Ys,Object.defineProperty(l,"getTextContent",{enumerable:!0,get:function(){return Zs.default}}),Object.defineProperty(h,"__esModule",{value:!0}),h.addUndoSnapshot=void 0,t),g=(h.addUndoSnapshot=function(e,t,n,r){var o,i,a=e.undo,l=a.isNested,s=!!e.lifecycle.shadowEditFragment;l||(a.isNested=!0,s||(a.snapshotsService.addSnapshot(e.api.getContent(e,2),r),a.hasNewContent=!1));try{t&&(o=t((i=e.api.getSelectionRange(e,!0))&&$s.Position.getStart(i).normalize(),i&&$s.Position.getEnd(i).normalize()),l||s||(a.snapshotsService.addSnapshot(e.api.getContent(e,2),!1),a.hasNewContent=!1))}finally{l||(a.isNested=!1)}t&&n&&e.api.triggerEvent(e,{eventType:7,source:n,data:o},!0),r&&(i=e.api.getSelectionRange(e,!1))&&(e.undo.hasNewContent=!1,e.undo.autoCompletePosition=$s.Position.getStart(i))},{}),Ae=(Object.defineProperty(g,"__esModule",{value:!0}),g.attachDomEvent=void 0,g.attachDomEvent=function(a,l){var e=Object.keys(l||{}).map(function(e){n=l[e],r={pluginEventType:null,beforeDispatch:null},"number"==typeof n?r.pluginEventType=n:"function"==typeof n?r.beforeDispatch=n:"object"==typeof n&&(r=n);function t(e){i&&i(e),null!=o&&a.api.triggerEvent(a,{eventType:o,rawEvent:e},!1)}var n,r,o=r.pluginEventType,i=r.beforeDispatch;return a.contentDiv.addEventListener(e,t),function(){a.contentDiv.removeEventListener(e,t)}});return function(){return e.forEach(function(e){return e()})}},{}),Qs=(Object.defineProperty(Ae,"__esModule",{value:!0}),Ae.createPasteFragment=void 0,t),Js="\x3c!--StartFragment--\x3e",ec="\x3c!--EndFragment--\x3e";function tc(e,t){(0,Qs.toArray)(e.querySelectorAll("style")).forEach(t)}Ae.createPasteFragment=function(e,n,t,r,d){if(!n)return null;var o,u,i,a,l={eventType:10,clipboardData:n,fragment:e.contentDiv.ownerDocument.createDocumentFragment(),sanitizingOption:(0,Qs.createDefaultHtmlSanitizerOptions)(),htmlBefore:"",htmlAfter:"",htmlAttributes:{}},s=l.fragment,f=l.sanitizingOption,c=n.rawHtml,h=n.text,p=n.imageDataUri,g=e.contentDiv.ownerDocument,d=(c&&null!==(o=(new DOMParser).parseFromString(e.trustedHTMLHandler(c),"text/html"))&&void 0!==o&&o.body&&(((i=null===(i=o.querySelector("html"))||void 0===i?void 0:i.attributes)?(0,Qs.toArray)(i):[]).reduce(function(e,t){return e[t.name]=t.value,e},l.htmlAttributes),(0,Qs.toArray)(o.querySelectorAll("meta")).reduce(function(e,t){return e[t.name]=t.content,e},l.htmlAttributes),n.htmlFirstLevelChildTags=[],null==o||o.body.normalize(),null==o||o.body.childNodes.forEach(function(e){var t;e.nodeType==Node.TEXT_NODE&&!e.nodeValue.replace(/(\r\n|\r|\n)/gm,"").trim()||(t=(0,Qs.getTagOfNode)(e),e.nodeType!=Node.COMMENT_NODE&&n.htmlFirstLevelChildTags.push(t))}),tc(o,function(e){o.head.appendChild(e),f.additionalGlobalStyleNodes.push(e)}),i=c.indexOf(Js),a=c.lastIndexOf(ec),0<=i&&i+Js.length<=a&&(l.htmlBefore=c.substr(0,i),l.htmlAfter=c.substr(a+ec.length),n.html=c.substring(i+Js.length,a),o.body.innerHTML=e.trustedHTMLHandler(n.html),tc(o.body,function(e){var t;return null===(t=e.parentNode)||void 0===t?void 0:t.removeChild(e)}))),r||h||!p?!r&&c&&o&&o.body?((0,Qs.moveChildNodes)(s,o.body),d&&t&&(i=e,a=t.node,r=i.api.getPendableFormatState(i,!0),u={fontFamily:(i=i.api.getStyleBasedFormatState(i,a)).fontName,fontSize:i.fontSize,textColor:i.textColor,backgroundColor:i.backgroundColor,textColors:i.textColors,backgroundColors:i.backgroundColors,bold:r.isBold,italic:r.isItalic,underline:r.isUnderline},(0,Qs.applyTextStyle)(s,function(e){return(0,Qs.applyFormat)(e,u)}))):h&&h.split("\n").forEach(function(e,t,n){e=e.replace(/^ /g," ").replace(/\r/g,"").replace(/ {2}/g,"  ");var r=g.createTextNode(e);2==n.length&&0==t?(s.appendChild(r),s.appendChild(g.createElement("br"))):0<t&&t<n.length-1?s.appendChild((0,Qs.wrap)(""==e?g.createElement("br"):r)):s.appendChild(r)}):((c=g.createElement("img")).style.maxWidth="100%",c.src=p,s.appendChild(c)),e.api.triggerEvent(e,l,!0),new Qs.HtmlSanitizer(l.sanitizingOption));return d.convertGlobalCssToInlineCss(s),d.sanitize(s,t&&(0,Qs.getInheritableStyles)(t.element)),s};var B={},nc=(Object.defineProperty(B,"__esModule",{value:!0}),B.ensureTypeInContainer=void 0,t),Et=(B.ensureTypeInContainer=function(e,t,n){t=t.normalize();var r,o,i=(0,nc.getBlockElementAtNode)(e.contentDiv,t.node);i?(r=i.collapseToSingleElement(),i=(0,nc.isNodeEmpty)(r)||n&&(i=n,o=r,(0,nc.safeInstanceOf)(i.target,"Node")&&i.target.contains(o)&&i.key===o.innerText),r=r&&i?r:null):(r=(0,nc.createElement)(1,e.contentDiv.ownerDocument),e.api.insertNode(e,r,{position:1,updateCursor:!1,replaceSelection:!1,insertOnNewLine:!1}),t=new nc.Position(r.firstChild,0)),r&&(0,nc.applyFormat)(r,e.lifecycle.defaultFormat,e.lifecycle.isDarkMode),n&&e.api.selectRange(e,(0,nc.createRange)(t))},{}),rc=(Object.defineProperty(Et,"__esModule",{value:!0}),Et.focus=void 0,t),Be=(Et.focus=function(e){var t;e.lifecycle.shadowEditFragment||(e.api.hasFocus(e)&&e.api.getSelectionRange(e,!1)||e.domEvent.selectionRange&&e.api.selectRange(e,e.domEvent.selectionRange,!0)||(t=(0,rc.getFirstLeafNode)(e.contentDiv)||e.contentDiv,e.api.selectRange(e,(0,rc.createRange)(t,0),!0)),e.domEvent.selectionRange=null,e.api.hasFocus(e)||e.contentDiv.focus())},{}),oc=(Object.defineProperty(Be,"__esModule",{value:!0}),Be.getContent=void 0,t),Fe=(Be.getContent=function(e,t){var n,r,o=0==t,i=2==t,a=e.lifecycle.shadowEditFragment||e.contentDiv;return 4==t?a.textContent:3==t?(0,oc.getTextContent)(a):o||e.lifecycle.isDarkMode?(t=a,(0,oc.safeInstanceOf)(t,"DocumentFragment")?(r=t.ownerDocument.createElement("div")).appendChild(t.cloneNode(!0)):r=t.cloneNode(!0),(t=r).normalize(),n=e.api.getSelectionRange(e,!0),n=(n=i?e.lifecycle.shadowEditFragment?e.lifecycle.shadowEditSelectionPath:n?(0,oc.getSelectionPath)(e.contentDiv,n):null:null)&&(0,oc.createRange)(t,n.start,n.end),e.lifecycle.isDarkMode&&e.api.transformColor(e,t,!1,null,1),o?(e.api.triggerEvent(e,{eventType:8,clonedRoot:t},!0),t.innerHTML):n?(0,oc.getHtmlWithSelectionPath)(t,n):t.innerHTML):(0,oc.getHtmlWithSelectionPath)(a,i&&e.api.getSelectionRange(e,!0))},{}),ic=(Object.defineProperty(Fe,"__esModule",{value:!0}),Fe.getPendableFormatState=void 0,t),ac=(Fe.getPendableFormatState=function(e,t){var n=e.api.getSelectionRange(e,!0),r=e.pendingFormatState.pendableFormatState,o=null===(o=e.pendingFormatState.pendableFormatPosition)||void 0===o?void 0:o.normalize(),i=n&&ic.Position.getStart(n).normalize(),o=i&&n.collapsed&&i.equalTo(o);{if(n&&r&&o&&!t)return r;if(i){for(var a=e,l=i.node,s={},c=[];(0,ic.contains)(a.contentDiv,l);)!function(){var t=(0,ic.getTagOfNode)(l),n=1==l.nodeType&&l.style;t&&n&&Object.keys(ac).forEach(function(e){0<=c.indexOf(e)||(s[e]=s[e]||ac[e](t,n),lc[e](n)&&c.push(e))}),l=l.parentNode}();return s}return{}}},{isBold:function(e,t){return"B"==e||"STRONG"==e||700<=parseInt(t.fontWeight)||0<=["bold","bolder"].indexOf(t.fontWeight)},isUnderline:function(e,t){return"U"==e||0<=t.textDecoration.indexOf("underline")},isItalic:function(e,t){return"I"==e||"EM"==e||"italic"===t.fontStyle},isSubscript:function(e,t){return"SUB"==e||"sub"===t.verticalAlign},isSuperscript:function(e,t){return"SUP"==e||"super"===t.verticalAlign},isStrikeThrough:function(e,t){return"S"==e||"STRIKE"==e||0<=t.textDecoration.indexOf("line-through")}}),lc={isBold:function(e){return""!==e.fontWeight&&parseInt(e.fontWeight)<700||"normal"===e.fontWeight},isUnderline:function(e){return""!==e.textDecoration&&e.textDecoration.indexOf("underline")<0},isItalic:function(e){return""!==e.fontStyle&&"italic"!==e.fontStyle},isSubscript:function(e){return""!==e.verticalAlign&&"sub"!==e.verticalAlign},isSuperscript:function(e){return""!==e.verticalAlign&&"super"!==e.verticalAlign},isStrikeThrough:function(e){return""!==e.textDecoration&&e.textDecoration.indexOf("line-through")<0}},vt={},sc=(Object.defineProperty(vt,"__esModule",{value:!0}),vt.getSelectionRange=void 0,t),He=(vt.getSelectionRange=function(e,t){var n,r=null;return e.lifecycle.shadowEditFragment?e.lifecycle.shadowEditSelectionPath&&(0,sc.createRange)(e.contentDiv,e.lifecycle.shadowEditSelectionPath.start,e.lifecycle.shadowEditSelectionPath.end):(t&&!e.api.hasFocus(e)||(n=null===(n=e.contentDiv.ownerDocument.defaultView)||void 0===n?void 0:n.getSelection())&&0<n.rangeCount&&(n=n.getRangeAt(0),(0,sc.contains)(e.contentDiv,n)&&(r=n)),!r&&t?e.domEvent.selectionRange:r)},{}),cc=(Object.defineProperty(He,"__esModule",{value:!0}),He.getSelectionRangeEx=void 0,t);function dc(e){return{type:0,ranges:e,areAllCollapsed:fc(e)}}function uc(e){o=[],e.querySelectorAll("tr").forEach(function(e){var t=new Range,n=null,r=null;e.querySelectorAll("td._tableCellSelected,th._tableCellSelected").forEach(function(e){(0,cc.safeInstanceOf)(e,"HTMLTableCellElement")&&(n=n||e,r=e)}),n&&(t.setStartBefore(n),t.setEndAfter(r),o.push(t))});var o,t=o;return{type:1,ranges:t,table:e,areAllCollapsed:fc(t)}}function fc(e){return e.filter(function(e){return null==e?void 0:e.collapsed}).length==e.length}function hc(e){e=e.querySelector("table._tableSelected");return(0,cc.safeInstanceOf)(e,"HTMLTableElement")?e:null}He.getSelectionRangeEx=function(e){if(e.lifecycle.shadowEditFragment)return n=e.lifecycle.shadowEditSelectionPath&&(0,cc.createRange)(e.contentDiv,e.lifecycle.shadowEditSelectionPath.start,e.lifecycle.shadowEditSelectionPath.end),(t=hc(e.contentDiv))?uc(t):dc([n]);if(e.api.hasFocus(e)){if(t=hc(e.contentDiv))return uc(t);var t=null===(n=e.contentDiv.ownerDocument.defaultView)||void 0===n?void 0:n.getSelection();if(t&&0<t.rangeCount){var n=t.getRangeAt(0);if((0,cc.contains)(e.contentDiv,n))return dc([n])}}return dc([e.domEvent.selectionRange])};var Ut={},pc=(Object.defineProperty(Ut,"__esModule",{value:!0}),Ut.getStyleBasedFormatState=void 0,t),ze=(Ut.getStyleBasedFormatState=function(e,t){if(!t)return{};var n=t?(0,pc.getComputedStyles)(t):[],r=e.lifecycle.isDarkMode,e=e.contentDiv,o=r&&(0,pc.findClosestElementAncestor)(t,e,"[data-ogsc],[data-ogac]"),r=r&&(0,pc.findClosestElementAncestor)(t,e,"[data-ogsb],[data-ogab]");return{fontName:n[0],fontSize:n[1],textColor:n[2],backgroundColor:n[3],textColors:o?{darkModeColor:n[2],lightModeColor:o.dataset.ogsc||o.dataset.ogac}:void 0,backgroundColors:r?{darkModeColor:n[3],lightModeColor:r.dataset.ogsb||r.dataset.ogab}:void 0}},{}),gc=(Object.defineProperty(ze,"__esModule",{value:!0}),ze.hasFocus=void 0,t),je=(ze.hasFocus=function(e){var t=e.contentDiv.ownerDocument.activeElement;return t&&(0,gc.contains)(e.contentDiv,t,!0)},{}),vc=(Object.defineProperty(je,"__esModule",{value:!0}),je.insertNode=void 0,t),Ht=(je.insertNode=function(l,s,c){c=c||{position:3,insertOnNewLine:!1,updateCursor:!0,replaceSelection:!0};var d=l.contentDiv;return c.updateCursor&&l.api.focus(l),4==c.position?d.parentNode.insertBefore(s,d.nextSibling):l.api.transformColor(l,s,!0,function(){switch(c.position){case 0:case 1:var e=0==c.position,t=(0,vc.getFirstLastBlockElement)(d,e);t?(t=e?t.getStartNode():t.getEndNode(),c.insertOnNewLine||3==t.nodeType||(0,vc.isVoidHtmlElement)(t)?(0,vc.safeInstanceOf)(s,"DocumentFragment")?(a=(0,vc.toArray)(s.childNodes),t.parentNode.insertBefore(s,e?t:t.nextSibling)):a=t.parentNode.insertBefore(s,e?t:t.nextSibling):a=t.insertBefore(s,e?t.firstChild:null)):a=d.appendChild(s),a&&c.insertOnNewLine&&(e=Array.isArray(a)?a:[a],(0,vc.isBlockElement)(e[0])&&(0,vc.isBlockElement)(e[e.length-1])||(0,vc.wrap)(e));break;case 2:t=d.appendChild(s);t&&c.insertOnNewLine&&!(0,vc.isBlockElement)(t)&&(0,vc.wrap)(t);break;case 5:case 3:a=c,e=(e=l).api.getSelectionRange(e,!0),t=null,5==a.position?(t=e,e=a.range):e&&(t=e.cloneRange());var n={range:e,rangeToRestore:t},r=n.range,n=n.rangeToRestore;if(!r)return;c.replaceSelection&&!r.collapsed&&r.deleteContents();var o=vc.Position.getStart(r),i=void 0,o=c.insertOnNewLine&&(i=(0,vc.getBlockElementAtNode)(d,o.normalize().node))?new vc.Position(i.getEndNode(),-3):(0,vc.adjustInsertPosition)(d,s,o,r),i=11==s.nodeType?s.lastChild:s;(r=(0,vc.createRange)(o)).insertNode(s),c.updateCursor&&i&&(n=(0,vc.createRange)(new vc.Position(i,-3).normalize())),l.api.selectRange(l,n)}var a},0),!0},{}),Yt=(Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.restoreUndoSnapshot=void 0,Ht.restoreUndoSnapshot=function(e,t){e.undo.hasNewContent&&t<0&&e.api.addUndoSnapshot(e,null,null,!1);t=e.undo.snapshotsService.move(t);if(null!=t)try{e.undo.isRestoring=!0,e.api.setContent(e,t,!0)}finally{e.undo.isRestoring=!1}},{}),mc=(Object.defineProperty(Yt,"__esModule",{value:!0}),Yt.selectRange=void 0,ze),yc=t,M=(Yt.selectRange=function(e,t,n){return!(e.lifecycle.shadowEditSelectionPath||!(0,yc.contains)(e.contentDiv,t)||((0,yc.addRangeToSelection)(t,n),(0,mc.hasFocus)(e)||(e.domEvent.selectionRange=t),t.collapsed&&(t=(n=e).contentDiv,i=n.pendingFormatState,e=n.api.getSelectionRange,i.pendableFormatState&&(r=t.ownerDocument,o=(0,yc.getPendableFormatState)(r),Object.keys(yc.PendableFormatCommandMap).forEach(function(e){!!i.pendableFormatState[e]!=o[e]&&r.execCommand(yc.PendableFormatCommandMap[e],!1,null)}),t=e(n,!0),i.pendableFormatPosition=t&&yc.Position.getStart(t))),0));var r,o,i},{}),bc=(Object.defineProperty(M,"__esModule",{value:!0}),M.selectTable=void 0,t),Ec="tableStyle";function Cc(e,t){if(e&&!e.id){for(var n=e.ownerDocument,r=function(e){return e.getElementById(t+o)},o=0,i=r(n);i;)i=r(n),o++;e.id=t+o}}M.selectTable=function(e,a,l){var t,c,i,h,p,g,v,m,y,d,u,f,b,s,E,n,r,o,C=e.contentDiv.ownerDocument.getElementById("tableStylecontentDiv_");if(null!==(t=null==C?void 0:C.sheet)&&void 0!==t&&t.cssRules)for(;0<C.sheet.cssRules.length;)C.sheet.deleteRule(0);return l&&a?(Cc(a,"tableSelected"),Cc(e.contentDiv,"contentDiv_"),e=(t=e).contentDiv.ownerDocument,n="#"+t.contentDiv.id,i=l,h=n,p=(i=function(t){function e(e){return t.rows.item(e.y).cells.item(e.x)}var n=i.firstCell,r=i.lastCell,o={x:Math.min(n.x,r.x),y:Math.min(n.y,r.y)},n={x:Math.max(n.x,r.x),y:Math.max(n.y,r.y)};if(!e(o)||!e(n))throw new Error("Table selection provided is not valid");return{firstCell:o,lastCell:n}}(c=a)).firstCell.y,g=i.firstCell.x,v=i.lastCell.y,m=i.lastCell.x,y=[],u=d=null,b=!(f=""),n=new bc.VTable(c),r=(0,bc.toArray)(c.childNodes).filter(function(e){return-1<["THEAD","TBODY","TFOOT"].indexOf((0,bc.getTagOfNode)(e))}),s=0,E=r.map(function(e){e={el:(0,bc.getTagOfNode)(e),start:s,end:e.childNodes.length+s};return s=e.end,e}),n.cells.forEach(function(e,t){var n=0,r=0;u=d=null;for(var o,i=E.filter(function(e){return e.start<=t&&e.end>t})[0],a=i?">"+i.el+">":">",l=i&&t+1>=i.start?t+1-i.start:t+1,s=0;s<e.length;s++)e[s].td&&("TD"==(o=(0,bc.getTagOfNode)(e[s].td))&&n++,"TH"==o&&r++,p<=t&&t<=v&&g<=s&&s<=m&&(b?b=!1:f.endsWith(",")||(f+=","),o=h+" #"+c.id+a+" tr:nth-child("+l+")>"+o+":nth-child("+("TD"==o?n:r)+")",f+=o,d=d||c.querySelector(o),u=c.querySelector(o))),d&&u&&((o=new Range).setStartBefore(d),o.setEndAfter(u),y.push(o))}),r={css:f+="{background-color: rgba(198,198,198,0.7) !important;}",ranges:y},n=r.css,r=r.ranges,(o=e.getElementById(Ec+t.contentDiv.id))||(o=e.createElement("style"),e.head.appendChild(o),o.id=Ec+t.contentDiv.id),o.sheet.insertRule(n),{type:1,ranges:e=r,table:a,areAllCollapsed:e.filter(function(e){return null==e?void 0:e.collapsed}).length==e.length,coordinates:l}):null};var de={},wc=(Object.defineProperty(de,"__esModule",{value:!0}),de.setContent=void 0,t),Un=(de.setContent=function(e,t,n){var r=!1;e.contentDiv.innerHTML!=t&&(e.api.triggerEvent(e,{eventType:20,newContent:t},!0),t=(0,wc.setHtmlWithSelectionPath)(e.contentDiv,t,e.trustedHTMLHandler),e.api.selectRange(e,t),r=!0),e.api.transformColor(e,e.contentDiv,!1,null,0),n&&(r||e.lifecycle.isDarkMode)&&e.api.triggerEvent(e,{eventType:7,source:"SetContent"},!1)},{}),Sc=(Object.defineProperty(Un,"__esModule",{value:!0}),Un.switchShadowEdit=void 0,t);Un.switchShadowEdit=function(e,t){var n=e.lifecycle,r=e.contentDiv,o=n.shadowEditFragment,i=n.shadowEditSelectionPath,a=!!o;t?(a||(i=(t=e.api.getSelectionRange(e,!0))&&(0,Sc.getSelectionPath)(r,t),o=e.contentDiv.ownerDocument.createDocumentFragment(),(0,Sc.moveChildNodes)(o,r),o.normalize(),e.api.triggerEvent(e,{eventType:17,fragment:o,selectionPath:i},!1),n.shadowEditFragment=o,n.shadowEditSelectionPath=i),(0,Sc.moveChildNodes)(r),r.appendChild(n.shadowEditFragment.cloneNode(!0))):(n.shadowEditFragment=null,n.shadowEditSelectionPath=null,a&&(e.api.triggerEvent(e,{eventType:18},!1),(0,Sc.moveChildNodes)(r),r.appendChild(o),e.api.focus(e),i&&e.api.selectRange(e,(0,Sc.createRange)(r,i.start,i.end))))};qn={};Object.defineProperty(qn,"__esModule",{value:!0}),qn.transformColor=void 0;var Pc=t,Tc=(0,[((v={})[0]="color",v[1]="color",v[2]="ogsc",v[3]="ogac",v),((m={})[0]="background-color",m[1]="bgcolor",m[2]="ogsb",m[3]="ogab",m)]);function Oc(n){Tc.forEach(function(e){n.style.setProperty(e[0],_c(n.dataset[e[2]],"")),delete n.dataset[e[2]];var t=n.dataset[e[3]];_c(t,null)?n.setAttribute(e[1],t):n.removeAttribute(e[1]),delete n.dataset[e[3]]})}function _c(e,t){return e&&"undefined"!=e&&"null"!=e?e:t}qn.transformColor=function(t,e,n,r,o){var i,a,n=t.lifecycle.isDarkMode?(e=e,n=n,a=[],(0,Pc.safeInstanceOf)(e,"HTMLElement")?(n&&a.push(e),i=e.getElementsByTagName("*"),(0,Pc.arrayPush)(a,(0,Pc.toArray)(i))):(0,Pc.safeInstanceOf)(e,"DocumentFragment")&&(i=e.querySelectorAll("*"),(0,Pc.arrayPush)(a,(0,Pc.toArray)(i))),a):[],l=1==o?Oc:t.lifecycle.onExternalContentTransform||function(e){var o,i,a;o=e,i=t.lifecycle.getDarkColor,a=(0,Pc.getComputedStyles)(o,["color","background-color"]),Tc.forEach(function(e,t){var n=o.style.getPropertyValue(e[0]),r=o.getAttribute(e[1]);o.dataset[e[2]]||o.dataset[e[3]]||!n&&!r||"inherit"==n||(t=i(a[t]||n||r),o.style.setProperty(e[0],t,"important"),o.dataset[e[2]]=n||"",r&&(o.setAttribute(e[1],t),o.dataset[e[3]]=r))})};null==r||r(),n.forEach(function(e){return(null==e?void 0:e.dataset)&&e.style&&l(e)})};var W={},he=(Object.defineProperty(W,"__esModule",{value:!0}),W.triggerEvent=void 0,W.triggerEvent=function(e,r,t){e.lifecycle.shadowEditFragment&&12!=r.eventType||!t&&e.plugins.some(function(e){return t=r,!(!(e=e).onPluginEvent||null===(n=e.willHandleEventExclusively)||void 0===n||!n.call(e,t))&&(e.onPluginEvent(t),!0);var t,n})||e.plugins.forEach(function(e){e.onPluginEvent&&e.onPluginEvent(r)})},Object.defineProperty(f,"__esModule",{value:!0}),f.coreApiMap=void 0,h),qe=(f.coreApiMap={attachDomEvent:g.attachDomEvent,addUndoSnapshot:he.addUndoSnapshot,createPasteFragment:Ae.createPasteFragment,ensureTypeInContainer:B.ensureTypeInContainer,focus:Et.focus,getContent:Be.getContent,getSelectionRange:vt.getSelectionRange,getSelectionRangeEx:He.getSelectionRangeEx,getStyleBasedFormatState:Ut.getStyleBasedFormatState,getPendableFormatState:Fe.getPendableFormatState,hasFocus:ze.hasFocus,insertNode:je.insertNode,restoreUndoSnapshot:Ht.restoreUndoSnapshot,selectRange:Yt.selectRange,setContent:de.setContent,switchShadowEdit:Un.switchShadowEdit,transformColor:qn.transformColor,triggerEvent:W.triggerEvent,selectTable:M.selectTable},{}),Xn={},xc=(Object.defineProperty(Xn,"__esModule",{value:!0}),t);function Nc(e){var n=this;this.onPaste=function(e){var t;(0,xc.extractClipboardEvent)(e,function(e){return n.editor.paste(e)},{allowLinkPreview:n.editor.isFeatureEnabled("PasteWithLinkPreview"),allowedCustomPasteType:n.state.allowedCustomPasteType,getTempDiv:function(){return t=n.editor.getSelectionRange(),n.getTempDiv()},removeTempDiv:function(e){n.cleanUpAndRestoreSelection(e,t)}})},this.state={allowedCustomPasteType:e.allowedCustomPasteType||[]}}Nc.prototype.getName=function(){return"CopyPaste"},Nc.prototype.initialize=function(e){var t=this;this.editor=e,this.disposer=this.editor.addDomEventHandler({paste:this.onPaste,copy:function(e){return t.onCutCopy(e,!1)},cut:function(e){return t.onCutCopy(e,!0)}})},Nc.prototype.dispose=function(){this.disposer(),this.disposer=null,this.editor=null},Nc.prototype.getState=function(){return this.state},Nc.prototype.onCutCopy=function(e,n){var r,o,i=this,t=this.editor.getSelectionRangeEx();t&&!t.areAllCollapsed&&(r=t.ranges[0],t=this.editor.getContent(2),o=this.getTempDiv(!0),(t=(0,xc.setHtmlWithSelectionPath)(o,t,this.editor.getTrustedHTMLHandler()))&&(0,xc.addRangeToSelection)(t),this.editor.triggerPluginEvent(9,{clonedRoot:o,range:t,rawEvent:e,isCut:n}),this.editor.runAsync(function(t){i.cleanUpAndRestoreSelection(o,r),n&&t.addUndoSnapshot(function(){var e=i.editor.deleteSelectedContent();t.focus(),t.select(e)},"Cut")}))},Nc.prototype.getTempDiv=function(e){var t=this,n=this.editor.getCustomData("CopyPasteTempDiv",function(){var e=(0,xc.createElement)(3,t.editor.getDocument());return t.editor.insertNode(e,{position:4}),e},function(e){var t;return null===(t=e.parentNode)||void 0===t?void 0:t.removeChild(e)});return e&&(n.style.backgroundColor="white",n.style.color="black"),n.style.display="",n.focus(),n},Nc.prototype.cleanUpAndRestoreSelection=function(e,t){xc.Browser.isAndroid&&t.collapse(),this.editor.select(t),e.style.backgroundColor="",e.style.color="",e.style.display="none",(0,xc.moveChildNodes)(e)},Xn.default=Nc;var n={},Rc=(Object.defineProperty(n,"__esModule",{value:!0}),t);function Lc(e,t){var o=this;this.onDrop=function(e){o.editor.runAsync(function(e){e.addUndoSnapshot(function(){},"Drop")})},this.onFocus=function(){o.editor.select(o.state.selectionRange),o.state.selectionRange=null},this.onKeyDownDocument=function(e){9!=e.which||e.defaultPrevented||o.cacheSelection()},this.onMouseDownDocument=function(e){o.state.selectionRange||o.editor.contains(e.target)||o.cacheSelection()},this.cacheSelection=function(){o.state.selectionRange||(o.state.selectionRange=o.editor.getSelectionRange(!1))},this.onScroll=function(e){o.editor.triggerPluginEvent(14,{rawEvent:e,scrollContainer:o.state.scrollContainer})},this.onKeyboardEvent=function(e){(0,Rc.isCharacterValue)(e)&&e.stopPropagation()},this.onInputEvent=function(e){e.stopPropagation()},this.onContextMenuEvent=function(e){var t=[],n=o.editor.getContentSearcherOfCursor(),n=null==n?void 0:n.getInlineElementBefore(),r=e.target;2!=e.button&&(r=null==n?void 0:n.getContainerNode()),o.state.contextMenuProviders.forEach(function(e){e=e.getContextMenuItems(r);0<(null==e?void 0:e.length)&&(0<t.length&&t.push(null),(0,Rc.arrayPush)(t,e))}),o.editor.triggerPluginEvent(16,{rawEvent:e,items:t})},this.state={isInIME:!1,scrollContainer:e.scrollContainer||t,selectionRange:null,stopPrintableKeyboardEventPropagation:!e.allowKeyboardEventPropagation,contextMenuProviders:(null===(t=e.plugins)||void 0===t?void 0:t.filter(kc))||[],tableSelectionRange:null}}function kc(e){return!(null===e||void 0===e||!e.getContextMenuItems)}Lc.prototype.getName=function(){return"DOMEvent"},Lc.prototype.initialize=function(t){var e,n,r=this,o=(this.editor=t,this.editor.getDocument());(n={keypress:this.getEventHandler(1),keydown:this.getEventHandler(0),keyup:this.getEventHandler(2),mousedown:5,contextmenu:this.onContextMenuEvent,compositionstart:function(){return r.state.isInIME=!0},compositionend:function(e){r.state.isInIME=!1,t.triggerPluginEvent(4,{rawEvent:e})},drop:this.onDrop,focus:this.onFocus})[Rc.Browser.isIE?"textinput":"input"]=this.getEventHandler(3);Rc.Browser.isSafari?(o.addEventListener("mousedown",this.onMouseDownDocument,!0),o.addEventListener("keydown",this.onKeyDownDocument),null===(e=o.defaultView)||void 0===e||e.addEventListener("blur",this.cacheSelection)):n[Rc.Browser.isIEOrEdge?"beforedeactivate":"blur"]=this.cacheSelection,this.disposer=t.addDomEventHandler(n),this.state.scrollContainer.addEventListener("scroll",this.onScroll),null===(e=o.defaultView)||void 0===e||e.addEventListener("scroll",this.onScroll),null===(n=o.defaultView)||void 0===n||n.addEventListener("resize",this.onScroll)},Lc.prototype.dispose=function(){var e,t=this.editor.getDocument();Rc.Browser.isSafari&&(t.removeEventListener("mousedown",this.onMouseDownDocument,!0),t.removeEventListener("keydown",this.onKeyDownDocument),null===(e=t.defaultView)||void 0===e||e.removeEventListener("blur",this.cacheSelection)),null===(e=t.defaultView)||void 0===e||e.removeEventListener("resize",this.onScroll),null===(e=t.defaultView)||void 0===e||e.removeEventListener("scroll",this.onScroll),this.state.scrollContainer.removeEventListener("scroll",this.onScroll),this.disposer(),this.disposer=null,this.editor=null},Lc.prototype.getState=function(){return this.state},Lc.prototype.getEventHandler=function(e){return this.state.stopPrintableKeyboardEventPropagation?{pluginEventType:e,beforeDispatch:3==e?this.onInputEvent:this.onKeyboardEvent}:e},n.default=Lc;var R={},Ic=(Object.defineProperty(R,"__esModule",{value:!0}),t);function Mc(){this.state={features:{}}}Mc.prototype.getName=function(){return"Edit"},Mc.prototype.initialize=function(e){this.editor=e},Mc.prototype.dispose=function(){this.editor=null},Mc.prototype.getState=function(){return this.state},Mc.prototype.onPluginEvent=function(e){var t,n,r,o=!1,i=!1;0==e.eventType?(t=e.rawEvent,n=this.editor.getSelectionRange(),o=(i=(0,Ic.isCtrlOrMetaPressed)(t))||t.altKey,r=this.state.features[t.which]||n&&!n.collapsed&&this.state.features[258]):7==e.eventType&&(r=this.state.features[257]);for(var a=0;a<(null==r?void 0:r.length);a++){var l=r[a];if((l.allowFunctionKeys||!o)&&l.shouldHandleEvent(e,this.editor,i)){l.handleEvent(e,this.editor);break}}},R.default=Mc;var $n={},Ac=(Object.defineProperty($n,"__esModule",{value:!0}),t),Dc=/_(\d{1,8})$/,jc=["^_Entity$","^_EId_","^_EType_","^_EReadonly_"],Bc=[6,7,4,5];function Fc(){var n=this;this.handleCutEvent=function(e){var t=n.editor.getSelectionRange();t&&!t.collapsed&&n.checkRemoveEntityForRange(e)},this.state={knownEntityElements:[],shadowEntityCache:{}}}Fc.prototype.getName=function(){return"Entity"},Fc.prototype.initialize=function(e){this.editor=e},Fc.prototype.willHandleEventExclusively=function(e){return 1==e.eventType&&!(null===(e=e.rawEvent.target)||void 0===e||!e.shadowRoot)},Fc.prototype.dispose=function(){this.editor=null,this.state.knownEntityElements=[]},Fc.prototype.getState=function(){return this.state},Fc.prototype.onPluginEvent=function(e){switch(e.eventType){case 6:this.handleMouseUpEvent(e);break;case 0:this.handleKeyDownEvent(e.rawEvent);break;case 9:e.isCut&&this.handleCutEvent(e.rawEvent);break;case 10:this.handleBeforePasteEvent(e.sanitizingOption);break;case 7:this.handleContentChangedEvent(e);break;case 11:this.handleContentChangedEvent();break;case 8:this.handleExtractContentWithDomEvent(e.clonedRoot);break;case 16:this.handleContextMenuEvent(e.rawEvent);break;case 20:this.handleBeforeSetContentEvent();break;case 15:this.handleEntityOperationEvent(e)}},Fc.prototype.handleContextMenuEvent=function(e){var t=e.target,t=t&&this.editor.getElementAtCursor((0,Ac.getEntitySelector)(),t);t&&(e.preventDefault(),this.triggerEvent(t,2,e))},Fc.prototype.handleMouseUpEvent=function(e){var t,n=e.rawEvent,e=e.isClicking,r=n.target;e&&r&&(t=this.editor.getElementAtCursor((0,Ac.getEntitySelector)(),r))&&(this.triggerEvent(t,1,n),Hc(this.editor))},Fc.prototype.handleKeyDownEvent=function(e){var t;!(0,Ac.isCharacterValue)(e)&&8!=e.which&&46!=e.which&&13!=e.which||(t=this.editor.getSelectionRange())&&!t.collapsed&&this.checkRemoveEntityForRange(e)},Fc.prototype.handleBeforePasteEvent=function(e){this.editor.getSelectionRange().collapsed||this.checkRemoveEntityForRange(null),(0,Ac.arrayPush)(e.additionalAllowedCssClasses,jc)},Fc.prototype.handleBeforeSetContentEvent=function(){this.cacheShadowEntities(this.state.shadowEntityCache)},Fc.prototype.handleContentChangedEvent=function(e){for(var i=this,t=this.state.knownEntityElements.length-1;0<=t;t--){var n=this.state.knownEntityElements[t];this.editor.contains(n)||(this.setIsEntityKnown(n,!1),n.shadowRoot&&this.triggerEvent(n,10))}var a=this.state.knownEntityElements.map(function(e){return null===(e=(0,Ac.getEntityFromElement)(e))||void 0===e?void 0:e.id}).filter(function(e){return!!e});("InsertEntity"==(null==e?void 0:e.source)&&e.data?[e.data]:this.getExistingEntities().filter(function(e){e=e.wrapper;return!i.isEntityKnown(e)})).forEach(function(e){var t=e.wrapper,n=e.type,r=e.id,o=e.isReadonly;e.id=i.ensureUniqueId(n,r,a),(0,Ac.commitEntity)(t,n,o,e.id),i.handleNewEntity(e)}),Object.keys(this.state.shadowEntityCache).forEach(function(e){i.triggerEvent(i.state.shadowEntityCache[e],6),delete i.state.shadowEntityCache[e]})},Fc.prototype.handleEntityOperationEvent=function(e){var t=this;0<=Bc.indexOf(e.operation)&&(null===(e=this.cancelAsyncRun)||void 0===e||e.call(this),this.cancelAsyncRun=this.editor.runAsync(function(){t.cancelAsyncRun=null,t.handleContentChangedEvent()}))},Fc.prototype.handleExtractContentWithDomEvent=function(e){var t=this;(0,Ac.toArray)(e.querySelectorAll((0,Ac.getEntitySelector)())).forEach(function(e){e.removeAttribute("contentEditable"),t.triggerEvent(e,8)})},Fc.prototype.checkRemoveEntityForRange=function(n){var r,o=this,t=[],e=(0,Ac.getEntitySelector)();this.editor.queryElements(e,1,function(e){e.isContentEditable?t.push(e):o.triggerEvent(e,6,n)}),0<t.length&&(r=this.editor.queryElements(e,2),t.forEach(function(e){var t=0<=r.indexOf(e);o.triggerEvent(e,t?6:7,n)}))},Fc.prototype.triggerEvent=function(e,t,n,r){e=e&&(0,Ac.getEntityFromElement)(e);e&&this.editor.triggerPluginEvent(15,{operation:t,rawEvent:n,entity:e,contentForShadowEntity:r})},Fc.prototype.handleNewEntity=function(e){var t=e.wrapper,n=this.editor.getDocument().createDocumentFragment(),r=this.state.shadowEntityCache[e.id];delete this.state.shadowEntityCache[e.id],null!=r&&r.shadowRoot&&(0,Ac.moveChildNodes)(n,r.shadowRoot),this.triggerEvent(t,0,void 0,n),n.firstChild?t.shadowRoot?(0,Ac.moveChildNodes)(t.shadowRoot,n):this.createShadowRoot(t,n):t.shadowRoot&&(this.triggerEvent(t,10),r=t.cloneNode(),(0,Ac.moveChildNodes)(r,t),this.editor.replaceNode(t,r),e.wrapper=r),this.setIsEntityKnown(e.wrapper,!0)},Fc.prototype.getExistingEntities=function(t){return this.editor.queryElements((0,Ac.getEntitySelector)()).map(Ac.getEntityFromElement).filter(function(e){return!(!e||t&&!e.wrapper.shadowRoot)})},Fc.prototype.createShadowRoot=function(e,t){var n;if(e.attachShadow)return n=e.attachShadow({mode:"open",delegatesFocus:!0}),e.contentEditable="false",this.triggerEvent(e,9),(0,Ac.moveChildNodes)(n,t),n},Fc.prototype.cacheShadowEntities=function(n){this.getExistingEntities(!0).forEach(function(e){var t=e.wrapper,e=e.id;n[e]=t})},Fc.prototype.ensureUniqueId=function(e,t,n){for(var r=Dc.exec(t),o=(r?t.substr(0,t.length-r[0].length):t)||e,i="",a=r&&parseInt(r[1])||0;;a++)if(n.indexOf(i=0<a?o+"_"+a:o)<0){n.push(i);break}return i},Fc.prototype.setIsEntityKnown=function(e,t){var n=this.state.knownEntityElements.indexOf(e);t&&n<0?this.state.knownEntityElements.push(e):!t&&0<=n&&this.state.knownEntityElements.splice(n,1)},Fc.prototype.isEntityKnown=function(e){return 0<=this.state.knownEntityElements.indexOf(e)},$n.default=Fc;var Hc=Ac.Browser.isIE?function(e){e.runAsync(function(t){var e=t.getCustomData("ENTITY_IE_FOCUS_BUTTON",function(){var e=(0,Ac.createElement)({tag:"button",style:"overflow:hidden;position:fixed;width:0;height:0;top:-1000px"},t.getDocument());return e.onblur=function(){e.style.display="none"},t.insertNode(e,{position:4}),e});(e.style.display="",Ac.addRangeToSelection)((0,Ac.createRange)(e,0))})}:function(){},H={},zc=(Object.defineProperty(H,"__esModule",{value:!0}),t),Uc="contenteditable",Vc=zc.Browser.isFirefox?((rr={}).enableObjectResizing=!1,rr.enableInlineTableEditing=!1,rr):zc.Browser.isIE?((or={}).defaultParagraphSeparator="div",or.AutoUrlDetect=!1,or):{},Wc={darkModeColor:"rgb(51,51,51)",lightModeColor:"rgb(255,255,255)"},qc={darkModeColor:"rgb(255,255,255)",lightModeColor:"rgb(0,0,0)"};function Kc(e,n){var r=this;this.initialContent=e.initialContent||n.innerHTML||"",this.contentDivFormat=(0,zc.getComputedStyles)(n),null===n.getAttribute(Uc)&&(this.initializer=function(){n.contentEditable="true",n.style.userSelect="text",n.style.webkitUserSelect="text"},this.disposer=function(){n.style.userSelect="",n.style.webkitUserSelect="",n.removeAttribute(Uc)}),this.adjustColor=e.doNotAdjustEditorColor?function(){}:function(){var e=Wc,t=r.state.isDarkMode;(0,zc.setColor)(n,qc,!1,t),(0,zc.setColor)(n,e,!0,t)},this.state={customData:{},defaultFormat:e.defaultFormat||null,isDarkMode:!!e.inDarkMode,getDarkColor:e.getDarkColor||function(e){return e},onExternalContentTransform:e.onExternalContentTransform,experimentalFeatures:e.experimentalFeatures||[],shadowEditFragment:null,shadowEditSelectionPath:null,shadowEditTableSelectionPath:null}}Kc.prototype.getName=function(){return"Lifecycle"},Kc.prototype.initialize=function(e){this.editor=e,this.recalculateDefaultFormat(),this.editor.setContent(this.initialContent,!1),null===(e=this.initializer)||void 0===e||e.call(this),this.adjustColor(),this.adjustBrowserBehavior(),this.editor.triggerPluginEvent(11,{},!0)},Kc.prototype.dispose=function(){var n=this;this.editor.triggerPluginEvent(12,{},!0),Object.keys(this.state.customData).forEach(function(e){var t=n.state.customData[e];t&&t.disposer&&t.disposer(t.value),delete n.state.customData[e]}),this.disposer&&(this.disposer(),this.disposer=null,this.initializer=null),this.editor=null},Kc.prototype.getState=function(){return this.state},Kc.prototype.onPluginEvent=function(e){7!=e.eventType||"SwitchToDarkMode"!=e.source&&"SwitchToLightMode"!=e.source||(this.state.isDarkMode="SwitchToDarkMode"==e.source,this.recalculateDefaultFormat(),this.adjustColor())},Kc.prototype.adjustBrowserBehavior=function(){var t=this;Object.keys(Vc).forEach(function(e){try{t.editor.getDocument().execCommand(e,!1,Vc[e])}catch(e){}})},Kc.prototype.recalculateDefaultFormat=function(){var e,t,n,r,o,i,d,a,l=this.state,s=l.defaultFormat,c=l.isDarkMode;c&&s&&(s.backgroundColors||(s.backgroundColors=Wc),s.textColors||(s.textColors=qc)),s&&0===Object.keys(s).length||(s=(l=s||{}).fontFamily,e=l.fontSize,t=l.textColor,n=l.textColors,r=l.backgroundColor,o=l.backgroundColors,i=l.bold,d=l.italic,l=l.underline,a=this.contentDivFormat,this.state.defaultFormat={fontFamily:s||a[0],fontSize:e||a[1],get textColor(){return n?c?n.darkModeColor:n.lightModeColor:t||a[2]},textColors:n,get backgroundColor(){return o?c?o.darkModeColor:o.lightModeColor:r||""},backgroundColors:o,bold:i,italic:d,underline:l})},H.default=Kc;C={};function Gc(){var t=this;this.onMouseUp=function(e){t.editor&&(t.removeMouseUpEventListener(),t.editor.triggerPluginEvent(6,{rawEvent:e,isClicking:t.mouseDownX==e.pageX&&t.mouseDownY==e.pageY}))}}Object.defineProperty(C,"__esModule",{value:!0}),Gc.prototype.getName=function(){return"MouseUp"},Gc.prototype.initialize=function(e){this.editor=e},Gc.prototype.dispose=function(){this.removeMouseUpEventListener(),this.editor=null},Gc.prototype.onPluginEvent=function(e){5!=e.eventType||this.mouseUpEventListerAdded||(this.editor.getDocument().addEventListener("mouseup",this.onMouseUp,!0),this.mouseUpEventListerAdded=!0,this.mouseDownX=e.rawEvent.pageX,this.mouseDownY=e.rawEvent.pageY)},Gc.prototype.removeMouseUpEventListener=function(){this.mouseUpEventListerAdded&&(this.mouseUpEventListerAdded=!1,this.editor.getDocument().removeEventListener("mouseup",this.onMouseUp,!0))},C.default=Gc;var ir={},Zc=(Object.defineProperty(ir,"__esModule",{value:!0}),t);function Yc(){this.state={pendableFormatPosition:null,pendableFormatState:null}}Yc.prototype.getName=function(){return"PendingFormatState"},Yc.prototype.initialize=function(e){this.editor=e},Yc.prototype.dispose=function(){this.editor=null,this.clear()},Yc.prototype.getState=function(){return this.state},Yc.prototype.onPluginEvent=function(e){switch(e.eventType){case 13:this.state.pendableFormatPosition=this.getCurrentPosition(),this.state.pendableFormatState=e.formatState;break;case 0:case 5:case 7:this.state.pendableFormatPosition&&!this.state.pendableFormatPosition.equalTo(this.getCurrentPosition())&&this.clear()}},Yc.prototype.clear=function(){this.state.pendableFormatPosition=null,this.state.pendableFormatState=null},Yc.prototype.getCurrentPosition=function(){var e=this.editor.getSelectionRange();return e&&Zc.Position.getStart(e).normalize()},ir.default=Yc;var se={},Xc=(Object.defineProperty(se,"__esModule",{value:!0}),t);function $c(){}$c.prototype.getName=function(){return"TypeInContainer"},$c.prototype.initialize=function(e){this.editor=e},$c.prototype.dispose=function(){this.editor=null},$c.prototype.onPluginEvent=function(t){var e,n;1==t.eventType&&(e=this.editor.getSelectionRange(),n=this.editor.isFeatureEnabled("AlwaysApplyDefaultFormat"),e&&!this.editor.contains((0,Xc.findClosestElementAncestor)(e.startContainer,null,n?"[style]":null))&&(e.collapsed?this.editor.ensureTypeInContainer(Xc.Position.getStart(e),t.rawEvent):this.editor.runAsync(function(e){e.ensureTypeInContainer(e.getFocusedPosition(),t.rawEvent)})))},se.default=$c;var Ve={},Qc=(Object.defineProperty(Ve,"__esModule",{value:!0}),t);function Jc(e){var n;this.state={snapshotsService:e.undoSnapshotService||(n=(0,Qc.createSnapshots)(1e7),{canMove:function(e){return(0,Qc.canMoveCurrentSnapshot)(n,e)},move:function(e){return(0,Qc.moveCurrentSnapshot)(n,e)},addSnapshot:function(e,t){return(0,Qc.addSnapshot)(n,e,t)},clearRedo:function(){return(0,Qc.clearProceedingSnapshots)(n)},canUndoAutoComplete:function(){return(0,Qc.canUndoAutoComplete)(n)}}),isRestoring:!1,hasNewContent:!1,isNested:!1,autoCompletePosition:null}}Jc.prototype.getName=function(){return"Undo"},Jc.prototype.initialize=function(e){this.editor=e},Jc.prototype.dispose=function(){this.editor=null},Jc.prototype.getState=function(){return this.state},Jc.prototype.willHandleEventExclusively=function(e){return 0==e.eventType&&8==e.rawEvent.which&&this.canUndoAutoComplete()},Jc.prototype.onPluginEvent=function(e){if(this.editor&&!this.editor.isInIME())switch(e.eventType){case 11:var t=this.editor.getUndoState();t.canUndo||t.canRedo||this.addUndoSnapshot();break;case 0:this.onKeyDown(e.rawEvent);break;case 1:this.onKeyPress(e.rawEvent);break;case 4:this.clearRedoForInput(),this.addUndoSnapshot();break;case 7:this.state.isRestoring||this.clearRedoForInput()}},Jc.prototype.onKeyDown=function(e){var t;8==e.which||46==e.which?(8==e.which&&this.canUndoAutoComplete()?(e.preventDefault(),this.editor.undo(),this.state.autoCompletePosition=null):(!(t=this.editor.getSelectionRange())||t.collapsed&&this.lastKeyPress==e.which&&!(0,Qc.isCtrlOrMetaPressed)(e)||this.addUndoSnapshot(),this.state.hasNewContent=!0),this.lastKeyPress=e.which):33<=e.which&&e.which<=40&&(this.state.hasNewContent&&this.addUndoSnapshot(),this.lastKeyPress=0)},Jc.prototype.onKeyPress=function(e){var t;e.metaKey||((t=this.editor.getSelectionRange())&&!t.collapsed||32==e.which&&32!=this.lastKeyPress||13==e.which?(this.addUndoSnapshot(),13==e.which&&(this.state.hasNewContent=!0)):this.clearRedoForInput(),this.lastKeyPress=e.which)},Jc.prototype.clearRedoForInput=function(){this.state.snapshotsService.clearRedo(),this.lastKeyPress=0,this.state.hasNewContent=!0},Jc.prototype.canUndoAutoComplete=function(){var e;return this.state.snapshotsService.canUndoAutoComplete()&&(null===(e=this.state.autoCompletePosition)||void 0===e?void 0:e.equalTo(this.editor.getFocusedPosition()))},Jc.prototype.addUndoSnapshot=function(){this.editor.addUndoSnapshot(),this.state.autoCompletePosition=null},Ve.default=Jc,Object.defineProperty(qe,"__esModule",{value:!0}),qe.getPluginState=void 0;var ed,td=Xn,nd=n,rd=R,od=$n,id=H,ad=C,ld=ir,sd=se,cd=Ve,dd=(qe.default=function(e,t){var n=t.corePluginOverride||{};return{typeInContainer:n.typeInContainer||new sd.default,edit:n.edit||new rd.default,pendingFormatState:n.pendingFormatState||new ld.default,_placeholder:null,typeAfterLink:null,undo:n.undo||new cd.default(t),domEvent:n.domEvent||new nd.default(t,e),mouseUp:n.mouseUp||new ad.default,copyPaste:n.copyPaste||new td.default(t),entity:n.entity||new od.default,lifecycle:n.lifecycle||new id.default(t,e)}},qe.getPluginState=function(e){return{domEvent:e.domEvent.getState(),pendingFormatState:e.pendingFormatState.getState(),edit:e.edit.getState(),lifecycle:e.lifecycle.getState(),undo:e.undo.getState(),entity:e.entity.getState(),copyPaste:e.copyPaste.getState()}},e&&e.__assign||function(){return(dd=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)}),ud=(Object.defineProperty(u,"__esModule",{value:!0}),f),fd=qe,a=t;function i(e,t){var n=this;if(void 0===t&&(t={}),"DIV"!=(0,a.getTagOfNode)(e))throw new Error("contentDiv must be an HTML DIV element");var r=(0,fd.default)(e,t),o=[];Object.keys(r).forEach(function(e){"_placeholder"==e?(0,a.arrayPush)(o,t.plugins):o.push(r[e])}),this.core=dd(dd({contentDiv:e,api:dd(dd({},ud.coreApiMap),t.coreApiOverride||{}),plugins:o.filter(function(e){return!!e})},(0,fd.getPluginState)(r)),{trustedHTMLHandler:t.trustedHTMLHandler||function(e){return e},sizeTransformer:t.sizeTransformer||function(e){return e}}),this.core.plugins.forEach(function(e){return e.initialize(n)}),this.ensureTypeInContainer(new a.Position(this.core.contentDiv,0).normalize())}i.prototype.dispose=function(){for(var e=this.core.plugins.length-1;0<=e;e--)this.core.plugins[e].dispose();this.core=null},i.prototype.isDisposed=function(){return!this.core},i.prototype.insertNode=function(e,t){return!!e&&this.core.api.insertNode(this.core,e,t)},i.prototype.deleteNode=function(e){return!(!e||!this.contains(e)||(e.parentNode.removeChild(e),0))},i.prototype.replaceNode=function(e,t,n){return!(!this.contains(e)||!t||(this.core.api.transformColor(this.core,n?t:null,!0,function(){return e.parentNode.replaceChild(t,e)},0),0))},i.prototype.getBlockElementAtNode=function(e){return(0,a.getBlockElementAtNode)(this.core.contentDiv,e)},i.prototype.contains=function(e){return(0,a.contains)(this.core.contentDiv,e)},i.prototype.queryElements=function(t,e,n){var r=this,o=[],i=(e=void 0===e?0:e)instanceof Function?0:e,e=(n=e instanceof Function?e:n,0==i?null:this.getSelectionRangeEx());return e?(e.ranges.forEach(function(e){o.push.apply(o,(0,a.queryElements)(r.core.contentDiv,t,n,i,e))}),o):(0,a.queryElements)(this.core.contentDiv,t,n,i,null)},i.prototype.collapseNodes=function(e,t,n){return(0,a.collapseNodes)(this.core.contentDiv,e,t,n)},i.prototype.isEmpty=function(e){return(0,a.isNodeEmpty)(this.core.contentDiv,e)},i.prototype.getContent=function(e){return this.core.api.getContent(this.core,e=void 0===e?0:e)},i.prototype.setContent=function(e,t){this.core.api.setContent(this.core,e,t=void 0===t?!0:t)},i.prototype.insertContent=function(e,t){var n,r;e&&(n=this.getDocument(),e=null!=(e=null===(e=(new DOMParser).parseFromString(this.core.trustedHTMLHandler(e),"text/html"))||void 0===e?void 0:e.body)&&e.childNodes?(0,a.toArray)(e.childNodes):[],t&&t.insertOnNewLine&&1<e.length&&(e=[(0,a.wrap)(e)]),r=n.createDocumentFragment(),e.forEach(function(e){return r.appendChild(e)}),this.insertNode(r,t))},i.prototype.deleteSelectedContent=function(){var e=this.getSelectionRange();return e&&!e.collapsed&&(0,a.deleteSelectedContent)(this.core.contentDiv,e)},i.prototype.paste=function(e,t,n){var r,o,i=this;e&&(e.snapshotBeforePaste?this.setContent(e.snapshotBeforePaste):e.snapshotBeforePaste=this.getContent(2),r=(r=this.getSelectionRange())&&a.Position.getStart(r),o=this.core.api.createPasteFragment(this.core,e,r,t,n),this.addUndoSnapshot(function(){return i.insertNode(o),e},"Paste"))},i.prototype.getSelectionRange=function(e){return this.core.api.getSelectionRange(this.core,e=void 0===e?!0:e)},i.prototype.getSelectionRangeEx=function(){return this.core.api.getSelectionRangeEx(this.core)},i.prototype.getSelectionPath=function(){var e=this.getSelectionRange();return e&&(0,a.getSelectionPath)(this.core.contentDiv,e)},i.prototype.hasFocus=function(){return this.core.api.hasFocus(this.core)},i.prototype.focus=function(){this.core.api.focus(this.core)},i.prototype.select=function(e,t,n,r){if(null!==e&&void 0!==e&&e.rows)return o=this.core.api.selectTable(this.core,e,t),!!(this.core.domEvent.tableSelectionRange=o);this.core.api.selectTable(this.core,null);var o=e?(0,a.safeInstanceOf)(e,"Range")?e:Array.isArray(e.start)&&Array.isArray(e.end)?(0,a.createRange)(this.core.contentDiv,e.start,e.end):(0,a.createRange)(e,t,n,r):null;return this.contains(o)&&this.core.api.selectRange(this.core,o)},i.prototype.getFocusedPosition=function(){var e=null===(e=this.getDocument().defaultView)||void 0===e?void 0:e.getSelection();if(this.contains(e&&e.focusNode))return new a.Position(e.focusNode,e.focusOffset);e=this.getSelectionRange();return e?a.Position.getStart(e):null},i.prototype.getElementAtCursor=function(t,n,e){var r=this;return e=n?null:e,(0,a.cacheGetEventData)(e,"GET_ELEMENT_AT_CURSOR_"+t,function(){var e;return n||(e=r.getFocusedPosition(),n=e&&e.node),n&&(0,a.findClosestElementAncestor)(n,r.core.contentDiv,t)})},i.prototype.isPositionAtBeginning=function(e){return(0,a.isPositionAtBeginningOf)(e,this.core.contentDiv)},i.prototype.getSelectedRegions=function(t){var n=this,e=(void 0===t&&(t=0),this.getSelectionRangeEx()),r=[];return e.ranges.forEach(function(e){r.push.apply(r,e?(0,a.getRegionsFromRange)(n.core.contentDiv,e,t):[])}),r.filter(function(e,t,n){return n.indexOf(e)===t})},i.prototype.addDomEventHandler=function(e,t){var n,t="string"==typeof e?((n={})[e]=t,n):e;return this.core.api.attachDomEvent(this.core,t)},i.prototype.triggerPluginEvent=function(e,t,n){e=dd({eventType:e},t);return this.core.api.triggerEvent(this.core,e,n),e},i.prototype.triggerContentChangedEvent=function(e,t){this.triggerPluginEvent(7,{source:e=void 0===e?"SetContent":e,data:t})},i.prototype.undo=function(){this.focus(),this.core.api.restoreUndoSnapshot(this.core,-1)},i.prototype.redo=function(){this.focus(),this.core.api.restoreUndoSnapshot(this.core,1)},i.prototype.addUndoSnapshot=function(e,t,n){this.core.api.addUndoSnapshot(this.core,e,t,n)},i.prototype.getUndoState=function(){var e=this.core.undo,t=e.hasNewContent,e=e.snapshotsService;return{canUndo:t||e.canMove(-1),canRedo:e.canMove(1)}},i.prototype.getDocument=function(){return this.core.contentDiv.ownerDocument},i.prototype.getScrollContainer=function(){return this.core.domEvent.scrollContainer},i.prototype.getCustomData=function(e,t,n){return(this.core.lifecycle.customData[e]=this.core.lifecycle.customData[e]||{value:t?t():void 0,disposer:n}).value},i.prototype.isInIME=function(){return this.core.domEvent.isInIME},i.prototype.getDefaultFormat=function(){return this.core.lifecycle.defaultFormat},i.prototype.getBodyTraverser=function(e){return a.ContentTraverser.createBodyTraverser(this.core.contentDiv,e)},i.prototype.getSelectionTraverser=function(e){return(e=null!=e?e:this.getSelectionRange())&&a.ContentTraverser.createSelectionTraverser(this.core.contentDiv,e)},i.prototype.getBlockTraverser=function(e){void 0===e&&(e=3);var t=this.getSelectionRange();return t&&a.ContentTraverser.createBlockTraverser(this.core.contentDiv,t,e)},i.prototype.getContentSearcherOfCursor=function(e){var t=this;return(0,a.cacheGetEventData)(e,"ContentSearcher",function(){var e=t.getSelectionRange();return e&&new a.PositionContentSearcher(t.core.contentDiv,a.Position.getStart(e))})},i.prototype.runAsync=function(e){var t=this,n=this.core.contentDiv.ownerDocument.defaultView||window,r=n.requestAnimationFrame(function(){!t.isDisposed()&&e&&e(t)});return function(){n.cancelAnimationFrame(r)}},i.prototype.setEditorDomAttribute=function(e,t){null===t?this.core.contentDiv.removeAttribute(e):this.core.contentDiv.setAttribute(e,t)},i.prototype.getEditorDomAttribute=function(e){return this.core.contentDiv.getAttribute(e)},i.prototype.getRelativeDistanceToEditor=function(e,t){if(this.contains(e)){var n,r=this.core.contentDiv,o=r.getBoundingClientRect(),e=e.getBoundingClientRect();if(o&&e)return n=e.left-(null==o?void 0:o.left),e=e.top-(null==o?void 0:o.top),t&&(n+=r.scrollLeft,e+=r.scrollTop),[n,e]}return null},i.prototype.addContentEditFeature=function(n){var r=this;null==n||n.keys.forEach(function(e){var t=r.core.edit.features[e]||[];t.push(n),r.core.edit.features[e]=t})},i.prototype.getStyleBasedFormatState=function(e){var t;return e||(e=(t=this.getSelectionRange())&&a.Position.getStart(t).normalize().node),this.core.api.getStyleBasedFormatState(this.core,e)},i.prototype.getPendableFormatState=function(e){return this.core.api.getPendableFormatState(this.core,e)},i.prototype.ensureTypeInContainer=function(e,t){this.core.api.ensureTypeInContainer(this.core,e,t)},i.prototype.setDarkModeState=function(e){var t;this.isDarkMode()!=e&&(t=this.getContent(0),this.triggerContentChangedEvent(e?"SwitchToDarkMode":"SwitchToLightMode"),this.setContent(t))},i.prototype.isDarkMode=function(){return this.core.lifecycle.isDarkMode},i.prototype.startShadowEdit=function(){this.core.api.switchShadowEdit(this.core,!0)},i.prototype.stopShadowEdit=function(){this.core.api.switchShadowEdit(this.core,!1)},i.prototype.isInShadowEdit=function(){return!!this.core.lifecycle.shadowEditFragment},i.prototype.isFeatureEnabled=function(e){return 0<=this.core.lifecycle.experimentalFeatures.indexOf(e)},i.prototype.getTrustedHTMLHandler=function(){return this.core.trustedHTMLHandler},i.prototype.getSizeTransformer=function(){return this.core.sizeTransformer},u.default=i,xt=d,Object.defineProperty(xt,"__esModule",{value:!0}),xt.Editor=void 0,ed=u,Object.defineProperty(xt,"Editor",{enumerable:!0,get:function(){return ed.default}});var hd,pd,gd,Ue={},cr={},T={},y={},Zt={},dr={},vd={},Vn={},q={},md=(Object.defineProperty(q,"__esModule",{value:!0}),t);function yd(e,t,n){e=1==t?Math.floor(e):Math.ceil(e);var r=n[n.length-1];if(e<=n[0])e=Math.max(e+t,1);else if(r<e||e==r&&1==t)e/=10,e=1==t?Math.floor(e):Math.ceil(e),e=Math.min(Math.max(10*(e+t),r),1e3);else if(1==t){for(var o=0;o<n.length;o++)if(e<n[o]){e=n[o];break}}else for(o=n.length-1;0<=o;o--)if(e>n[o]){e=n[o];break}return e}q.default=function(a,l){a.focus();var e,t,n=a.getSelectionRangeEx();n&&n.areAllCollapsed?(t=(e=n.ranges[0]).startContainer,"SPAN"!=(0,md.getTagOfNode)(t)||t.firstChild&&("BR"!=(0,md.getTagOfNode)(t.firstChild)||t.firstChild.nextSibling)?(t&&3==t.nodeType&&"​"==t.nodeValue&&"SPAN"==(0,md.getTagOfNode)(t.parentNode)||(a.addUndoSnapshot(),t=a.getDocument().createTextNode("​"),e.insertNode(t)),(0,md.applyTextStyle)(t,l),a.select(t,-1)):(a.addUndoSnapshot(),l(t))):a.addUndoSnapshot(function(){var o,i;n.ranges.forEach(function(e){for(var t=a.getSelectionTraverser(e),n=t&&t.currentInlineElement;n;){var r=t.getNextInlineElement();n.applyStyle(function(e,t){l(e,t),o=o||e,i=e}),n=r}}),o&&i&&0==n.type&&a.select(o,-2,i,-3)},"Format")},hd=Vn,Object.defineProperty(hd,"__esModule",{value:!0}),hd.getNewFontSize=hd.FONT_SIZES=void 0,pd=q,gd=t,hd.FONT_SIZES=[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72],hd.default=function(e,t,n){void 0===n&&(n=hd.FONT_SIZES);var r=0==t?1:-1;(0,pd.default)(e,function(e){var t=parseFloat((0,gd.getComputedStyle)(e,"font-size"));e.style.fontSize=yd(t,r,n)+"pt","normal"!=(0,gd.getComputedStyle)(e,"line-height")&&(e.style.lineHeight="normal")})},hd.getNewFontSize=yd;var ce={},Kn={},fr={},hr={},bd=(Object.defineProperty(hr,"__esModule",{value:!0}),t),Ed=(hr.default=function(e,t){var n,r;0<(null==t?void 0:t.length)&&(n=(r=e.getSelectionRange())&&bd.Position.getStart(r),r=r&&bd.Position.getEnd(r),t.forEach(function(e){return e.commit()}),e.select(n,r))},Object.defineProperty(fr,"__esModule",{value:!0}),hr),Cd=t,Lr=(fr.default=function(o,i,a){o.focus(),o.addUndoSnapshot(function(t,n){var e,r;a&&!a()||(e=o.getSelectedRegions(),r=Cd.VListChain.createListChains(e,null==t?void 0:t.node),e.forEach(function(e){return i(e,t,n,r)}),(0,Ed.default)(o,r)),o.select(t,n)},"Format")},{}),wd=(Object.defineProperty(Lr,"__esModule",{value:!0}),t),yo=(Lr.default=function(n,t){n.focus();function r(){return n.getDocument().execCommand(t,!1,null)}var e,o,i=n.getSelectionRangeEx();i&&i.areAllCollapsed?(n.addUndoSnapshot(),e=n.getPendableFormatState(!1),r(),(o=Object.keys(wd.PendableFormatCommandMap).filter(function(e){return wd.PendableFormatCommandMap[e]==t})[0])&&(e[o]=!e[o],n.triggerPluginEvent(13,{formatState:e}))):n.addUndoSnapshot(function(){var t;i.ranges.forEach(function(e){1==i.type&&n.select(e),r(),t=e}),t&&1==i.type&&(t.collapse(),n.select(t))},"Format")},{}),Sd=(Object.defineProperty(yo,"__esModule",{value:!0}),q),Pd=t,We=(yo.default=function(n,r){(0,Sd.default)(n,function(e,t){(0,Pd.setColor)(e,t?"":r,!0,n.isDarkMode())})},{}),kr={},Td=(Object.defineProperty(kr,"__esModule",{value:!0}),q),Od=t,_d=(kr.default=function(n,e,r){var t,o=[];(0,Td.default)(n,function(e,t){r(e,t);t=n.getElementAtCursor("LI",e);t&&-1===o.indexOf(t)&&o.push(t)}),t=[e],o.forEach(function(e){(0,Od.safeInstanceOf)(e,"HTMLLIElement")&&(0,Od.setListItemStyle)(e,t)})},Object.defineProperty(We,"__esModule",{value:!0}),kr),r=(We.default=function(e,n){(0,_d.default)(e,"font-family",function(e,t){e.style.fontFamily=t?"":n})},{}),xd=(Object.defineProperty(r,"__esModule",{value:!0}),kr),Nd=t,Co=(r.default=function(e,n){(0,xd.default)(e,"font-size",function(e,t){e.style.fontSize=t?"":n,"normal"!=(0,Nd.getComputedStyle)(e,"line-height")&&(e.style.lineHeight="normal")})},{}),Rd=(Object.defineProperty(Co,"__esModule",{value:!0}),kr),Ld=t,w=(Co.default=function(n,r,o){(0,Rd.default)(n,"color",function(e,t){o&&!o(e)||(0,Ld.setColor)(e,t?"":r,!1,n.isDarkMode())})},{}),kd=(Object.defineProperty(w,"__esModule",{value:!0}),Lr),Lo=(w.default=function(e){(0,kd.default)(e,"bold")},{}),Id=(Object.defineProperty(Lo,"__esModule",{value:!0}),Lr),wo=(Lo.default=function(e){(0,Id.default)(e,"italic")},{}),Md=(Object.defineProperty(wo,"__esModule",{value:!0}),Lr),Ad=(wo.default=function(e){(0,Md.default)(e,"underline")},Object.defineProperty(Kn,"__esModule",{value:!0}),fr),Dd=Lr,jd=yo,Bd=We,Fd=r,Hd=Co,zd=w,Ud=Lo,Vd=wo,Wd=t,qd=["font","text-decoration","color","background"],Kd="B,I,U,STRONG,EM,SUB,SUP,STRIKE,FONT,CENTER,H1,H2,H3,H4,H5,H6,UL,OL,LI,SPAN,P,BLOCKQUOTE,CODE,S,PRE".split(","),Gd=["href","src"],Zd=["TD","TH","TR","TABLE","TBODY","THEAD"];function Yd(e){var t=(0,Wd.toArray)(e.childNodes).map(Yd).every(function(e){return e}),n=(0,Wd.isBlockElement)(e),r=(0,Wd.getTagOfNode)(e);if(r)if(0<=Kd.indexOf(r)||t&&!(0,Wd.isVoidHtmlElement)(e)&&Zd.indexOf(r)<0)n&&!t&&(0,Wd.wrap)(e),(0,Wd.unwrap)(e);else for(var o=e,i=(0,Wd.safeInstanceOf)(o,"HTMLTableCellElement"),a=0,l=(0,Wd.toArray)(o.attributes);a<l.length;a++){var s=l[a];i&&"style"==s.name?Xd(o):Gd.indexOf(s.name.toLowerCase())<0&&0!=s.name.indexOf("data-")&&o.removeAttribute(s.name)}return n}function Xd(e){var t=(0,Wd.getStyles)(e),n={};return Object.keys(t).forEach(function(e){e.indexOf("border")<0&&(n[e]=t[e],delete t[e])}),(0,Wd.setStyles)(e,t),n}function $d(o){(0,Ad.default)(o,function(e){var t,n=(0,Wd.getSelectedBlockElementsInRegion)(e),r=(0,Wd.collapseNodesInRegion)(e,n);for(o.contains(e.rootNode)&&(n=Xd(e.rootNode),0<Object.keys(n).length&&(t=(0,Wd.wrap)((0,Wd.toArray)(e.rootNode.childNodes)),(0,Wd.setStyles)(t,n)));0<r.length&&(0,Wd.isNodeInRegion)(e,r[0].parentNode);)r=[(0,Wd.splitBalancedNodeRange)(r)];r.forEach(Yd)})}Kn.default=function e(t,n){switch(n=void 0===n?0:n){case 0:(i=t).focus(),i.addUndoSnapshot(function(){(0,Dd.default)(i,"removeFormat"),i.queryElements("[class]",1,function(e){return e.removeAttribute("class")});var t,e,n=i.getDefaultFormat(),r=0===Object.keys(n).length;i.queryElements("[style]",2,function(t){qd.forEach(function(e){return t.style.removeProperty(e)}),r&&""===t.getAttribute("style")&&t.removeAttribute("style")}),r||(n.fontFamily&&(0,Bd.default)(i,n.fontFamily),n.fontSize&&(0,Fd.default)(i,n.fontSize),n.textColor&&(e=0<(t=i.queryElements("a *, a",1)).length?function(e){return-1==t.indexOf(e)}:null,n.textColors?(0,Hd.default)(i,n.textColors,e):(0,Hd.default)(i,n.textColor,e)),n.backgroundColor&&(n.backgroundColors?(0,jd.default)(i,n.backgroundColors):(0,jd.default)(i,n.backgroundColor)),n.bold&&(0,zd.default)(i),n.italic&&(0,Ud.default)(i),n.underline&&(0,Vd.default)(i))},"Format");break;case 1:$d(t);break;default:((o=(r=t).getSelectionTraverser()).currentBlockElement&&o.getNextBlockElement()||!(r.getSelectionTraverser().currentInlineElement instanceof Wd.PartialInlineElement)?$d:e)(r)}var r,o,i},Object.defineProperty(ce,"__esModule",{value:!0});var Qd=Kn,bo=(ce.default=function(e){(0,Qd.default)(e,1)},{}),Jd=(Object.defineProperty(bo,"__esModule",{value:!0}),t),eu=/^[a-zA-Z]+:/i,tu=/^[\w.%+-]+@/i,nu=/^ftp\./i;function ru(e){return e.queryElements("a[href]",1)[0]}function ou(e,t){t&&e.textContent!=t&&(e.textContent=t)}bo.default=function(n,e,r,o){n.focus();e=e,i=new Jd.HtmlSanitizer,(t=document.createElement("a")).href=e||"",i.sanitize(t);var t,i,a,l,e=(t.getAttribute("href")||"").trim();e&&(i=(0,Jd.matchLink)(e),a=i?i.normalizedUrl:function(e){if(!e)return e;var t="";return(t=e.search(eu)<0?0==e.search(tu)?"mailto:":0==e.search(nu)?"ftp://":"http://":t)+e}(e),l=i?i.originalUrl:e,n.addUndoSnapshot(function(){var e=n.getSelectionRange(),t=null;return e&&e.collapsed?(t=ru(n))?(t.href=a,ou(t,o)):((t=n.getDocument().createElement("A")).textContent=o||l,t.href=a,n.insertNode(t)):(n.getDocument().execCommand("createLink",!1,a),ou(t=ru(n),o)),r&&t&&(t.title=r),t},"CreateLink"))};var V={},iu=e&&e.__assign||function(){return(iu=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},au=(Object.defineProperty(V,"__esModule",{value:!0}),V.getElementBasedFormatState=void 0,t);function lu(e,t){var n=(0,au.getTagOfNode)(e.getElementAtCursor("OL,UL",null,t)),t=(0,au.getTagOfNode)(e.getElementAtCursor("H1,H2,H3,H4,H5,H6",null,t));return{isBullet:"UL"==n,isNumbering:"OL"==n,headerLevel:t&&parseInt(t[1])||0,canUnlink:!!e.queryElements("a[href]",1)[0],canAddImageAltText:!!e.queryElements("img",1)[0],isBlockQuote:!!e.queryElements("blockquote",1)[0]}}V.getElementBasedFormatState=lu,V.default=function(e,t){return iu(iu(iu(iu({},e.getPendableFormatState(!1)),lu(e,t)),e.getStyleBasedFormatState()),e.getUndoState())};var F={},su=(Object.defineProperty(F,"__esModule",{value:!0}),t),Pi=(F.default=function(e,t,n,r,o,i){var a,n=(0,su.wrap)(n,r?"DIV":"SPAN"),i=(!r&&o&&(n.style.display="inline-block"),(0,su.commitEntity)(n,t,o),e.contains(n)||(o=t=void 0,o="number"==typeof i?i:(i?(t=e.getSelectionRange(),(a=(a=i.normalize().node)&&e.getElementAtCursor((0,su.getEntitySelector)(),a))&&(i=new su.Position(a,-3)),e.select(i)):e.focus(),3),e.insertNode(n,{updateCursor:!1,insertOnNewLine:r,replaceSelection:!0,position:o}),3==o&&(t?e.select(t):r||e.select(n,-3))),r&&(a=e.getDocument().createElement("BR"),n.parentNode.insertBefore(a,n.nextSibling)),(0,su.getEntityFromElement)(n));return e.triggerContentChangedEvent("InsertEntity",i),i},{}),cu=(Object.defineProperty(Pi,"__esModule",{value:!0}),t);function du(t,n){t.addUndoSnapshot(function(){var e=t.getDocument().createElement("img");e.src=n,e.style.maxWidth="100%",t.insertNode(e)},"Format")}Pi.default=function(t,e){"string"==typeof e?du(t,e):(0,cu.readFile)(e,function(e){e&&!t.isDisposed()&&du(t,e)})};var xi={},uu=(Object.defineProperty(xi,"__esModule",{value:!0}),t);xi.default=function(t,e,n,d){var r=t.getDocument(),o=r.createDocumentFragment(),i=r.createElement("table");o.appendChild(i),i.cellSpacing="0",i.cellPadding="1";for(var a=0;a<n;a++){var l=r.createElement("tr");i.appendChild(l);for(var s=0;s<e;s++){var c=r.createElement("td");l.appendChild(c),c.appendChild(r.createElement("br")),c.style.width=(c=e)<=4?"120px":c<=6?"100px":"70px"}}t.focus(),t.addUndoSnapshot(function(){var e=new uu.VTable(i);e.applyFormat(d),e.writeBack(),t.insertNode(o),t.runAsync(function(e){return e.select(new uu.Position(i,0).normalize())})},"Format")};var ki={},fu=(Object.defineProperty(ki,"__esModule",{value:!0}),t),Di=(ki.default=function(o,i){var a=o.getElementAtCursor("TD,TH");a&&o.addUndoSnapshot(function(e,t){var n=new fu.VTable(a),r=(n.edit(i),n.writeBack(),o.focus(),function(){var e=n.row,t=n.col;switch(i){case 0:t=0;break;case 1:e+=1,t=0;break;case 2:e=0;break;case 3:e=0,t+=1}return{newRow:e,newCol:t}}());o.select(n.getCell(r.newRow,r.newCol).td,0)},"Format")},{}),hu=(Object.defineProperty(Di,"__esModule",{value:!0}),t),zi=(Di.default=function(r,o,i){(i=i||r.getElementAtCursor("TABLE"))&&r.addUndoSnapshot(function(e,t){var n=new hu.VTable(i);n.applyFormat(o),n.writeBack(),r.focus(),r.select(e,t)},"Format")},{}),pu=(Object.defineProperty(zi,"__esModule",{value:!0}),t),Wi=(zi.default=function(n){n.focus(),n.addUndoSnapshot(function(e,t){n.queryElements("a[href]",1,pu.unwrap),n.select(e,t)},"Format")},{}),Ki=(Object.defineProperty(Wi,"__esModule",{value:!0}),Wi.default=function(e,t,n,r,o){return!(!t||!n)&&(!!(o="string"==typeof t?(o=o||e.getContentSearcherOfCursor())&&o.getRangeFromText(t,r):t)&&((t=e.getSelectionRange()).collapsed&&o.endContainer==t.startContainer&&o.endOffset==t.startOffset&&(r=!0),e.insertNode(n,{position:5,updateCursor:r,replaceSelection:!0,insertOnNewLine:!1,range:o}),!0))},{}),Zi=(Object.defineProperty(Ki,"__esModule",{value:!0}),Ki.default=function(e,t,n){t&&e.addUndoSnapshot(function(){t.style.transform="rotate("+n+"deg)"},"Format")},{}),gu=(Object.defineProperty(Zi,"__esModule",{value:!0}),Lr),Gi=(Zi.default=function(e,t){var n="justifyLeft",r="left";1==t?(n="justifyCenter",r="center"):2==t&&(n="justifyRight",r="right"),e.addUndoSnapshot(function(){(0,gu.default)(e,n),e.queryElements("[align]",1,function(e){return e.style.textAlign=r})},"Format")},{}),$i={},vu=(Object.defineProperty($i,"__esModule",{value:!0}),t);$i.default=function(e,t){for(var n,r,o=e.getSelectionTraverser(),i=o&&o.currentBlockElement,a=[];i;)r=void 0,(r=(n=i).getStartNode())==n.getEndNode()&&3==r.nodeType&&0<=["TR","TABLE"].indexOf((0,vu.getTagOfNode)(r.parentNode))||a.push(i),i=o.getNextBlockElement();a.forEach(function(e){e=e.collapseToSingleElement();t(e)})},Object.defineProperty(Gi,"__esModule",{value:!0});var mu=$i,ea=(Gi.default=function(n,r){n.focus(),n.addUndoSnapshot(function(e,t){(0,mu.default)(n,function(e){e.setAttribute("dir",0==r?"ltr":"rtl"),e.style.textAlign=0==r?"left":"right"}),n.select(e,t)},"Format")},{}),ta=(Object.defineProperty(ea,"__esModule",{value:!0}),ea.default=function(e,t){e.focus(),e.addUndoSnapshot(function(){e.queryElements("img",1,function(e){return e.setAttribute("alt",t)})},"Format")},{}),yu=(Object.defineProperty(ta,"__esModule",{value:!0}),fr),bu=t;function Eu(e,t){e=(0,bu.collapseNodesInRegion)(e,t);(0,bu.wrap)(e,2)}function Cu(n,e){e.forEach(function(e){var t=e.collapseToSingleElement(),e=(0,bu.findClosestElementAncestor)(t,n.rootNode,"blockquote");if(e){for(t==e&&(t=(0,bu.wrap)((0,bu.toArray)(t.childNodes)));(0,bu.isNodeInRegion)(n,t)&&"BLOCKQUOTE"!=(0,bu.getTagOfNode)(t);)t=(0,bu.splitBalancedNodeRange)(t);(0,bu.isNodeInRegion)(n,t)&&(0,bu.unwrap)(t)}})}ta.default=function(e,s){var c=0==s?Eu:Cu;(0,yu.default)(e,function(t,e,n){for(var r=(0,bu.getSelectedBlockElementsInRegion)(t,!0),o=[[]],i=0;i<r.length;i++){var a=r[i].getStartNode(),l=(0,bu.createVListFromRegion)(t,!0,a);if(l){for(o.push([]);r[i+1]&&l.contains(r[i+1].getStartNode());)i++;l.setIndentation(e,n,s),l.writeBack()}else o[o.length-1].push(r[i])}o.forEach(function(e){return c(t,e)})})};var wu,Su,Pu,Tu,Ou,_u,xu,Nu,Ru,Lu,ku,Iu,Mu,Au,Du,ju,Bu,Fu,Hu,zu,Uu,Vu,Wu,qu,Ku,Gu,Zu,Yu,Xu,$u,Qu,Ju,ef,tf,nf,rf,of,af,na={},lf=(Object.defineProperty(na,"__esModule",{value:!0}),q),sf=t,ra=(na.default=function(e,i,n){function r(e,t){switch(i){case"lowercase":return e.toLocaleLowerCase(t);case"uppercase":return e.toLocaleUpperCase(t);case"capitalize":for(var n=e.toLocaleLowerCase(t).split(" "),r=0;r<n.length;r++)n[r]=n[r].charAt(0).toLocaleUpperCase(t)+n[r].slice(1);return n.join(" ");case"sentence":var o=new RegExp("^\\s*\\w|[\\.\\!\\?]\\s+\\w","g");return e.toLocaleLowerCase(t).replace(o,function(e){return e.toLocaleUpperCase(t)})}}(0,lf.default)(e,function(e){for(var t=(0,sf.getFirstLeafNode)(e);t;t=(0,sf.getNextLeafSibling)(e,t))if(3==t.nodeType)try{t.textContent=r(t.textContent,n)}catch(e){t.textContent=r(t.textContent,void 0)}})},{}),ui={},cf=(Object.defineProperty(ui,"__esModule",{value:!0}),fr),df=t,uf=(ui.default=function(e,o,i,a){void 0===a&&(a=!0),(0,cf.default)(e,function(e,t,n,r){var r=0<i&&r.filter(function(e){return e.canAppendAtCursor(i)})[0],r=r&&t.equalTo(n)?r.createVListAtBlock(null===(r=(0,df.getBlockElementAtNode)(e.rootNode,t.node))||void 0===r?void 0:r.collapseToSingleElement(),i):(0,df.createVListFromRegion)(e,a);r&&(r.changeListType(t,n,o),r.writeBack())})},Object.defineProperty(ra,"__esModule",{value:!0}),ui),ia=(ra.default=function(e){(0,uf.default)(e,2)},{}),ff=(Object.defineProperty(ia,"__esModule",{value:!0}),ui),la=(ia.default=function(e,t){(0,ff.default)(e,1,t)},{}),hf=(Object.defineProperty(la,"__esModule",{value:!0}),t),xa=(la.default=function(t,n,r){void 0===r&&(r=1),t.addUndoSnapshot(function(){t.focus();var e=t.getSelectedRegions();!e[0]||(e=(0,hf.createVListFromRegion)(e[0],!1,n))&&(e.split(n,r),e.writeBack())},"Format")},{}),Na={},pf=(Object.defineProperty(Na,"__esModule",{value:!0}),fr),gf=t,vf=(Na.default=function(e,r,t){(0,pf.default)(e,function(e){var t=(0,gf.getSelectedBlockElementsInRegion)(e,!0),n=(0,gf.collapseNodesInRegion)(e,t);if(0<n.length){for(1==n.length&&("BR"==(t=(0,gf.getTagOfNode)(n[0]))?n=[(0,gf.wrap)(n[0])]:"LI"!=t&&"TD"!=t||(n=(0,gf.toArray)(n[0].childNodes)));n[0]&&(0,gf.isNodeInRegion)(e,n[0].parentNode)&&n.some(function(e){return"LI"==(0,gf.getTagOfNode)(e)});)n=[(0,gf.splitBalancedNodeRange)(n)];r(n)}},t)},Object.defineProperty(xa,"__esModule",{value:!0}),Na),mf=t,Ra=(xa.default=function(e,t){(0,vf.default)(e,function(e){e=(0,mf.wrap)(e,"blockquote");(t||function(e){e.style.borderLeft="3px solid",e.style.borderColor="#C8C8C8",e.style.paddingLeft="10px",e.style.color="#666666"})(e)},function(){return 0==e.queryElements("blockquote",1,mf.unwrap).length})},{}),yf=(Object.defineProperty(Ra,"__esModule",{value:!0}),Na),bf=t,La=(Ra.default=function(e,t){(0,yf.default)(e,function(e){e=(0,bf.wrap)(e,"code"),e=(0,bf.wrap)(e,"pre");null==t||t(e)},function(){return 0==e.queryElements("pre>code",1,function(e){var t;e.previousSibling||e.nextSibling||(t=e.parentNode,(0,bf.unwrap)(e),(0,bf.unwrap)(t))}).length})},{}),Ef=(Object.defineProperty(La,"__esModule",{value:!0}),Lr),ka=(La.default=function(e){(0,Ef.default)(e,"strikeThrough")},{}),Cf=(Object.defineProperty(ka,"__esModule",{value:!0}),Lr),Ia=(ka.default=function(e){(0,Cf.default)(e,"subscript")},{}),wf=(Object.defineProperty(Ia,"__esModule",{value:!0}),Lr),Aa=(Ia.default=function(e){(0,wf.default)(e,"superscript")},{}),Sf=(Object.defineProperty(Aa,"__esModule",{value:!0}),t),Ir=(Aa.default=function(i,a){a=Math.min(Math.max(Math.round(a),0),6),i.addUndoSnapshot(function(){i.focus();var n=!1;if(i.queryElements("H1,H2,H3,H4,H5,H6",1,function(e){n||(i.getDocument().execCommand("formatBlock",!1,"<DIV>"),n=!0);var t=i.getDocument().createElement("div");(0,Sf.moveChildNodes)(t,e),i.replaceNode(e,t)}),0<a){for(var e=i.getSelectionTraverser(),t=e?e.currentBlockElement:null,r=new Sf.HtmlSanitizer({cssStyleCallbacks:{"font-size":function(){return!1}}});t;){var o=t.collapseToSingleElement();r.sanitize(o),t=e.getNextBlockElement()}i.getDocument().execCommand("formatBlock",!1,"<H"+a+">")}},"Format")},{}),Pf=(Object.defineProperty(Ir,"__esModule",{value:!0}),t),Tf=(Ir.default=function(t,n){t.focus(),t.addUndoSnapshot(function(){t.getSelectedRegions().forEach(function(e){(0,Pf.safeInstanceOf)(e.rootNode,"HTMLTableCellElement")&&((0,Pf.setColor)(e.rootNode,n,!0,t.isDarkMode()),e.rootNode.dataset.cellShade="true",e.rootNode.dataset.originalBackgroundColor=e.rootNode.style.backgroundColor)})})},o=vd,Object.defineProperty(o,"__esModule",{value:!0}),o.experimentCommitListChains=o.blockFormat=o.toggleListType=o.applyCellShading=o.toggleHeader=o.toggleUnderline=o.toggleSuperscript=o.toggleSubscript=o.toggleStrikethrough=o.toggleCodeBlock=o.toggleBlockQuote=o.setOrderedListNumbering=o.toggleNumbering=o.toggleItalic=o.toggleBullet=o.toggleBold=o.changeCapitalization=o.setIndentation=o.setImageAltText=o.setFontSize=o.setFontName=o.setDirection=o.setTextColor=o.setBackgroundColor=o.setAlignment=o.rotateElement=o.replaceWithNode=o.removeLink=o.formatTable=o.editTable=o.insertTable=o.insertImage=o.insertEntity=o.getElementBasedFormatState=o.getFormatState=o.createLink=o.clearFormat=o.clearBlockFormat=o.FONT_SIZES=o.changeFontSize=void 0,wu=Vn,Object.defineProperty(o,"changeFontSize",{enumerable:!0,get:function(){return wu.default}}),Object.defineProperty(o,"FONT_SIZES",{enumerable:!0,get:function(){return wu.FONT_SIZES}}),Su=ce,Object.defineProperty(o,"clearBlockFormat",{enumerable:!0,get:function(){return Su.default}}),Pu=Kn,Object.defineProperty(o,"clearFormat",{enumerable:!0,get:function(){return Pu.default}}),Tu=bo,Object.defineProperty(o,"createLink",{enumerable:!0,get:function(){return Tu.default}}),Ou=V,Object.defineProperty(o,"getFormatState",{enumerable:!0,get:function(){return Ou.default}}),Object.defineProperty(o,"getElementBasedFormatState",{enumerable:!0,get:function(){return Ou.getElementBasedFormatState}}),_u=F,Object.defineProperty(o,"insertEntity",{enumerable:!0,get:function(){return _u.default}}),xu=Pi,Object.defineProperty(o,"insertImage",{enumerable:!0,get:function(){return xu.default}}),Nu=xi,Object.defineProperty(o,"insertTable",{enumerable:!0,get:function(){return Nu.default}}),Ru=ki,Object.defineProperty(o,"editTable",{enumerable:!0,get:function(){return Ru.default}}),Lu=Di,Object.defineProperty(o,"formatTable",{enumerable:!0,get:function(){return Lu.default}}),ku=zi,Object.defineProperty(o,"removeLink",{enumerable:!0,get:function(){return ku.default}}),Iu=Wi,Object.defineProperty(o,"replaceWithNode",{enumerable:!0,get:function(){return Iu.default}}),Mu=Ki,Object.defineProperty(o,"rotateElement",{enumerable:!0,get:function(){return Mu.default}}),Au=Zi,Object.defineProperty(o,"setAlignment",{enumerable:!0,get:function(){return Au.default}}),Du=yo,Object.defineProperty(o,"setBackgroundColor",{enumerable:!0,get:function(){return Du.default}}),ju=Co,Object.defineProperty(o,"setTextColor",{enumerable:!0,get:function(){return ju.default}}),Bu=Gi,Object.defineProperty(o,"setDirection",{enumerable:!0,get:function(){return Bu.default}}),Fu=We,Object.defineProperty(o,"setFontName",{enumerable:!0,get:function(){return Fu.default}}),Hu=r,Object.defineProperty(o,"setFontSize",{enumerable:!0,get:function(){return Hu.default}}),zu=ea,Object.defineProperty(o,"setImageAltText",{enumerable:!0,get:function(){return zu.default}}),Uu=ta,Object.defineProperty(o,"setIndentation",{enumerable:!0,get:function(){return Uu.default}}),Vu=na,Object.defineProperty(o,"changeCapitalization",{enumerable:!0,get:function(){return Vu.default}}),Wu=w,Object.defineProperty(o,"toggleBold",{enumerable:!0,get:function(){return Wu.default}}),qu=ra,Object.defineProperty(o,"toggleBullet",{enumerable:!0,get:function(){return qu.default}}),Ku=Lo,Object.defineProperty(o,"toggleItalic",{enumerable:!0,get:function(){return Ku.default}}),Gu=ia,Object.defineProperty(o,"toggleNumbering",{enumerable:!0,get:function(){return Gu.default}}),Zu=la,Object.defineProperty(o,"setOrderedListNumbering",{enumerable:!0,get:function(){return Zu.default}}),Yu=xa,Object.defineProperty(o,"toggleBlockQuote",{enumerable:!0,get:function(){return Yu.default}}),Xu=Ra,Object.defineProperty(o,"toggleCodeBlock",{enumerable:!0,get:function(){return Xu.default}}),$u=La,Object.defineProperty(o,"toggleStrikethrough",{enumerable:!0,get:function(){return $u.default}}),Qu=ka,Object.defineProperty(o,"toggleSubscript",{enumerable:!0,get:function(){return Qu.default}}),Ju=Ia,Object.defineProperty(o,"toggleSuperscript",{enumerable:!0,get:function(){return Ju.default}}),ef=wo,Object.defineProperty(o,"toggleUnderline",{enumerable:!0,get:function(){return ef.default}}),tf=Aa,Object.defineProperty(o,"toggleHeader",{enumerable:!0,get:function(){return tf.default}}),nf=Ir,Object.defineProperty(o,"applyCellShading",{enumerable:!0,get:function(){return nf.default}}),rf=ui,Object.defineProperty(o,"toggleListType",{enumerable:!0,get:function(){return rf.default}}),of=fr,Object.defineProperty(o,"blockFormat",{enumerable:!0,get:function(){return of.default}}),af=hr,Object.defineProperty(o,"experimentCommitListChains",{enumerable:!0,get:function(){return af.default}}),Object.defineProperty(dr,"__esModule",{value:!0}),dr.AutoLinkFeatures=void 0,vd),Of=t,_f=/[.+=\s:;"',>]+$/i;function xf(r,o){return 0==r.eventType||7==r.eventType&&"Paste"==r.source?(0,Of.cacheGetEventData)(r,"LINK_DATA",function(){var e=7==r.eventType&&"Paste"==r.source&&r.data,e=(0,Of.matchLink)((e.text||"").trim()),t=o.getContentSearcherOfCursor(r);if(e&&t.getRangeFromText(e.originalUrl,!1))return e;var n,e=t&&t.getWordBefore();return e&&5<e.length?(t=(e.match(_f)||[])[0]||"",n=e.substring(0,e.length-t.length),["()","{}","[]"].forEach(function(e){n[n.length-1]==e[1]&&n.indexOf(e[0])<0&&(n=n.substr(0,n.length-1))}),(0,Of.matchLink)(n)):null}):null}dr.AutoLinkFeatures={autoLink:{keys:[13,32,257],shouldHandleEvent:xf,handleEvent:function(t,e){var n=e.getDocument().createElement("a"),r=xf(t,e),o=e.getContentSearcherOfCursor();n.textContent=r.originalUrl,n.href=r.normalizedUrl,e.runAsync(function(e){e.addUndoSnapshot(function(){return(0,Tf.replaceWithNode)(e,r.originalUrl,n,!1,o),(0,Of.clearEventDataCache)(t),n},"AutoLink",!0)})}},unlinkWhenBackspaceAfterLink:{keys:[8],shouldHandleEvent:function(e,t){return t.getContentSearcherOfCursor(e).getInlineElementBefore()instanceof Of.LinkInlineElement},handleEvent:function(e,t){e.rawEvent.preventDefault(),(0,Tf.removeLink)(t)},defaultDisabled:!0}};var ja={},Nf=(Object.defineProperty(ja,"__esModule",{value:!0}),ja.CursorFeatures=void 0,t),il={keys:[37,39],allowFunctionKeys:!0,shouldHandleEvent:function(e,t,n){var r;if(!(n&&(o=t.getSelectionRange())&&o.collapsed&&(r=Nf.Position.getStart(o))&&t.isPositionAtBeginning(r)))return!1;var n="rtl"==(0,Nf.getComputedStyle)(r.element,"direction"),o=e.rawEvent;return!n&&37==o.which||n&&39==o.which},handleEvent:function(e){e.rawEvent.preventDefault()},defaultDisabled:!Nf.Browser.isChrome},Ys=(ja.CursorFeatures={noCycleCursorMove:il},{}),Rf=(Object.defineProperty(Ys,"__esModule",{value:!0}),Ys.EntityFeatures=void 0,t);function Lf(t,n,e){var r=(0,Rf.cacheGetEventData)(t,"READONLY_ENTITY_ELEMENT",function(){var e=t.rawEvent.target,e=e&&n.getElementAtCursor((0,Rf.getEntitySelector)(),e);return e&&!e.isContentEditable?e:null});return r&&void 0!==e&&n.triggerPluginEvent(15,{operation:e,rawEvent:t.rawEvent,entity:(0,Rf.getEntityFromElement)(r)}),r}function kf(e,r,o,i,t){var n=(0,Rf.cacheGetEventData)(e,"NEIGHBOR_ENTITY_ELEMENT_"+o+"_"+i,function(){var e=r.getSelectionRange();if(i&&!e.collapsed)return null;e.commonAncestorContainer.normalize();var t,e=Rf.Position.getEnd(e).normalize(),n=null;return 0!=e.offset&&!e.isAtEnd||(t=r.getBodyTraverser(e.node),t=(t=o?0==e.offset?t.currentInlineElement:t.getNextInlineElement():e.isAtEnd?t.currentInlineElement:t.getPreviousInlineElement())&&t.getContainerNode(),i||((e=r.getBlockElementAtNode(e.node))&&e.contains(t)||(t=null)),n=t&&r.getElementAtCursor((0,Rf.getEntitySelector)(),t)),n});return n&&void 0!==t&&r.triggerPluginEvent(15,{operation:t,rawEvent:e.rawEvent,entity:(0,Rf.getEntityFromElement)(n)}),n}Ys.EntityFeatures={clickOnEntity:{keys:[13],shouldHandleEvent:function(e,t){return Lf(e,t)},handleEvent:function(e,t){Lf(e,t,1)}},escapeFromEntity:{keys:[27],shouldHandleEvent:function(e,t){return Lf(e,t)},handleEvent:function(e,t){Lf(e,t,3)}},enterBeforeReadonlyEntity:{keys:[13],shouldHandleEvent:function(e,t){return kf(e,t,!0,!1)},handleEvent:function(e,t){e.rawEvent.preventDefault();var e=t.getSelectionRange(),e=Rf.Position.getEnd(e).normalize().node,n=t.getDocument().createElement("BR");e.parentNode.insertBefore(n,e.nextSibling);var r,e=t.getBlockElementAtNode(e);e&&(r=e.collapseToSingleElement(),null===(e=n.parentNode)||void 0===e||e.removeChild(n)),t.getSelectionRange().deleteContents(),r.nextSibling&&t.select(r.nextSibling,0)}},backspaceAfterEntity:{keys:[8],shouldHandleEvent:function(e,t){return kf(e,t,!1,!0)},handleEvent:function(e,t){kf(e,t,!1,!0,5)}},deleteBeforeEntity:{keys:[46],shouldHandleEvent:function(e,t){return kf(e,t,!0,!0)},handleEvent:function(e,t){kf(e,t,!0,!0,4)}}};var l={},If=(Object.defineProperty(l,"__esModule",{value:!0}),l.ListFeatures=void 0,vd),Mf=t,v={keys:[13],shouldHandleEvent:function(e,t){t=t.getElementAtCursor("LI",null,e);return!e.rawEvent.shiftKey&&t&&(0,Mf.isNodeEmpty)(t)},handleEvent:function(e,t){t.addUndoSnapshot(function(){return Bf(e,t,!1)},null,!0)},defaultDisabled:!Mf.Browser.isIE&&!Mf.Browser.isChrome};function Af(e){return/^(\*|-|[0-9]{1,2}\.|[0-9]{1,2}\>|[0-9]{1,2}\)|[0-9]{1,2}\-|\([0-9]{1,2}\))$/.test(e)}function Df(e){return Mf.VListChain.createListChains(e.getSelectedRegions())}function jf(e,t){var n,r=e.getBlockElementAtNode(t.startContainer),r=null==r?void 0:r.getEndNode();r&&"BR"!=(0,Mf.getTagOfNode)(r)&&(n=e.getDocument().createElement("BR"),(0,Mf.isBlockElement)(r)?r.appendChild(n):r.parentNode.insertBefore(n,r.nextSibling),e.select(t.startContainer,t.startOffset))}function Bf(e,t,n){void 0===n&&(n=!0);var r=Ff(e,t);r&&(r=r[0],"UL"!=(r=(0,Mf.getTagOfNode)(r))&&"OL"!=r||(0,If.toggleListType)(t,"UL"==r?2:1,null,n),t.focus(),e.rawEvent.preventDefault())}function Ff(e,t){e=t.getElementAtCursor("LI,TABLE",null,e),t=e&&"LI"==(0,Mf.getTagOfNode)(e)&&t.getElementAtCursor("UL,OL",e);return t?[t,e]:null}l.ListFeatures={autoBullet:{keys:[32],shouldHandleEvent:function(e,t){return!Ff(e,t)&&(Af((t=t.getContentSearcherOfCursor(e)).getSubStringBefore(4))&&!t.getNearestNonTextInlineElement())},handleEvent:function(e,o){o.insertContent("&nbsp;"),e.rawEvent.preventDefault(),o.addUndoSnapshot(function(){var e,t=o.getContentSearcherOfCursor(),n=t.getSubStringBefore(4),r=t.getRangeFromText(n,!0);r&&(0==n.indexOf("*")||0==n.indexOf("-")?(jf(o,r),(0,If.toggleBullet)(o)):Af(n)?(jf(o,r),(0,If.toggleNumbering)(o)):(e=o.getSelectedRegions())&&1==e.length&&(e=parseInt(n),jf(o,r),(0,If.toggleNumbering)(o,e))),null===(r=t.getRangeFromText(n,!0))||void 0===r||r.deleteContents()},null,!0)}},indentWhenTab:{keys:[9],shouldHandleEvent:function(e,t){return!e.rawEvent.shiftKey&&Ff(e,t)},handleEvent:function(e,t){(0,If.setIndentation)(t,0),e.rawEvent.preventDefault()}},outdentWhenShiftTab:{keys:[9],shouldHandleEvent:function(e,t){return e.rawEvent.shiftKey&&Ff(e,t)},handleEvent:function(e,t){(0,If.setIndentation)(t,1),e.rawEvent.preventDefault()}},outdentWhenBackspaceOnEmptyFirstLine:{keys:[8],shouldHandleEvent:function(e,t){t=t.getElementAtCursor("LI",null,e);return t&&(0,Mf.isNodeEmpty)(t)&&!t.previousSibling},handleEvent:Bf},outdentWhenEnterOnEmptyLine:v,mergeInNewLineWhenBackspaceOnFirstChar:{keys:[8],shouldHandleEvent:function(e,t){e=t.getElementAtCursor("LI",null,e),t=t.getSelectionRange();return e&&(null==t?void 0:t.collapsed)&&(0,Mf.isPositionAtBeginningOf)(Mf.Position.getStart(t),e)},handleEvent:function(r,e){var o=e.getElementAtCursor("LI",null,r);o.previousSibling?(0,If.blockFormat)(e,function(e,t,n){e=(0,Mf.createVListFromRegion)(e,!1,o);e.setIndentation(t,n,1,!0),e.writeBack(),r.rawEvent.preventDefault()}):Bf(r,e)},defaultDisabled:!0},maintainListChain:{keys:[13,9,46,8,258],shouldHandleEvent:function(e,t){return 0<t.queryElements("li",1).length},handleEvent:function(e,t){var n=Df(t);t.runAsync(function(e){return(0,If.experimentCommitListChains)(e,n)})}},maintainListChainWhenDelete:{keys:[46],shouldHandleEvent:function(e,t){if(t.getElementAtCursor("LI",null,e))return!1;var n,r=Mf.Position.getEnd(t.getSelectionRange()).isAtEnd?(n=t,(0,Mf.cacheGetEventData)(e,"nextSibling",function(){var e=n.getSelectionRange(),e=Mf.Position.getEnd(e).normalize(),e=n.getBodyTraverser(e.node);return null===(e=null==e?void 0:e.getNextBlockElement())||void 0===e?void 0:e.getStartNode()})):null;return t.getElementAtCursor("LI",r,e)},handleEvent:function(e,t){var n=Df(t);t.runAsync(function(e){return(0,If.experimentCommitListChains)(e,n)})}}};var m={},Hf=(Object.defineProperty(m,"__esModule",{value:!0}),m.MarkdownFeatures=void 0,t);function zf(e,n,l,r){return{keys:[e],shouldHandleEvent:function(e,t){return e.rawEvent.shiftKey===r&&!!Uf(e,t,n)},handleEvent:function(t,e){e.runAsync(function(e){var r,o,i,a;r=t,i=n,a=l,(o=e).addUndoSnapshot(function(){var e,t,n=Uf(r,o,i);n&&((t=n.cloneRange()).setStart(t.startContainer,t.startOffset+1),n.setEnd(n.endContainer,n.endOffset+1),(e=o.getDocument().createElement(a)).appendChild(t.extractContents()),n.deleteContents(),t=o.getDocument().createTextNode("​"),n.insertNode(t),n.insertNode(e),o.select(t,-1))},"Format",!0)})}}}function Uf(e,t,i){return(0,Hf.cacheGetEventData)(e,"MARKDOWN_RANGE",function(){var r,o;return t.getContentSearcherOfCursor(e).forEachTextInlineElement(function(e){if(o&&r)return!0;var t=e.getTextContent();if(0==t[t.length-1].trim().length)return!1;if(t[t.length-1]===i)return!1;if(o=o||e.getStartPosition().move(t.length),t[0]==i)r=e.getStartPosition();else for(var n=t.length-1;0<n;n--){if(r)return!0;if(t[n]==i&&0==t[n-1].trim().length)return r=e.getStartPosition().move(n),!0}}),!!r&&!!o&&(0,Hf.createRange)(r,o)})}var h=zf(56,"*","b",!0),g=zf(189,"_","i",!0),he=zf(192,"~","s",!0),Ae=zf(192,"`","code",!1),B=(m.MarkdownFeatures={markdownBold:h,markdownItalic:g,markdownStrikethru:he,markdownInlineCode:Ae},{}),Vf=(Object.defineProperty(B,"__esModule",{value:!0}),B.QuoteFeatures=void 0,vd),Wf=t,qf="BLOCKQUOTE",Kf=[qf,"LI","TD","TH"].join(",");function Gf(e,n){return(0,Wf.cacheGetEventData)(e,"QUOTE_CHILD",function(){var e=n.getElementAtCursor(Kf);if(e&&(0,Wf.getTagOfNode)(e)==qf){var t=n.getFocusedPosition(),t=t&&n.getBlockElementAtNode(t.normalize().node);if(t)return e=t.getStartNode()==e?t.getStartNode():t.collapseToSingleElement(),(0,Wf.isNodeEmpty)(e)?e:null}return null})}function Zf(r,o){o.addUndoSnapshot(function(){var e,t,n=Gf(r,o);(0,Wf.getTagOfNode)(n)==qf&&(n=(0,Wf.wrap)((0,Wf.toArray)(n.childNodes))),e=(0,Wf.splitBalancedNodeRange)(n),t=Yf(e),(0,Wf.unwrap)(e),o.select(n,0),t&&(0,Vf.clearFormat)(o)}),r.rawEvent.preventDefault()}var Yf=function(e){return!!(e&&(0,Wf.safeInstanceOf)(e,"HTMLQuoteElement")&&e.style.borderLeft&&e.style.borderColor&&e.style.paddingLeft&&e.style.color)},Et=(B.QuoteFeatures={unquoteWhenBackspaceOnEmptyFirstLine:{keys:[8],shouldHandleEvent:function(e,t){e=Gf(e,t);return e&&(0,Wf.isNodeEmpty)(e)&&!e.previousSibling},handleEvent:Zf},unquoteWhenEnterOnEmptyLine:{keys:[13],shouldHandleEvent:function(e,t){t=Gf(e,t);return!e.rawEvent.shiftKey&&t&&(0,Wf.isNodeEmpty)(t)},handleEvent:function(e,t){return t.addUndoSnapshot(function(){return Zf(e,t)},null,!0)}}},{}),Xf=(Object.defineProperty(Et,"__esModule",{value:!0}),Et.ShortcutFeatures=void 0,t),$f=vd;function Qf(e,t,n){return{winKey:e,macKey:t,action:n}}var Jf=[Qf(4162,8258,$f.toggleBold),Qf(4169,8265,$f.toggleItalic),Qf(4181,8277,$f.toggleUnderline),Qf(4186,8282,function(e){return e.undo()}),Qf(4185,24666,function(e){return e.redo()}),Qf(4286,8382,$f.toggleBullet),Qf(4287,8383,$f.toggleNumbering),Qf(20670,24766,function(e){return(0,$f.changeFontSize)(e,0)}),Qf(20668,24764,function(e){return(0,$f.changeFontSize)(e,1)})];function eh(n){return(0,Xf.cacheGetEventData)(n,"DEFAULT_SHORT_COMMAND",function(){var e=n.rawEvent,t=0!=n.eventType||e.altKey?0:e.which|(e.metaKey&&8192)|(e.shiftKey&&16384)|(e.ctrlKey&&4096);return t&&Jf.filter(function(e){return(Xf.Browser.isMac?e.macKey:e.winKey)==t})[0]})}Et.ShortcutFeatures={defaultShortcut:{allowFunctionKeys:!0,keys:[66,73,85,89,90,188,190,191],shouldHandleEvent:eh,handleEvent:function(e,t){var n=eh(e);n&&(n.action(t),e.rawEvent.preventDefault(),e.rawEvent.stopPropagation())}}};var Be={},th=(Object.defineProperty(Be,"__esModule",{value:!0}),Be.StructuredNodeFeatures=void 0,t),nh={TD:"TABLE",TH:"TABLE",LI:"OL,UL"},rh=Object.keys(nh).join(",");function oh(n,r){return(0,th.cacheGetEventData)(n,"FIRST_STRUCTURE",function(){var e=n.rawEvent.shiftKey?null:r.getElementAtCursor(rh);if(e){var t=r.getSelectionRange();if(t&&t.collapsed&&(0,th.isPositionAtBeginningOf)(th.Position.getStart(t),e)&&!r.getBodyTraverser(e).getPreviousBlockElement())return r.getElementAtCursor(nh[(0,th.getTagOfNode)(e)])}return null})}Be.StructuredNodeFeatures={insertLineBeforeStructuredNodeFeature:{keys:[13],shouldHandleEvent:oh,handleEvent:function(e,t){var n=oh(e,t),r=(0,th.createElement)(1,t.getDocument());t.addUndoSnapshot(function(){n.parentNode.insertBefore(r,n),"TABLE"==(0,th.getTagOfNode)(n)&&t.select(new th.Position(r,0).normalize())}),e.rawEvent.preventDefault()},defaultDisabled:!0}};var vt={},ih=(Object.defineProperty(vt,"__esModule",{value:!0}),vt.TableFeatures=void 0,vd),ah=t,He={keys:[38,40],shouldHandleEvent:lh,handleEvent:function(e,t){var r=lh(e,t),o=new ah.VTable(r),i=38==e.rawEvent.which,n=i?-1:1,a=e.rawEvent.shiftKey,e=null===(e=t.getDocument().defaultView)||void 0===e?void 0:e.getSelection(),l=null;if(e){for(var d=e.anchorNode,u=e.anchorOffset,s=o.row;0<=s&&s<o.cells.length;s+=n){var c=o.getCell(s,o.col);if(c.td&&c.td!=r){l=c.td;break}}t.runAsync(function(e){var t,n=e.getElementAtCursor();(0,ah.contains)(o.table,n)&&!(0,ah.contains)(r,n,!0)&&(n=l?new ah.Position(l,0):new ah.Position(o.table,i?-2:-3),a?(n=1==n.node.nodeType&&(0,ah.isVoidHtmlElement)(n.node)?new ah.Position(n.node,n.isAtEnd?-3:-2):n,null==(t=null===(t=e.getDocument().defaultView)||void 0===t?void 0:t.getSelection())||t.setBaseAndExtent(d,u,n.node,n.offset)):e.select(n))})}},defaultDisabled:!ah.Browser.isChrome&&!ah.Browser.isSafari};function lh(e,t){return(0,ah.cacheGetEventData)(e,"TABLE_CELL_FOR_TABLE_FEATURES",function(){var e=t.getFocusedPosition(),e=e&&t.getElementAtCursor("TD,TH,LI",e.node);return e&&("LI"==(0,ah.getTagOfNode)(e)?null:e)})}vt.TableFeatures={tabInTable:{keys:[9],shouldHandleEvent:lh,handleEvent:function(e,t){for(var n=e.rawEvent.shiftKey,r=lh(e,t),o=new ah.VTable(r),i=n?-1:1,a=o.row,l=o.col+i;;l+=i){if(l<0||l>=o.cells[a].length){if((a+=i)<0){t.select(o.table,-2);break}if(a>=o.cells.length){(0,ih.editTable)(t,1);break}l=n?o.cells[a].length-1:0}var s=o.getCell(a,l);if(s.td){t.select(s.td,0);break}}e.rawEvent.preventDefault()}},upDownInTable:He};var sh,ch,dh,uh=e&&e.__assign||function(){return(uh=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Ut=(Object.defineProperty(Zt,"__esModule",{value:!0}),dr),Fe=ja,ze=Ys,je=m,Ht=B,Yt=Et,de=Be,Un=vt,fh=uh(uh(uh(uh(uh(uh(uh(uh(uh({},l.ListFeatures),Ht.QuoteFeatures),Un.TableFeatures),de.StructuredNodeFeatures),Ut.AutoLinkFeatures),Yt.ShortcutFeatures),Fe.CursorFeatures),je.MarkdownFeatures),ze.EntityFeatures),hh=(Zt.default=function(){return fh},Object.defineProperty(y,"__esModule",{value:!0}),Zt);function ph(e,t){this.settingsOverride=e,this.additionalFeatures=t}ph.prototype.getName=function(){return"ContentEdit"},ph.prototype.initialize=function(t){var r=this,o=[],i=(0,hh.default)();Object.keys(i).forEach(function(e){var t=i[e],n=r.settingsOverride&&void 0!==r.settingsOverride[e];(n&&r.settingsOverride[e]||!n&&!t.defaultDisabled)&&o.push(t)}),o.concat(this.additionalFeatures||[]).forEach(function(e){return t.addContentEditFeature(e)})},ph.prototype.dispose=function(){},y.default=ph,qn=T,Object.defineProperty(qn,"__esModule",{value:!0}),qn.getAllFeatures=qn.ContentEdit=void 0,ch=y,Object.defineProperty(qn,"ContentEdit",{enumerable:!0,get:function(){return ch.default}}),dh=Zt,Object.defineProperty(qn,"getAllFeatures",{enumerable:!0,get:function(){return dh.default}}),W=cr,sh=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),M=e&&e.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||sh(t,e,n)},Object.defineProperty(W,"__esModule",{value:!0}),M(T,W);var gh,vh,rr={},or={},Xn={},mh=(Object.defineProperty(Xn,"__esModule",{value:!0}),t);function yh(e){var n=this;this.options=e,this.onDismiss=function(){var e,t;n.container&&n.isMenuShowing&&(null===(t=(e=n.options).dismiss)||void 0===t||t.call(e,n.container),n.isMenuShowing=!1)}}yh.prototype.getName=function(){return"ContextMenu"},yh.prototype.initialize=function(e){this.editor=e},yh.prototype.dispose=function(){this.onDismiss(),this.container&&(this.container.parentNode.removeChild(this.container),this.container=null),this.editor=null},yh.prototype.onPluginEvent=function(e){var t;16==e.eventType&&0<e.items.length&&(t=e.rawEvent,e=e.items,this.onDismiss(),this.options.allowDefaultMenu||t.preventDefault(),this.initContainer(t.pageX,t.pageY),this.options.render(this.container,e,this.onDismiss),this.isMenuShowing=!0)},yh.prototype.initContainer=function(e,t){this.container||(this.container=(0,mh.createElement)(5,this.editor.getDocument()),this.editor.getDocument().body.appendChild(this.container)),this.container.style.left=e+"px",this.container.style.top=t+"px"},Xn.default=yh,n=or,Object.defineProperty(n,"__esModule",{value:!0}),n.ContextMenu=void 0,vh=Xn,Object.defineProperty(n,"ContextMenu",{enumerable:!0,get:function(){return vh.default}}),R=rr,gh=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),$n=e&&e.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||gh(t,e,n)},Object.defineProperty(R,"__esModule",{value:!0}),$n(or,R);function bh(e,t,n,r){return{sourceString:e,replacementHTML:t,matchSourceCaseSensitive:n,shouldReplace:r}}var Eh,Ch,H={},C={},ir={},wh=(Object.defineProperty(ir,"__esModule",{value:!0}),[bh(":)","🙂",!0),bh(";)","😉",!0),bh(":O","😲",!0),bh(":o","😯",!0),bh("<3","❤️",!0)]);function Sh(e){this.updateReplacements(e=void 0===e?wh:e)}Sh.prototype.updateReplacements=function(e){this.replacements=e,this.longestReplacementLength=(e=this.replacements,Math.max.apply(null,e.map(function(e){return e.sourceString.length}))),this.replacementEndCharacters=function(e){for(var t=new Set,n=0,r=e;n<r.length;n++){var o=r[n],i=o.sourceString;0!=i.length&&(i=i[i.length-1],o.matchSourceCaseSensitive?t.add(i):(t.add(i.toLocaleLowerCase()),t.add(i.toLocaleUpperCase())))}return t}(this.replacements)},Sh.prototype.getName=function(){return"CustomReplace"},Sh.prototype.initialize=function(e){this.editor=e},Sh.prototype.dispose=function(){this.editor=null},Sh.prototype.onPluginEvent=function(e){var t,n,r,o,i=this;3==e.eventType&&!this.editor.isInIME()&&e.rawEvent.data&&this.replacementEndCharacters.has(e.rawEvent.data)&&null!=this.editor.getSelectionRange()&&(t=(e=this.editor.getContentSearcherOfCursor(e)).getSubStringBefore(this.longestReplacementLength),null==(t=this.getMatchingReplacement(t))||t.shouldReplace&&!t.shouldReplace(t,e.getWordBefore())||(n=e.getSubStringBefore(t.sourceString.length),r=e.getRangeFromText(n,!0),(e=this.editor.getDocument().createElement("span")).innerHTML=this.editor.getTrustedHTMLHandler()(t.replacementHTML),o=1==e.childNodes.length?e.childNodes[0]:e,this.editor.addUndoSnapshot(function(){r.deleteContents(),r.insertNode(o),i.editor.select(o,-1)},null,!0)))},Sh.prototype.getMatchingReplacement=function(e){if(0==e.length)return null;for(var t=e.replace(/\s/g," "),n=t.toLocaleLowerCase(),r=0,o=this.replacements;r<o.length;r++){var i=o[r],a=i.matchSourceCaseSensitive?[t,i.sourceString]:[n,i.sourceString.toLocaleLowerCase()],l=a[0],a=a[1];if(l.substring(l.length-a.length)==a)return i}return null},ir.default=Sh,se=C,Object.defineProperty(se,"__esModule",{value:!0}),se.CustomReplace=void 0,Ch=ir,Object.defineProperty(se,"CustomReplace",{enumerable:!0,get:function(){return Ch.default}}),Ve=H,Eh=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),f=e&&e.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||Eh(t,e,n)},Object.defineProperty(Ve,"__esModule",{value:!0}),f(C,Ve);var Ph,Th,qe={},u={},xt={},Oh=(Object.defineProperty(xt,"__esModule",{value:!0}),vd),_h=t;function xh(){var e=this;this.onDrop=function(){e.cacheListChains("Drop")}}xh.prototype.getName=function(){return"CutPasteListChain"},xh.prototype.initialize=function(e){this.editor=e,this.disposer=this.editor.addDomEventHandler("drop",this.onDrop)},xh.prototype.dispose=function(){var e;null===(e=this.disposer)||void 0===e||e.call(this),this.disposer=null,this.editor=null},xh.prototype.onPluginEvent=function(e){var t;switch(e.eventType){case 9:e.isCut&&this.cacheListChains("Cut");break;case 10:this.cacheListChains("Paste");break;case 7:0<(null===(t=this.chains)||void 0===t?void 0:t.length)&&this.expectedChangeSource==e.source&&((0,Oh.experimentCommitListChains)(this.editor,this.chains),this.chains=null,this.expectedChangeSource=null)}},xh.prototype.cacheListChains=function(e){this.chains=_h.VListChain.createListChains(this.editor.getSelectedRegions()),this.expectedChangeSource=e},xt.default=xh,kr=u,Object.defineProperty(kr,"__esModule",{value:!0}),kr.CutPasteListChain=void 0,Th=xt,Object.defineProperty(kr,"CutPasteListChain",{enumerable:!0,get:function(){return Th.default}}),$i=qe,Ph=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),q=e&&e.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||Ph(t,e,n)},Object.defineProperty($i,"__esModule",{value:!0}),q(u,$i);var Nh,Rh,Na={},Lr={},Vn={},Lh=(Object.defineProperty(Vn,"__esModule",{value:!0}),t);function kh(e,t,n){var r=this;this.getTooltipCallback=e=void 0===e?function(e){return e}:e,this.target=t,this.onLinkClick=n,this.trackedLink=null,this.onMouse=function(e){var t=r.editor.getElementAtCursor("a[href]",e.target),n=r.tryGetHref(t);n&&r.editor.setEditorDomAttribute("title","mouseover"==e.type?r.getTooltipCallback(n,t):null)},this.onBlur=function(e){r.trackedLink&&r.updateLinkHrefIfShouldUpdate(),r.resetLinkTracking()}}kh.prototype.getName=function(){return"Hyperlink"},kh.prototype.initialize=function(e){this.editor=e,this.disposer=this.getTooltipCallback&&e.addDomEventHandler({mouseover:this.onMouse,mouseout:this.onMouse,blur:this.onBlur})},kh.prototype.dispose=function(){this.disposer&&(this.disposer(),this.disposer=null),this.editor=null},kh.prototype.onPluginEvent=function(e){var t;if(6!=e.eventType&&(2!=e.eventType||this.isContentEditValue(e.rawEvent)&&32!=e.rawEvent.which)&&7!=e.eventType||(n=(t=this.editor.getElementAtCursor("A[href]",null,e))!==this.trackedLink||2==e.eventType||7==e.eventType,this.trackedLink&&(n||this.tryGetHref(this.trackedLink)!==this.originalHref)&&(n&&this.updateLinkHrefIfShouldUpdate(),this.resetLinkTracking()),!this.trackedLink&&this.doesLinkDisplayMatchHref(t)&&(this.trackedLink=t,this.originalHref=this.tryGetHref(t))),6==e.eventType&&(t=this.editor.getElementAtCursor("A",e.rawEvent.srcElement))&&(!this.onLinkClick||!1===this.onLinkClick(t,e.rawEvent))){var n=void 0;if(!Lh.Browser.isFirefox&&(n=this.tryGetHref(t))&&(0,Lh.isCtrlOrMetaPressed)(e.rawEvent)&&0===e.rawEvent.button)try{var r=this.target||"_blank";this.editor.getDocument().defaultView.open(n,r)}catch(e){}}},kh.prototype.tryGetHref=function(e){try{return e?e.href:null}catch(e){}},kh.prototype.isContentEditValue=function(e){return(0,Lh.isCharacterValue)(e)||8==e.which||46==e.which},kh.prototype.updateLinkHrefIfShouldUpdate=function(){this.doesLinkDisplayMatchHref(this.trackedLink)||this.updateLinkHref()},kh.prototype.resetLinkTracking=function(){this.trackedLink=null,this.originalHref=""},kh.prototype.doesLinkDisplayMatchHref=function(e){if(e){var t=e.innerText.trim().replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),t=new RegExp("^(?:https?:\\/\\/)?"+t+"\\/?","i"),e=this.tryGetHref(e);if(null!==e)return t.test(e)}return!1},kh.prototype.updateLinkHref=function(){var e,t=this;!this.trackedLink||null!==(e=(0,Lh.matchLink)(this.trackedLink.innerText.trim()))&&this.editor.addUndoSnapshot(function(){t.trackedLink.href=e.normalizedUrl})},Vn.default=kh,ce=Lr,Object.defineProperty(ce,"__esModule",{value:!0}),ce.HyperLink=void 0,Rh=Vn,Object.defineProperty(ce,"HyperLink",{enumerable:!0,get:function(){return Rh.default}}),Kn=Na,Nh=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),bo=e&&e.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||Nh(t,e,n)},Object.defineProperty(Kn,"__esModule",{value:!0}),bo(Lr,Kn);var Ih,Mh,Ah,Dh,V={},F={},Pi={},xi={},ki={};function jh(e,t){return Math.abs(e-t)<.001}Di=ki,zi=e&&e.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||((r=r||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},Object.defineProperty(Di,"__esModule",{value:!0}),Di.ImageEditInfoState=void 0,Mh=["leftPercent","rightPercent","topPercent","bottomPercent"],Ah=zi(zi([],Ih=["angleRad"],!0),Mh,!0),Dh=zi(zi([],Ah,!0),["widthPx","heightPx"],!0),(zi=Di.ImageEditInfoState||(Di.ImageEditInfoState={}))[zi.Invalid=0]="Invalid",zi[zi.ResizeOnly=1]="ResizeOnly",zi[zi.SameWithLast=2]="SameWithLast",zi[zi.FullyChanged=3]="FullyChanged",Di.default=function(t,n){return t&&t.src&&!Dh.some(function(e){return!("number"==typeof t[e])})?Ah.every(function(e){return jh(t[e],0)})?1:n&&Ih.every(function(e){return jh(t[e],0)})&&Ih.every(function(e){return jh(n[e],0)})&&Mh.every(function(e){return jh(t[e],n[e])})?2:3:0};var Wi={},Ki={},Bh=(Object.defineProperty(Ki,"__esModule",{value:!0}),Ki.default=function(e,t){var n=e.widthPx,r=e.heightPx,o=e.angleRad,i=n/(1-e.leftPercent-e.rightPercent),e=r/(1-e.topPercent-e.bottomPercent),n=t?i:n,t=t?e:r;return{targetWidth:Math.abs(n*Math.cos(o))+Math.abs(t*Math.sin(o)),targetHeight:Math.abs(n*Math.sin(o))+Math.abs(t*Math.cos(o)),originalWidth:i,originalHeight:e,visibleWidth:n,visibleHeight:t}},Object.defineProperty(Wi,"__esModule",{value:!0}),Ki),Zi=(Wi.default=function(d,e){var u=e.angleRad,t=e.widthPx,n=e.heightPx,r=e.bottomPercent,o=e.leftPercent,i=e.rightPercent,a=e.topPercent,l=e.naturalWidth,f=e.naturalHeight,i=l*(1-o-i),r=f*(1-a-r),s=document.createElement("canvas"),e=(0,Bh.default)(e),h=e.targetWidth,e=e.targetHeight,c=(s.width=h,s.height=e,s.getContext("2d"));return c.translate(h/2,e/2),c.rotate(u),c.drawImage(d,l*o,f*a,i,r,-t/2,-n/2,t,n),s.toDataURL("image/png",1)},{}),Fh=(Object.defineProperty(Zi,"__esModule",{value:!0}),Zi.getEditInfoFromImage=Zi.deleteEditInfo=Zi.saveEditInfo=void 0,ki),Hh=(Zi.saveEditInfo=function(e,t){e&&(e.dataset.roosterEditInfo=JSON.stringify(t))},Zi.deleteEditInfo=function(e){e&&delete e.dataset.roosterEditInfo},Zi.getEditInfoFromImage=function(e){var t=function(e){try{return JSON.parse(e)}catch(e){return null}}(null==e?void 0:e.dataset.roosterEditInfo);return 0==(0,Fh.default)(t)?{src:(e=e).getAttribute("src")||"",widthPx:e.clientWidth,heightPx:e.clientHeight,naturalWidth:e.naturalWidth,naturalHeight:e.naturalHeight,leftPercent:0,rightPercent:0,topPercent:0,bottomPercent:0,angleRad:0}:t},Object.defineProperty(xi,"__esModule",{value:!0}),ki),zh=Wi,Uh=Ki,Vh=Zi,yo=(xi.default=function(e,t,n,r,o){var i="",a=(0,Vh.getEditInfoFromImage)(t);switch((0,Hh.default)(n,a)){case 1:i=n.src;break;case 2:i=r;break;case 3:i=(0,zh.default)(t,n)}var l,s=i!=r,e=((i=s?e.triggerPluginEvent(19,{image:t,originalSrc:n.src,previousSrc:r,newSrc:i}).newSrc:i)==n.src?(0,Vh.deleteEditInfo)(t):(0,Vh.saveEditInfo)(t,n),(0,Uh.default)(n)),c=e.targetWidth,e=e.targetHeight;return t.src=i,l=t,c=c,e=e,o?(l.style.maxWidth="initial",l.width=c,l.height=e,l.style.width=c+"px",l.style.height=e+"px"):(l.style.maxWidth="100%",l.style.height="initial",l.style.width="initial",l.removeAttribute("height"),l.removeAttribute("width")),s||n.widthPx!=a.widthPx||n.heightPx!=a.heightPx},{}),Co=(Object.defineProperty(yo,"__esModule",{value:!0}),yo.default=function(e){if(!e)return!1;try{var t=e.ownerDocument.createElement("canvas"),n=(t.width=10,t.height=10,t.getContext("2d"));return n.drawImage(e,0,0),n.getImageData(0,0,1,1),!0}catch(e){return!1}},{});function Wh(e,t,n,r,o){var i=this;this.trigger=e,this.context=t,this.onSubmit=n,this.handler=r,this.sizeTransformer=o,this.onMouseDown=function(e){var t,n;e.preventDefault(),e.stopPropagation(),i.addDocumentEvents(),i.initX=e.pageX,i.initY=e.pageY,i.initValue=null===(n=(t=i.handler).onDragStart)||void 0===n?void 0:n.call(t,i.context,e)},this.onMouseMove=function(e){e.preventDefault();var t,n,r=i.sizeTransformer,o=r(e.pageX-i.initX),r=r(e.pageY-i.initY);null!==(n=(t=i.handler).onDragging)&&void 0!==n&&n.call(t,i.context,e,i.initValue,o,r)&&(null===(n=i.onSubmit)||void 0===n||n.call(i,i.context,i.trigger))},this.onMouseUp=function(e){var t,n;e.preventDefault(),i.removeDocumentEvents(),null!==(n=(t=i.handler).onDragEnd)&&void 0!==n&&n.call(t,i.context,e,i.initValue)&&(null===(n=i.onSubmit)||void 0===n||n.call(i,i.context,i.trigger))},e.addEventListener("mousedown",this.onMouseDown),this.sizeTransformer=o}Object.defineProperty(Co,"__esModule",{value:!0}),Wh.prototype.dispose=function(){this.trigger.removeEventListener("mousedown",this.onMouseDown),this.removeDocumentEvents()},Wh.prototype.addDocumentEvents=function(){var e=this.trigger.ownerDocument;e.addEventListener("mousemove",this.onMouseMove,!0),e.addEventListener("mouseup",this.onMouseUp,!0)},Wh.prototype.removeDocumentEvents=function(){var e=this.trigger.ownerDocument;e.removeEventListener("mousemove",this.onMouseMove,!0),e.removeEventListener("mouseup",this.onMouseUp,!0)},Co.default=Wh;var Gi={},We={},qh=e&&e.__assign||function(){return(qh=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Kh=(Object.defineProperty(We,"__esModule",{value:!0}),We.getSideResizeHTML=We.getCornerResizeHTML=We.doubleCheckResize=We.rotateCoordinate=We.Resizer=void 0,["w","","e"]),Gh=["s","","n"];function Zh(e,t,n){if(0==e&&0==t)return[0,0];var r=Math.sqrt(e*e+t*t);return n=Math.atan2(t,e)-n,[r*Math.cos(n),r*Math.sin(n)]}function Yh(e,t,n){var r="w"==e?"left":"right",o="n"==t?"top":"bottom";return""==e&&""==t?{tag:"div",style:"position:absolute;left:0;right:0;top:0;bottom:0;border:solid 1px "+n+";pointer-events:none"}:{tag:"div",style:"position:absolute;"+r+":"+(""==e?"50%":"0px")+";"+o+":"+(""==t?"50%":"0px"),children:[{tag:"div",style:"position:relative;width:7px;height:7px;background-color: "+n+";cursor:"+(t+e)+"-resize;"+o+":-3px;"+r+":-3px",className:"r_resizeH",dataset:{x:e,y:t}}]}}We.Resizer={onDragStart:function(e){e=e.editInfo;return qh({},e)},onDragging:function(e,t,n,r,o){var i=e.x,a=e.y,l=e.editInfo,e=e.options,s=0<n.widthPx&&0<n.heightPx?+n.widthPx/n.heightPx:0,c=(r=(c=Zh(r,o,l.angleRad))[0],o=c[1],""==i),d=""==a,t=!(c||d)&&(e.preserveRatio||t.shiftKey),c=c?n.widthPx:Math.max(n.widthPx+r*("w"==i?-1:1),e.minWidth),r=d?n.heightPx:Math.max(n.heightPx+o*("n"==a?-1:1),e.minHeight);return t&&0<s&&(r=Math.min(r,c/s),(c=Math.min(c,r*s))<r*s?c=r*s:r=c/s),l.widthPx=c,l.heightPx=r,!0}},We.rotateCoordinate=Zh,We.doubleCheckResize=function(e,t,n,r){var o=e.widthPx,i=e.heightPx,a=0<i?o/i:0;n=Math.floor(n),r=Math.floor(r),o=Math.floor(o),i=Math.floor(i),e.widthPx=n,e.heightPx=r,t&&0<a&&(o!==n||i!==r)&&(n<o?e.heightPx=n/a:e.widthPx=r*a)},We.getCornerResizeHTML=function(e){var n=e.borderColor,r=[];return Kh.forEach(function(t){return Gh.forEach(function(e){return r.push(""==t==(""==e)?Yh(t,e,n):null)})}),r},We.getSideResizeHTML=function(e){var n=e.borderColor,r=[];return Kh.forEach(function(t){return Gh.forEach(function(e){return r.push(""==t!=(""==e)?Yh(t,e,n):null)})}),r};var Xh=e&&e.__assign||function(){return(Xh=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},$h=(Object.defineProperty(Gi,"__esModule",{value:!0}),Gi.getCropHTML=Gi.Cropper=void 0,We),Qh=["w","e"],Jh=["s","n"],e0={sw:0,nw:90,ne:180,se:270};function t0(e,t,n,r,o){return Math.max(Math.min(n*e+t,n*(1-r)-o),0)/n}Gi.Cropper={onDragStart:function(e){e=e.editInfo;return Xh({},e)},onDragging:function(e,d,t,n,r){var o=e.editInfo,i=e.x,u=e.y,e=e.options,a=(n=(a=(0,$h.rotateCoordinate)(n,r,o.angleRad))[0],r=a[1],o.widthPx),l=o.heightPx,f=o.leftPercent,h=o.rightPercent,p=o.topPercent,g=o.bottomPercent,v=e.minWidth,e=e.minHeight,s=1-f-h,c=1-p-g;return 0<s&&0<c&&(a=a/s,s=l/c,l="e"!=i?t0(t.leftPercent,n,a,h,v):f,c="w"!=i?t0(t.rightPercent,-n,a,f,v):h,i="s"!=u?t0(t.topPercent,r,s,g,e):p,n="n"!=u?t0(t.bottomPercent,-r,s,p,e):g,o.leftPercent=l,o.rightPercent=c,o.topPercent=i,o.bottomPercent=n,o.widthPx=a*(1-l-c),o.heightPx=s*(1-i-n),!0)}},Gi.getCropHTML=function(){var e={tag:"div",style:"position:absolute;background-color:rgb(0,0,0,0.5);pointer-events:none",className:"r_cropO"},r={tag:"div",style:"position:absolute;overflow:hidden",className:"r_cropC",children:[]};return Qh.forEach(function(t){return Jh.forEach(function(e){return r.children.push({tag:"div",className:"r_cropH",style:"position:absolute;pointer-events:auto;cursor:"+e+t+"-resize;"+("w"==t?"left":"right")+":0;"+("n"==e?"top":"bottom")+":0;width:22px;height:22px;transform:rotate("+e0[e+t]+"deg)",dataset:{x:t,y:e},children:(n=[],[0,1].forEach(function(t){return[0,1].forEach(function(e){n.push({tag:"div",style:"position:absolute;left:"+t+"px;bottom:"+t+"px;"+(0==e?"right:"+t+"px;height:"+(7-2*t)+"px;":"top:"+t+"px;width:"+(7-2*t)+"px;")+";background-color:"+(0==t?"white":"black")})})}),n)});var n})}),[r,e,e,e,e]};var r={},n0=e&&e.__assign||function(){return(n0=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},r0=(Object.defineProperty(r,"__esModule",{value:!0}),r.getRotateHTML=r.updateRotateHandlePosition=r.Rotator=void 0,180/Math.PI);r.Rotator={onDragStart:function(e){e=e.editInfo;return n0({},e)},onDragging:function(e,t,n,r,o){var i=e.editInfo,e=e.options,a=i.heightPx/2+31,r=a*Math.sin(n.angleRad)+r,a=a*Math.cos(n.angleRad)-o,n=Math.atan2(r,a);return t.altKey||(n=Math.round(n*r0/e.minRotateDeg)*e.minRotateDeg/r0),i.angleRad!=n&&(i.angleRad=n,!0)}},r.updateRotateHandlePosition=function(e,t,n,r,o){var i;r&&o&&t&&(i=e.angleRad,e=e.heightPx,t=(i=Math.cos(i))<=0?Number.MAX_SAFE_INTEGER:(t[1]+e/2+n)/i-e/2,n=Math.max(Math.min(15,t),0),i=Math.max(Math.min(32,t-n),0),r.style.top=-n+"px",r.style.height=n+"px",o.style.top=-i+"px")},r.getRotateHTML=function(e){var t=e.borderColor;return[{tag:"div",className:"r_rotateC",style:"position:absolute;left:50%;width:1px;background-color:"+t,children:[{tag:"div",className:"r_rotateH",style:"position:absolute;background-color:"+e.rotateHandleBackColor+";border:solid 1px "+t+";border-radius:50%;width:32px;height:32px;left:-16px;cursor:move",children:[(e=t,{tag:"svg",namespace:"http://www.w3.org/2000/svg",style:"width:16px;height:16px;margin: 8px 8px",children:[{tag:"path",namespace:"http://www.w3.org/2000/svg",attributes:((t={d:"M 10.5,10.0 A 3.8,3.8 0 1 1 6.7,6.3",transform:"matrix(1.1 1.1 -1.1 1.1 11.6 -10.8)"})["fill-opacity"]="0",t.stroke=e,t)},{tag:"path",namespace:"http://www.w3.org/2000/svg",attributes:{d:"M12.0 3.648l.884-.884.53 2.298-2.298-.53z",stroke:e}}]})]}]}]};var o0=e&&e.__assign||function(){return(o0=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},i0=e&&e.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||((r=r||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},a0=(Object.defineProperty(Pi,"__esModule",{value:!0}),xi),l0=yo,s0=Co,c0=Ki,d0=Gi,u0=Zi,f0=r,h0=vd,p0=t,g0=We,v0=2*Math.PI/8,m0=["nw","n","ne","e","se","s","sw","w"],y0=((ea={}).SingleDirectionResize=2,ea.ImageRotate=4,ea.ImageCrop=8,ea),b0={borderColor:"#DB626C",minWidth:10,minHeight:10,preserveRatio:!1,minRotateDeg:5,imageSelector:"img",rotateIconHTML:null},E0=((ta={})[1]=g0.getCornerResizeHTML,ta[2]=g0.getSideResizeHTML,ta[4]=f0.getRotateHTML,ta[8]=d0.getCropHTML,ta),C0="IMAGE_EDIT_WRAPPER";function w0(e){var E=this;this.allowedOperations=1,this.onBlur=function(){E.setEditingImage(null)},this.removeWrapper=function(e){var t=null==e?void 0:e.parentNode,n=null==e?void 0:e.querySelector("img");n&&t&&(n.style.position="",n.style.margin=null,n.style.textAlign=null,t.insertBefore(n,e),t.removeChild(e))},this.updateWrapper=function(d){var u,e,f,h,p,g,v,t,m,y,n,r,o,i,a,l,s,b,c=E.getImageWrapper(E.image);c&&(u=T0(c,"r_cropC"),e=T0(c,"r_cropO"),f=T0(c,"r_rotateC")[0],h=T0(c,"r_rotateH")[0],p=T0(c,"r_resizeH"),g=T0(c,"r_cropH"),v=1==u.length&&4==e.length,t=(a=E.editInfo).angleRad,l=a.bottomPercent,o=a.leftPercent,i=a.rightPercent,a=a.topPercent,n=(r=(0,c0.default)(E.editInfo,v)).targetWidth,s=r.targetHeight,m=r.originalWidth,y=r.originalHeight,b=(n-(n=r.visibleWidth))/2,r=(s-(s=r.visibleHeight))/2,o=m*o,i=m*i,a=y*a,l=y*l,c.style.width=P0(n),c.style.height=P0(s),c.style.margin=r+"px "+b+"px",c.style.transform="rotate("+t+"rad)",c.style.textAlign=(n=c.parentNode,(0,p0.safeInstanceOf)(n,"HTMLElement")&&"rtl"==(0,p0.getComputedStyle)(n,"direction")?"right":"left"),E.image.style.width=P0(m),E.image.style.height=P0(y),v?(S0(u[0],o,a,i,l,void 0,void 0),S0(e[0],0,0,i,void 0,void 0,a),S0(e[1],void 0,0,0,l,i,void 0),S0(e[2],o,void 0,0,0,void 0,l),S0(e[3],0,a,void 0,0,o,void 0),O0(g,t)):(E.image.style.margin=-a+"px 0 0 "+-o+"px","r_resizeH"==(null==d?void 0:d.elementClass)&&(s=c.clientWidth,b=c.clientHeight,E.wasResized=!0,(0,g0.doubleCheckResize)(E.editInfo,E.options.preserveRatio,s,b),E.updateWrapper()),(0,f0.updateRotateHandlePosition)(E.editInfo,E.editor.getRelativeDistanceToEditor(c,!0),r,f,h),O0(p,t)))},this.options=o0(o0({},b0),e||{})}function S0(e,t,n,r,o,i,a){e.style.left=P0(t),e.style.top=P0(n),e.style.right=P0(r),e.style.bottom=P0(o),e.style.width=P0(i),e.style.height=P0(a)}function P0(e){return void 0===e?null:e+"px"}function T0(e,t){return(0,p0.toArray)(e.querySelectorAll("."+t))}function O0(e,n){e.map(function(e){var t;e.style.cursor=(e=e,t=n,t=(t=Math.round(t/v0)%8)<0?8+t:t,e=e.dataset.y+e.dataset.x,e=m0.indexOf(e),m0[(0<=e&&e+t)%8]+"-resize")})}function _0(e){e="string"==typeof e?parseInt(e):e;return!isNaN(e)}w0.prototype.getName=function(){return"ImageEdit"},w0.prototype.initialize=function(e){var t=this;this.editor=e,this.disposer=e.addDomEventHandler("blur",this.onBlur),Object.keys(y0).forEach(function(e){t.allowedOperations|=t.editor.isFeatureEnabled(e)?y0[e]:0})},w0.prototype.dispose=function(){this.clearDndHelpers(),this.disposer(),this.disposer=null,this.editor=null},w0.prototype.onPluginEvent=function(e){switch(e.eventType){case 5:this.setEditingImage(null);break;case 6:var t=e.rawEvent.target;e.isClicking&&0==e.rawEvent.button&&(0,p0.safeInstanceOf)(t,"HTMLImageElement")&&t.isContentEditable&&(0,p0.matchesSelector)(t,this.options.imageSelector)&&this.setEditingImage(t,7);break;case 0:t=e.rawEvent.which;46==t||8==t?this.setEditingImage(null,!0):27==t&&this.image?(this.editInfo=(0,u0.getEditInfoFromImage)(this.image),this.setEditingImage(null),e.rawEvent.preventDefault()):16!=t&&17!=t&&18!=t&&this.setEditingImage(null,!0);break;case 7:"InsertEntity"==e.source&&e.data.type==C0||this.editor.queryElements((0,p0.getEntitySelector)(C0),this.removeWrapper);break;case 15:e.entity.type==C0&&(8==e.operation?this.removeWrapper(e.entity.wrapper):1==e.operation&&e.rawEvent.preventDefault());break;case 8:(0,p0.toArray)(e.clonedRoot.querySelectorAll(this.options.imageSelector)).forEach(function(e){(0,u0.deleteEditInfo)(e)})}},w0.prototype.setEditingImage=function(e,t){var n,r,o,i=this,a="number"==typeof t?t:0,t="number"!=typeof t&&!!t;this.image&&(this.clearDndHelpers(),(0,a0.default)(this.editor,this.image,this.editInfo,this.lastSrc,this.wasResized)&&this.editor.addUndoSnapshot(function(){return i.image},"ImageResize"),(n=this.getImageWrapper(this.image))&&this.removeWrapper(n),t&&this.editor.select(this.image),this.image=null,this.editInfo=null,this.lastSrc=null),!this.image&&null!=e&&e.isContentEditable&&(this.editor.addUndoSnapshot(),this.image=e,this.editInfo=(0,u0.getEditInfoFromImage)(e),this.wasResized=(t=this.image,r=t.width,o=t.height,!(""!==(t=t.style).maxWidth&&"initial"!==t.maxWidth&&"auto"!==t.maxWidth||!(_0(t.height)||_0(t.width)||_0(r)||_0(o)))),a=((0,l0.default)(e)?a:3)&this.allowedOperations,n=this.createWrapper(a),this.updateWrapper(),this.dndHelpers=i0(i0(i0(i0([],this.createDndHelpers("r_resizeH",g0.Resizer),!0),this.createDndHelpers("r_rotateH",f0.Rotator),!0),this.createDndHelpers("r_cropH",d0.Cropper),!0),this.createDndHelpers("r_cropC",d0.Cropper),!0),this.editor.select(n,-3))},w0.prototype.createWrapper=function(t){var n=this,r=(0,h0.insertEntity)(this.editor,C0,(0,p0.wrap)(this.image,6),!1,!0).wrapper,o=(r.style.position="relative",r.style.maxWidth="100%",r.style.verticalAlign="bottom",r.style.display=p0.Browser.isSafari?"inline-block":"inline-flex",this.lastSrc=this.image.getAttribute("src"),this.image.src=this.editInfo.src,this.image.style.position="absolute",this.image.style.maxWidth=null,{borderColor:this.options.borderColor,rotateIconHTML:this.options.rotateIconHTML,rotateHandleBackColor:this.editor.isDarkMode()?"#333":"white"}),i=[];return Object.keys(E0).forEach(function(e){(t&e)==e&&(0,p0.arrayPush)(i,E0[e](o))}),i.forEach(function(e){e=(0,p0.createElement)(e,n.image.ownerDocument);e&&r.appendChild(e)}),r},w0.prototype.getImageWrapper=function(e){e=(0,p0.getEntityFromElement)(null===(e=null==e?void 0:e.parentNode)||void 0===e?void 0:e.parentNode);return(null==e?void 0:e.type)==C0?e.wrapper:null},w0.prototype.createDndHelpers=function(e,t){var n=this,r={editInfo:this.editInfo,options:this.options,elementClass:e},o=this.getImageWrapper(this.image);return o?T0(o,e).map(function(e){return new s0.default(e,o0(o0({},r),{x:e.dataset.x,y:e.dataset.y}),n.updateWrapper,t,n.editor.getSizeTransformer())}):[]},w0.prototype.clearDndHelpers=function(){var e;null===(e=this.dndHelpers)||void 0===e||e.forEach(function(e){return e.dispose()}),this.dndHelpers=null},Pi.default=w0;var x0,N0,R0,L0,k0,I0,M0,A0,D0,j0,na={},w={},ra=(Object.defineProperty(w,"__esModule",{value:!0}),w.default=function(e,t){var n=e.naturalWidth,r=e.naturalHeight,o=e.leftPercent,i=e.topPercent;return{width:n*(1-o-e.rightPercent)*t,height:r*(1-i-e.bottomPercent)*t}},{}),B0=(Object.defineProperty(ra,"__esModule",{value:!0}),w),F0=Zi,H0=(ra.default=function(e,t){var e=(0,F0.getEditInfoFromImage)(e),t=(0,B0.default)(e,t),n=t.width,t=t.height;return Math.round(n)==Math.round(e.widthPx)&&Math.round(t)==Math.round(e.heightPx)},Object.defineProperty(na,"__esModule",{value:!0}),xi),z0=w,U0=ra,V0=Zi,Lo=(na.default=function(r,o,i,a,l){var e,t,n,s=(0,V0.getEditInfoFromImage)(o);(0,U0.default)(o,i)||(e=o,t=s.src,n=function(){var e,t,n;!r.isDisposed()&&r.contains(o)&&(e=o.getAttribute("src"),t=(n=(0,z0.default)(s,i)).width,n=n.height,s.widthPx=Math.max(t,a),s.heightPx=Math.max(n,l),r.addUndoSnapshot(function(){(0,H0.default)(r,o,s,e,!0)},"ImageResize"))},e.onload=function(){e.onload=null,e.onerror=null,n()},e.onerror=function(){e.onload=null,e.onerror=null,n()},e.src=t)},{}),W0=(Object.defineProperty(Lo,"__esModule",{value:!0}),Zi),Ra=(Lo.default=function(e,t){e.addUndoSnapshot(function(){t.style.width="",t.style.height="",t.style.maxWidth="100%",t.removeAttribute("width"),t.removeAttribute("height"),(0,W0.deleteEditInfo)(t)},"ImageResize")},ia=F,Object.defineProperty(ia,"__esModule",{value:!0}),ia.resetImage=ia.isResizedTo=ia.resizeByPercentage=ia.canRegenerateImage=ia.ImageEdit=void 0,N0=Pi,Object.defineProperty(ia,"ImageEdit",{enumerable:!0,get:function(){return N0.default}}),R0=yo,Object.defineProperty(ia,"canRegenerateImage",{enumerable:!0,get:function(){return R0.default}}),L0=na,Object.defineProperty(ia,"resizeByPercentage",{enumerable:!0,get:function(){return L0.default}}),k0=ra,Object.defineProperty(ia,"isResizedTo",{enumerable:!0,get:function(){return k0.default}}),I0=Lo,Object.defineProperty(ia,"resetImage",{enumerable:!0,get:function(){return I0.default}}),la=V,x0=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),xa=e&&e.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||x0(t,e,n)},Object.defineProperty(la,"__esModule",{value:!0}),xa(F,la),{}),La={},ka={},Ia=e&&e.__extends||(M0=function(e,t){return(M0=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}M0(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),wo=(Object.defineProperty(ka,"__esModule",{value:!0}),A0=Pi.default,Ia(q0,A0),q0.prototype.showResizeHandle=function(e){this.setEditingImage(e,3)},q0.prototype.hideResizeHandle=function(e){this.setEditingImage(null,e)},q0);function q0(e,t,n,r,o){return A0.call(this,{minHeight:t=void 0===t?10:t,minWidth:e=void 0===e?10:e,borderColor:n=void 0===n?"#DB626C":n,preserveRatio:r=void 0===r?!1:r,imageSelector:o=void 0===o?"img":o})||this}ka.default=wo,Aa=La,Object.defineProperty(Aa,"__esModule",{value:!0}),Aa.ImageResize=void 0,j0=ka,Object.defineProperty(Aa,"ImageResize",{enumerable:!0,get:function(){return j0.default}}),Ir=Ra,D0=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),ui=e&&e.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||D0(t,e,n)},Object.defineProperty(Ir,"__esModule",{value:!0}),ui(La,Ir);var fr={},hr={},o={},il={},K0=(Object.defineProperty(il,"__esModule",{value:!0}),t),v=(il.default=function(e,t){var n=e.fragment,e=e.clipboardData,r=e.html,e=e.image;r&&e&&(e=(new DOMParser).parseFromString(t(r),"text/html"),(0,K0.moveChildNodes)(n,null==e?void 0:e.body))},{}),G0=(Object.defineProperty(v,"__esModule",{value:!0}),t);function Z0(e){if(e&&!e.nextSibling&&["OL","UL","MENU"].indexOf((0,G0.getTagOfNode)(e))<0){var n=!1;if((0,G0.toArray)(e.childNodes).every(function(e){var t;return!(!(0,G0.safeInstanceOf)(e,"Text")||null!==(t=e.nodeValue)&&void 0!==t&&t.trim())||"LI"==(0,G0.getTagOfNode)(e)&&(n=!0)})&&n)return 1}}v.default=function(e){Z0(e)?(0,G0.wrap)((0,G0.toArray)(e.childNodes),"UL"):(0,G0.safeInstanceOf)(e.firstChild,"HTMLElement")&&Z0(e.firstChild)&&(0,G0.changeElementTag)(e.firstChild,"UL")};var h={},Y0=(Object.defineProperty(h,"__esModule",{value:!0}),h.excelHandler=void 0,t),X0=/<\/\s*td\s*>((?!<\/\s*tr\s*>)[\s\S])*$/i,$0=/<\/\s*tr\s*>((?!<\/\s*table\s*>)[\s\S])*$/i,Q0=/<tr[^>]*>[^<]*/i,J0=/<table[^>]*>[^<]*/i;function ep(e,t){var n;return e=(e=e.match(X0)?((n=t.match(Q0))?n[0]:"<TR>")+e+"</TR>":e).match($0)?((n=t.match(J0))?n[0]:"<TABLE>")+e+"</TABLE>":e}h.default=function(e,t){var n=e.fragment,r=e.sanitizingOption,o=e.htmlBefore,e=e.clipboardData,o=ep(e.html,o);e.html!=o&&(e=(new DOMParser).parseFromString(t(o),"text/html"),(0,Y0.moveChildNodes)(n,null==e?void 0:e.body)),(0,Y0.chainSanitizerCallback)(r.elementCallbacks,"TD",function(e){return"none"==e.style.borderStyle&&(e.style.border="solid 1px #d4d4d4"),!0})},h.excelHandler=ep;var g={},tp=(Object.defineProperty(g,"__esModule",{value:!0}),t),he=(g.default=function(e,t){var n=e.fragment,e=e.clipboardData;e.html&&!e.text&&e.image&&(t=(new DOMParser).parseFromString(t(e.html),"text/html"),(0,tp.moveChildNodes)(n,null==t?void 0:t.body))},{}),Ae={},He={};Object.defineProperty(He,"__esModule",{value:!0}),He.getObject=He.setObject=He.createCustomData=void 0;function np(e,t){var n=t.getAttribute("NodeId");return n||(n=e.nextNodeId.toString(),e.nextNodeId++,t.setAttribute("NodeId",n)),n}He.createCustomData=function(){return{dict:{},nextNodeId:1}},He.setObject=function(e,t,n,r){1!=t.nodeType||""!=(t=np(e,t))&&(e.dict[t]||(e.dict[t]={}),e.dict[t][n]=r)},He.getObject=function(e,t,n){if(1==t.nodeType){t=np(e,t);if(""!=t)return e.dict[t]&&e.dict[t][n]}return null},Object.defineProperty(Ae,"__esModule",{value:!0}),Ae.createWordConverter=void 0;var rp=He,dr=(Ae.createWordConverter=function(){return{nextUniqueId:1,numBulletsConverted:0,numNumberedConverted:0,wordConverterArgs:null,wordCustomData:(0,rp.createCustomData)()}},{}),ja={},op=(Object.defineProperty(ja,"__esModule",{value:!0}),ja.createLevelLists=void 0,ja.createLevelLists=function(){return{listsMetadata:{},currentUniqueListId:-1}},Object.defineProperty(dr,"__esModule",{value:!0}),dr.createWordConverterArguments=void 0,ja),Ys=(dr.createWordConverterArguments=function(e){return{nodes:e,currentIndex:0,lists:{},listItems:[],currentListIdsByLevels:[(0,op.createLevelLists)()],lastProcessedItem:null}},{}),ip=(Object.defineProperty(Ys,"__esModule",{value:!0}),Ys.processNodeConvert=Ys.processNodesDiscovery=void 0,ja),ap=He,lp=t,sp="UniqueListId",cp="mso-list",dp=/[\n|\r]/gi;function up(e,t,n,r){var o=function e(t,n,r){var o,i=null;if((o=1==n?gp(t):(i=e(t,n-1,null)).lastChild)&&1==o.nodeType){var a=(0,lp.getTagOfNode)(o);if("UL"==a||"OL"==a)return o}a=t.ownerDocument.createElement(r?r.tagName:"UL");return 1==n?t.parentNode.insertBefore(a,t):i.appendChild(a),a}(t,n.level,r),i=(0,ap.getObject)(e.wordCustomData,o,sp);return(i&&i!=n.uniqueListId||!i&&o.firstChild)&&(i=t.ownerDocument.createElement(r.tagName),o.parentNode.insertBefore(i,o.nextSibling),o=i),(0,ap.setObject)(e.wordCustomData,o,sp,n.uniqueListId),t=e,i=o,(n=r).tagName!=(0,lp.getTagOfNode)(i)&&(n=i.ownerDocument.createElement(n.tagName),(0,ap.setObject)(t.wordCustomData,n,sp,(0,ap.getObject)(t.wordCustomData,i,sp)),(0,lp.moveChildNodes)(n,i),i.parentNode.insertBefore(n,i),i.parentNode.removeChild(i),i=n),i}function fp(t,e){for(var n,r=[],o=t.firstChild;o;o=o.nextSibling)1==o.nodeType&&1<e&&fp(o,e-1),n=o=pp(o,!0),("SPAN"==(0,lp.getTagOfNode)(n)&&!n.firstChild||mp(o))&&r.push(o);r.forEach(function(e){return t.removeChild(e)})}function hp(e,t){for(var n=null,r=e.firstChild;!n&&r;)mp(r=pp(r,!0))?0==(n=r.textContent.trim()).length&&(n="o"):1==r.nodeType&&1<t&&(n=hp(r,t-1)),r=r.nextSibling;return n}function pp(e,t){if(8==e.nodeType){var n=e.data;if(n&&"[if !supportlists]"==n.trim().toLowerCase()){for(var r=e,o=null,i=0;i<4&&(r=vp(r));i++)if(8==r.nodeType&&(n=r.data)&&"[endif]"==n.trim().toLowerCase()){o=r;break}if(o){var a=e.ownerDocument.createElement("span");for(a.setAttribute("style","mso-list: ignore"),r=vp(e);r!=o;)r=r.nextSibling,a.appendChild(r.previousSibling);o.parentNode.insertBefore(a,o),t&&(e.parentNode.removeChild(e),o.parentNode.removeChild(o)),e=a}}}return e}function gp(e){for(var t=e;(t=t.previousSibling)&&bp(t););return t}function vp(e){for(var t=e;(t=t.nextSibling)&&bp(t););return t}function mp(e){if(1==e.nodeType){e=yp(e,cp);if(e&&0<e.length&&"ignore"==e.trim().toLowerCase())return 1}}function yp(e,t){return(0,lp.getStyles)(e)[t]||null}function bp(e){if(!e)return!0;if(3==e.nodeType)return 0==e.nodeValue.replace(dp,"").trim().length;var t=(0,lp.getTagOfNode)(e);return e.firstChild==e.lastChild&&("SPAN"==t||"FONT"==t)&&bp(e.firstChild)}Ys.processNodesDiscovery=function(e){for(var t=e.wordConverterArgs;t.currentIndex<t.nodes.length;){var n=t.nodes.item(t.currentIndex),r=function(e){if(1==e.nodeType){var t=yp(e,cp);if(t&&0<t.length)try{var n=t.split(" ");if(3==n.length)return{level:parseInt(n[1].substr("level".length)),wordListId:t,originalNode:e,uniqueListId:0}}catch(e){}}return null}(n);if(r){var o=t.currentListIdsByLevels[r.level-1]||(0,ip.createLevelLists)();if(t.currentListIdsByLevels[r.level-1]=o,t.lastProcessedItem&&gp(n)!=t.lastProcessedItem){i=void 0;a=void 0;l=void 0;var i=t;for(var a=0;a<i.currentListIdsByLevels.length;a++){var l=i.currentListIdsByLevels[a];l&&(l.currentUniqueListId=-1)}}var s,c=o.listsMetadata[r.wordListId];c?c.ignore||1!=c.numberOfItems||(s=hp(n,5),c.tagName=c.firstFakeBullet==s?"UL":"OL"):(s=hp(n,5),c={numberOfItems:0,uniqueListId:e.nextUniqueId++,firstFakeBullet:s,ignore:!s||0==s.length,tagName:0<=["o","·","§","-"].indexOf(s)?"UL":"OL"},o.listsMetadata[r.wordListId]=c,t.lists[c.uniqueListId.toString()]=c),r.uniqueListId=c.uniqueListId,c.ignore||"OL"==c.tagName&&0<c.numberOfItems&&o.currentUniqueListId!=r.uniqueListId?(c.ignore=!0,t.currentListIdsByLevels[0].currentUniqueListId=-1,t.currentListIdsByLevels=t.currentListIdsByLevels.slice(0,1)):(t.currentListIdsByLevels.length>r.level&&(t.currentListIdsByLevels=t.currentListIdsByLevels.slice(0,r.level)),o.currentUniqueListId=r.uniqueListId,t.listItems.push(r),c.numberOfItems++),t.lastProcessedItem=n}else{o=t.lastProcessedItem;o&&gp(n)==o&&n.tagName==o.tagName&&n.className==o.className&&(o.appendChild(o.ownerDocument.createElement("br")),o.appendChild(o.ownerDocument.createElement("br")),(0,lp.moveChildNodes)(o,n,!0),n.parentNode.removeChild(n))}t.currentIndex++}return 0<t.listItems.length},Ys.processNodeConvert=function(e){var t=e.wordConverterArgs;for(t.currentIndex=0;t.currentIndex<t.listItems.length;){var n,r=t.listItems[t.currentIndex],o=r.originalNode,i=t.lists[r.uniqueListId.toString()];i.ignore||(r=up(e,o,r,i))&&(fp(o,5),n=o.ownerDocument.createElement("LI"),(0,lp.moveChildNodes)(n,o),r.appendChild(n),o.parentNode.removeChild(o),"UL"==i.tagName?e.numBulletsConverted++:e.numNumberedConverted++),t.currentIndex++}return 0<e.numBulletsConverted||0<e.numNumberedConverted},Object.defineProperty(he,"__esModule",{value:!0});var Ep=t,Cp=Ae,wp=dr,Sp=Ys,m=(he.default=function(e){var t=e.sanitizingOption,e=e.fragment,t=((0,Ep.chainSanitizerCallback)(t.elementCallbacks,"O:P",function(e){return(0,Ep.moveChildNodes)(e),e.appendChild(e.ownerDocument.createTextNode(" ")),!0}),(0,Cp.createWordConverter)()),e=e.querySelectorAll("p");0<e.length&&(t.wordConverterArgs=(0,wp.createWordConverterArguments)(e),(0,Sp.processNodesDiscovery)(t)&&(0,Sp.processNodeConvert)(t))},{}),Pp=(Object.defineProperty(m,"__esModule",{value:!0}),t);function Tp(e){var t,n=e.start,r=e.end;n==r&&"DIV"==(0,Pp.getTagOfNode)(n)?(t=(0,Pp.changeElementTag)(n,"SPAN"),e.start=t,e.end=t,"BR"==(0,Pp.getTagOfNode)(t.lastChild)&&t.removeChild(t.lastChild)):"BR"==(0,Pp.getTagOfNode)(r)&&(t=r.ownerDocument.createTextNode(""),null===(n=r.parentNode)||void 0===n||n.insertBefore(t,r),e.end=t,null===(n=r.parentNode)||void 0===n||n.removeChild(r))}function Op(e,t,n){var r=(0,Pp.getBlockElementAtNode)(e,t.start),e=n?(0,Pp.getNextLeafSibling)(e,t.end):(0,Pp.getPreviousLeafSibling)(e,t.start);null!=r&&r.contains(e)&&(null===(r=(n?t.end:t.start).parentNode)||void 0===r||r.insertBefore(t.start.ownerDocument.createElement("br"),n?t.end.nextSibling:t.start))}m.default=function(e){for(var t=Pp.ContentTraverser.createBodyTraverser(e),n=[],r=null==t?void 0:t.currentBlockElement;r;r=t.getNextBlockElement())n.push({start:r.getStartNode(),end:r.getEndNode()});0<n.length&&(Tp(n[0]),Tp(n[n.length-1]),Op(e,n[0],!0),Op(e,n[n.length-1],!1))};var B={},Et={},_p=(Object.defineProperty(Et,"__esModule",{value:!0}),Et.createListItemBlock=void 0,Et.createListItemBlock=function(e){return{startElement:e=void 0===e?null:e,endElement:e,insertPositionNode:null,listItemContainers:e?[e]:[]}},Object.defineProperty(B,"__esModule",{value:!0}),B.isWordOnlineWithList=void 0,Et),xp=t,Np='div.ListContainerWrapper>ul[class^="BulletListStyle"],div.ListContainerWrapper>ol[class^="NumberListStyle"],span.WACImageContainer > img';function Rp(e,t,n){var r,o;e&&((o=n.insertPositionNode)?(r=o.parentNode)&&r.insertBefore(e,o):((r=n.startElement.parentNode)?r:t).appendChild(e))}B.isWordOnlineWithList=function(e){return!(!e||!e.querySelector(Np))},B.default=function(f){(0,xp.toArray)(f.querySelectorAll(Np)).forEach(function(e){var t,n=new RegExp("\\bListContainerWrapper\\b","g");e.previousSibling&&((t=(0,xp.splitParentNode)(e,!0)).className=t.className.replace(n,"")),e.nextSibling&&((t=(0,xp.splitParentNode)(e,!1)).className=t.className.replace(n,""))}),function(){for(var e,t=f.querySelectorAll(".ListContainerWrapper"),n=[],r=0;r<t.length;r++){var o,i,a=t[r];e?a==(i=(o=e.listItemContainers)[o.length-1]).nextSibling||(0,xp.getFirstLeafNode)(a)==(0,xp.getNextLeafSibling)(i.parentNode,i)?(o.push(a),e.endElement=a):(e.endElement=i,n.push(e),e=(0,_p.createListItemBlock)(a)):e=(0,_p.createListItemBlock)(a)}return 0<(null==e?void 0:e.listItemContainers.length)&&n.push(e),n}().forEach(function(c){(0,xp.collapseNodes)(f,c.startElement,c.endElement,!0).forEach(function(e){"DIV"==(0,xp.getTagOfNode)(e.firstChild)&&(0,xp.unwrap)(e)}),c.insertPositionNode=c.endElement.nextSibling;var d,u=f.ownerDocument,t=(c.listItemContainers.forEach(function(e){var t,s="UL"==(t=(0,xp.getTagOfNode)(e.firstChild))||"OL"==t?t:null;d=d||u.createElement(s),(0,xp.toArray)(e.querySelectorAll("li")).forEach(function(e){var t=parseInt(e.getAttribute("data-aria-level")),t=((0,xp.getTagOfNode)(d)!=s&&1==t&&(Rp(d,f,c),d=u.createElement(s)),d),n=s,r=u;if(n){for(var o,i,a=parseInt(e.getAttribute("data-aria-level")),l=t;1<a;)l=l.firstChild?(o=l.lastElementChild,"UL"==(i=(0,xp.getTagOfNode)(o))||"OL"==i?o:(l.appendChild(r.createElement(n)),l.lastElementChild)):(l.appendChild(r.createElement(n)),l.firstElementChild),a--;l.appendChild(e)}})}),Rp(d,f,c),c.startElement.parentNode);t&&c.listItemContainers.forEach(function(e){t.removeChild(e)})}),f.querySelectorAll(".WACImageContainer").forEach(function(e){(0,xp.safeInstanceOf)(e,"HTMLSpanElement")&&e.childNodes.forEach(function(e){"IMG"!=(0,xp.getTagOfNode)(e)&&e.parentElement.removeChild(e)})})},Object.defineProperty(o,"__esModule",{value:!0});var Lp,kp,Ip=il,Mp=v,Ap=h,Dp=g,jp=he,Bp=m,Fp=t,Hp=B,zp="google-sheets-html-origin";function Up(e){this.unknownTagReplacement=e=void 0===e?"SPAN":e}Up.prototype.getName=function(){return"Paste"},Up.prototype.initialize=function(e){this.editor=e},Up.prototype.dispose=function(){this.editor=null},Up.prototype.onPluginEvent=function(e){var t,n,r,o,i,a;10==e.eventType&&(t=e.htmlAttributes,n=e.fragment,r=e.sanitizingOption,o=e.clipboardData,i=this.editor.getTrustedHTMLHandler(),a=void 0,"urn:schemas-microsoft-com:office:word"==t["xmlns:w"]?(0,jp.default)(e):"urn:schemas-microsoft-com:office:excel"==t["xmlns:x"]||"Excel.Sheet"==t.ProgId?(0,Ap.default)(e,i):"PowerPoint.Slide"==t.ProgId?(0,Dp.default)(e,i):(a=(0,Fp.toArray)(n.querySelectorAll('ul[class^="BulletListStyle"]>.OutlineElement,ol[class^="NumberListStyle"]>.OutlineElement,span.WACImageContainer')))&&0<a.length?(a.forEach(function(e){e.style.display=null,e.style.margin=null}),(0,Hp.isWordOnlineWithList)(n)&&(0,Hp.default)(n)):n.querySelector(zp)?r.additionalTagReplacements[zp]="*":this.editor.isFeatureEnabled("ConvertSingleImageBody")&&1==(null===(t=o.htmlFirstLevelChildTags)||void 0===t?void 0:t.length)&&"IMG"==o.htmlFirstLevelChildTags[0]?(0,Ip.default)(e,i):((0,Mp.default)(n),(0,Bp.default)(n)),r.unknownTagReplacement=this.unknownTagReplacement)},o.default=Up,Be=hr,Object.defineProperty(Be,"__esModule",{value:!0}),Be.Paste=void 0,kp=o,Object.defineProperty(Be,"Paste",{enumerable:!0,get:function(){return kp.default}}),vt=fr,Lp=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),l=e&&e.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||Lp(t,e,n)},Object.defineProperty(vt,"__esModule",{value:!0}),l(hr,vt);var Vp,Wp,Ht={},Un={},de={},qp=(Object.defineProperty(de,"__esModule",{value:!0}),vd),Kp=t,Gp="Backspace",Zp=Kp.Browser.isIE?"Esc":"Escape",Yp=Kp.Browser.isIE?"Left":"ArrowLeft",Xp=Kp.Browser.isIE?"Up":"ArrowUp",$p=Kp.Browser.isIE?"Right":"ArrowRight",Qp=Kp.Browser.isIE?"Down":"ArrowDown",Jp=Kp.Browser.isIE?"Del":"Delete",eg=[0,229];function tg(e,t){this.dataProvider=e,this.pickerOptions=t,this.isPendingInputEventHandling=!1}tg.prototype.getName=function(){return"Picker"},tg.prototype.initialize=function(e){var n=this;this.editor=e,this.dataProvider.onInitalize(function(e){n.editor.focus();var t=n.getWord(null);t&&0!=t.length||!n.lastKnownRange||(n.editor.select(n.lastKnownRange),t=n.getWord(null)),n.editor.addUndoSnapshot(function(){t?(0,qp.replaceWithNode)(n.editor,t,e,!0):n.editor.insertNode(e),n.setIsSuggesting(!1)},n.pickerOptions.changeSource,n.pickerOptions.handleAutoComplete)},function(e){n.setIsSuggesting(e)},e)},tg.prototype.dispose=function(){this.editor=null,this.dataProvider.onDispose()},tg.prototype.willHandleEventExclusively=function(e){return this.isSuggesting&&(0==e.eventType||2==e.eventType||3==e.eventType)},tg.prototype.onPluginEvent=function(e){switch(e.eventType){case 7:var t;"SetContent"==e.source&&this.dataProvider.onContentChanged&&(this.isSuggesting&&this.setIsSuggesting(!1),t=[],this.editor.queryElements("[id^='"+this.pickerOptions.elementIdPrefix+"']",function(e){e.id&&t.push(e.id)}),this.dataProvider.onContentChanged(t));break;case 0:this.eventHandledOnKeyDown=!1,this.isAndroidKeyboardEvent(e)?(this.currentInputLength=this.calcInputLength(e),this.isPendingInputEventHandling=!0):(this.onKeyDownEvent(e),this.isPendingInputEventHandling=!1);break;case 3:this.isPendingInputEventHandling&&this.onAndroidInputEvent(e);break;case 2:!this.eventHandledOnKeyDown&&this.shouldHandleKeyUpEvent(e)&&(this.onKeyUpDomEvent(e),this.isPendingInputEventHandling=!1);break;case 6:this.isSuggesting&&this.setIsSuggesting(!1);break;case 14:this.dataProvider.onScroll&&this.dataProvider.onScroll(e.scrollContainer)}},tg.prototype.setLastKnownRange=function(e){this.lastKnownRange=e},tg.prototype.setIsSuggesting=function(e){(this.isSuggesting=e)||this.setLastKnownRange(null),this.dataProvider.onIsSuggestingChanged(e),this.setAriaOwns(e),this.setAriaActiveDescendant(e?0:null)},tg.prototype.cancelDefaultKeyDownEvent=function(e){this.eventHandledOnKeyDown=!0,e.rawEvent.preventDefault(),e.rawEvent.stopImmediatePropagation()},tg.prototype.getIdValue=function(e){return e.attributes&&e.attributes.getNamedItem("id")?e.attributes.getNamedItem("id").value:null},tg.prototype.getWordBeforeCursor=function(e){e=this.editor.getContentSearcherOfCursor(e);return e?e.getWordBefore():null},tg.prototype.replaceNode=function(e,t){e&&this.editor.deleteNode(e),t&&this.editor.insertNode(t)},tg.prototype.getRangeUntilAt=function(e){var o,i,a=this;return this.editor.getContentSearcherOfCursor(e).forEachTextInlineElement(function(e){for(var t=!1,n=e.getTextContent(),r=n?n.length:-1;0<=r;){if(n[r]==a.pickerOptions.triggerCharacter){o=e.getStartPosition().move(r),t=!0;break}r--}return t&&(i=e.getEndPosition()),t}),(0,Kp.createRange)(o,i)||this.editor.getDocument().createRange()},tg.prototype.shouldHandleKeyUpEvent=function(e){return this.isAndroidKeyboardEvent(e)||(0,Kp.isCharacterValue)(e.rawEvent)||this.isSuggesting&&!(0,Kp.isModifierKey)(e.rawEvent)},tg.prototype.onKeyUpDomEvent=function(e){var t,n,r;this.isSuggesting?(t=(r=(n=this.getWord(e)).substring(1)).trim(),n==this.pickerOptions.triggerCharacter||t&&0<t.length&&t.split(" ").length<=4?(this.dataProvider.queryStringUpdated(t,r==t),this.setLastKnownRange(this.editor.getSelectionRange())):this.setIsSuggesting(!1)):(n=this.getWordBeforeCursor(e),this.blockSuggestions?null!=n&&n[0]!=this.pickerOptions.triggerCharacter&&(this.blockSuggestions=!1):null!=n&&n.split(" ").length<=4&&n[0]==this.pickerOptions.triggerCharacter&&(this.setIsSuggesting(!0),t=(r=n.substring(1)).trim(),this.dataProvider.queryStringUpdated(t,r==t),this.setLastKnownRange(this.editor.getSelectionRange()),this.dataProvider.setCursorPoint&&(r=this.editor.getContentSearcherOfCursor(e),t=this.editor.getDocument().createRange(),e=r.getInlineElementBefore().getContainerNode(),this.setRangeStart(t,e,n)||(r=e.previousSibling,this.setRangeStart(t,r,this.pickerOptions.triggerCharacter)),(n=0==(n=t.getBoundingClientRect()).left&&0==n.bottom&&0==n.top?t.getClientRects()[0]:n)&&(t.detach(),e={x:n.left,y:(n.bottom+n.top)/2},r=(n.bottom-n.top)/2,this.dataProvider.setCursorPoint(e,r)))))},tg.prototype.onKeyDownEvent=function(e){var t,n=e.rawEvent;this.isSuggesting?n.key==Zp?(this.setIsSuggesting(!1),this.blockSuggestions=!0,this.cancelDefaultKeyDownEvent(e)):n.key==Gp?this.getWord(e)==this.pickerOptions.triggerCharacter&&this.setIsSuggesting(!1):this.dataProvider.shiftHighlight&&(this.pickerOptions.isHorizontal?n.key==Yp||n.key==$p:n.key==Xp||n.key==Qp)?(this.dataProvider.shiftHighlight(this.pickerOptions.isHorizontal?n.key==$p:n.key==Qp),this.dataProvider.getSelectedIndex&&this.setAriaActiveDescendant(this.dataProvider.getSelectedIndex()),this.cancelDefaultKeyDownEvent(e)):!this.dataProvider.selectOption||"Enter"!=n.key&&"Tab"!=n.key||(this.dataProvider.selectOption(),this.cancelDefaultKeyDownEvent(e)):n.key==Gp?this.tryRemoveNode(e)&&this.cancelDefaultKeyDownEvent(e):n.key!=Jp||(t=(n=(n=this.editor.getContentSearcherOfCursor(e)).getInlineElementAfter()?n.getInlineElementAfter().getContainerNode():null)?this.getIdValue(n):null)&&0==t.indexOf(this.pickerOptions.elementIdPrefix)&&(t=this.dataProvider.onRemove(n,!1),this.replaceNode(n,t),this.cancelDefaultKeyDownEvent(e))},tg.prototype.onAndroidInputEvent=function(e){this.newInputLength=this.calcInputLength(e),(this.newInputLength<this.currentInputLength||"deleteContentBackwards"===e.rawEvent.inputType)&&this.tryRemoveNode(e)&&(this.eventHandledOnKeyDown=!0)},tg.prototype.calcInputLength=function(e){e=this.getInlineElementBeforeCursor(e);return e?e.length:0},tg.prototype.tryRemoveNode=function(e){var t,e=this.editor.getContentSearcherOfCursor(e),n=e.getInlineElementBefore(),n=n?n.getContainerNode():null,r=n?this.getIdValue(n):null,e=e.getInlineElementAfter();return!(!r||0!=r.indexOf(this.pickerOptions.elementIdPrefix)||null!=e&&e instanceof Kp.PartialInlineElement)&&((t=this.dataProvider.onRemove(n,!0))?(this.replaceNode(n,t),this.isPendingInputEventHandling?this.editor.runAsync(function(e){e.select(t,-3)}):this.editor.select(t,-3)):this.editor.deleteNode(n),!0)},tg.prototype.getWord=function(e){var t=this.getRangeUntilAt(e).toString(),e=this.getWordBeforeCursor(e);return t==this.pickerOptions.triggerCharacter&&t!=e?e:t},tg.prototype.setRangeStart=function(e,t,n){n=t?t.textContent.lastIndexOf(n):-1;return-1<n&&(e.setStart(t,n),!0)},tg.prototype.setAriaOwns=function(e){this.editor.setEditorDomAttribute("aria-owns",e&&this.pickerOptions.suggestionsLabel?this.pickerOptions.suggestionsLabel:null)},tg.prototype.setAriaActiveDescendant=function(e){this.editor.setEditorDomAttribute("aria-activedescendant",null!=e&&this.pickerOptions.suggestionLabelPrefix?this.pickerOptions.suggestionLabelPrefix+e.toString():null)},tg.prototype.getInlineElementBeforeCursor=function(e){e=this.editor.getContentSearcherOfCursor(e),e=e?e.getInlineElementBefore():null;return e?e.getTextContent():null},tg.prototype.isAndroidKeyboardEvent=function(e){return"Unidentified"==e.rawEvent.key||null==e.rawEvent.key&&-1<eg.indexOf(e.rawEvent.charCode)},de.default=tg,Ut=Un,Object.defineProperty(Ut,"__esModule",{value:!0}),Ut.PickerPlugin=void 0,Wp=de,Object.defineProperty(Ut,"PickerPlugin",{enumerable:!0,get:function(){return Wp.default}}),Yt=Ht,Vp=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),Fe=e&&e.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||Vp(t,e,n)},Object.defineProperty(Yt,"__esModule",{value:!0}),Fe(Un,Yt);var je={},ze={},y={},Zt={},qn={},ng=(Object.defineProperty(qn,"__esModule",{value:!0}),Co),rg=t;function og(e,t){var n=e.td,r=e.isRTL,o=e.sizeTransformer,e=e.onStart,o=new rg.VTable(n,!0,o),n=(0,rg.normalizeRect)(n.getBoundingClientRect());return n?(e(),e=o.getCellsWithBorder(r?n.left:n.right,!r),n=o.getCellsWithBorder(r?n.left:n.right,r),{vTable:o,currentCells:e,nextCells:n}):{vTable:o,currentCells:[],nextCells:[]}}function ig(e,t,n,r,o){var i=e.td,a=e.sizeTransformer,e=n.vTable;return e.table.removeAttribute("height"),e.table.style.height=null,e.forEachCellOfCurrentRow(function(e){e.td&&(e.td.style.height=e.td==i?a(e.height)+o+"px":null)}),e.writeBack(),!0}function ag(e,n,t,c,d){var r=e.isRTL,o=e.sizeTransformer,e=t.vTable,i=t.nextCells,t=t.currentCells;if(!function(e,t,n,r,o){for(var i=0;i<t.length;i++){var a=t[i];if((l=(0,rg.normalizeRect)(a.getBoundingClientRect()))&&(s=o(lg(l,e,!r)))<30)return}for(i=0;i<n.length;i++){var l,a=n[i],s=Number.MAX_SAFE_INTEGER;if((s=a&&(l=(0,rg.normalizeRect)(a.getBoundingClientRect()))?o(lg(l,e,r)):s)<30)return}return 1}(n.pageX,t,i,r,o))return!1;var a=0==i.length,l=n.shiftKey,s=((a||l)&&(e.table.style.width=null),new Map);return t.forEach(function(e){var t=(0,rg.normalizeRect)(e.getBoundingClientRect());t&&(e.style.wordBreak="break-word",e.style.whiteSpace="normal",e.style.boxSizing="border-box",t=o(lg(t,n.pageX,!r)),s.set(e,t))}),s.forEach(function(e,t){t.style.width=e+"px"}),l||i.forEach(function(e){e.style.wordBreak="break-word",e.style.whiteSpace="normal",e.style.boxSizing="border-box",e.style.width=null}),e.writeBack(),!0}function lg(e,t,n){return n?t-e.left:e.right-t}function sg(e,t){e=e.td,e=(0,rg.normalizeRect)(e.getBoundingClientRect());e&&(t.style.top=e.bottom-4+"px",t.style.left=e.left+"px",t.style.width=e.right-e.left+"px",t.style.height="4px")}function cg(e,t){var n=e.td,e=e.isRTL,n=(0,rg.normalizeRect)(n.getBoundingClientRect());n&&(t.style.top=n.top+"px",t.style.left=(e?n.left:n.right)-4+1+"px",t.style.width="4px",t.style.height=n.bottom-n.top+"px")}qn.default=function(e,t,n,r,o,i){var a=e.ownerDocument,l=(0,rg.createElement)(r?7:8,a),a=(a.body.appendChild(l),{td:e,isRTL:n,sizeTransformer:t,onStart:o}),n=r?sg:cg,o=(n(a,l),{onDragStart:og,onDragging:r?ig:ag,onDragEnd:i});return{node:e,div:l,featureHandler:new ng.default(l,a,n,o,t)}};var M={},dg=(Object.defineProperty(M,"__esModule",{value:!0}),t),ug=(M.default=function(e,t,n,r,o){var i,a,l=e.getElementAtCursor("table",t),s=(0,dg.normalizeRect)(t.getBoundingClientRect()),l=l?(0,dg.normalizeRect)(l.getBoundingClientRect()):null;if(s&&l)return i=t.ownerDocument,a=(0,dg.createElement)(function(e,t,n,r){t=t?"white":"#4A4A4A";return{tag:"div",style:"position: fixed; width: 12px; height: 12px; font-size: 16px; color: "+t+"; line-height: 10px; vertical-align: middle; text-align: center; cursor: pointer; border: solid 1px "+t+"; border-radius: 50%; background-color: "+r,children:[{tag:"div",style:"position: absolute; box-sizing: border-box; background-color: "+r+";"+(e?(n?"right":"left")+": 12px; top: 5px; height: 3px; border-top: 1px solid "+t+"; border-bottom: 1px solid "+t+"; border-right: 1px solid "+t+"; border-left: 0px;":"left: 5px; top: 12px; width: 3px; border-left: 1px solid "+t+"; border-right: 1px solid "+t+"; border-bottom: 1px solid "+t+"; border-top: 0px;")},"+"]}}(r,e.isDarkMode(),n,e.getDefaultFormat().backgroundColor||"white"),i),r?(a.style.left=(n?s.right:s.left-13)+"px",a.style.top=s.bottom-8+"px",a.firstChild.style.width=l.right-l.left+"px"):(a.style.left=(n?s.left:s.right-8)+"px",a.style.top=s.top-13+"px",a.firstChild.style.height=l.bottom-l.top+"px"),i.body.appendChild(a),{div:a,featureHandler:new ug(a,t,r,e.getSizeTransformer(),o),node:t}},fg.prototype.dispose=function(){this.div.removeEventListener("click",this.insertTd),this.div=null},fg);function fg(e,t,n,r,o){var i=this;this.div=e,this.td=t,this.isHorizontal=n,this.sizeTransformer=r,this.onInsert=o,this.insertTd=function(){var e=new dg.VTable(i.td);i.isHorizontal||(e.normalizeTableCellSize(i.sizeTransformer),e.table.removeAttribute("width"),e.table.style.width=null),e.edit(i.isHorizontal?1:3),e.writeBack(),i.onInsert()},this.div.addEventListener("click",this.insertTd)}var T={},hg=(Object.defineProperty(T,"__esModule",{value:!0}),Co),pg=t;function gg(e,t){return{originalRect:e.table.getBoundingClientRect(),vTable:new pg.VTable(e.table,!0,e.sizeTransformer)}}function vg(e,d,t,u,f){var h=e.isRTL,n=e.sizeTransformer,e=t.originalRect,r=t.vTable,o=1+u/n(e.width)*(h?-1:1),i=1+f/n(e.height),p=.001<Math.abs(o-1),g=.001<Math.abs(i-1);if(p||g){for(var a=0;a<r.cells.length;a++)for(var l=0;l<r.cells[a].length;l++){var s,c=r.cells[a][l];c.td&&(p&&(r.table.style.width=null,s=n(c.width*o),c.td.style.boxSizing="border-box",30<=s&&(c.td.style.wordBreak="break-word",c.td.style.whiteSpace="normal",c.td.style.width=s+"px")),g&&(r.table.style.height=null,0==l?20<=(s=n(c.height*i))&&(c.td.style.height=s+"px"):c.td.style.height=null))}return r.writeBack(),!0}return!1}function mg(e,t){var n=e.table,e=e.isRTL,n=(0,pg.normalizeRect)(n.getBoundingClientRect());n&&(t.style.top=n.bottom+"px",t.style.left=e?n.left-12-2+"px":n.right+"px")}T.default=function(e,t,n,r){var o=e.ownerDocument,i=(0,pg.createElement)(n?10:9,o),o=(i.style.width="12px",i.style.height="12px",o.body.appendChild(i),{isRTL:n,table:e,sizeTransformer:t});return mg(o,i),{node:e,div:i,featureHandler:new hg.default(i,o,mg,{onDragStart:gg,onDragging:vg,onDragEnd:r},t)}};var W={},yg=(Object.defineProperty(W,"__esModule",{value:!0}),W.disposeTableEditFeature=void 0,W.disposeTableEditFeature=function(e){var t;null===(t=e.div.parentNode)||void 0===t||t.removeChild(e.div),e.div=null,e.featureHandler.dispose(),e.featureHandler=null},Object.defineProperty(Zt,"__esModule",{value:!0}),qn),bg=M,Eg=T,Cg=W,wg=t;function Sg(e,t,n){var r=this,n=(this.editor=e,this.table=t,this.onChanged=n,this.onFinishEditing=function(){return r.editor.select(r.start,r.end),r.editor.addUndoSnapshot(null,"Format"),r.editor.focus(),r.onChanged(),!1},this.onStartCellResize=function(){r.disposeTableResizer()},this.onInserted=function(){r.disposeTableResizer(),r.onFinishEditing()},e.getSizeTransformer());this.isRTL="rtl"==(0,wg.getComputedStyle)(t,"direction"),this.tableResizer=(0,Eg.default)(t,n,this.isRTL,this.onFinishEditing),this.editor.addUndoSnapshot(function(e,t){r.start=e,r.end=t})}Sg.prototype.dispose=function(){this.disposeTableResizer(),this.disposeCellResizers(),this.disposeTableInserter()},Sg.prototype.onMouseMove=function(e,t){for(var n=0;n<this.table.rows.length;n++){for(var r=this.table.rows[n],o=0;o<r.cells.length;o++){var i=r.cells[o],a=(0,wg.normalizeRect)(i.getBoundingClientRect());if(a){var l=t<=a.bottom;if((this.isRTL?e>=a.right:e<=a.right)&&l){0==n&&t<=a.top+5?(l=(a.left+a.right)/2,l=this.isRTL?e<l:l<e,this.setInserterTd(l?i:r.cells[o-1],!1)):0==o&&(this.isRTL?e>=a.right-5:e<=a.left+5)?this.setInserterTd(t>(a.top+a.bottom)/2?i:null===(l=this.table.rows[n-1])||void 0===l?void 0:l.cells[0],!0):this.setInserterTd(null),this.setResizingTd(i);break}}}if(o<r.cells.length)break}},Sg.prototype.setResizingTd=function(e){var t;this.horizontalResizer&&this.horizontalResizer.node!=e&&this.disposeCellResizers(),!this.horizontalResizer&&e&&(t=this.editor.getSizeTransformer(),this.horizontalResizer=(0,yg.default)(e,t,this.isRTL,!0,this.onStartCellResize,this.onFinishEditing),this.verticalResizer=(0,yg.default)(e,t,this.isRTL,!1,this.onStartCellResize,this.onFinishEditing))},Sg.prototype.setInserterTd=function(e,t){var n=t?this.horizontalInserter:this.verticalInserter;n&&n.node!=e&&this.disposeTableInserter(),this.horizontalInserter||this.verticalInserter||!e||(n=(0,bg.default)(this.editor,e,this.isRTL,t,this.onInserted),t?this.horizontalInserter=n:this.verticalInserter=n)},Sg.prototype.disposeTableResizer=function(){this.tableResizer&&((0,Cg.disposeTableEditFeature)(this.tableResizer),this.tableResizer=null)},Sg.prototype.disposeTableInserter=function(){this.horizontalInserter&&((0,Cg.disposeTableEditFeature)(this.horizontalInserter),this.horizontalInserter=null),this.verticalInserter&&((0,Cg.disposeTableEditFeature)(this.verticalInserter),this.verticalInserter=null)},Sg.prototype.disposeCellResizers=function(){this.horizontalResizer&&((0,Cg.disposeTableEditFeature)(this.horizontalResizer),this.horizontalResizer=null),this.verticalResizer&&((0,Cg.disposeTableEditFeature)(this.verticalResizer),this.verticalResizer=null)},Zt.default=Sg,Object.defineProperty(y,"__esModule",{value:!0});var Pg,Tg,Og=Zt,_g=t;function xg(){var l=this;this.tableRectMap=null,this.onMouseMove=function(e){if(!(0<e.buttons)){l.ensureTableRects();for(var t=e.pageX,n=e.pageY,r=null,o=l.tableRectMap.length-1;0<=o;o--){var i=l.tableRectMap[o],a=i.table,i=i.rect;if(t>=i.left-12&&t<=i.right+12&&n>=i.top-12&&n<=i.bottom+12){r=a;break}}l.setTableEditor(r),null===(e=l.tableEditor)||void 0===e||e.onMouseMove(t,n)}},this.invalidateTableRects=function(){l.tableRectMap=null}}xg.prototype.getName=function(){return"TableResize"},xg.prototype.initialize=function(e){this.editor=e,this.onMouseMoveDisposer=this.editor.addDomEventHandler({mousemove:this.onMouseMove})},xg.prototype.dispose=function(){this.onMouseMoveDisposer(),this.invalidateTableRects(),this.setTableEditor(null),this.editor=null},xg.prototype.onPluginEvent=function(e){switch(e.eventType){case 3:case 7:case 14:this.setTableEditor(null),this.invalidateTableRects()}},xg.prototype.setTableEditor=function(e){this.tableEditor&&e!=this.tableEditor.table&&(this.tableEditor.dispose(),this.tableEditor=null),!this.tableEditor&&e&&(this.tableEditor=new Og.default(this.editor,e,this.invalidateTableRects))},xg.prototype.ensureTableRects=function(){var n=this;this.tableRectMap||(this.tableRectMap=[],this.editor.queryElements("table",function(e){var t;!e.isContentEditable||(t=(0,_g.normalizeRect)(e.getBoundingClientRect()))&&n.tableRectMap.push({table:e,rect:t})}))},y.default=xg,Xn=ze,Object.defineProperty(Xn,"__esModule",{value:!0}),Xn.TableResize=void 0,Tg=y,Object.defineProperty(Xn,"TableResize",{enumerable:!0,get:function(){return Tg.default}}),n=je,Pg=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),$n=e&&e.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||Pg(t,e,n)},Object.defineProperty(n,"__esModule",{value:!0}),$n(ze,n);var Ng,Rg,or={},R={},ir={},Lg=(Object.defineProperty(ir,"__esModule",{value:!0}),t),kg=vd,Ig="WATERMARK_WRAPPER";function Mg(e,t){var r=this;this.watermark=e,this.format=t,this.showHideWatermark=function(){var e=r.editor.hasFocus(),t=r.editor.queryElements((0,Lg.getEntitySelector)(Ig)),n=0<t.length;e&&n?(t.forEach(r.removeWatermark),r.editor.focus()):e||n||!r.editor.isEmpty()||(0,kg.insertEntity)(r.editor,Ig,r.editor.getDocument().createTextNode(r.watermark),!1,!1,0)},this.removeWatermark=function(e){var t=e.parentNode;null==t||t.removeChild(e),r.editor.contains(t)&&"DIV"==(0,Lg.getTagOfNode)(t)&&!t.firstChild&&t.appendChild(r.editor.getDocument().createElement("BR"))},this.format=this.format||{fontSize:"14px",textColors:{lightModeColor:"#AAAAAA",darkModeColor:"#6B6B6B"}}}Mg.prototype.getName=function(){return"Watermark"},Mg.prototype.initialize=function(e){this.editor=e,this.disposer=this.editor.addDomEventHandler({focus:this.showHideWatermark,blur:this.showHideWatermark})},Mg.prototype.dispose=function(){this.disposer(),this.disposer=null,this.editor=null},Mg.prototype.onPluginEvent=function(e){var t,n;11==e.eventType||7==e.eventType&&(null===(t=e.data)||void 0===t?void 0:t.type)!=Ig?this.showHideWatermark():15==e.eventType&&e.entity.type==Ig&&(t=e.operation,n=e.entity.wrapper,8==t?this.removeWatermark(n):0==e.operation&&((0,Lg.applyFormat)(n,this.format,this.editor.isDarkMode()),n.spellcheck=!1))},ir.default=Mg,se=R,Object.defineProperty(se,"__esModule",{value:!0}),se.Watermark=void 0,Rg=ir,Object.defineProperty(se,"Watermark",{enumerable:!0,get:function(){return Rg.default}}),f=or,Ng=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),C=e&&e.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||Ng(t,e,n)},Object.defineProperty(f,"__esModule",{value:!0}),C(R,f);var Ve={},xt={},kr={},q={},u={},$i={},Ag=(Object.defineProperty($i,"__esModule",{value:!0}),$i.forEachCell=void 0,$i.forEachCell=function(e,t){for(var n=0;n<e.cells.length;n++)for(var r=0;r<e.cells[n].length;r++)t(e.cells[n][r],r,n)},Object.defineProperty(u,"__esModule",{value:!0}),u.deselectCellHandler=void 0,$i),Dg=t,jg=(u.deselectCellHandler=function t(e){var n;e&&(0,Dg.safeInstanceOf)(e,"HTMLTableCellElement")&&e.classList.contains("_tableCellSelected")&&(e.classList.remove("_tableCellSelected"),e.style.backgroundColor=null!==(n=e.dataset.originalBackgroundColor)&&void 0!==n?n:"",delete e.dataset.originalBackgroundColor,e.querySelectorAll("table").forEach(function(e){e=new Dg.VTable(e);(0,Ag.forEachCell)(e,function(e){return t(e.td)})}))},Object.defineProperty(q,"__esModule",{value:!0}),q.deSelectAll=void 0,u),Bg=$i,Vn=(q.deSelectAll=function(e){var t;(0,Bg.forEachCell)(e,function(e){e.td&&(0,jg.deselectCellHandler)(e.td)}),null!==(t=e.table)&&void 0!==t&&t.classList.contains("_tableSelected")&&e.table.classList.remove("_tableSelected")},{}),ce=(Object.defineProperty(Vn,"__esModule",{value:!0}),Vn.forEachSelectedCell=void 0,Vn.forEachSelectedCell=function(e,t){for(var n=0,r=e.selection,o=r.lastCell,i=r.firstCell,a=0;a<e.cells.length;a++)for(var l=0;l<e.cells[a].length;l++){var s=e.cells[a][l].td;(null!=s&&s.classList.contains("_tableCellSelected")||(a>=i.y&&a<=o.y||a<=i.y&&a>=o.y)&&(l>=i.x&&l<=o.x||l<=i.x&&l>=o.x))&&(n+=1,t(e.cells[a][l]))}return n},{}),bo=(Object.defineProperty(ce,"__esModule",{value:!0}),ce.getCellCoordinates=void 0,ce.getCellCoordinates=function(e,t){var n;if(e.cells)for(var r=0;r<e.cells.length;r++)for(var o=0;o<e.cells[r].length;o++)t==e.cells[r][o].td&&(n={x:o,y:r});return n},{}),Lr={},Fg=(Object.defineProperty(Lr,"__esModule",{value:!0}),Lr.highlightCellHandler=void 0,t),Kn=(Lr.highlightCellHandler=function t(e){var n;e.classList.contains("_tableCellSelected")||"rgba(198,198,198,0.7)"==e.style.backgroundColor||e.dataset.originalBackgroundColor&&""!=e.dataset.originalBackgroundColor||(e.dataset.originalBackgroundColor=null!==(n=null!==(n=e.style.backgroundColor)&&void 0!==n?n:e.style.background)&&void 0!==n?n:""),e.style.backgroundColor="rgba(198,198,198,0.7)",e.classList.add("_tableCellSelected"),e.querySelectorAll("td, th").forEach(function(e){(0,Fg.safeInstanceOf)(e,"HTMLTableCellElement")&&t(e)})},{});function Hg(e,t){return t<e?t:e}function zg(e,t){return e<t?t:e}Object.defineProperty(Kn,"__esModule",{value:!0}),Kn.normalizeTableSelection=void 0,Kn.normalizeTableSelection=function(e){var t=e.firstCell,e=e.lastCell;return{firstCell:{x:Hg(t.x,e.x),y:Hg(t.y,e.y)},lastCell:{x:zg(t.x,e.x),y:zg(t.y,e.y)}}},Object.defineProperty(bo,"__esModule",{value:!0}),bo.highlight=void 0;var Ug=u,Vg=Lr,Wg=Kn;bo.highlight=function(e){if(e.selection&&e.cells&&e){e.table.classList.contains("_tableSelected")||e.table.classList.add("_tableSelected");for(var t=(0,Wg.normalizeTableSelection)(e.selection),n=t.firstCell,r=t.lastCell,t=e.cells[e.cells.length-1].length-1,o=0==n.x&&0==n.y&&r.x==t&&r.y==e.cells.length-1,i=0;i<e.cells.length;i++)for(var a=0;a<e.cells[i].length;a++){var l=function(e,t,n){var r=e.cells[n][t].td;if(e.cells[n][t].spanLeft)for(var o=t;0<o;o--){var i=e.cells[n][o];if(i.spanAbove){r=null;break}if(i.td){r=i.td,t=o;break}}return r}(e,a,i);l&&(o||(i>=n.y&&i<=r.y||i<=n.y&&i>=r.y)&&(a>=n.x&&a<=r.x||a<=n.x&&a>=r.x)?(0,Vg.highlightCellHandler):(0,Ug.deselectCellHandler))(l)}}};var qg,Kg,Gg,zi={},Zg=(Object.defineProperty(zi,"__esModule",{value:!0}),zi.highlightAll=void 0,$i),Yg=Lr,Di=(zi.highlightAll=function(e){var r,o,i=null,a=null;e.table.classList.contains("_tableSelected")||e.table.classList.add("_tableSelected"),(0,Zg.forEachCell)(e,function(e,t,n){e.td&&((0,Yg.highlightCellHandler)(e.td),i=null!=i?i:t,a=null!=a?a:n,r=t,o=n)}),e.selection={firstCell:{x:i,y:a},lastCell:{x:r,y:o}}},{}),Xg=(Object.defineProperty(Di,"__esModule",{value:!0}),Di.removeCellsOutsideSelection=void 0,Kn),$g=(Di.removeCellsOutsideSelection=function(e){var t=(0,Xg.normalizeTableSelection)(e.selection),n=t.firstCell,t=t.lastCell,r=e.cells.length-1,o=e.cells[r].length-1,i=[],a=n.x,l=n.y,s=t.x,c=t.y;0==a&&0==l&&s==o&&c==r||(e.cells.forEach(function(e,n){0<(e=e.filter(function(e,t){return(l<=n&&n<=c||n<=l&&c<=n)&&(a<=t&&t<=s||t<=a&&s<=t)})).length&&i.push(e)}),e.cells=i)},Object.defineProperty(kr,"__esModule",{value:!0}),q),Qg=Vn,Jg=ce,e2=bo,t2=zi,n2=Di,s=t,r2="td,th";function o2(){var n=this;this.onMouseMove=function(e){if(n.editor.contains(e.target)){if(n.tableSelection&&(0,s.contains)(n.lastTarget,e.target,!0))return a2(n.editor,n.firstTarget,0),void e.preventDefault();var t;"TABLE"!=(0,s.getTagOfNode)(e.target)?(n.setData(e.target),n.firstTarget&&!n.firstTable||(n.lastTarget.lastChild==n.lastTarget.firstChild&&"TABLE"==(0,s.getTagOfNode)(n.lastTarget.lastChild)&&"DIV"==(0,s.getTagOfNode)(n.lastTarget)||!n.editor.contains(n.lastTarget)?e.preventDefault():(n.prepareSelection(),t=!!(0,s.safeInstanceOf)(n.lastTarget,"HTMLTableCellElement")&&(0,s.contains)(n.lastTarget,n.firstTable),n.firstTable&&n.firstTable==n.targetTable||t?n.selectionInsideTableMouseMove(e):n.tableSelection&&n.restoreSelection(),n.tableSelection&&(a2(n.editor,n.firstTarget,0),e.preventDefault())))):e.preventDefault()}},this.onMouseUp=function(){n.editor&&n.removeMouseUpEventListener()},this.DeleteTableContents={keys:[46,8],shouldHandleEvent:function(e,t){return 1==t.getSelectionRangeEx().type},handleEvent:function(e,t){1==t.getSelectionRangeEx().type&&t.addUndoSnapshot(function(){t.getSelectedRegions().forEach(function(e){(0,s.safeInstanceOf)(e.rootNode,"HTMLTableCellElement")&&i2(e.rootNode,t)})})}},this.lastTarget=null,this.firstTarget=null,this.tableSelection=!1,this.tableRange={firstCell:null,lastCell:null},this.startedSelection=!1}function i2(e,t){var n=new Range;n.selectNodeContents(e),n.deleteContents(),e.appendChild(t.getDocument().createElement("br"))}function a2(e,t,n,r,o){r=r||t,o=o||n,e.getDocument().defaultView.getSelection().setBaseAndExtent(t,n,r,o)}function l2(e,t){return e&&e.getElementAtCursor(r2,t)||t}function s2(e,t){return e?e.getElementAtCursor("table",t):null}function c2(e){e.queryElements("table._tableSelected",u2)}function d2(e){e.querySelectorAll("table._tableSelected").forEach(u2)}function u2(e){(0,s.safeInstanceOf)(e,"HTMLTableElement")&&(e=new s.VTable(e),(0,$g.deSelectAll)(e))}o2.prototype.getName=function(){return"TableCellSelection"},o2.prototype.initialize=function(e){this.editor=e,this.editor.addContentEditFeature(this.DeleteTableContents)},o2.prototype.dispose=function(){this.removeMouseUpEventListener(),this.editor=null},o2.prototype.onPluginEvent=function(e){if(this.editor)switch(e.eventType){case 8:d2(e.clonedRoot);break;case 9:this.handleBeforeCutCopy(e);break;case 5:this.startedSelection||this.handleMouseDownEvent(e);break;case 0:this.startedSelection?e.rawEvent.preventDefault():this.handleKeyDownEvent(e);break;case 2:this.startedSelection?e.rawEvent.preventDefault():this.handleKeyUpEvent(e);break;case 14:this.startedSelection&&this.handleScrollEvent()}},o2.prototype.handleScrollEvent=function(){this.setData(this.editor.getElementAtCursor()),this.firstTable==this.targetTable?this.tableSelection&&(this.vTable.selection.lastCell=(0,Jg.getCellCoordinates)(this.vTable,this.lastTarget),(0,e2.highlight)(this.vTable),this.tableRange.lastCell=this.vTable.selection.lastCell,a2(this.editor,this.firstTarget,0)):this.tableRange&&this.restoreSelection()},o2.prototype.handleBeforeCutCopy=function(e){var t,n=this,r=e.clonedRoot.querySelector("table._tableSelected");r&&((t=new s.VTable(r)).selection=this.tableRange,(0,n2.removeCellsOutsideSelection)(t),t.writeBack(),e.range.selectNode(r),e.isCut&&(0,Qg.forEachSelectedCell)(this.vTable,function(e){null!=e&&e.td&&i2(e.td,n.editor)}),d2(e.clonedRoot))},o2.prototype.handleKeyDownEvent=function(t){var n=this,e=t.rawEvent,r=e.shiftKey,o=e.ctrlKey,i=e.metaKey,e=e.which;r&&(o||i)||16==e||!r||(this.firstTarget||(o=this.editor.getFocusedPosition(),i=l2(this.editor,o.node),this.firstTarget=this.firstTarget||i),(0,s.safeInstanceOf)(this.firstTarget,"HTMLTableCellElement")&&this.editor.runAsync(function(e){e=e.getFocusedPosition();n.setData(n.tableSelection?n.lastTarget:e.node),n.firstTable==n.targetTable?(n.shouldConvertToTableSelection()||n.tableSelection)&&n.handleKeySelectionInsideTable(t):n.tableSelection&&(c2(n.editor),n.tableSelection=!1)}))},o2.prototype.handleKeyUpEvent=function(e){var e=e.rawEvent,t=e.shiftKey,e=e.which;!t&&16!=e&&this.firstTarget&&this.clearState()},o2.prototype.handleKeySelectionInsideTable=function(e){if(this.firstTarget=l2(this.editor,this.firstTarget),this.lastTarget=l2(this.editor,this.lastTarget),a2(this.editor,this.firstTarget,0),this.vTable=this.vTable||new s.VTable(this.firstTable),this.tableRange.firstCell=(0,Jg.getCellCoordinates)(this.vTable,this.firstTarget),this.tableRange.lastCell=this.getNextTD(e),!this.tableRange.lastCell||this.tableRange.lastCell.y>this.vTable.cells.length-1||-1==this.tableRange.lastCell.y){var t,n;if(this.lastTarget=this.editor.getElementAtCursor("td,th,div",this.firstTable),!(0,s.safeInstanceOf)(this.lastTarget,"HTMLTableCellElement"))return t=new s.Position(this.targetTable,null==this.tableRange.lastCell.y||-1==this.tableRange.lastCell.y?-2:-3),o=(r=this.editor.getDocument().defaultView.getSelection()).anchorNode,n=r.anchorOffset,r.setBaseAndExtent(o,n,t.node,t.offset),this.lastTarget=t.node,void e.rawEvent.preventDefault();this.prepareSelection()}this.vTable.selection=this.tableRange,(0,e2.highlight)(this.vTable);var r=this.isAfter(this.firstTarget,this.lastTarget),o=new s.Position(this.lastTarget,r?0:-1);a2(this.editor,o.node,o.offset),this.tableSelection=!0,e.rawEvent.preventDefault()},o2.prototype.handleMouseDownEvent=function(e){var l=this,e=e.rawEvent,t=e.which,e=e.shiftKey;if(3==t&&this.tableSelection){var n=this.editor.getElementAtCursor(r2);if(null!=n&&n.classList.contains("_tableCellSelected"))return this.firstTarget=null,this.lastTarget=null,this.editor.queryElements("td._tableCellSelected",function(e){l.firstTarget=l.firstTarget||e,l.lastTarget=e}),this.editor.getDocument().defaultView.getSelection().setBaseAndExtent(this.firstTarget,0,this.lastTarget,0),void(0,e2.highlight)(this.vTable)}this.editor.getDocument().addEventListener("mouseup",this.onMouseUp,!0),1!=t||e||(this.clearState(),this.editor.getDocument().addEventListener("mousemove",this.onMouseMove,!0),this.startedSelection=!0),1==t&&e&&this.editor.runAsync(function(e){var t,n,r=e.getDocument().defaultView.getSelection(),o=l2(e,r.anchorNode),r=l2(e,r.focusNode),i=s2(e,o),a=s2(e,o);i==a&&(0,s.safeInstanceOf)(o,"HTMLTableCellElement")&&(0,s.safeInstanceOf)(r,"HTMLTableCellElement")&&(l.vTable=new s.VTable(o),t=(0,Jg.getCellCoordinates)(l.vTable,o),n=(0,Jg.getCellCoordinates)(l.vTable,r),l.vTable.selection={firstCell:t,lastCell:n},l.firstTarget=o,l.lastTarget=r,(0,e2.highlight)(l.vTable),l.tableRange=l.vTable.selection,l.tableSelection=!0,l.firstTable=i,l.targetTable=a,a2(e,o,0))})},o2.prototype.restoreSelection=function(){c2(this.editor),this.tableSelection=!1;var e=this.isAfter(this.firstTarget,this.lastTarget),t=new s.Position(this.lastTarget,e?-1:0),n=new Range;this.firstTarget&&n.selectNodeContents(this.firstTarget),a2(this.editor,this.firstTarget,(e?s.Position.getEnd(n):s.Position.getStart(n)).offset,t.element,t.offset)},o2.prototype.selectionInsideTableMouseMove=function(e){var t;this.lastTarget!=this.firstTarget?(a2(this.editor,this.firstTarget,0),this.firstTable!=this.targetTable&&null!==(t=this.targetTable)&&void 0!==t&&t.contains(this.firstTable)&&(this.firstTarget=this.editor.getElementAtCursor(r2,this.lastTarget),this.firstTarget.querySelectorAll("table").forEach(function(e){e=new s.VTable(e);(0,t2.highlightAll)(e)})),this.firstTable&&(this.tableSelection=!0,(null===(t=this.vTable)||void 0===t?void 0:t.table)!=this.firstTable&&(0,s.safeInstanceOf)(this.firstTarget,"HTMLTableCellElement")&&(this.vTable=new s.VTable(this.firstTarget)),this.tableRange.firstCell=(0,Jg.getCellCoordinates)(this.vTable,this.firstTarget),this.tableRange.lastCell=(0,Jg.getCellCoordinates)(this.vTable,this.lastTarget),this.vTable.selection=this.tableRange,(0,e2.highlight)(this.vTable)),e.preventDefault()):this.lastTarget==this.firstTarget&&this.tableSelection&&(this.vTable=new s.VTable(this.firstTable),this.tableRange.firstCell=(0,Jg.getCellCoordinates)(this.vTable,this.firstTarget),this.tableRange.lastCell=this.tableRange.firstCell,this.vTable.selection=this.tableRange,(0,e2.highlight)(this.vTable),this.tableRange=this.vTable.selection)},o2.prototype.removeMouseUpEventListener=function(){this.startedSelection&&(this.startedSelection=!1,this.editor.getDocument().removeEventListener("mouseup",this.onMouseUp,!0),this.editor.getDocument().removeEventListener("mousemove",this.onMouseMove,!0))},o2.prototype.clearTableCellSelection=function(){var e;null!==(e=this.editor)&&void 0!==e&&e.hasFocus()&&c2(this.editor)},o2.prototype.clearState=function(){this.clearTableCellSelection(),this.vTable=null,this.firstTarget=null,this.lastTarget=null,this.tableRange={firstCell:null,lastCell:null},this.tableSelection=!1,this.firstTable=null,this.targetTable=null},o2.prototype.getNextTD=function(e){if(this.lastTarget=this.editor.getElementAtCursor(r2,this.lastTarget),(0,s.safeInstanceOf)(this.lastTarget,"HTMLTableCellElement")){var t=(0,Jg.getCellCoordinates)(this.vTable,this.lastTarget);if(this.tableSelection)switch(e.rawEvent.which){case 39:t.x+=this.lastTarget.colSpan,null==this.vTable.cells[t.y][t.x]&&(t.x=this.vTable.cells[t.y].length-1,t.y++);break;case 37:0==t.x?t.y--:t.x--;break;case 38:t.y--;break;case 40:t.y++}return 0<=t.y&&0<=t.x&&(this.lastTarget=this.vTable.getTd(t.y,t.x)),t}return null},o2.prototype.prepareSelection=function(){var e,t,n,r=this.lastTarget!=this.firstTarget&&(null===(t=this.firstTable)||void 0===t?void 0:t.contains((0,s.findClosestElementAncestor)(this.targetTable,this.firstTable,r2)));if(r&&this.tableSelection)for(;r;)this.lastTarget=(0,s.findClosestElementAncestor)(this.targetTable,this.firstTable,r2),this.targetTable=s2(this.editor,this.lastTarget),r=this.lastTarget!=this.firstTarget&&(null===(e=this.firstTable)||void 0===e?void 0:e.contains((0,s.findClosestElementAncestor)(this.targetTable,this.firstTable,r2)));var o=this.lastTarget!=this.firstTarget&&(null===(t=this.targetTable)||void 0===t?void 0:t.contains((0,s.findClosestElementAncestor)(this.firstTable,this.targetTable,r2)));if(o&&this.tableSelection)for(;o;)this.firstTarget=(0,s.findClosestElementAncestor)(this.firstTable,this.targetTable,r2),this.firstTable=this.editor.getElementAtCursor("table",this.firstTarget),o=this.lastTarget!=this.firstTarget&&(null===(n=this.targetTable)||void 0===n?void 0:n.contains((0,s.findClosestElementAncestor)(this.firstTable,this.targetTable,r2)))},o2.prototype.setData=function(e){var t=this.editor.getFocusedPosition();t&&(this.firstTarget=this.firstTarget||l2(this.editor,t.node),this.firstTarget.nodeType==Node.TEXT_NODE&&(this.firstTarget=this.editor.getElementAtCursor(r2,this.firstTarget)),!this.editor.contains(this.firstTarget)&&this.lastTarget&&(this.firstTarget=this.lastTarget)),this.firstTable=s2(this.editor,this.firstTarget),this.lastTarget=l2(this.editor,e),this.targetTable=s2(this.editor,this.lastTarget)},o2.prototype.isAfter=function(e,t){if(e&&t){if(t.contains(e)){var n=null===(n=e.getBoundingClientRect)||void 0===n?void 0:n.call(e),r=null===(r=t.getBoundingClientRect)||void 0===r?void 0:r.call(t);if(n&&r)return n.top>r.top&&n.bottom<r.bottom}return new s.Position(e,-1).isAfter(new s.Position(t,-1))}return!1},o2.prototype.shouldConvertToTableSelection=function(){var t=this;if(!this.firstTable||!this.editor)return!1;var e=this.editor.getSelectedRegions();if(1==e.length)return!1;var n=!0;return e.forEach(function(e){(0,s.contains)(t.firstTable,e.rootNode)||(n=!1)}),n},kr.default=o2,ki=xt,Object.defineProperty(ki,"__esModule",{value:!0}),ki.TableCellSelection=void 0,Gg=kr,Object.defineProperty(ki,"TableCellSelection",{enumerable:!0,get:function(){return Gg.default}}),Wi=Ve,Kg=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),Ki=e&&e.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||Kg(t,e,n)},Object.defineProperty(Wi,"__esModule",{value:!0}),Ki(xt,Wi),Gi=Ue,qg=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),r=e&&e.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||qg(t,e,n)},Object.defineProperty(Gi,"__esModule",{value:!0}),r(cr,Gi),r(rr,Gi),r(H,Gi),r(qe,Gi),r(Na,Gi),r(V,Gi),r(Ra,Gi),r(fr,Gi),r(Ht,Gi),r(je,Gi),r(or,Gi),r(Ve,Gi);const f2=[new cr.ContentEdit,new qe.CutPasteListChain,new Na.HyperLink,new fr.Paste,new Ve.TableCellSelection,new je.TableResize,new Ue.ImageEdit];function h2(e,t,...n){const r=document.createElement(e);if(t)for(const e in t)r.setAttribute(e,t[e]);for(const e of n)"string"==typeof e?r.appendChild(document.createTextNode(e)):r.appendChild(e);return r}function p2(e,t){var n,r,t=(t=void 0===t?{}:t).insertAt;e&&"undefined"!=typeof document&&(n=document.head||document.getElementsByTagName("head")[0],(r=document.createElement("style")).type="text/css","top"===t&&n.firstChild?n.insertBefore(r,n.firstChild):n.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e)))}p2(":root {\r\n    --border-color: #f1f3f4;\r\n    --active-color: #e8f0fe;\r\n}\r\n\r\n.toolbar {\r\n    display: flex;\r\n    flex: 0 0 auto;\r\n    /* border: 2px solid var(--border-color); */\r\n    width: 100%;\r\n    box-sizing: border-box;\r\n    gap: 4px;\r\n    flex-wrap: wrap;\r\n    padding: 4px;\r\n    padding-bottom: 0px;\r\n    margin-bottom: 2px;\r\n}\r\n\r\n.toolbar-button {\r\n    border-width: 0;\r\n    border-radius: 4px;\r\n    margin: 2px;\r\n    padding: 0;\r\n    background-color: #fff;\r\n    cursor: pointer;\r\n    height: 30px;\r\n}\r\n\r\n.toolbar-button:hover,\r\n.toolbar-button:focus {\r\n    background-color: var(--border-color);\r\n    /* outline: none; */\r\n}\r\n\r\n.active {\r\n    background-color: var(--active-color);\r\n}\r\n");const g2={bold:{title:"Bold",image:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-6255 -8740 32 32'%3e %3cdefs%3e %3cstyle%3e .cls-1 %7b fill: none%3b %7d .cls-2 %7b fill: %23666%3b %7d %3c/style%3e %3c/defs%3e %3cg id='FB:_Bold' data-name='FB: Bold' transform='translate(-6999 -9195.999)'%3e %3crect id='Rectangle_2297' data-name='Rectangle 2297' class='cls-1' width='32' height='32' rx='2' transform='translate(744 455.999)'/%3e %3cpath id='Path_1536' data-name='Path 1536' class='cls-2' d='M9.828-9.031a3.888%2c3.888%2c0%2c0%2c1%2c1.548.311%2c4.012%2c4.012%2c0%2c0%2c1%2c1.27.855%2c4.012%2c4.012%2c0%2c0%2c1%2c.855%2c1.27%2c3.888%2c3.888%2c0%2c0%2c1%2c.311%2c1.548A3.888%2c3.888%2c0%2c0%2c1%2c13.5-3.5a4.012%2c4.012%2c0%2c0%2c1-.855%2c1.27%2c4.012%2c4.012%2c0%2c0%2c1-1.27.855%2c3.888%2c3.888%2c0%2c0%2c1-1.548.311H3.188V-15.937H9.828a3.384%2c3.384%2c0%2c0%2c1%2c1.345.27%2c3.465%2c3.465%2c0%2c0%2c1%2c1.1.739%2c3.465%2c3.465%2c0%2c0%2c1%2c.739%2c1.1%2c3.384%2c3.384%2c0%2c0%2c1%2c.27%2c1.345%2c3.384%2c3.384%2c0%2c0%2c1-.27%2c1.345%2c3.465%2c3.465%2c0%2c0%2c1-.739%2c1.1%2c3.465%2c3.465%2c0%2c0%2c1-1.1.739A3.384%2c3.384%2c0%2c0%2c1%2c9.828-9.031ZM6.375-9.562H7.969a2.034%2c2.034%2c0%2c0%2c0%2c.822-.17%2c2.176%2c2.176%2c0%2c0%2c0%2c.677-.457%2c2.19%2c2.19%2c0%2c0%2c0%2c.457-.672%2c2.024%2c2.024%2c0%2c0%2c0%2c.17-.826%2c2.034%2c2.034%2c0%2c0%2c0-.17-.822%2c2.176%2c2.176%2c0%2c0%2c0-.457-.677%2c2.176%2c2.176%2c0%2c0%2c0-.677-.457%2c2.034%2c2.034%2c0%2c0%2c0-.822-.17H6.375ZM8.5-3.187a2.034%2c2.034%2c0%2c0%2c0%2c.822-.17A2.176%2c2.176%2c0%2c0%2c0%2c10-3.814a2.19%2c2.19%2c0%2c0%2c0%2c.457-.672%2c2.024%2c2.024%2c0%2c0%2c0%2c.17-.826%2c2.034%2c2.034%2c0%2c0%2c0-.17-.822A2.176%2c2.176%2c0%2c0%2c0%2c10-6.811a2.176%2c2.176%2c0%2c0%2c0-.677-.457%2c2.034%2c2.034%2c0%2c0%2c0-.822-.17H6.375v4.25Z' transform='translate(752 479.999)'/%3e %3c/g%3e%3c/svg%3e",onClick:vd.toggleBold,checked:e=>!!e.isBold},italic:{title:"Italic",image:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-6219 -8740 32 32'%3e %3cdefs%3e %3cstyle%3e .cls-1 %7b fill: none%3b %7d .cls-2 %7b fill: %23666%3b %7d %3c/style%3e %3c/defs%3e %3cg id='FB:_Italics' data-name='FB: Italics' transform='translate(-6999 -9195.999)'%3e %3crect id='Rectangle_2298' data-name='Rectangle 2298' class='cls-1' width='32' height='32' rx='2' transform='translate(780 455.999)'/%3e %3cpath id='Path_1552' data-name='Path 1552' class='cls-2' d='M10.808-17H11.92L6.259%2c0H5.138Z' transform='translate(788 479.999)'/%3e %3c/g%3e%3c/svg%3e",onClick:vd.toggleItalic,checked:e=>!!e.isItalic},underline:{title:"Underline",image:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-6183 -8740 32 32'%3e %3cdefs%3e %3cstyle%3e .cls-1 %7b fill: none%3b %7d .cls-2 %7b fill: %23666%3b %7d %3c/style%3e %3c/defs%3e %3cg id='FB:_Underline' data-name='FB: Underline' transform='translate(-6999 -9196)'%3e %3crect id='Rectangle_2299' data-name='Rectangle 2299' class='cls-1' width='32' height='32' rx='2' transform='translate(816 456)'/%3e %3cpath id='Path_1568' data-name='Path 1568' class='cls-2' d='M13.813-17v9.563A5.2%2c5.2%2c0%2c0%2c1%2c13.4-5.366%2c5.344%2c5.344%2c0%2c0%2c1%2c12.26-3.677%2c5.344%2c5.344%2c0%2c0%2c1%2c10.571-2.54%2c5.2%2c5.2%2c0%2c0%2c1%2c8.5-2.125%2c5.2%2c5.2%2c0%2c0%2c1%2c6.429-2.54%2c5.344%2c5.344%2c0%2c0%2c1%2c4.74-3.677%2c5.344%2c5.344%2c0%2c0%2c1%2c3.6-5.366a5.2%2c5.2%2c0%2c0%2c1-.415-2.071V-17H4.25v9.563a4.092%2c4.092%2c0%2c0%2c0%2c.336%2c1.652A4.336%2c4.336%2c0%2c0%2c0%2c5.5-4.437a4.336%2c4.336%2c0%2c0%2c0%2c1.349.913A4.092%2c4.092%2c0%2c0%2c0%2c8.5-3.187a4.092%2c4.092%2c0%2c0%2c0%2c1.652-.336A4.336%2c4.336%2c0%2c0%2c0%2c11.5-4.437a4.336%2c4.336%2c0%2c0%2c0%2c.913-1.349%2c4.092%2c4.092%2c0%2c0%2c0%2c.336-1.652V-17ZM3.188-1.062H13.813V0H3.188Z' transform='translate(824 480)'/%3e %3c/g%3e%3c/svg%3e",onClick:vd.toggleUnderline,checked:e=>!!e.isUnderline},strikeThrough:{title:"Strike through",image:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-5860 -8860 32 32'%3e %3cdefs%3e %3cstyle%3e .cls-1 %7b fill: none%3b %7d .cls-2 %7b fill: %23666%3b %7d %3c/style%3e %3c/defs%3e %3cg id='FB:_Strikeout' data-name='FB: Strikeout' transform='translate(-6880 -9195.999)'%3e %3crect id='Rectangle_2295' data-name='Rectangle 2295' class='cls-1' width='32' height='32' rx='2' transform='translate(1020 335.999)'/%3e %3cpath id='Path_1745' data-name='Path 1745' class='cls-2' d='M8.5-7.437H4.292a2.083%2c2.083%2c0%2c0%2c0%2c.145.643%2c1.589%2c1.589%2c0%2c0%2c0%2c.324.506%2c1.391%2c1.391%2c0%2c0%2c0%2c.494.328%2c1.753%2c1.753%2c0%2c0%2c0%2c.656.116%2c1.725%2c1.725%2c0%2c0%2c0%2c.618-.112%2c2.287%2c2.287%2c0%2c0%2c0%2c.552-.3v.73a2.183%2c2.183%2c0%2c0%2c1-.623.253%2c2.936%2c2.936%2c0%2c0%2c1-.681.079%2c2.4%2c2.4%2c0%2c0%2c1-.909-.166%2c2.108%2c2.108%2c0%2c0%2c1-.71-.465%2c2.16%2c2.16%2c0%2c0%2c1-.469-.71%2c2.562%2c2.562%2c0%2c0%2c1-.187-.9H2.582a3.234%2c3.234%2c0%2c0%2c1-.2.876%2c2.347%2c2.347%2c0%2c0%2c1-.423.714%2c1.886%2c1.886%2c0%2c0%2c1-.652.477A2.127%2c2.127%2c0%2c0%2c1%2c.423-5.2%2c1.58%2c1.58%2c0%2c0%2c1-1.013-6h-.017v.689h-.764V-7.437H-3.237v2.125h-.772V-6.06h-.017A1.6%2c1.6%2c0%2c0%2c1-5.5-5.2a2%2c2%2c0%2c0%2c1-.6-.087%2c1.35%2c1.35%2c0%2c0%2c1-.481-.261%2c1.213%2c1.213%2c0%2c0%2c1-.32-.436%2c1.469%2c1.469%2c0%2c0%2c1-.116-.6%2c2%2c2%2c0%2c0%2c1%2c.05-.444%2c1.253%2c1.253%2c0%2c0%2c1%2c.174-.411H-8.5V-8.5h4.491a1.357%2c1.357%2c0%2c0%2c0-.249-.768.859.859%2c0%2c0%2c0-.73-.295%2c2.236%2c2.236%2c0%2c0%2c0-.834.154%2c2.7%2c2.7%2c0%2c0%2c0-.726.436v-.789a2.635%2c2.635%2c0%2c0%2c1%2c.78-.336%2c3.478%2c3.478%2c0%2c0%2c1%2c.847-.1%2c1.638%2c1.638%2c0%2c0%2c1%2c1.253.436A1.847%2c1.847%2c0%2c0%2c1-3.246-8.5h1.453v-3.893h.764v3.138h.017A1.8%2c1.8%2c0%2c0%2c1%2c.639-10.2a2.059%2c2.059%2c0%2c0%2c1%2c.722.12%2c1.675%2c1.675%2c0%2c0%2c1%2c.564.344%2c1.873%2c1.873%2c0%2c0%2c1%2c.4.54%2c2.513%2c2.513%2c0%2c0%2c1%2c.224.7H3.619a2.274%2c2.274%2c0%2c0%2c1%2c.344-.739A2.269%2c2.269%2c0%2c0%2c1%2c4.5-9.77a2.262%2c2.262%2c0%2c0%2c1%2c.685-.324%2c2.9%2c2.9%2c0%2c0%2c1%2c.8-.108%2c3.219%2c3.219%2c0%2c0%2c1%2c.569.05%2c1.887%2c1.887%2c0%2c0%2c1%2c.535.183v.78a1.892%2c1.892%2c0%2c0%2c0-1.137-.374%2c1.539%2c1.539%2c0%2c0%2c0-.934.282%2c1.794%2c1.794%2c0%2c0%2c0-.594.78H8.5Zm-12.509%2c0h-1.7a.825.825%2c0%2c0%2c0-.407.3.921.921%2c0%2c0%2c0-.116.5.77.77%2c0%2c0%2c0%2c.075.349.735.735%2c0%2c0%2c0%2c.2.249.851.851%2c0%2c0%2c0%2c.291.149%2c1.207%2c1.207%2c0%2c0%2c0%2c.349.05%2c1.284%2c1.284%2c0%2c0%2c0%2c.548-.112%2c1.25%2c1.25%2c0%2c0%2c0%2c.411-.3A1.338%2c1.338%2c0%2c0%2c0-4.1-6.707a1.626%2c1.626%2c0%2c0%2c0%2c.091-.548ZM.448-9.562A1.431%2c1.431%2c0%2c0%2c0-.44-9.28a1.434%2c1.434%2c0%2c0%2c0-.515.78h2.7a1.422%2c1.422%2c0%2c0%2c0-.457-.772A1.247%2c1.247%2c0%2c0%2c0%2c.448-9.562ZM.332-5.844a1.366%2c1.366%2c0%2c0%2c0%2c.61-.129%2c1.3%2c1.3%2c0%2c0%2c0%2c.44-.349%2c1.653%2c1.653%2c0%2c0%2c0%2c.278-.51%2c2.75%2c2.75%2c0%2c0%2c0%2c.133-.606H-1.029v.174a1.527%2c1.527%2c0%2c0%2c0%2c.1.556%2c1.376%2c1.376%2c0%2c0%2c0%2c.278.448%2c1.307%2c1.307%2c0%2c0%2c0%2c.432.3A1.348%2c1.348%2c0%2c0%2c0%2c.332-5.844Z' transform='translate(1036 359.999)'/%3e %3c/g%3e%3c/svg%3e",onClick:vd.toggleStrikethrough,checked:e=>!!e.isStrikeThrough},bullet:{title:"Bullet",image:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-10568 -10457 32 32'%3e %3cdefs%3e %3cstyle%3e .cls-1 %7b fill: none%3b %7d .cls-2 %7b fill: %23666%3b %7d .cls-3 %7b fill: %232E77D0%3b %7d %3c/style%3e %3c/defs%3e %3cg id='_00-UL' data-name='00-UL' transform='translate(-11635 -10912.999)'%3e %3crect id='Rectangle_2306' data-name='Rectangle 2306' class='cls-1' width='32' height='32' rx='2' transform='translate(1067 455.999)'/%3e %3crect id='Rectangle_3057' data-name='Rectangle 3057' class='cls-2' width='13' height='1' transform='translate(1078 466.999)'/%3e %3crect id='Rectangle_3058' data-name='Rectangle 3058' class='cls-2' width='13' height='1' transform='translate(1078 469.999)'/%3e %3crect id='Rectangle_3059' data-name='Rectangle 3059' class='cls-2' width='13' height='1' transform='translate(1078 472.999)'/%3e %3crect id='Rectangle_3060' data-name='Rectangle 3060' class='cls-2' width='13' height='1' transform='translate(1078 475.999)'/%3e %3crect id='Rectangle_3062' data-name='Rectangle 3062' class='cls-3' width='1' height='1' transform='translate(1075 466.999)'/%3e %3crect id='Rectangle_3065' data-name='Rectangle 3065' class='cls-3' width='1' height='1' transform='translate(1075 469.999)'/%3e %3crect id='Rectangle_3064' data-name='Rectangle 3064' class='cls-3' width='1' height='1' transform='translate(1075 472.999)'/%3e %3crect id='Rectangle_3063' data-name='Rectangle 3063' class='cls-3' width='1' height='1' transform='translate(1075 475.999)'/%3e %3c/g%3e%3c/svg%3e",onClick:vd.toggleBullet,checked:e=>!!e.isBullet},numbering:{title:"Numbering",image:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-10536 -10457 32 32'%3e %3cdefs%3e %3cstyle%3e .cls-1 %7b fill: none%3b %7d .cls-2 %7b fill: %23666%3b %7d .cls-3 %7b fill: %232E77D0%3b %7d %3c/style%3e %3c/defs%3e %3cg id='_01-OL' data-name='01-OL' transform='translate(-11603 -10912.999)'%3e %3crect id='Rectangle_2306' data-name='Rectangle 2306' class='cls-1' width='32' height='32' rx='2' transform='translate(1067 455.999)'/%3e %3crect id='Rectangle_3057' data-name='Rectangle 3057' class='cls-2' width='12' height='1' transform='translate(1079 466.999)'/%3e %3crect id='Rectangle_3058' data-name='Rectangle 3058' class='cls-2' width='12' height='1' transform='translate(1079 470.999)'/%3e %3crect id='Rectangle_3059' data-name='Rectangle 3059' class='cls-2' width='12' height='1' transform='translate(1079 474.999)'/%3e %3cpath id='Path_1833' data-name='Path 1833' class='cls-3' d='M1.121-14.1a1.5%2c1.5%2c0%2c0%2c1-.311.178.877.877%2c0%2c0%2c1-.353.087v-.573q.257-.091.49-.2a2.376%2c2.376%2c0%2c0%2c0%2c.448-.274H1.8v3.2H1.121Zm-.008%2c3.486a1.414%2c1.414%2c0%2c0%2c1%2c.394.054.9.9%2c0%2c0%2c1%2c.324.166.794.794%2c0%2c0%2c1%2c.216.278.9.9%2c0%2c0%2c1%2c.079.39.982.982%2c0%2c0%2c1-.1.452%2c1.49%2c1.49%2c0%2c0%2c1-.245.349%2c2.013%2c2.013%2c0%2c0%2c1-.32.274q-.174.12-.32.224A1.744%2c1.744%2c0%2c0%2c0%2c.9-8.222a.307.307%2c0%2c0%2c0-.1.212H2.125v.573H.042q0-.191%2c0-.34A.89.89%2c0%2c0%2c1%2c.125-8.1a1.39%2c1.39%2c0%2c0%2c1%2c.34-.477q.216-.2.427-.361a3.419%2c3.419%2c0%2c0%2c0%2c.369-.332.548.548%2c0%2c0%2c0%2c.158-.39.366.366%2c0%2c0%2c0-.125-.315.549.549%2c0%2c0%2c0-.332-.091.958.958%2c0%2c0%2c0-.411.091%2c1.608%2c1.608%2c0%2c0%2c0-.361.232v-.606A1.674%2c1.674%2c0%2c0%2c1%2c1.112-10.617Zm.3%2c5.8a.944.944%2c0%2c0%2c1%2c.506.224.639.639%2c0%2c0%2c1%2c.208.506.877.877%2c0%2c0%2c1-.1.44.865.865%2c0%2c0%2c1-.27.295%2c1.19%2c1.19%2c0%2c0%2c1-.386.166%2c1.858%2c1.858%2c0%2c0%2c1-.444.054%2c2.5%2c2.5%2c0%2c0%2c1-.4-.033%2c1.341%2c1.341%2c0%2c0%2c1-.386-.125v-.606a1.155%2c1.155%2c0%2c0%2c0%2c.344.174%2c1.292%2c1.292%2c0%2c0%2c0%2c.386.058.8.8%2c0%2c0%2c0%2c.386-.091.351.351%2c0%2c0%2c0%2c.17-.34.326.326%2c0%2c0%2c0-.108-.27.657.657%2c0%2c0%2c0-.261-.125%2c1.347%2c1.347%2c0%2c0%2c0-.32-.037H.448v-.531H.714A1.377%2c1.377%2c0%2c0%2c0%2c1-5.084.508.508%2c0%2c0%2c0%2c1.233-5.2a.323.323%2c0%2c0%2c0%2c.1-.257.32.32%2c0%2c0%2c0-.137-.3.621.621%2c0%2c0%2c0-.328-.083%2c1.068%2c1.068%2c0%2c0%2c0-.614.2V-6.2a1.452%2c1.452%2c0%2c0%2c1%2c.378-.129%2c2.092%2c2.092%2c0%2c0%2c1%2c.394-.037%2c1.643%2c1.643%2c0%2c0%2c1%2c.365.042.946.946%2c0%2c0%2c1%2c.324.137.787.787%2c0%2c0%2c1%2c.232.245.671.671%2c0%2c0%2c1%2c.091.357.74.74%2c0%2c0%2c1-.162.5.868.868%2c0%2c0%2c1-.461.261Z' transform='translate(1075 480.999)'/%3e %3c/g%3e%3c/svg%3e",onClick:e=>vd.toggleNumbering(e),checked:e=>!!e.isNumbering},outdent:{title:"Decrease indent",image:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-10408 -10457 32 32'%3e %3cdefs%3e %3cstyle%3e .cls-1 %7b fill: none%3b %7d .cls-2 %7b fill: %23666%3b %7d .cls-3 %7b fill: %232E77D0%3b %7d %3c/style%3e %3c/defs%3e %3cg id='_05-IndentLeft' data-name='05-IndentLeft' transform='translate(-11475 -10912.999)'%3e %3crect id='Rectangle_2306' data-name='Rectangle 2306' class='cls-1' width='32' height='32' rx='2' transform='translate(1067 455.999)'/%3e %3crect id='Rectangle_3057' data-name='Rectangle 3057' class='cls-2' width='9' height='1' transform='translate(1082 466.999)'/%3e %3crect id='Rectangle_3058' data-name='Rectangle 3058' class='cls-2' width='6' height='1' transform='translate(1082 468.999)'/%3e %3crect id='Rectangle_3059' data-name='Rectangle 3059' class='cls-2' width='9' height='1' transform='translate(1082 470.999)'/%3e %3crect id='Rectangle_3060' data-name='Rectangle 3060' class='cls-2' width='6' height='1' transform='translate(1082 472.999)'/%3e %3crect id='Rectangle_3061' data-name='Rectangle 3061' class='cls-2' width='9' height='1' transform='translate(1082 474.999)'/%3e %3cg id='Group_3989' data-name='Group 3989' transform='translate(-11)'%3e %3crect id='Rectangle_3062' data-name='Rectangle 3062' class='cls-3' width='6' height='1' transform='translate(1086 470.999)'/%3e %3cpath id='Arrow' class='cls-3' d='M11395%2c10917v-4h4v1h-3v3Z' transform='translate(-14689.138 812.326) rotate(-45)'/%3e %3c/g%3e %3c/g%3e%3c/svg%3e",onClick:e=>vd.setIndentation(e,1)},indent:{title:"Increase indent",image:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-10376 -10457 32 32'%3e %3cdefs%3e %3cstyle%3e .cls-1 %7b fill: none%3b %7d .cls-2 %7b fill: %23666%3b %7d .cls-3 %7b fill: %232E77D0%3b %7d %3c/style%3e %3c/defs%3e %3cg id='_06-IndentRight' data-name='06-IndentRight' transform='translate(-11443 -10912.999)'%3e %3crect id='Rectangle_2306' data-name='Rectangle 2306' class='cls-1' width='32' height='32' rx='2' transform='translate(1067 455.999)'/%3e %3crect id='Rectangle_3057' data-name='Rectangle 3057' class='cls-2' width='9' height='1' transform='translate(1082 466.999)'/%3e %3crect id='Rectangle_3058' data-name='Rectangle 3058' class='cls-2' width='6' height='1' transform='translate(1082 468.999)'/%3e %3crect id='Rectangle_3059' data-name='Rectangle 3059' class='cls-2' width='9' height='1' transform='translate(1082 470.999)'/%3e %3crect id='Rectangle_3060' data-name='Rectangle 3060' class='cls-2' width='6' height='1' transform='translate(1082 472.999)'/%3e %3crect id='Rectangle_3061' data-name='Rectangle 3061' class='cls-2' width='9' height='1' transform='translate(1082 474.999)'/%3e %3cg id='Group_3988' data-name='Group 3988' transform='translate(2165.999 942.998) rotate(180)'%3e %3crect id='Rectangle_3062' data-name='Rectangle 3062' class='cls-3' width='6' height='1' transform='translate(1086 470.999)'/%3e %3cpath id='Arrow' class='cls-3' d='M11395%2c10917v-4h4v1h-3v3Z' transform='translate(-14689.138 812.326) rotate(-45)'/%3e %3c/g%3e %3c/g%3e%3c/svg%3e",onClick:e=>vd.setIndentation(e,0)},alignLeft:{title:"Align left",image:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-10504 -10457 32 32'%3e %3cdefs%3e %3cstyle%3e .cls-1 %7b fill: none%3b %7d .cls-2 %7b fill: %23666%3b %7d %3c/style%3e %3c/defs%3e %3cg id='_02-Left' data-name='02-Left' transform='translate(-11571 -10912.999)'%3e %3crect id='Rectangle_2306' data-name='Rectangle 2306' class='cls-1' width='32' height='32' rx='2' transform='translate(1067 455.999)'/%3e %3crect id='Rectangle_3057' data-name='Rectangle 3057' class='cls-2' width='17' height='1' transform='translate(1075 464.999)'/%3e %3crect id='Rectangle_3058' data-name='Rectangle 3058' class='cls-2' width='13' height='1' transform='translate(1075 467.999)'/%3e %3crect id='Rectangle_3059' data-name='Rectangle 3059' class='cls-2' width='17' height='1' transform='translate(1075 470.999)'/%3e %3crect id='Rectangle_3060' data-name='Rectangle 3060' class='cls-2' width='13' height='1' transform='translate(1075 473.999)'/%3e %3crect id='Rectangle_3061' data-name='Rectangle 3061' class='cls-2' width='17' height='1' transform='translate(1075 476.999)'/%3e %3c/g%3e%3c/svg%3e",onClick:e=>vd.setAlignment(e,0)},alignCenter:{title:"Align center",image:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-10472 -10457 32 32'%3e %3cdefs%3e %3cstyle%3e .cls-1 %7b fill: none%3b %7d .cls-2 %7b fill: %23666%3b %7d %3c/style%3e %3c/defs%3e %3cg id='_03-Center' data-name='03-Center' transform='translate(-11539 -10912.999)'%3e %3crect id='Rectangle_2306' data-name='Rectangle 2306' class='cls-1' width='32' height='32' rx='2' transform='translate(1067 455.999)'/%3e %3crect id='Rectangle_3057' data-name='Rectangle 3057' class='cls-2' width='17' height='1' transform='translate(1075 464.999)'/%3e %3crect id='Rectangle_3058' data-name='Rectangle 3058' class='cls-2' width='13' height='1' transform='translate(1077 467.999)'/%3e %3crect id='Rectangle_3059' data-name='Rectangle 3059' class='cls-2' width='17' height='1' transform='translate(1075 470.999)'/%3e %3crect id='Rectangle_3060' data-name='Rectangle 3060' class='cls-2' width='13' height='1' transform='translate(1077 473.999)'/%3e %3crect id='Rectangle_3061' data-name='Rectangle 3061' class='cls-2' width='17' height='1' transform='translate(1075 476.999)'/%3e %3c/g%3e%3c/svg%3e",onClick:e=>vd.setAlignment(e,1)},alignRight:{title:"Align right",image:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-10440 -10457 32 32'%3e %3cdefs%3e %3cstyle%3e .cls-1 %7b fill: none%3b %7d .cls-2 %7b fill: %23666%3b %7d %3c/style%3e %3c/defs%3e %3cg id='_04-Right' data-name='04-Right' transform='translate(-11507 -10912.999)'%3e %3crect id='Rectangle_2306' data-name='Rectangle 2306' class='cls-1' width='32' height='32' rx='2' transform='translate(1067 455.999)'/%3e %3crect id='Rectangle_3057' data-name='Rectangle 3057' class='cls-2' width='17' height='1' transform='translate(1075 464.999)'/%3e %3crect id='Rectangle_3058' data-name='Rectangle 3058' class='cls-2' width='13' height='1' transform='translate(1079 467.999)'/%3e %3crect id='Rectangle_3059' data-name='Rectangle 3059' class='cls-2' width='17' height='1' transform='translate(1075 470.999)'/%3e %3crect id='Rectangle_3060' data-name='Rectangle 3060' class='cls-2' width='13' height='1' transform='translate(1079 473.999)'/%3e %3crect id='Rectangle_3061' data-name='Rectangle 3061' class='cls-2' width='17' height='1' transform='translate(1075 476.999)'/%3e %3c/g%3e%3c/svg%3e",onClick:e=>vd.setAlignment(e,2)},unlink:{title:"Remove hyperlink",image:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-5860 -8896 32 32'%3e %3cdefs%3e %3cstyle%3e .cls-1 %7b fill: none%3b %7d .cls-2 %7b fill: %23666%3b %7d .cls-3 %7b fill: %23D82300%3b %7d %3c/style%3e %3c/defs%3e %3cg id='FB:_Unlink' data-name='FB: Unlink' transform='translate(-6880 -9199.999)'%3e %3crect id='Rectangle_2295' data-name='Rectangle 2295' class='cls-1' width='32' height='32' rx='2' transform='translate(1020 303.999)'/%3e %3cg id='Group_3910' data-name='Group 3910'%3e %3cpath id='Path_1712' data-name='Path 1712' class='cls-2' d='M-.531-13.812a3.558%2c3.558%2c0%2c0%2c1%2c1.444.295%2c3.854%2c3.854%2c0%2c0%2c1%2c1.179.8%2c3.7%2c3.7%2c0%2c0%2c1%2c.8%2c1.179%2c3.632%2c3.632%2c0%2c0%2c1%2c.291%2c1.448%2c3.632%2c3.632%2c0%2c0%2c1-.291%2c1.448%2c3.7%2c3.7%2c0%2c0%2c1-.8%2c1.179%2c3.854%2c3.854%2c0%2c0%2c1-1.179.8%2c3.558%2c3.558%2c0%2c0%2c1-1.444.295h-.531V-7.437h.531A2.572%2c2.572%2c0%2c0%2c0%2c.5-7.645a2.679%2c2.679%2c0%2c0%2c0%2c.843-.569%2c2.724%2c2.724%2c0%2c0%2c0%2c.573-.847%2c2.558%2c2.558%2c0%2c0%2c0%2c.212-1.033%2c2.529%2c2.529%2c0%2c0%2c0-.212-1.029%2c2.737%2c2.737%2c0%2c0%2c0-.573-.843A2.737%2c2.737%2c0%2c0%2c0%2c.5-12.538%2c2.529%2c2.529%2c0%2c0%2c0-.531-12.75h-4.25a2.558%2c2.558%2c0%2c0%2c0-1.033.212%2c2.724%2c2.724%2c0%2c0%2c0-.847.573%2c2.679%2c2.679%2c0%2c0%2c0-.569.843%2c2.572%2c2.572%2c0%2c0%2c0-.208%2c1.029A2.6%2c2.6%2c0%2c0%2c0-7.23-9.06a2.666%2c2.666%2c0%2c0%2c0%2c.569.847%2c2.666%2c2.666%2c0%2c0%2c0%2c.847.569%2c2.6%2c2.6%2c0%2c0%2c0%2c1.033.208h.531v1.063h-.531A3.587%2c3.587%2c0%2c0%2c1-6.23-6.67a3.788%2c3.788%2c0%2c0%2c1-1.179-.8%2c3.788%2c3.788%2c0%2c0%2c1-.8-1.179A3.587%2c3.587%2c0%2c0%2c1-8.5-10.094a3.587%2c3.587%2c0%2c0%2c1%2c.295-1.448%2c3.788%2c3.788%2c0%2c0%2c1%2c.8-1.179%2c3.788%2c3.788%2c0%2c0%2c1%2c1.179-.8%2c3.587%2c3.587%2c0%2c0%2c1%2c1.448-.295ZM7.421-7.1a2.661%2c2.661%2c0%2c0%2c0-.261-.971%2c2.686%2c2.686%2c0%2c0%2c0-.573-.78%2c2.65%2c2.65%2c0%2c0%2c0-.818-.523%2c2.574%2c2.574%2c0%2c0%2c0-.988-.191H4.25v-1.062h.531a3.587%2c3.587%2c0%2c0%2c1%2c1.448.295%2c3.788%2c3.788%2c0%2c0%2c1%2c1.179.8%2c3.788%2c3.788%2c0%2c0%2c1%2c.8%2c1.179A3.587%2c3.587%2c0%2c0%2c1%2c8.5-6.906a3.632%2c3.632%2c0%2c0%2c1-.091.8Zm-9.546.191a2.6%2c2.6%2c0%2c0%2c0%2c.208%2c1.033%2c2.666%2c2.666%2c0%2c0%2c0%2c.569.847A2.666%2c2.666%2c0%2c0%2c0-.5-4.458%2c2.6%2c2.6%2c0%2c0%2c0%2c.531-4.25H1.992L3.055-3.187H.531A3.587%2c3.587%2c0%2c0%2c1-.917-3.482a3.788%2c3.788%2c0%2c0%2c1-1.179-.8%2c3.788%2c3.788%2c0%2c0%2c1-.8-1.179%2c3.587%2c3.587%2c0%2c0%2c1-.295-1.448%2c3.587%2c3.587%2c0%2c0%2c1%2c.295-1.448%2c3.788%2c3.788%2c0%2c0%2c1%2c.8-1.179%2c3.788%2c3.788%2c0%2c0%2c1%2c1.179-.8%2c3.587%2c3.587%2c0%2c0%2c1%2c1.448-.295h.531v1.063H.531A2.558%2c2.558%2c0%2c0%2c0-.5-9.351a2.724%2c2.724%2c0%2c0%2c0-.847.573%2c2.679%2c2.679%2c0%2c0%2c0-.569.843A2.572%2c2.572%2c0%2c0%2c0-2.125-6.906Zm10.6%2c2.374L6.6-2.656%2c8.475-.772l-.747.747L5.844-1.9%2c3.959-.017%2c3.212-.772%2c5.1-2.656%2c3.212-4.541l.747-.747L5.844-3.4%2c7.728-5.288Z' transform='translate(1036 327.999)'/%3e %3cpath id='Path_1391' data-name='Path 1391' class='cls-3' d='M8.475-4.532%2c6.6-2.656%2c8.475-.772l-.747.747L5.844-1.9%2c3.959-.017%2c3.212-.772%2c5.1-2.656%2c3.212-4.541l.747-.747L5.844-3.4%2c7.728-5.288Z' transform='translate(1036 327.999)'/%3e %3c/g%3e %3c/g%3e%3c/svg%3e",onClick:vd.removeLink},code:{title:"Code block",image:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32'%3e %3cg%3e %3cline id='svg_1' y2='16.5' x2='7' y1='10' x1='13' stroke-width='1' stroke='black' fill='none'/%3e %3cline id='svg_2' y2='16.5' x2='7' y1='23' x1='13' stroke-width='1' stroke='black' fill='none'/%3e %3cline id='svg_3' y2='16.5' x2='26' y1='10' x1='20' stroke-width='1' stroke='black' fill='none'/%3e %3cline id='svg_4' y2='16.5' x2='26' y1='23' x1='20' stroke-width='1' stroke='black' fill='none'/%3e %3c/g%3e%3c/svg%3e",onClick:e=>vd.toggleCodeBlock(e)},ltr:{title:"Left-to-right",image:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-5896 -8824 32 32'%3e %3cdefs%3e %3cstyle%3e .cls-1 %7b fill: none%3b %7d .cls-2 %7b fill: %23666%3b %7d .cls-3 %7b fill: %232E77D0%3b %7d %3c/style%3e %3c/defs%3e %3cg id='FB:_Paragraph_In' data-name='FB: Paragraph In' transform='translate(-6884 -9191.999)'%3e %3crect id='Rectangle_2295' data-name='Rectangle 2295' class='cls-1' width='32' height='32' rx='2' transform='translate(988 367.999)'/%3e %3cg id='Group_3954' data-name='Group 3954'%3e %3cpath id='Path_1756' data-name='Path 1756' class='cls-2' d='M-7.437-12.966l5.528%2c5.528L-7.437-1.909Zm1.063%2c8.5L-3.4-7.437l-2.972-2.972ZM6.375-14.875v12.75H7.438v1.063H2.125V-2.125H3.188V-8.5H1.594A3.632%2c3.632%2c0%2c0%2c1%2c.145-8.791a3.745%2c3.745%2c0%2c0%2c1-1.183-.8%2c3.745%2c3.745%2c0%2c0%2c1-.8-1.183%2c3.632%2c3.632%2c0%2c0%2c1-.291-1.448%2c3.632%2c3.632%2c0%2c0%2c1%2c.291-1.448%2c3.745%2c3.745%2c0%2c0%2c1%2c.8-1.183%2c3.745%2c3.745%2c0%2c0%2c1%2c1.183-.8%2c3.632%2c3.632%2c0%2c0%2c1%2c1.448-.291H7.438v1.063ZM3.188-9.562v-5.312H1.594a2.558%2c2.558%2c0%2c0%2c0-1.033.212%2c2.724%2c2.724%2c0%2c0%2c0-.847.573%2c2.679%2c2.679%2c0%2c0%2c0-.569.843%2c2.572%2c2.572%2c0%2c0%2c0-.208%2c1.029%2c2.6%2c2.6%2c0%2c0%2c0%2c.208%2c1.033%2c2.666%2c2.666%2c0%2c0%2c0%2c.569.847A2.666%2c2.666%2c0%2c0%2c0%2c.56-9.77a2.6%2c2.6%2c0%2c0%2c0%2c1.033.208ZM5.313-2.125v-12.75H4.25v12.75Z' transform='translate(1004 391.999)'/%3e %3cpath id='Path_1404' data-name='Path 1404' class='cls-3' d='M-7.437-12.966l5.528%2c5.528L-7.437-1.909Zm1.063%2c8.5L-3.4-7.437l-2.972-2.972Z' transform='translate(1004 391.999)'/%3e %3c/g%3e %3c/g%3e%3c/svg%3e",onClick:e=>vd.setDirection(e,0)},rtl:{title:"Right-to-left",image:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-5860 -8824 32 32'%3e %3cdefs%3e %3cstyle%3e .cls-1 %7b fill: none%3b %7d .cls-2 %7b fill: %23666%3b %7d .cls-3 %7b fill: %232E77D0%3b %7d %3c/style%3e %3c/defs%3e %3cg id='FB:_Paragraph_Out' data-name='FB: Paragraph Out' transform='translate(-6880 -9191.999)'%3e %3crect id='Rectangle_2295' data-name='Rectangle 2295' class='cls-1' width='32' height='32' rx='2' transform='translate(1020 367.999)'/%3e %3cg id='Group_3965' data-name='Group 3965'%3e %3cpath id='Path_1767' data-name='Path 1767' class='cls-2' d='M1.063-15.937v1.063H0v12.75H1.063v1.063H-4.25V-2.125h1.063V-8.5H-4.781A3.632%2c3.632%2c0%2c0%2c1-6.23-8.791a3.745%2c3.745%2c0%2c0%2c1-1.183-.8%2c3.745%2c3.745%2c0%2c0%2c1-.8-1.183A3.632%2c3.632%2c0%2c0%2c1-8.5-12.219a3.632%2c3.632%2c0%2c0%2c1%2c.291-1.448%2c3.745%2c3.745%2c0%2c0%2c1%2c.8-1.183%2c3.745%2c3.745%2c0%2c0%2c1%2c1.183-.8%2c3.632%2c3.632%2c0%2c0%2c1%2c1.448-.291Zm-4.25%2c6.375v-5.312H-4.781a2.558%2c2.558%2c0%2c0%2c0-1.033.212%2c2.724%2c2.724%2c0%2c0%2c0-.847.573%2c2.679%2c2.679%2c0%2c0%2c0-.569.843%2c2.572%2c2.572%2c0%2c0%2c0-.208%2c1.029%2c2.6%2c2.6%2c0%2c0%2c0%2c.208%2c1.033%2c2.666%2c2.666%2c0%2c0%2c0%2c.569.847%2c2.666%2c2.666%2c0%2c0%2c0%2c.847.569%2c2.6%2c2.6%2c0%2c0%2c0%2c1.033.208Zm2.125%2c7.438v-12.75H-2.125v12.75Zm8.5-10.841V-1.909L1.909-7.437ZM6.375-10.409%2c3.4-7.437%2c6.375-4.466Z' transform='translate(1036 391.999)'/%3e %3cpath id='Path_1401' data-name='Path 1401' class='cls-3' d='M7.438-12.966V-1.909L1.909-7.437ZM6.375-10.409%2c3.4-7.437%2c6.375-4.466Z' transform='translate(1036 391.999)'/%3e %3c/g%3e %3c/g%3e%3c/svg%3e",onClick:e=>vd.setDirection(e,1)},undo:{title:"Undo",image:"data:image/svg+xml,%3c%3fxml version='1.0' encoding='UTF-8'%3f%3e%3csvg viewBox='-8 -8 32 32' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e %3cdefs%3e %3cpath d='M8.5%2c0.03125 C9.0000025%2c0.03125 9.48176852%2c0.0963535156 9.9453125%2c0.2265625 C10.4088565%2c0.356771484 10.843748%2c0.541665469 11.25%2c0.78125 C11.656252%2c1.02083453 12.02604%2c1.30729 12.359375%2c1.640625 C12.69271%2c1.97396 12.9791655%2c2.34374797 13.21875%2c2.75 C13.4583345%2c3.15625203 13.6432285%2c3.59114352 13.7734375%2c4.0546875 C13.9036465%2c4.51823148 13.96875%2c4.9999975 13.96875%2c5.5 C13.96875%2c6.21354523 13.8320326%2c6.90234043 13.5585938%2c7.56640625 C13.2851549%2c8.23047207 12.8958359%2c8.81510164 12.390625%2c9.3203125 L5.8515625%2c15.8515625 L5.1484375%2c15.1484375 L11.6796875%2c8.609375 C12.0911479%2c8.19791461 12.408853%2c7.72265895 12.6328125%2c7.18359375 C12.856772%2c6.64452855 12.96875%2c6.08333625 12.96875%2c5.5 C12.96875%2c4.89062195 12.8502616%2c4.31510687 12.6132812%2c3.7734375 C12.3763009%2c3.23176813 12.0546895%2c2.75781453 11.6484375%2c2.3515625 C11.2421855%2c1.94531047 10.7682319%2c1.6236991 10.2265625%2c1.38671875 C9.68489312%2c1.1497384 9.10937805%2c1.03125 8.5%2c1.03125 C7.93749719%2c1.03125 7.4414084%2c1.11588457 7.01171875%2c1.28515625 C6.5820291%2c1.45442793 6.18489766%2c1.67838402 5.8203125%2c1.95703125 C5.45572734%2c2.23567848 5.10547043%2c2.55208156 4.76953125%2c2.90625 C4.43359207%2c3.26041844 4.08073102%2c3.62499813 3.7109375%2c4 L7%2c4 L7%2c5 L2%2c5 L2%2c0 L3%2c0 L3%2c3.2890625 C3.28645977%2c2.99739438 3.5611966%2c2.71484512 3.82421875%2c2.44140625 C4.0872409%2c2.16796738 4.3502591%2c1.91015746 4.61328125%2c1.66796875 C4.8763034%2c1.42578004 5.14452988%2c1.20442809 5.41796875%2c1.00390625 C5.69140762%2c0.803384414 5.98307137%2c0.631511133 6.29296875%2c0.48828125 C6.60286613%2c0.345051367 6.93880027%2c0.23307332 7.30078125%2c0.15234375 C7.66276223%2c0.0716141797 8.06249781%2c0.03125 8.5%2c0.03125 Z' id='path-1'%3e%3c/path%3e %3c/defs%3e %3cg id='Undo_16x16' stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'%3e %3cg id='undo'%3e %3cuse id='Mask' fill='%23666666' fill-rule='evenodd' xlink:href='%23path-1'%3e%3c/use%3e %3c/g%3e %3c/g%3e%3c/svg%3e",onClick:e=>e.undo()},redo:{title:"Redo",image:"data:image/svg+xml,%3c%3fxml version='1.0' encoding='UTF-8'%3f%3e%3csvg viewBox='-8 -8 32 32' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e %3cdefs%3e %3cpath d='M8.5%2c0.03125 C9.0000025%2c0.03125 9.48176852%2c0.0963535156 9.9453125%2c0.2265625 C10.4088565%2c0.356771484 10.843748%2c0.541665469 11.25%2c0.78125 C11.656252%2c1.02083453 12.02604%2c1.30729 12.359375%2c1.640625 C12.69271%2c1.97396 12.9791655%2c2.34374797 13.21875%2c2.75 C13.4583345%2c3.15625203 13.6432285%2c3.59114352 13.7734375%2c4.0546875 C13.9036465%2c4.51823148 13.96875%2c4.9999975 13.96875%2c5.5 C13.96875%2c6.21354523 13.8320326%2c6.90234043 13.5585938%2c7.56640625 C13.2851549%2c8.23047207 12.8958359%2c8.81510164 12.390625%2c9.3203125 L5.8515625%2c15.8515625 L5.1484375%2c15.1484375 L11.6796875%2c8.609375 C12.0911479%2c8.19791461 12.408853%2c7.72265895 12.6328125%2c7.18359375 C12.856772%2c6.64452855 12.96875%2c6.08333625 12.96875%2c5.5 C12.96875%2c4.89062195 12.8502616%2c4.31510687 12.6132812%2c3.7734375 C12.3763009%2c3.23176813 12.0546895%2c2.75781453 11.6484375%2c2.3515625 C11.2421855%2c1.94531047 10.7682319%2c1.6236991 10.2265625%2c1.38671875 C9.68489312%2c1.1497384 9.10937805%2c1.03125 8.5%2c1.03125 C7.93749719%2c1.03125 7.4414084%2c1.11588457 7.01171875%2c1.28515625 C6.5820291%2c1.45442793 6.18489766%2c1.67838402 5.8203125%2c1.95703125 C5.45572734%2c2.23567848 5.10547043%2c2.55208156 4.76953125%2c2.90625 C4.43359207%2c3.26041844 4.08073102%2c3.62499813 3.7109375%2c4 L7%2c4 L7%2c5 L2%2c5 L2%2c0 L3%2c0 L3%2c3.2890625 C3.28645977%2c2.99739438 3.5611966%2c2.71484512 3.82421875%2c2.44140625 C4.0872409%2c2.16796738 4.3502591%2c1.91015746 4.61328125%2c1.66796875 C4.8763034%2c1.42578004 5.14452988%2c1.20442809 5.41796875%2c1.00390625 C5.69140762%2c0.803384414 5.98307137%2c0.631511133 6.29296875%2c0.48828125 C6.60286613%2c0.345051367 6.93880027%2c0.23307332 7.30078125%2c0.15234375 C7.66276223%2c0.0716141797 8.06249781%2c0.03125 8.5%2c0.03125 Z' id='path-1'%3e%3c/path%3e %3c/defs%3e %3cg id='Redo_16x16' stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'%3e %3cg id='undo' transform='translate(8.000000%2c 8.000000) scale(-1%2c 1) translate(-8.000000%2c -8.000000) '%3e %3cuse id='Mask' fill='%23666666' fill-rule='evenodd' xlink:href='%23path-1'%3e%3c/use%3e %3c/g%3e %3c/g%3e%3c/svg%3e",onClick:e=>e.redo()},insertImage:{title:"Insert inline image",image:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-6111 -8692 32 32'%3e %3cdefs%3e %3cstyle%3e .cls-1 %7b fill: none%3b %7d .cls-2 %7b fill: %232E77D0%3b stroke: white%3b stroke-width: 1.5px%3b %7d .cls-3 %7b fill: %23666%3b %7d %3c/style%3e %3c/defs%3e %3cg id='TB:_Insert' data-name='TB: Insert' transform='translate(-6366 -9160.999)'%3e %3crect id='Rectangle_2291' data-name='Rectangle 2291' class='cls-1' width='32' height='32' rx='2' transform='translate(255 468.999)'/%3e %3cg id='Group_3880' data-name='Group 3880'%3e %3cpath id='Path_990' data-name='Path 990' class='cls-2' d='M1.063-3.187H11.995L4.781-10.409%2c1.063-6.682Zm14.875%2c0v-.307L12.219-7.222%2c10.841-5.844l2.665%2c2.656Z' transform='translate(263 492.999)'/%3e %3cpath id='Path_1452' data-name='Path 1452' class='cls-3' d='M17-14.875v12.75H0v-12.75ZM1.063-13.812v5.62L4.781-11.9l5.313%2c5.313%2c2.125-2.125%2c3.719%2c3.71v-8.807Zm0%2c10.625H11.995L4.781-10.409%2c1.063-6.682Zm14.875%2c0v-.307L12.219-7.222%2c10.841-5.844l2.665%2c2.656Zm-2.656-7.437a.511.511%2c0%2c0%2c1-.374-.158.511.511%2c0%2c0%2c1-.158-.374.511.511%2c0%2c0%2c1%2c.158-.374.511.511%2c0%2c0%2c1%2c.374-.158.511.511%2c0%2c0%2c1%2c.374.158.511.511%2c0%2c0%2c1%2c.158.374.511.511%2c0%2c0%2c1-.158.374A.511.511%2c0%2c0%2c1%2c13.281-10.625Z' transform='translate(263 492.999)'/%3e %3c/g%3e %3c/g%3e%3c/svg%3e",onClick:(n,r)=>{const e=n.getDocument(),o=e.createElement("input");o.type="file",o.accept="image/*",o.style.display="none",o.addEventListener("change",()=>{var e=void 0,a=void 0,l=void 0,s=function*(){var e,[t]=null!==(e=null==o?void 0:o.files)&&void 0!==e?e:[];if(t&&r){const e=yield r(t);"string"==typeof e?vd.insertImage(n,e):vd.insertImage(n,t)}};return new(l=l||Promise)(function(n,t){function r(e){try{i(s.next(e))}catch(e){t(e)}}function o(e){try{i(s.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?n(e.value):((t=e.value)instanceof l?t:new l(function(e){e(t)})).then(r,o)}i((s=s.apply(e,a||[])).next())})}),e.body.appendChild(o),o.click(),e.body.removeChild(o)}}};function v2(e,t,n){var r;const o=h2("div",{class:"toolbar"}),d=vd.getFormatState(n),u=null==e?void 0:e.parentNode,i=Object.keys(t);for(const[e,a]of i.entries())if(g2[a]){const{image:i="",onClick:l,checked:f=()=>{},title:s}=g2[a],h=f(d)||!1,c=h2("button",{class:"toolbar-button",id:a,title:s,"aria-label":s,type:"button",tabindex:0===e?"0":"-1"},h2("img",{src:i,alt:s,width:"30",height:"30"}));c.onclick=()=>{c.classList.toggle("active"),c.setAttribute("tabindex","0"),null!=t&&t.insertImage?l(n,null==t?void 0:t.insertImage):l(n)},null===(r=null==u?void 0:u.querySelector("#"+a))||void 0===r||r.classList.toggle("active",h),o.appendChild(c)}return o.onkeydown=e=>{var t;if("ArrowLeft"===e.key||"ArrowRight"===e.key){const n=document.querySelector(".toolbar"),r=null==n?void 0:n.querySelector('button[tabindex="0"]');"ArrowRight"===e.key&&r.nextSibling?(r.setAttribute("tabindex","-1"),r.classList.remove("active"),null===(t=r.nextElementSibling)||void 0===t||t.setAttribute("tabindex","0"),null===(t=r.nextElementSibling)||void 0===t||t.focus()):"ArrowLeft"===e.key&&r.previousSibling&&(r.setAttribute("tabindex","-1"),r.classList.remove("active"),null===(t=r.previousElementSibling)||void 0===t||t.setAttribute("tabindex","0"),null===(e=r.previousElementSibling)||void 0===e||e.focus())}},o}class m2{constructor(e,t){this.rootElement=e,this.toolbarConfig=t}getName(){return"Toolbar"}initialize(e){this.editor=e}dispose(){this.editor=null}getEditor(){return this.editor}updateToolbarOptions(){this.editor&&v2(this.rootElement,this.toolbarConfig,this.editor)}onPluginEvent(e){if(this.editor)if(0==e.eventType||6==e.eventType)this.updateToolbarOptions();else if(7==e.eventType){const t=this.editor.getCustomData("LAST_CLIPBOARD_DATA")||{data:null};"Paste"==e.source?t.data=e.data:t.data=null}else 11==e.eventType&&this.updateToolbarOptions()}}return p2(".editor-container {\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.editor-textarea {\r\n  flex: 1 1 auto;\r\n  min-height: 100px;\r\n  border: 2px solid #ddd;\r\n  overflow: auto;\r\n  padding: 10px;\r\n}\r\n"),c.RoosterEditor=class{constructor(e,t){this.rootElement=e,this.config=t}mount(){var e;this.createWrapperDiv(),this.editor=new d.Editor(this.rootElement,{plugins:[...f2,new m2(this.rootElement,null===(e=this.config)||void 0===e?void 0:e.toolbar)]}),this.rootElement.classList.add("editor-textarea"),this.config.readonly?this.rootElement.contentEditable="false":this.mountWithToolbar()}unmount(){this.editor.dispose(),this.replaceWrapperDiv()}getContent(e){return this.editor.getContent(e)}setContent(e){return this.editor.setContent(e)}createWrapperDiv(){const e=h2("div",{class:"editor-container"});e.style.width=this.config.width||"100%",e.style.height=this.config.height||"100%",this.container=e}replaceWrapperDiv(){var e,t;this.rootElement&&(null===(e=null==(t=this.rootElement.parentNode)?void 0:t.parentNode)||void 0===e||e.replaceChild(this.rootElement,t))}mountWithToolbar(){var e,t;if(!this.config.toolbar)throw new Error("Toolbar options are not passed in config.");this.container&&(t=v2(this.rootElement,null===(t=this.config)||void 0===t?void 0:t.toolbar,this.editor),null===(e=null===(e=this.rootElement)||void 0===e?void 0:e.parentElement)||void 0===e||e.replaceChild(this.container,this.rootElement),null===(e=this.container)||void 0===e||e.appendChild(this.rootElement),null===(e=this.container)||void 0===e||e.prepend(t))}},Object.defineProperty(c,"__esModule",{value:!0}),c}({});
